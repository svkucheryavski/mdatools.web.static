var Jh=Object.defineProperty;var _c=at=>{throw TypeError(at)};var Qh=(at,$e,xt)=>$e in at?Jh(at,$e,{enumerable:!0,configurable:!0,writable:!0,value:xt}):at[$e]=xt;var yr=(at,$e,xt)=>Qh(at,typeof $e!="symbol"?$e+"":$e,xt),ja=(at,$e,xt)=>$e.has(at)||_c("Cannot "+xt);var Ue=(at,$e,xt)=>(ja(at,$e,"read from private field"),xt?xt.call(at):$e.get(at)),zt=(at,$e,xt)=>$e.has(at)?_c("Cannot add the same private member more than once"):$e instanceof WeakSet?$e.add(at):$e.set(at,xt),Xt=(at,$e,xt,sn)=>(ja(at,$e,"write to private field"),sn?sn.call(at,xt):$e.set(at,xt),xt),ln=(at,$e,xt)=>(ja(at,$e,"access private method"),xt);(function(){"use strict";var Yn,Wn,en,ml,hl,Cn,Un,Sn,tn,Hn,gl,pl,br,wc,vs,qa,rn,Gn,bl,us,yc,gc;var at=document.createElement("style");at.textContent=`button.svelte-ymtj5z{display:inline-block;font-size:.9em;padding:0 .5em;line-height:1.5em;border-radius:.25em;box-shadow:none;margin:0;text-align:center;border:1px solid}.button.svelte-ymtj5z:focus-visible{outline:solid 2px;outline-offset:2px}button.svelte-bx9fh5{display:inline-block;font-size:1em;width:1.3em;height:1.3em;border:none;border-radius:50%;box-shadow:none;margin:0 .25em;text-align:center;padding:0;background-size:45% 45%;background-position:50%;background-repeat:no-repeat}button.svelte-bx9fh5:last-of-type{margin-right:0}.button.svelte-bx9fh5:focus-visible{outline:solid 2px;outline-offset:2px}.control-element.svelte-1986c5z{font-size:.85em;background:var(--container-bg-color, #fff);color:var(--text-color-dark, #606570);padding:.5em .5em .5em 1em;border-radius:0;display:flex;justify-items:flex-start;justify-content:flex-start;align-items:center;margin-bottom:.5px}.control-element.svelte-1986c5z:hover{background:var(--container-bg-color, #fafdff)}.control-element.svelte-1986c5z:first-child{margin-top:.25rem;border-top-left-radius:.25rem;border-top-right-radius:.25rem}.control-element.svelte-1986c5z:last-child{margin-bottom:.25rem;border-bottom-left-radius:.25rem;border-bottom-right-radius:.25rem}.hidden.svelte-1986c5z{display:none}.control-element.error.svelte-1986c5z{background:var(--warning-color, crimson);color:var(--warning-text-color, #fefefe)}.label.svelte-1986c5z{padding-right:.75em;flex-grow:0;flex-shrink:1;color:var(--text-color-dark, #606570)}.control-element.svelte-1986c5z>.wrapper{flex:1 1 auto;position:relative;box-sizing:border-box;display:inline-block;margin:0;padding:0;width:auto;align-items:flex-start;justify-content:center;justify-items:flex-start}.control-element.svelte-1986c5z>h2{text-align:left;flex-grow:1;padding:0 .25em 0 0;margin:0;font-size:1.1em}.control-element.svelte-1986c5z>p{text-align:left;flex-grow:1;padding:0 .25em 0 0;margin:0;font-size:max(12px,.9em)}.control-element.error p{color:var(--warning-text-color, #fefafa)}.control-element.error a{color:var(--warning-link-color, #ffeeaa)}.control-element.error a:hover{color:var(--warning-link-hover-color, #ffee80)}.control-element.svelte-1986c5z>.title{font-size:1.05em;font-weight:700;color:var(--text-color-dark, #606570);flex-grow:1;padding:.3em 0;margin:0}.control-element.svelte-1986c5z>.range-slider-container{outline-color:var(--outline-color, #ccc);background:var(--bg-color-light, #f0f0f0)}.control-element.svelte-1986c5z>.range-slider-container:focus-visible{outline-color:var(--outline-color, #ccc)}.control-element.svelte-1986c5z .range-slider{color:var(--text-color-light, #fafafa);background-color:var(--main-color1, #6eb8ff);border-right-color:var(--main-color2, #528abe)}.control-element.svelte-1986c5z .range-value{color:var(--text-color-light, #fafafa)}.control-element.svelte-1986c5z .range-value_left,.control-element.svelte-1986c5z .range-value_right{color:var(--text-color-dark, #606570)}.control-element.svelte-1986c5z .button{border-color:transparent;background-color:var(--bg-color-dark, #606570);color:var(--text-color-light, #fafafa);outline-color:var(--outline-color, #ccc)}.control-element.svelte-1986c5z .button:hover{border-color:var(--main-color1, #6eb8ff);background-color:var(--main-color1-light, #6eb8ff20);color:var(--main-color2, #5086b9)}.control-element.svelte-1986c5z .button-cancel{background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" version="2.0" viewBox="0 0 100 100" style="stroke:%23fafafa;stroke-width:1em;" ><line x1="0" y1="0" x2="100" y2="100"/><line x1="0" y1="100" x2="100" y2="0"/></svg>')}.control-element.svelte-1986c5z .button-cancel:hover{background-color:var(--warning-color, #dc143c)}.control-element.svelte-1986c5z .button-undo{background-image:url('data:image/svg+xml;utf8,<svg width="99px" height="99px" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><g stroke-linecap="round" stroke-linejoin="round" ><path d="M6 7L7 6L4.70711 3.70711L5.19868 3.21553C5.97697 2.43724 7.03256 2 8.13323 2C11.361 2 14 4.68015 14 7.93274C14 11.2589 11.3013 14 8 14C6.46292 14 4.92913 13.4144 3.75736 12.2426L2.34315 13.6569C3.90505 15.2188 5.95417 16 8 16C12.4307 16 16 12.3385 16 7.93274C16 3.60052 12.4903 0 8.13323 0C6.50213 0 4.93783 0.647954 3.78447 1.80132L3.29289 2.29289L1 0L0 1V7H6Z" fill="%23fafafa"></path> </g></svg>')}.control-element.svelte-1986c5z .button-undo:hover{background-color:var(--main-color1,#6eb8ff)}.control-element.svelte-1986c5z .button-up{background-image:url('data:image/svg+xml;utf8,<svg viewBox="0 0 110 110" style="stroke:%23fafafa;stroke-width:1.1em;" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><line x1="55" y1="110" x2="55" y2="10"/><line x1="20" y1="50" x2="55" y2="10"/><line x1="90" y1="50" x2="55" y2="10"/></svg>')}.control-element.svelte-1986c5z .button-up:hover{background-color:var(--main-color1,#6eb8ff)}.control-element.svelte-1986c5z .button-down{background-image:url('data:image/svg+xml;utf8,<svg viewBox="0 0 110 110" style="stroke:%23fafafa;stroke-width:1.1em;" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><line x1="55" y1="0" x2="55" y2="100"/><line x1="20" y1="60" x2="55" y2="100"/><line x1="90" y1="60" x2="55" y2="100"/></svg>')}.control-element.svelte-1986c5z .button-down:hover{background-color:var(--main-color1,#6eb8ff)}.control-element.svelte-1986c5z .button-download{background-image:url('data:image/svg+xml;utf8,<svg viewBox="0 0 110 110" style="stroke:%23fafafa;stroke-width:1.1em;" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><line x1="50" y1="0" x2="50" y2="100"/><line x1="10" y1="60" x2="50" y2="100"/><line x1="90" y1="60" x2="50" y2="100"/></svg>')}.control-element.svelte-1986c5z .button-download:hover{background-color:var(--main-color1,#6eb8ff)}.control-element.svelte-1986c5z .button-add{background-image:url('data:image/svg+xml;utf8,<svg viewBox="0 0 110 110" style="stroke:%23fafafa;stroke-width:1.1em;" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><line x1="55" y1="0" x2="55" y2="110"/><line x1="0" y1="55" x2="110" y2="55"/></svg>')}.control-element.svelte-1986c5z .button-add:hover{background-color:var(--main-color1,#6eb8ff)}.control-element.svelte-1986c5z .button-settings{background-size:75%;background-image:url('data:image/svg+xml;utf8,<svg width="16" height="16" viewBox="0 0 16 16"  style="stroke:none;stroke-width:1px;" fill="%23fafafa" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><path d="M12.2418 6.58543L6.27026 12.5584C5.94986 12.8788 5.54841 13.1061 5.10883 13.216L2.81783 13.7887C2.45164 13.8803 2.11994 13.5486 2.21149 13.1824L2.78424 10.8914C2.89413 10.4518 3.12143 10.0504 3.44183 9.72996L9.41337 3.75701L12.2418 6.58543ZM13.6567 2.3435C14.4378 3.12455 14.4378 4.39088 13.6567 5.17193L12.9489 5.87833L10.1205 3.0499L10.8283 2.3435C11.6093 1.56245 12.8757 1.56245 13.6567 2.3435Z"/></svg>')}.control-element.svelte-1986c5z .button-settings:hover{background-color:var(--main-color1,#6eb8ff)}.control-element.svelte-1986c5z .selector:focus-visible{outline:2px solid;outline-offset:2px;outline-color:var(--outline-color, #ccc)}.control-element.svelte-1986c5z .selector>.option{color:var(--text-color-dark, #606570);background-color:var(--bg-color-light, #f0f0f0)}.control-element.svelte-1986c5z .plot-selector>.option>svg{stroke:var(--main-color1, #606570)}.control-element.svelte-1986c5z .plot-selector>.option.selected>svg{stroke:var(--text-color-light, #fefefe)}.control-element.svelte-1986c5z .selector>.option.selected{background-color:var(--main-color1, #6eb8ff);color:var(--text-color-light, #fefefe)}.control-element.svelte-1986c5z .selector>.option:not(.selected):hover{border:1px solid var(--main-color1, #6eb8ff);background-color:var(--main-color1-light, #6eb8ff20);color:var(--main-color2, #4777a4)}.control-element.svelte-1986c5z .selector>.option:not(.selected):hover>svg{stroke:var(--main-color2, #4777a4)}.control-element.svelte-1986c5z .file-selector:before{color:var(--text-color-dark, #606570)}.control-element.svelte-1986c5z .file-selector.selected:before{color:var(--main-color1, #6eb8ff)}.control-element.svelte-1986c5z .file-selector:focus-visible{outline-color:var(--outline-color, #ccc)}.control-element.svelte-1986c5z .file-selector:focus-visible:before{outline-color:var(--outline-color, #ccc);color:var(--main-color1, #6eb8ff)}.control-element.svelte-1986c5z .file-selector:hover:before{color:var(--main-color1, #6eb8ff)}.control-element.svelte-1986c5z .textinput>input{background-color:var(--main-color1, #6eb8ff);color:var(--text-color-light, #fefefe)}.control-element.svelte-1986c5z .textinput>input:placeholder-shown{color:var(--text-color-dark, #a0a0a0);background-color:var(--bg-color-light, #f0f0f0);border-color:var(--bg-color-light, #f0f0f0)}.control-element.svelte-1986c5z .textinput>input::placeholder{color:#a0a0a0}.control-element.svelte-1986c5z .textinput>input:active::placeholder,.control-element.svelte-1986c5z .textinput>input:focus::placeholder{color:transparent}.control-element.svelte-1986c5z .textinput>input:focus,.control-element.svelte-1986c5z .textinput>input:active{border-color:var(--main-color1, #6eb8ff);background-color:var(--main-color1-light, #6eb8ff20);color:var(--main-color2, #4777a4)}.control-element.svelte-1986c5z .textinput.error>input,.control-element.svelte-1986c5z .textinput.error>input:focus,.control-element.svelte-1986c5z .textinput.error>input:active{color:var(--warning-color, crimson);background-color:var(--warning-color-light, #ffd5ce);border-color:var(--warning-color, crimson)}.control-element.svelte-1986c5z .textinput.error>.error-message{color:var(--warning-color, crimson);background-color:var(--warning-color-light, #ffd5ce)}.control-element.svelte-1986c5z .spinner:after{border-color:var(--main-color1, #6eb8ff) transparent var(--main-color1, #6eb8ff) transparent}.control-element.svelte-1986c5z .number-container{background-color:var(--bg-color-light, #f0f0f0)}.control-element.svelte-1986c5z .number-container>.value{color:var(--text-color-dark, #606570)}.control-element.svelte-1986c5z .number-container>.button-small>svg>polygon{fill:var(--main-color2, #4777a4)}.control-element.svelte-1986c5z .number-container>.button-small:hover>svg>polygon{fill:var(--main-color1, #6eb8ff)}.control-element.svelte-1986c5z .number-container:focus-visible{outline-color:var(--outline-color, #ccc)}.range-slider-container.svelte-vhx0r0{position:relative;box-sizing:border-box;flex:1 1 auto;height:1.5em;margin:0;padding:0;width:auto;border-radius:2px;cursor:default;display:flex;align-items:center;user-select:none;-webkit-user-select:none;-moz-user-select:none}.range-slider-container.svelte-vhx0r0:focus-visible{outline:solid 2px #ccc;outline-offset:2px}.range-slider.svelte-vhx0r0{position:relative;display:flex;justify-content:right;align-items:center;box-sizing:border-box;border-radius:2px;border-right:solid 5px;text-align:right;margin:0;padding:0;height:100%;cursor:default;user-select:none;-webkit-user-select:none;-moz-user-select:none}.range-slider_right.svelte-vhx0r0{justify-content:left}.range-value.svelte-vhx0r0{display:inline-block;margin:0;padding:0;cursor:default;font-size:.85em;position:relative;user-select:none;-webkit-user-select:none;-moz-user-select:none;right:.25em}.range-value_right.svelte-vhx0r0{left:calc(100% + 5px + .25em)}.range-slider-container.svelte-xdlm7u{position:relative;box-sizing:border-box;display:inline-block;flex:1 1 auto;height:1.5em;margin:0;padding:0;width:auto;border-radius:2px;cursor:default;display:flex;align-items:center;user-select:none;-webkit-user-select:none;-moz-user-select:none}.range-slider-container.svelte-xdlm7u:focus-visible{outline:solid 2px;outline-offset:2px}.range-slider.svelte-xdlm7u{position:relative;display:flex;justify-content:center;align-items:center;box-sizing:border-box;border-radius:2px;text-align:center;margin:0;padding:0;height:100%;cursor:default;user-select:none;-webkit-user-select:none;-moz-user-select:none}.range-slider_left.svelte-xdlm7u{justify-content:left}.range-slider_right.svelte-xdlm7u{justify-content:right}.range-value.svelte-xdlm7u{display:inline-block;margin:0;padding:0;cursor:default;font-size:.85em;user-select:none;-webkit-user-select:none;-moz-user-select:none}.range-value_left.svelte-xdlm7u{position:relative;left:calc(100% + .25em)}.range-value_right.svelte-xdlm7u{position:relative;right:calc(100% + .25em)}input.svelte-1i17tox{display:none}.selector.svelte-1i17tox{position:relative;box-sizing:border-box;flex:1 1 auto;font-size:1em;line-height:1.5em;margin:0;padding:0;width:auto;border-radius:2px;user-select:none;-webkit-user-select:none;-moz-user-select:none;display:flex}.selector.svelte-1i17tox:focus-visible{outline:solid 2px;outline-offset:2px}.option.svelte-1i17tox{cursor:default;padding:.25em .5em;margin:0 .3em 0 0;border:1px solid transparent;border-radius:.3em;font-size:.85em}.option.svelte-1i17tox:not(.selected):hover{border:1px solid}.file-selector.svelte-1k0x7uv>input:where(.svelte-1k0x7uv){display:none}.file-selector.svelte-1k0x7uv{display:flex;align-items:baseline;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;flex:1 1;min-width:0;border-radius:2px;cursor:default}.file-selector.svelte-1k0x7uv:focus-visible{outline:solid 2px;outline-offset:2px}.file-selector.svelte-1k0x7uv:before{display:inline-block;content:"⇪";font-size:1.1em;margin:0 .5em 0 0;padding:0}.file-selector.selected.svelte-1k0x7uv:before{content:"☷";font-size:1.3em;letter-spacing:-.2em;font-weight:700}.textinput.svelte-1qtiwcs{box-sizing:border-box;flex:1 1 auto;font-size:1em;line-height:1.5em;margin:0;padding:.15em 0;width:auto;border-radius:2px;user-select:none;-webkit-user-select:none;-moz-user-select:none;display:flex;position:relative}.textinput.svelte-1qtiwcs>input:where(.svelte-1qtiwcs){flex:1 1 auto;font-size:.9em;width:100%;cursor:default;padding:.25em .5em;border:1px solid;border-radius:.3em;outline:none}.textinput.svelte-1qtiwcs>input:where(.svelte-1qtiwcs):focus,.textinput.svelte-1qtiwcs>input:where(.svelte-1qtiwcs):active{border:1px solid}.error-message.svelte-1qtiwcs{position:absolute;left:0;bottom:calc(100% + 2px);border-radius:.3em;line-height:1em;font-size:.75em;padding:.5em}.spinner.svelte-n48urb{display:inline-block;height:1.5em;line-height:1.5em;width:1.5em;margin:0 .5em}.spinner.svelte-n48urb:after{content:" ";display:block;width:.8em;height:.8em;margin:.1em;border-radius:50%;border:.2em solid;animation:svelte-n48urb-spinner 1.2s linear infinite}@keyframes svelte-n48urb-spinner{0%{transform:rotate(0)}to{transform:rotate(360deg)}}input.svelte-yf64an{display:none}.selector.svelte-yf64an{position:relative;box-sizing:border-box;flex:1 1 auto;font-size:1em;margin:0;padding:0;width:auto;border-radius:2px;user-select:none;-webkit-user-select:none;-moz-user-select:none;display:flex}.option.svelte-yf64an{cursor:default;padding:0;padding-inline:0;padding-block:0;margin:0 .2em 0 0;border:1px solid transparent;border-radius:.3em;font-size:.85em;height:auto;display:flex;justify-content:center}.option.svelte-yf64an:not(.selected):hover{border:1px solid}.outliers.svelte-1ggez3e{line-height:1.5em;text-align:left;padding:.5em 0;flex:0 0 80%}.outliers.svelte-1ggez3e>.item:where(.svelte-1ggez3e){color:#dc143c;background:#dc143c20;display:inline-block;white-space:nowrap;vertical-align:middle;max-width:10ch;overflow:hidden;text-overflow:ellipsis;padding:.1em .5em;margin:.2em .1em;border-radius:.2em}.show-download-links-none.svelte-1jtdxd0>.download-links:where(.svelte-1jtdxd0){display:none}.show-download-links-hover.svelte-1jtdxd0:hover>.download-links:where(.svelte-1jtdxd0){bottom:0}.show-download-links-fixed.svelte-1jtdxd0>.download-links:where(.svelte-1jtdxd0){bottom:0}.download-links.svelte-1jtdxd0{position:absolute;font-size:.8em;bottom:-50%;right:0;z-index:10;padding:.5em 1em;background:#fefefe;border-radius:.5em;transition:bottom .35s ease;box-shadow:0 0 .75em #00000060;margin:.6em;box-sizing:border-box;display:flex;align-items:center;justify-content:center}.download-links.svelte-1jtdxd0>button:where(.svelte-1jtdxd0){box-sizing:border-box;color:#606060;border:none;box-shadow:none;background:#fafafa;border-radius:.35em;padding:.25em .5em}.download-links.svelte-1jtdxd0>button:where(.svelte-1jtdxd0):hover{background:#433;color:#fafafa}.download-links.svelte-1jtdxd0>button.error{background:#e43}.download-links.svelte-1jtdxd0>button.copied{background:#48e}.plot-container.svelte-1jtdxd0{font-family:Arial,Helvetica,sans-serif;box-sizing:border-box;position:relative;min-width:100px;min-height:50px;width:100%;height:100%;padding:0;margin:0;overflow:hidden;background:#fff}.plot-error.svelte-1jtdxd0{display:flex;justify-content:center;align-items:center}.message-error.svelte-1jtdxd0{font-size:1.2em;color:#dc143c;padding:1em;box-sizing:border-box;text-align:center}.plot.svelte-1jtdxd0{display:block;box-sizing:border-box;position:absolute;padding:0;margin:0;left:0;top:0;bottom:0;right:0;width:100%;height:100%}.axes-content.svelte-1jtdxd0{padding:0;margin:0;height:100%;width:100%;max-height:100%;max-width:100%;min-height:100%;min-width:100%}.drop.svelte-q7wo60{position:fixed;z-index:9999;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background-color:#000000a0}.modal.svelte-q7wo60{border-radius:.5rem;background-color:#fff;display:grid;grid-template-areas:"header" "body";grid-template-rows:30px 1fr;width:auto;height:auto;border-radius:.25rem}.body.svelte-q7wo60{grid-area:body;box-sizing:border-box;padding:0 1em .5em;width:100%;height:100%}.header.svelte-q7wo60{grid-area:header}.close-button.svelte-q7wo60{cursor:pointer;border:none;box-shadow:none;background:transparent;font-size:inherit;font-weight:700;color:#f8ebc5;border-radius:50%;width:20px;height:20px;background-color:#9ea0a2;float:right;text-align:center;padding:0;line-height:20px;font-size:12px;margin:5px}.close-button.svelte-q7wo60:hover{background-color:#4e5052}.isdark.svelte-q7wo60,.isdark.svelte-q7wo60 .header:where(.svelte-q7wo60),.isdark.svelte-q7wo60 .body:where(.svelte-q7wo60){background-color:#606060}.isdark.svelte-q7wo60 .close-button:where(.svelte-q7wo60){color:#433201;background-color:#c2be9b}.isdark.svelte-q7wo60 .close-button:where(.svelte-q7wo60):hover{background-color:#f0f674}.wrapper.svelte-ha02r1{width:95vw;height:90vh;display:grid;grid-template-areas:"plot" "message" "controls";grid-template-rows:1fr 15px min-content}.plot-container.svelte-ha02r1{grid-area:plot}.plot-controls.svelte-ha02r1{grid-area:controls;display:flex;width:100%;justify-content:center;border-radius:.5rem}.plot-controls.svelte-ha02r1>.control-element{background:transparent}.msg-select.svelte-ha02r1{grid-area:message;height:15px;font-size:12px;color:#aaa;text-align:center}.info-details.svelte-1l1cvmx{position:relative;border-bottom:dashed 1px #606060;cursor:help}.info-details.svelte-1l1cvmx>span:where(.svelte-1l1cvmx){position:absolute;z-index:1;background:#505050;visibility:hidden;width:300px;top:100%;left:50%;margin-left:-100px;color:beige;box-shadow:0 0 5px #00000060;padding:.5em 1em;border-radius:.25em}.info-details.svelte-1l1cvmx>span:where(.svelte-1l1cvmx) ul{padding:0;margin:0;list-style:none}.info-details.svelte-1l1cvmx>span:where(.svelte-1l1cvmx) ul>li{padding:.25em 0}.info-details.svelte-1l1cvmx>span:where(.svelte-1l1cvmx) ul>li>span{margin-left:1em;padding:.15em .5em;background-color:#707070;border-radius:3px}.info-details.svelte-1l1cvmx:hover>span:where(.svelte-1l1cvmx){visibility:visible}.info{position:relative}.info-text.svelte-1dxrrpt{line-height:1.5em}.info-text.svelte-1dxrrpt>span{vertical-align:top;color:#a0a0a0}.info-text.svelte-1dxrrpt>.file-name:where(.svelte-1dxrrpt){display:inline-block;padding:0;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:25ch;color:#222}.prep-info{position:relative}span.svelte-2gffce{cursor:default;display:inline-block;border-radius:3px;border:solid 1px #a0a0a0;color:gray;background-color:#fafafa;padding:.2em .5em;margin:0 .5em}span.svelte-2gffce:hover{border:solid 1px #6eb8ff;color:#5086b9;background-color:#6eb8ff20}button.button-down{box-sizing:border-box;margin:0 .3em 0 0}botton.button-up{box-sizing:border-box;margin:0}.method-open.svelte-2gffce{position:absolute;height:100vh;top:0;left:inherit;width:340px;padding:200px 1em 1em;margin-left:-18px;background:#000000a0;z-index:999;box-sizing:border-box}.selected-methods-list.svelte-15cx0gr{background:#fefafaa0;border-radius:5px}.selected-methods-list.svelte-15cx0gr>.control-element:last-child .button-down,.selected-methods-list.svelte-15cx0gr>.control-element:nth-child(2) .button-up{cursor:text;background-color:transparent;color:transparent}.selected-methods-list.svelte-15cx0gr:not(.editable)>.control-element .button-settings{display:block}.methods-list.svelte-15cx0gr{margin-top:1em;font-size:.9em}.methods-list.svelte-15cx0gr>div{background:#ebf0f0}.final.svelte-15cx0gr .button-up,.final.svelte-15cx0gr .button-down,.final.svelte-15cx0gr .button-cancel{visibility:hidden}.plot-panel.svelte-x8qn01{width:100%;height:100%;box-sizing:border-box;padding:0;display:grid;grid-template-rows:1fr;grid-template-columns:1fr minmax(270px,30%)}.plot-area.svelte-x8qn01{padding:1em;margin-top:.25rem;border-radius:.25em;background:#fefefe}.plot-controls-area.svelte-x8qn01{padding:0 .25em 0 .5em}.plot.svelte-x8qn01{width:100%;height:calc(100% - 15px)}@media (min-width:1100px){.plot-panel.svelte-x8qn01{grid-template-columns:1fr minmax(285px,30%)}}@media (min-width:1300px){.plot-panel.svelte-x8qn01{grid-template-columns:1fr max(300px,30%)}}@media (min-width:1600px){.plot-panel.svelte-x8qn01{grid-template-columns:1fr 400px}}.widget-container.svelte-1soqt9v{font-family:Helvetica,Arial,sans-serif;font-size:1rem;color:#404040;box-sizing:border-box;margin:0 auto;padding:.35em .25em;width:100%;height:100%;display:grid;grid-template-areas:"controls content";grid-template-rows:100%;grid-template-columns:min(310px,30%) 1fr;background-color:#606060;width:98vw;height:95vh}.app-controls.svelte-1soqt9v{box-sizing:border-box;padding:.25em .5em}.app-content.svelte-1soqt9v{box-sizing:border-box;padding:.25em;height:100%}.app-controls.svelte-1soqt9v>div:where(.svelte-1soqt9v){border-radius:.25rem}@media (min-width:1300px){.widget-container.svelte-1soqt9v{grid-template-columns:min(340px,30%) 1fr}}@media (min-width:1100px){.widget-container.svelte-1soqt9v{grid-template-columns:min(320px,30%) 1fr}}.prep-container>button{margin-left:.25em}.dataset-info.svelte-gdjwex{line-height:1.5em}.dataset-info.svelte-gdjwex>span{vertical-align:middle;color:#a0a0a0}.dataset-info.svelte-gdjwex>.file-name:where(.svelte-gdjwex),.dataset-info.svelte-gdjwex>.file-size:where(.svelte-gdjwex){display:inline-block;padding:0;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:25ch;color:#222}.selected-buttons.svelte-8mh2yv>.control-element{background:#fff0c8}.selected-buttons.svelte-8mh2yv>.control-element button:last-of-type{color:#fff;border-color:#dc143c;background:#dc143c;margin-left:5px}.selected-buttons.svelte-8mh2yv>.control-element button:last-of-type:hover{background:#dc143c20;border-color:#dc143c80;color:#dc143c}.plot-panel.svelte-8mh2yv{width:100%;height:100%;box-sizing:border-box;padding:0;display:grid;grid-template-rows:1fr;grid-template-columns:1fr minmax(270px,30%)}.plot-area.svelte-8mh2yv{padding:1em;margin-top:.25rem;border-radius:.25em;background:#fefefe}.plot-controls-area.svelte-8mh2yv{padding:0 .25em 0 .5em}.plot-selector.svelte-8mh2yv{cursor:pointer;color:#606060;background:#fffef480;box-sizing:border-box;padding:.5em 1em;margin:.25em 0;border-radius:.25rem;box-shadow:none;border:none;width:100%;text-align:left;font-size:1rem}.plot-selector.svelte-8mh2yv:hover{background:#e0e0e0;color:#403020}div.plot-container.off-screen{position:absolute;top:0;left:50%;width:650px;height:600px;background:#fff;z-index:999}.plot.svelte-8mh2yv{width:100%;height:calc(100% - 15px)}.plot-select-msg.svelte-8mh2yv{height:15px;font-size:12px;color:#aaa;text-align:center}@media (min-width:1100px){.plot-panel.svelte-8mh2yv{grid-template-columns:1fr minmax(285px,30%)}}@media (min-width:1300px){.plot-panel.svelte-8mh2yv{grid-template-columns:1fr max(300px,30%)}}@media (min-width:1600px){.plot-panel.svelte-8mh2yv{grid-template-columns:1fr 400px}}.app-container.svelte-1v0yar6{font-family:Helvetica,Arial,sans-serif;font-size:1rem;color:#404040;box-sizing:border-box;margin:0 auto;padding:.35em .25em;width:100%;height:100%;display:grid;grid-template-areas:"controls content";grid-template-rows:100%;grid-template-columns:min(310px,30%) 1fr}.app-controls.svelte-1v0yar6{box-sizing:border-box;padding:.25em .5em}.app-content.svelte-1v0yar6{box-sizing:border-box;padding:.25em;height:100%}.app-controls.svelte-1v0yar6>div:where(.svelte-1v0yar6){border-radius:.25rem}.app-controls.svelte-1v0yar6>.model-stats:where(.svelte-1v0yar6),.app-controls.svelte-1v0yar6>.result-stats:where(.svelte-1v0yar6){background:#e8e8e8}.app-controls.svelte-1v0yar6>.model-stats:where(.svelte-1v0yar6),.app-controls.svelte-1v0yar6>.result-stats:where(.svelte-1v0yar6){padding:.5rem 1rem;margin-top:.25rem;font-size:.85em}.help-text.svelte-1v0yar6{margin-top:.25rem}.help-text.svelte-1v0yar6>p:where(.svelte-1v0yar6),.help-text.svelte-1v0yar6>div:where(.svelte-1v0yar6){background:#fafafa;padding:0 1.5em .5em;color:#606060;line-height:1.5em;margin:0 1em 0 0}.help-text.svelte-1v0yar6 table:where(.svelte-1v0yar6){border-collapse:collapse}.help-text.svelte-1v0yar6 table:where(.svelte-1v0yar6) td:where(.svelte-1v0yar6){padding:.25em .5em;background:#e0f0fa;text-align:right;border:1px solid white}.help-text.svelte-1v0yar6 table:where(.svelte-1v0yar6) thead:where(.svelte-1v0yar6) tr:where(.svelte-1v0yar6) td:where(.svelte-1v0yar6){font-weight:700;background:#f8f4e0}.help-text.svelte-1v0yar6 table:where(.svelte-1v0yar6) td:where(.svelte-1v0yar6):first-child{font-weight:700;background:#f8f4e0;padding-right:1em}.help-text.svelte-1v0yar6 table:where(.svelte-1v0yar6) tbody:where(.svelte-1v0yar6) td:where(.svelte-1v0yar6):nth-child(2){background:#e0e8f0;padding-right:1em}.help-text.svelte-1v0yar6>p:where(.svelte-1v0yar6):first-child{border-top-left-radius:.25rem;border-top-right-radius:.25rem;padding-top:1.5em}.help-text.svelte-1v0yar6>p:where(.svelte-1v0yar6):last-child{border-bottom-left-radius:.25rem;border-bottom-right-radius:.25rem;padding-bottom:1.5em}@media (min-width:1300px){.app-container.svelte-1v0yar6{grid-template-columns:min(340px,30%) 1fr}}@media (min-width:1100px){.app-container.svelte-1v0yar6{grid-template-columns:min(325px,30%) 1fr}}.model-info.svelte-14tszjv{line-height:1.5em}.model-info.svelte-14tszjv>span{vertical-align:top;color:#a0a0a0}.model-info.svelte-14tszjv>.file-name:where(.svelte-14tszjv){display:inline-block;padding:0;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:25ch;color:#222}table.svelte-1i1bo7x{width:100%;border-collapse:collapse}tr.svelte-1i1bo7x{width:100%}th.svelte-1i1bo7x{border-bottom:1px solid #a0a0a0}tr.section.svelte-1i1bo7x>td:where(.svelte-1i1bo7x){border-top:1px solid #a0a0a0}th.svelte-1i1bo7x,td.svelte-1i1bo7x{text-align:right;padding:.2em .5em .2em .1em;color:#404040;margin:0}.label.svelte-1i1bo7x{text-align:left;padding:.1em .5em}table.svelte-kg0b31{width:100%;border-collapse:collapse}tr.svelte-kg0b31{width:100%}th.svelte-kg0b31{border-bottom:1px solid #a0a0a0}th.svelte-kg0b31,td.svelte-kg0b31{text-align:right;padding:.2em .5em .2em .1em;color:#404040;margin:0}.label.svelte-kg0b31{text-align:left;padding:.1em .5em}.app-container.svelte-1qdsey6{font-family:Helvetica,Arial,sans-serif;font-size:1rem;color:#404040;box-sizing:border-box;margin:0 auto;padding:.35em .25em;width:100%;height:100%;display:grid;grid-template-areas:"controls content";grid-template-rows:100%;grid-template-columns:min(310px,30%) 1fr}.app-controls.svelte-1qdsey6{box-sizing:border-box;padding:.25em .5em}.app-content.svelte-1qdsey6{box-sizing:border-box;padding:.25em;height:100%}.app-controls.svelte-1qdsey6>div:where(.svelte-1qdsey6){border-radius:.25rem}.app-controls.svelte-1qdsey6>.model-stats:where(.svelte-1qdsey6),.app-controls.svelte-1qdsey6>.result-stats:where(.svelte-1qdsey6){background:#e8e8e8}.app-controls.svelte-1qdsey6>.model-stats:where(.svelte-1qdsey6),.app-controls.svelte-1qdsey6>.result-stats:where(.svelte-1qdsey6){padding:.5rem 1rem;margin-top:.25rem;font-size:.85em}.help-text.svelte-1qdsey6{margin-top:.25rem}.help-text.svelte-1qdsey6>p:where(.svelte-1qdsey6){background:#fafafa;padding:0 1.5em .5em;color:#606060;line-height:1.5em;margin:0 1em 0 0}.help-text.svelte-1qdsey6>p:where(.svelte-1qdsey6):first-child{border-top-left-radius:.25rem;border-top-right-radius:.25rem;padding-top:1.5em}.help-text.svelte-1qdsey6>p:where(.svelte-1qdsey6):last-child{border-bottom-left-radius:.25rem;border-bottom-right-radius:.25rem;padding-bottom:1.5em}@media (min-width:1300px){.app-container.svelte-1qdsey6{grid-template-columns:min(340px,30%) 1fr}}@media (min-width:1100px){.app-container.svelte-1qdsey6{grid-template-columns:min(325px,30%) 1fr}}.page.svelte-1cyr8za{width:100%;height:100%;margin:0 auto;padding:0;min-width:1020px;min-height:590px;max-width:1900px;display:flex;flex-direction:column}header.svelte-1cyr8za{display:flex;justify-content:flex-start;flex-direction:row;background:#f8f6f4}.header-group.svelte-1cyr8za{width:min-content;min-width:400px;margin:0 0 0 .25rem;display:grid;align-items:center;grid-template-columns:min-content 1fr;grid-template-rows:min-content min-content min-content min-content;grid-template-areas:"logo ." "logo title" "logo subtitle" "logo ."}.logo.svelte-1cyr8za{width:3.5rem;margin:.25rem;padding:.5rem;grid-area:logo}.header-group.svelte-1cyr8za>h1:where(.svelte-1cyr8za){margin:0;padding:0;text-align:left;font-size:1.6rem;color:#4e5052;white-space:nowrap;grid-area:title}.header-group.svelte-1cyr8za>p:where(.svelte-1cyr8za){margin:0;padding:0;text-align:left;font-size:1.1rem;color:#7e8082;grid-area:subtitle}main.svelte-1cyr8za{flex-basis:auto;flex-grow:1;flex-shrink:1;box-sizing:border-box;padding:.2rem 0}main.svelte-1cyr8za>div:where(.svelte-1cyr8za){height:100%}footer.svelte-1cyr8za{display:grid;grid-template-columns:20% 60% 20%;grid-template-areas:"session info .";align-items:center;justify-content:center;font-size:.9rem;flex-basis:min-content;flex-grow:0;flex-shrink:0;background:#4e5052;color:silver;padding:.5em}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za){grid-area:session;padding-left:.5em;display:flex;align-items:center}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) input:where(.svelte-1cyr8za){display:none}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .session-message:where(.svelte-1cyr8za){color:silver;padding-right:.5em}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .session-message:where(.svelte-1cyr8za){color:#fafafa}footer.svelte-1cyr8za .session.no-buttons:where(.svelte-1cyr8za) .clear-button:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session.no-buttons:where(.svelte-1cyr8za) .upload-button:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session.no-buttons:where(.svelte-1cyr8za) .download-button:where(.svelte-1cyr8za){display:none}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .clear-button:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .upload-button:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .download-button:where(.svelte-1cyr8za){font-size:.9rem;background:#5e6062;color:silver;box-shadow:none;padding:0;margin:0 0 0 .2em;border-radius:3px;border:none;height:20px;box-sizing:border-box;display:inline-block}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .clear-button:where(.svelte-1cyr8za) svg:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .upload-button:where(.svelte-1cyr8za) svg:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .download-button:where(.svelte-1cyr8za) svg:where(.svelte-1cyr8za){stroke-width:.75em;stroke-linecap:round;stroke-linejoin:round;stroke:silver}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .clear-button:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .upload-button:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .download-button:where(.svelte-1cyr8za){background:#35332d}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .clear-button:where(.svelte-1cyr8za) svg:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .upload-button:where(.svelte-1cyr8za) svg:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .download-button:where(.svelte-1cyr8za) svg:where(.svelte-1cyr8za){stroke:#fafafa}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .clear-button:where(.svelte-1cyr8za){margin-left:.5em}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .upload-button:where(.svelte-1cyr8za):hover,footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .download-button:where(.svelte-1cyr8za):hover{background-color:#6eb8ff}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .clear-button:where(.svelte-1cyr8za):hover{background-color:#dc143c}footer.svelte-1cyr8za .info:where(.svelte-1cyr8za){grid-area:info;display:flex;justify-content:center;align-items:center}footer.svelte-1cyr8za .info:where(.svelte-1cyr8za) .button-info:where(.svelte-1cyr8za){cursor:default;border:none;box-shadow:none;background:transparent;font-weight:700;color:#4e5052;border-radius:.2em;padding:.25em .5em;text-align:center;line-height:1em;margin-left:.25em;margin-right:.5em;background-color:#f8ebc5}footer.svelte-1cyr8za .info:where(.svelte-1cyr8za) .button-info:where(.svelte-1cyr8za):hover{background-color:#f7db89}footer.svelte-1cyr8za p{margin:0 .5em;text-align:center;padding:.15em}footer.svelte-1cyr8za span,footer.svelte-1cyr8za a{color:#f8ebc5}.hidden.svelte-1cyr8za{display:none}.nav.svelte-1cyr8za,.nav.svelte-1cyr8za :where(.svelte-1cyr8za){-webkit-user-select:none;user-select:none;-moz-user-select:none}.nav.svelte-1cyr8za{display:flex;flex-direction:row;justify-content:flex-end;list-style:none;margin:0 100px 0 auto;padding:0;align-self:flex-end}.nav-item.svelte-1cyr8za{list-style:none;margin:0;border-bottom:5px solid transparent}.nav-item.svelte-1cyr8za>button:where(.svelte-1cyr8za){cursor:pointer;padding:.5em 1em;border:none;box-shadow:none;background:transparent;font-size:inherit}.nav-item.svelte-1cyr8za>button:where(.svelte-1cyr8za)>span{color:#888}.nav-item.svelte-1cyr8za:hover{border-bottom:5px solid #80888f50}.nav-item.svelte-1cyr8za:hover>button:where(.svelte-1cyr8za){border-top-left-radius:5px;border-top-right-radius:5px;background:#00000010}.nav-item.selected.svelte-1cyr8za{border-bottom:5px solid #80888f}.nav-item.selected.svelte-1cyr8za>button:where(.svelte-1cyr8za){font-weight:700;cursor:default}.nav-item.selected.svelte-1cyr8za:hover{border-bottom:5px solid #80888f}@media (min-width: 1600px){.page.svelte-1cyr8za>header:where(.svelte-1cyr8za){border-bottom-right-radius:.25rem;border-bottom-left-radius:.25rem}.page.svelte-1cyr8za>footer:where(.svelte-1cyr8za){border-top-right-radius:.25rem;border-top-left-radius:.25rem}}.info-container.svelte-1cyr8za{width:900px}.info-container.svelte-1cyr8za>p{font-size:1.15em;line-height:1.35em;padding:0 1em .5em;margin:0}.info-container.svelte-1cyr8za>.release-info{font-size:1em;color:gray;line-height:1.25em;padding:0 1.2em .5em;margin:0}.info-container.svelte-1cyr8za>h2{font-size:1.5em;line-height:1.25em;padding:0em 1rem .5em;margin:0}.info-container.svelte-1cyr8za>h3{font-size:1.15em;line-height:1.25em;padding:1rem 1em .25em;margin:0}.info-container.svelte-1cyr8za>ul{margin:0}.info-container.svelte-1cyr8za>ul>li{font-size:1.15em;line-height:1.25em;padding:0 .5em .5em 0;margin:0}.info-container.svelte-1cyr8za>ul>li>span{font-size:.9em;color:gray;line-height:1.25em;padding:0 .25em;margin:0}.info-container.svelte-1cyr8za a{color:#ae8032}.info-container.svelte-1cyr8za a:hover{color:#eb9707}.info-container.svelte-1cyr8za:last-child{padding-bottom:1rem}
/*$vite$:1*/`,document.head.appendChild(at);var $e=typeof document<"u"?document.currentScript:null;const xt=!1;var sn=Array.isArray,xc=Array.prototype.indexOf,ms=Array.from,hs=Object.defineProperty,Or=Object.getOwnPropertyDescriptor,Fa=Object.getOwnPropertyDescriptors,Oa=Object.prototype,kc=Array.prototype,yl=Object.getPrototypeOf,Ba=Object.isExtensible;function Mn(l){return typeof l=="function"}const kt=()=>{};function Ec(l){return typeof(l==null?void 0:l.then)=="function"}function Cc(l){return l()}function xl(l){for(var e=0;e<l.length;e++)l[e]()}function Sc(){var l,e,t=new Promise((s,a)=>{l=s,e=a});return{promise:t,resolve:l,reject:e}}function gs(l,e){if(Array.isArray(l))return l;if(e===void 0||!(Symbol.iterator in l))return Array.from(l);const t=[];for(const s of l)if(t.push(s),t.length===e)break;return t}const Kt=2,ps=4,kl=8,Tn=16,Lr=32,an=64,Da=128,lr=256,El=512,qt=1024,sr=2048,Br=4096,dr=8192,on=16384,Cl=32768,Pn=65536,Va=1<<17,Ac=1<<18,bs=1<<19,_s=1<<20,ws=1<<21,ys=1<<22,cn=1<<23,Dr=Symbol("$state"),Ya=Symbol("legacy props"),Nc=Symbol(""),xs=new class extends Error{constructor(){super(...arguments);yr(this,"name","StaleReactionError");yr(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Mc(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function Wa(l){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Tc(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Pc(l){throw new Error("https://svelte.dev/e/effect_in_teardown")}function zc(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Lc(l){throw new Error("https://svelte.dev/e/effect_orphan")}function Rc(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Ic(l){throw new Error("https://svelte.dev/e/props_invalid_value")}function jc(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function qc(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Fc(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const Sl=1,Al=2,Ua=4,Oc=8,Bc=16,Dc=1,Vc=2,Yc=4,Wc=8,Uc=16,Hc=1,Gc=2,Xc=4,Ha=1,Kc=2,Et=Symbol(),Jc="http://www.w3.org/1999/xhtml";let Qc=!1;function Ga(l){return l===this.v}function Xa(l,e){return l!=l?e==e:l!==e||l!==null&&typeof l=="object"||typeof l=="function"}function Zc(l,e){return l!==e}function Ka(l){return!Xa(l,this.v)}let zn=!1,$c=!1;function eu(){zn=!0}const tu=[];function ru(l,e=!1){return Nl(l,new Map,"",tu)}function Nl(l,e,t,s,a=null){if(typeof l=="object"&&l!==null){var o=e.get(l);if(o!==void 0)return o;if(l instanceof Map)return new Map(l);if(l instanceof Set)return new Set(l);if(sn(l)){var c=Array(l.length);e.set(l,c),a!==null&&e.set(a,c);for(var d=0;d<l.length;d+=1){var u=l[d];d in l&&(c[d]=Nl(u,e,t,s))}return c}if(yl(l)===Oa){c={},e.set(l,c),a!==null&&e.set(a,c);for(var f in l)c[f]=Nl(l[f],e,t,s);return c}if(l instanceof Date)return structuredClone(l);if(typeof l.toJSON=="function")return Nl(l.toJSON(),e,t,s,l)}if(l instanceof EventTarget)return l;try{return structuredClone(l)}catch{return l}}let ot=null;function Ln(l){ot=l}function Vt(l){return Ja().get(l)}function nu(l,e){return Ja().set(l,e),e}function be(l,e=!1,t){ot={p:ot,c:null,e:null,s:l,x:null,l:zn&&!e?{s:null,u:null,$:[]}:null}}function _e(l){var e=ot,t=e.e;if(t!==null){e.e=null;for(var s of t)fo(s)}return ot=e.p,{}}function Vr(){return!zn||ot!==null&&ot.l===null}function Ja(l){return ot===null&&Wa(),ot.c??(ot.c=new Map(lu(ot)||void 0))}function lu(l){let e=l.p;for(;e!==null;){const t=e.c;if(t!==null)return t;e=e.p}return null}const su=new WeakMap;function au(l){var e=He;if(e===null)return Ge.f|=cn,l;if((e.f&Cl)===0){if((e.f&Da)===0)throw!e.parent&&l instanceof Error&&Qa(l),l;e.b.error(l)}else ks(l,e)}function ks(l,e){for(;e!==null;){if((e.f&Da)!==0)try{e.b.error(l);return}catch(t){l=t}e=e.parent}throw l instanceof Error&&Qa(l),l}function Qa(l){const e=su.get(l);e&&(hs(l,"message",{value:e.message}),hs(l,"stack",{value:e.stack}))}let Xn=[],Es=[];function Za(){var l=Xn;Xn=[],xl(l)}function ou(){var l=Es;Es=[],xl(l)}function Kn(l){Xn.length===0&&queueMicrotask(Za),Xn.push(l)}function iu(){Xn.length>0&&Za(),Es.length>0&&ou()}function cu(){for(var l=He.b;l!==null&&!l.has_pending_snippet();)l=l.parent;return l===null&&Mc(),l}function Jn(l){var e=Kt|sr,t=Ge!==null&&(Ge.f&Kt)!==0?Ge:null;return He===null||t!==null&&(t.f&lr)!==0?e|=lr:He.f|=bs,{ctx:ot,deps:null,effects:null,equals:Ga,f:e,fn:l,reactions:null,rv:0,v:Et,wv:0,parent:t??He,ac:null}}function uu(l,e){let t=He;t===null&&Tc();var s=t.b,a=void 0,o=vn(Et),c=null,d=!Ge;return yu(()=>{try{var u=l()}catch(h){u=Promise.reject(h)}var f=()=>u;a=(c==null?void 0:c.then(f,f))??Promise.resolve(u),c=a;var v=tt,m=s.pending;d&&(s.update_pending_count(1),m||v.increment());const g=(h,p=void 0)=>{c=null,m||v.activate(),p?p!==xs&&(o.f|=cn,Wr(o,p)):((o.f&cn)!==0&&(o.f^=cn),Wr(o,h)),d&&(s.update_pending_count(-1),m||v.decrement()),to()};if(a.then(g,h=>g(null,h||"unknown")),v)return()=>{queueMicrotask(()=>v.neuter())}}),new Promise(u=>{function f(v){function m(){v===a?u(o):f(a)}v.then(m,m)}f(a)})}function w(l){const e=Jn(l);return xo(e),e}function Cs(l){const e=Jn(l);return e.equals=Ka,e}function $a(l){var e=l.effects;if(e!==null){l.effects=null;for(var t=0;t<e.length;t+=1)Er(e[t])}}function fu(l){for(var e=l.parent;e!==null;){if((e.f&Kt)===0)return e;e=e.parent}return null}function Ss(l){var e,t=He;Sr(fu(l));try{$a(l),e=Ao(l)}finally{Sr(t)}return e}function eo(l){var e=Ss(l);if(l.equals(e)||(l.v=e,l.wv=Co()),!mn)if(Yr!==null)Yr.set(l,l.v);else{var t=(Gr||(l.f&lr)!==0)&&l.deps!==null?Br:qt;Wt(l,t)}}function du(l,e,t){const s=Vr()?Jn:Cs;if(e.length===0){t(l.map(s));return}var a=tt,o=He,c=vu(),d=cu();Promise.all(e.map(u=>uu(u))).then(u=>{a==null||a.activate(),c();try{t([...l.map(s),...u])}catch(f){(o.f&on)===0&&ks(f,o)}a==null||a.deactivate(),to()}).catch(u=>{d.error(u)})}function vu(){var l=He,e=Ge,t=ot;return function(){Sr(l),ar(e),Ln(t)}}function to(){Sr(null),ar(null),Ln(null)}const Qn=new Set;let tt=null,Ml=null,Yr=null,ro=new Set,Tl=[];function no(){const l=Tl.shift();Tl.length>0&&queueMicrotask(no),l()}let un=[],Pl=null,As=!1,zl=!1;const cs=class cs{constructor(){zt(this,br);yr(this,"current",new Map);zt(this,Yn,new Map);zt(this,Wn,new Set);zt(this,en,0);zt(this,ml,null);zt(this,hl,!1);zt(this,Cn,[]);zt(this,Un,[]);zt(this,Sn,[]);zt(this,tn,[]);zt(this,Hn,[]);zt(this,gl,[]);zt(this,pl,[]);yr(this,"skipped_effects",new Set)}process(e){var o;un=[],Ml=null;var t=null;if(Qn.size>1){t=new Map,Yr=new Map;for(const[c,d]of this.current)t.set(c,{v:c.v,wv:c.wv}),c.v=d;for(const c of Qn)if(c!==this)for(const[d,u]of Ue(c,Yn))t.has(d)||(t.set(d,{v:d.v,wv:d.wv}),d.v=u)}for(const c of e)ln(this,br,wc).call(this,c);if(Ue(this,Cn).length===0&&Ue(this,en)===0){ln(this,br,qa).call(this);var s=Ue(this,Sn),a=Ue(this,tn);Xt(this,Sn,[]),Xt(this,tn,[]),Xt(this,Hn,[]),Ml=tt,tt=null,so(s),so(a),tt===null?tt=this:Qn.delete(this),(o=Ue(this,ml))==null||o.resolve()}else ln(this,br,vs).call(this,Ue(this,Sn)),ln(this,br,vs).call(this,Ue(this,tn)),ln(this,br,vs).call(this,Ue(this,Hn));if(t){for(const[c,{v:d,wv:u}]of t)c.wv<=u&&(c.v=d);Yr=null}for(const c of Ue(this,Cn))tl(c);for(const c of Ue(this,Un))tl(c);Xt(this,Cn,[]),Xt(this,Un,[])}capture(e,t){Ue(this,Yn).has(e)||Ue(this,Yn).set(e,t),this.current.set(e,e.v)}activate(){tt=this}deactivate(){tt=null,Ml=null;for(const e of ro)if(ro.delete(e),e(),tt!==null)break}neuter(){Xt(this,hl,!0)}flush(){un.length>0?lo():ln(this,br,qa).call(this),tt===this&&(Ue(this,en)===0&&Qn.delete(this),this.deactivate())}increment(){Xt(this,en,Ue(this,en)+1)}decrement(){if(Xt(this,en,Ue(this,en)-1),Ue(this,en)===0){for(const e of Ue(this,gl))Wt(e,sr),fn(e);for(const e of Ue(this,pl))Wt(e,Br),fn(e);Xt(this,Sn,[]),Xt(this,tn,[]),this.flush()}else this.deactivate()}add_callback(e){Ue(this,Wn).add(e)}settled(){return(Ue(this,ml)??Xt(this,ml,Sc())).promise}static ensure(){if(tt===null){const e=tt=new cs;Qn.add(tt),zl||cs.enqueue(()=>{tt===e&&e.flush()})}return tt}static enqueue(e){Tl.length===0&&queueMicrotask(no),Tl.unshift(e)}};Yn=new WeakMap,Wn=new WeakMap,en=new WeakMap,ml=new WeakMap,hl=new WeakMap,Cn=new WeakMap,Un=new WeakMap,Sn=new WeakMap,tn=new WeakMap,Hn=new WeakMap,gl=new WeakMap,pl=new WeakMap,br=new WeakSet,wc=function(e){var v;e.f^=qt;for(var t=e.first;t!==null;){var s=t.f,a=(s&(Lr|an))!==0,o=a&&(s&qt)!==0,c=o||(s&dr)!==0||this.skipped_effects.has(t);if(!c&&t.fn!==null){if(a)t.f^=qt;else if((s&qt)===0)if((s&ps)!==0)Ue(this,tn).push(t);else if((s&ys)!==0){var d=(v=t.b)!=null&&v.pending?Ue(this,Un):Ue(this,Cn);d.push(t)}else jl(t)&&((t.f&Tn)!==0&&Ue(this,Hn).push(t),tl(t));var u=t.first;if(u!==null){t=u;continue}}var f=t.parent;for(t=t.next;t===null&&f!==null;)t=f.next,f=f.parent}},vs=function(e){for(const t of e)((t.f&sr)!==0?Ue(this,gl):Ue(this,pl)).push(t),Wt(t,qt);e.length=0},qa=function(){if(!Ue(this,hl))for(const e of Ue(this,Wn))e();Ue(this,Wn).clear()};let Zn=cs;function mu(l){var e=zl;zl=!0;try{for(var t;;){if(iu(),un.length===0&&(tt==null||tt.flush(),un.length===0))return Pl=null,t;lo()}}finally{zl=e}}function lo(){var l=In;As=!0;try{var e=0;for(wo(!0);un.length>0;){var t=Zn.ensure();if(e++>1e3){var s,a;hu()}t.process(un),dn.clear()}}finally{As=!1,wo(l),Pl=null}}function hu(){try{Rc()}catch(l){ks(l,Pl)}}function so(l){var e=l.length;if(e!==0){for(var t=0;t<e;){var s=l[t++];if((s.f&(on|dr))===0&&jl(s)){var a=tt?tt.current.size:0;if(tl(s),s.deps===null&&s.first===null&&s.nodes_start===null&&(s.teardown===null&&s.ac===null?po(s):s.fn=null),tt!==null&&tt.current.size>a&&(s.f&_s)!==0)break}}for(;t<e;)fn(l[t++])}}function fn(l){for(var e=Pl=l;e.parent!==null;){e=e.parent;var t=e.f;if(As&&e===He&&(t&Tn)!==0)return;if((t&(an|Lr))!==0){if((t&qt)===0)return;e.f^=qt}}un.push(e)}const dn=new Map;function vn(l,e){var t={f:0,v:l,reactions:null,equals:Ga,rv:0,wv:0};return t}function re(l,e){const t=vn(l);return xo(t),t}function Ns(l,e=!1,t=!0){var a;const s=vn(l);return e||(s.equals=Ka),zn&&t&&ot!==null&&ot.l!==null&&((a=ot.l).s??(a.s=[])).push(s),s}function B(l,e,t=!1){Ge!==null&&(!Cr||(Ge.f&Va)!==0)&&Vr()&&(Ge.f&(Kt|Tn|ys|Va))!==0&&!(Ft!=null&&Ft.includes(l))&&Fc();let s=t?De(e):e;return Wr(l,s)}function Wr(l,e){if(!l.equals(e)){var t=l.v;mn?dn.set(l,e):dn.set(l,t),l.v=e;var s=Zn.ensure();s.capture(l,t),(l.f&Kt)!==0&&((l.f&sr)!==0&&Ss(l),Wt(l,(l.f&lr)===0?qt:Br)),l.wv=Co(),ao(l,sr),Vr()&&He!==null&&(He.f&qt)!==0&&(He.f&(Lr|an))===0&&(or===null?ku([l]):or.push(l))}return e}function Ms(l){B(l,l.v+1)}function ao(l,e){var t=l.reactions;if(t!==null)for(var s=Vr(),a=t.length,o=0;o<a;o++){var c=t[o],d=c.f;if(!(!s&&c===He)){var u=(d&sr)===0;u&&Wt(c,e),(d&Kt)!==0?ao(c,Br):u&&fn(c)}}}function De(l){if(typeof l!="object"||l===null||Dr in l)return l;const e=yl(l);if(e!==Oa&&e!==kc)return l;var t=new Map,s=sn(l),a=re(0),o=hn,c=d=>{if(hn===o)return d();var u=Ge,f=hn;ar(null),Eo(o);var v=d();return ar(u),Eo(f),v};return s&&t.set("length",re(l.length)),new Proxy(l,{defineProperty(d,u,f){(!("value"in f)||f.configurable===!1||f.enumerable===!1||f.writable===!1)&&jc();var v=t.get(u);return v===void 0?v=c(()=>{var m=re(f.value);return t.set(u,m),m}):B(v,f.value,!0),!0},deleteProperty(d,u){var f=t.get(u);if(f===void 0){if(u in d){const v=c(()=>re(Et));t.set(u,v),Ms(a)}}else B(f,Et),Ms(a);return!0},get(d,u,f){var h;if(u===Dr)return l;var v=t.get(u),m=u in d;if(v===void 0&&(!m||(h=Or(d,u))!=null&&h.writable)&&(v=c(()=>{var p=De(m?d[u]:Et),_=re(p);return _}),t.set(u,v)),v!==void 0){var g=r(v);return g===Et?void 0:g}return Reflect.get(d,u,f)},getOwnPropertyDescriptor(d,u){var f=Reflect.getOwnPropertyDescriptor(d,u);if(f&&"value"in f){var v=t.get(u);v&&(f.value=r(v))}else if(f===void 0){var m=t.get(u),g=m==null?void 0:m.v;if(m!==void 0&&g!==Et)return{enumerable:!0,configurable:!0,value:g,writable:!0}}return f},has(d,u){var g;if(u===Dr)return!0;var f=t.get(u),v=f!==void 0&&f.v!==Et||Reflect.has(d,u);if(f!==void 0||He!==null&&(!v||(g=Or(d,u))!=null&&g.writable)){f===void 0&&(f=c(()=>{var h=v?De(d[u]):Et,p=re(h);return p}),t.set(u,f));var m=r(f);if(m===Et)return!1}return v},set(d,u,f,v){var E;var m=t.get(u),g=u in d;if(s&&u==="length")for(var h=f;h<m.v;h+=1){var p=t.get(h+"");p!==void 0?B(p,Et):h in d&&(p=c(()=>re(Et)),t.set(h+"",p))}if(m===void 0)(!g||(E=Or(d,u))!=null&&E.writable)&&(m=c(()=>re(void 0)),B(m,De(f)),t.set(u,m));else{g=m.v!==Et;var _=c(()=>De(f));B(m,_)}var b=Reflect.getOwnPropertyDescriptor(d,u);if(b!=null&&b.set&&b.set.call(v,f),!g){if(s&&typeof u=="string"){var y=t.get("length"),S=Number(u);Number.isInteger(S)&&S>=y.v&&B(y,S+1)}Ms(a)}return!0},ownKeys(d){r(a);var u=Reflect.ownKeys(d).filter(m=>{var g=t.get(m);return g===void 0||g.v!==Et});for(var[f,v]of t)v.v!==Et&&!(f in d)&&u.push(f);return u},setPrototypeOf(){qc()}})}var Ts,oo,io,co;function gu(){if(Ts===void 0){Ts=window,oo=/Firefox/.test(navigator.userAgent);var l=Element.prototype,e=Node.prototype,t=Text.prototype;io=Or(e,"firstChild").get,co=Or(e,"nextSibling").get,Ba(l)&&(l.__click=void 0,l.__className=void 0,l.__attributes=null,l.__style=void 0,l.__e=void 0),Ba(t)&&(t.__t=void 0)}}function Ur(l=""){return document.createTextNode(l)}function Jt(l){return io.call(l)}function Ll(l){return co.call(l)}function j(l,e){return Jt(l)}function J(l,e){{var t=Jt(l);return t instanceof Comment&&t.data===""?Ll(t):t}}function z(l,e=1,t=!1){let s=l;for(;e--;)s=Ll(s);return s}function pu(l){l.textContent=""}function Rl(){return!1}function uo(l){He===null&&Ge===null&&Lc(),Ge!==null&&(Ge.f&lr)!==0&&He===null&&zc(),mn&&Pc()}function bu(l,e){var t=e.last;t===null?e.last=e.first=l:(t.next=l,l.prev=t,e.last=l)}function xr(l,e,t,s=!0){var a=He;a!==null&&(a.f&dr)!==0&&(l|=dr);var o={ctx:ot,deps:null,nodes_start:null,nodes_end:null,f:l|sr,first:null,fn:e,last:null,next:null,parent:a,b:a&&a.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{tl(o),o.f|=Cl}catch(u){throw Er(o),u}else e!==null&&fn(o);var c=t&&o.deps===null&&o.first===null&&o.nodes_start===null&&o.teardown===null&&(o.f&bs)===0;if(!c&&s&&(a!==null&&bu(o,a),Ge!==null&&(Ge.f&Kt)!==0&&(l&an)===0)){var d=Ge;(d.effects??(d.effects=[])).push(o)}return o}function _u(l){const e=xr(kl,null,!1);return Wt(e,qt),e.teardown=l,e}function ue(l){uo();var e=He.f,t=!Ge&&(e&Lr)!==0&&(e&Cl)===0;if(t){var s=ot;(s.e??(s.e=[])).push(l)}else return fo(l)}function fo(l){return xr(ps|_s,l,!1)}function Il(l){return uo(),xr(kl|_s,l,!0)}function wu(l){Zn.ensure();const e=xr(an,l,!0);return(t={})=>new Promise(s=>{t.outro?Hr(e,()=>{Er(e),s(void 0)}):(Er(e),s(void 0))})}function Ps(l){return xr(ps,l,!1)}function yu(l){return xr(ys|bs,l,!0)}function vo(l,e=0){return xr(kl|e,l,!0)}function ae(l,e=[],t=[]){du(e,t,s=>{xr(kl,()=>l(...s.map(r)),!0)})}function Rn(l,e=0){var t=xr(Tn|e,l,!0);return t}function kr(l,e=!0){return xr(Lr,l,!0,e)}function mo(l){var e=l.teardown;if(e!==null){const t=mn,s=Ge;yo(!0),ar(null);try{e.call(null)}finally{yo(t),ar(s)}}}function ho(l,e=!1){var a;var t=l.first;for(l.first=l.last=null;t!==null;){(a=t.ac)==null||a.abort(xs);var s=t.next;(t.f&an)!==0?t.parent=null:Er(t,e),t=s}}function xu(l){for(var e=l.first;e!==null;){var t=e.next;(e.f&Lr)===0&&Er(e),e=t}}function Er(l,e=!0){var t=!1;(e||(l.f&Ac)!==0)&&l.nodes_start!==null&&l.nodes_end!==null&&(go(l.nodes_start,l.nodes_end),t=!0),ho(l,e&&!t),ql(l,0),Wt(l,on);var s=l.transitions;if(s!==null)for(const o of s)o.stop();mo(l);var a=l.parent;a!==null&&a.first!==null&&po(l),l.next=l.prev=l.teardown=l.ctx=l.deps=l.fn=l.nodes_start=l.nodes_end=l.ac=null}function go(l,e){for(;l!==null;){var t=l===e?null:Ll(l);l.remove(),l=t}}function po(l){var e=l.parent,t=l.prev,s=l.next;t!==null&&(t.next=s),s!==null&&(s.prev=t),e!==null&&(e.first===l&&(e.first=s),e.last===l&&(e.last=t))}function Hr(l,e){var t=[];zs(l,t,!0),bo(t,()=>{Er(l),e&&e()})}function bo(l,e){var t=l.length;if(t>0){var s=()=>--t||e();for(var a of l)a.out(s)}else e()}function zs(l,e,t){if((l.f&dr)===0){if(l.f^=dr,l.transitions!==null)for(const c of l.transitions)(c.is_global||t)&&e.push(c);for(var s=l.first;s!==null;){var a=s.next,o=(s.f&Pn)!==0||(s.f&Lr)!==0;zs(s,e,o?t:!1),s=a}}}function $n(l){_o(l,!0)}function _o(l,e){if((l.f&dr)!==0){l.f^=dr,(l.f&qt)===0&&(Wt(l,sr),fn(l));for(var t=l.first;t!==null;){var s=t.next,a=(t.f&Pn)!==0||(t.f&Lr)!==0;_o(t,a?e:!1),t=s}if(l.transitions!==null)for(const o of l.transitions)(o.is_global||e)&&o.in()}}let In=!1;function wo(l){In=l}let mn=!1;function yo(l){mn=l}let Ge=null,Cr=!1;function ar(l){Ge=l}let He=null;function Sr(l){He=l}let Ft=null;function xo(l){Ge!==null&&(Ft===null?Ft=[l]:Ft.push(l))}let Ot=null,Qt=0,or=null;function ku(l){or=l}let ko=1,el=0,hn=el;function Eo(l){hn=l}let Gr=!1;function Co(){return++ko}function jl(l){var m;var e=l.f;if((e&sr)!==0)return!0;if((e&Br)!==0){var t=l.deps,s=(e&lr)!==0;if(t!==null){var a,o,c=(e&El)!==0,d=s&&He!==null&&!Gr,u=t.length;if((c||d)&&(He===null||(He.f&on)===0)){var f=l,v=f.parent;for(a=0;a<u;a++)o=t[a],(c||!((m=o==null?void 0:o.reactions)!=null&&m.includes(f)))&&(o.reactions??(o.reactions=[])).push(f);c&&(f.f^=El),d&&v!==null&&(v.f&lr)===0&&(f.f^=lr)}for(a=0;a<u;a++)if(o=t[a],jl(o)&&eo(o),o.wv>l.wv)return!0}(!s||He!==null&&!Gr)&&Wt(l,qt)}return!1}function So(l,e,t=!0){var s=l.reactions;if(s!==null&&!(Ft!=null&&Ft.includes(l)))for(var a=0;a<s.length;a++){var o=s[a];(o.f&Kt)!==0?So(o,e,!1):e===o&&(t?Wt(o,sr):(o.f&qt)!==0&&Wt(o,Br),fn(o))}}function Ao(l){var p;var e=Ot,t=Qt,s=or,a=Ge,o=Gr,c=Ft,d=ot,u=Cr,f=hn,v=l.f;Ot=null,Qt=0,or=null,Gr=(v&lr)!==0&&(Cr||!In||Ge===null),Ge=(v&(Lr|an))===0?l:null,Ft=null,Ln(l.ctx),Cr=!1,hn=++el,l.ac!==null&&(l.ac.abort(xs),l.ac=null);try{l.f|=ws;var m=(0,l.fn)(),g=l.deps;if(Ot!==null){var h;if(ql(l,Qt),g!==null&&Qt>0)for(g.length=Qt+Ot.length,h=0;h<Ot.length;h++)g[Qt+h]=Ot[h];else l.deps=g=Ot;if(!Gr||(v&Kt)!==0&&l.reactions!==null)for(h=Qt;h<g.length;h++)((p=g[h]).reactions??(p.reactions=[])).push(l)}else g!==null&&Qt<g.length&&(ql(l,Qt),g.length=Qt);if(Vr()&&or!==null&&!Cr&&g!==null&&(l.f&(Kt|Br|sr))===0)for(h=0;h<or.length;h++)So(or[h],l);return a!==null&&a!==l&&(el++,or!==null&&(s===null?s=or:s.push(...or))),(l.f&cn)!==0&&(l.f^=cn),m}catch(_){return au(_)}finally{l.f^=ws,Ot=e,Qt=t,or=s,Ge=a,Gr=o,Ft=c,Ln(d),Cr=u,hn=f}}function Eu(l,e){let t=e.reactions;if(t!==null){var s=xc.call(t,l);if(s!==-1){var a=t.length-1;a===0?t=e.reactions=null:(t[s]=t[a],t.pop())}}t===null&&(e.f&Kt)!==0&&(Ot===null||!Ot.includes(e))&&(Wt(e,Br),(e.f&(lr|El))===0&&(e.f^=El),$a(e),ql(e,0))}function ql(l,e){var t=l.deps;if(t!==null)for(var s=e;s<t.length;s++)Eu(l,t[s])}function tl(l){var e=l.f;if((e&on)===0){Wt(l,qt);var t=He,s=In;He=l,In=!0;try{(e&Tn)!==0?xu(l):ho(l),mo(l);var a=Ao(l);l.teardown=typeof a=="function"?a:null,l.wv=ko;var o;xt&&$c&&(l.f&sr)!==0&&l.deps}finally{In=s,He=t}}}function r(l){var e=l.f,t=(e&Kt)!==0;if(Ge!==null&&!Cr){var s=He!==null&&(He.f&on)!==0;if(!s&&!(Ft!=null&&Ft.includes(l))){var a=Ge.deps;if((Ge.f&ws)!==0)l.rv<el&&(l.rv=el,Ot===null&&a!==null&&a[Qt]===l?Qt++:Ot===null?Ot=[l]:(!Gr||!Ot.includes(l))&&Ot.push(l));else{(Ge.deps??(Ge.deps=[])).push(l);var o=l.reactions;o===null?l.reactions=[Ge]:o.includes(Ge)||o.push(Ge)}}}else if(t&&l.deps===null&&l.effects===null){var c=l,d=c.parent;d!==null&&(d.f&lr)===0&&(c.f^=lr)}if(mn){if(dn.has(l))return dn.get(l);if(t){c=l;var u=c.v;return((c.f&qt)===0&&c.reactions!==null||No(c))&&(u=Ss(c)),dn.set(c,u),u}}else if(t){if(c=l,Yr!=null&&Yr.has(c))return Yr.get(c);jl(c)&&eo(c)}if((l.f&cn)!==0)throw l.v;return l.v}function No(l){if(l.v===Et)return!0;if(l.deps===null)return!1;for(const e of l.deps)if(dn.has(e)||(e.f&Kt)!==0&&No(e))return!0;return!1}function Yt(l){var e=Cr;try{return Cr=!0,l()}finally{Cr=e}}const Cu=-7169;function Wt(l,e){l.f=l.f&Cu|e}function Su(l){if(!(typeof l!="object"||!l||l instanceof EventTarget)){if(Dr in l)Ls(l);else if(!Array.isArray(l))for(let e in l){const t=l[e];typeof t=="object"&&t&&Dr in t&&Ls(t)}}}function Ls(l,e=new Set){if(typeof l=="object"&&l!==null&&!(l instanceof EventTarget)&&!e.has(l)){e.add(l),l instanceof Date&&l.getTime();for(let s in l)try{Ls(l[s],e)}catch{}const t=yl(l);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const s=Fa(t);for(let a in s){const o=s[a].get;if(o)try{o.call(l)}catch{}}}}}const Au=["touchstart","touchmove"];function Nu(l){return Au.includes(l)}let Mo=!1;function Mu(){Mo||(Mo=!0,document.addEventListener("reset",l=>{Promise.resolve().then(()=>{var e;if(!l.defaultPrevented)for(const t of l.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function Fl(l){var e=Ge,t=He;ar(null),Sr(null);try{return l()}finally{ar(e),Sr(t)}}function Tu(l,e,t,s=t){l.addEventListener(e,()=>Fl(t));const a=l.__on_r;a?l.__on_r=()=>{a(),s(!0)}:l.__on_r=()=>s(!0),Mu()}const To=new Set,Rs=new Set;function Pu(l,e,t,s={}){function a(o){if(s.capture||rl.call(e,o),!o.cancelBubble)return Fl(()=>t==null?void 0:t.call(this,o))}return l.startsWith("pointer")||l.startsWith("touch")||l==="wheel"?Kn(()=>{e.addEventListener(l,a,s)}):e.addEventListener(l,a,s),a}function gn(l,e,t,s,a){var o={capture:s,passive:a},c=Pu(l,e,t,o);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&_u(()=>{e.removeEventListener(l,c,o)})}function mt(l){for(var e=0;e<l.length;e++)To.add(l[e]);for(var t of Rs)t(l)}function rl(l){var S;var e=this,t=e.ownerDocument,s=l.type,a=((S=l.composedPath)==null?void 0:S.call(l))||[],o=a[0]||l.target,c=0,d=l.__root;if(d){var u=a.indexOf(d);if(u!==-1&&(e===document||e===window)){l.__root=e;return}var f=a.indexOf(e);if(f===-1)return;u<=f&&(c=u)}if(o=a[c]||l.target,o!==e){hs(l,"currentTarget",{configurable:!0,get(){return o||t}});var v=Ge,m=He;ar(null),Sr(null);try{for(var g,h=[];o!==null;){var p=o.assignedSlot||o.parentNode||o.host||null;try{var _=o["__"+s];if(_!=null&&(!o.disabled||l.target===o))if(sn(_)){var[b,...y]=_;b.apply(o,[l,...y])}else _.call(o,l)}catch(E){g?h.push(E):g=E}if(l.cancelBubble||p===e||p===null)break;o=p}if(g){for(let E of h)queueMicrotask(()=>{throw E});throw g}}finally{l.__root=e,delete l.currentTarget,ar(v),Sr(m)}}}function Is(l){var e=document.createElement("template");return e.innerHTML=l.replaceAll("<!>","<!---->"),e.content}function pn(l,e){var t=He;t.nodes_start===null&&(t.nodes_start=l,t.nodes_end=e)}function X(l,e){var t=(e&Ha)!==0,s=(e&Kc)!==0,a,o=!l.startsWith("<!>");return()=>{a===void 0&&(a=Is(o?l:"<!>"+l),t||(a=Jt(a)));var c=s||oo?document.importNode(a,!0):a.cloneNode(!0);if(t){var d=Jt(c),u=c.lastChild;pn(d,u)}else pn(c,c);return c}}function zu(l,e,t="svg"){var s=!l.startsWith("<!>"),a=(e&Ha)!==0,o=`<${t}>${s?l:"<!>"+l}</${t}>`,c;return()=>{if(!c){var d=Is(o),u=Jt(d);if(a)for(c=document.createDocumentFragment();Jt(u);)c.appendChild(Jt(u));else c=Jt(u)}var f=c.cloneNode(!0);if(a){var v=Jt(f),m=f.lastChild;pn(v,m)}else pn(f,f);return f}}function Ne(l,e){return zu(l,e,"svg")}function Lu(l=""){{var e=Ur(l+"");return pn(e,e),e}}function he(){var l=document.createDocumentFragment(),e=document.createComment(""),t=Ur();return l.append(e,t),pn(e,t),l}function T(l,e){l!==null&&l.before(e)}let js=!0;function me(l,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(l.__t??(l.__t=l.nodeValue))&&(l.__t=t,l.nodeValue=t+"")}function Ru(l,e){return Iu(l,e)}const jn=new Map;function Iu(l,{target:e,anchor:t,props:s={},events:a,context:o,intro:c=!0}){gu();var d=new Set,u=m=>{for(var g=0;g<m.length;g++){var h=m[g];if(!d.has(h)){d.add(h);var p=Nu(h);e.addEventListener(h,rl,{passive:p});var _=jn.get(h);_===void 0?(document.addEventListener(h,rl,{passive:p}),jn.set(h,1)):jn.set(h,_+1)}}};u(ms(To)),Rs.add(u);var f=void 0,v=wu(()=>{var m=t??e.appendChild(Ur());return kr(()=>{if(o){be({});var g=ot;g.c=o}a&&(s.$$events=a),js=c,f=l(m,s)||{},js=!0,o&&_e()}),()=>{var p;for(var g of d){e.removeEventListener(g,rl);var h=jn.get(g);--h===0?(document.removeEventListener(g,rl),jn.delete(g)):jn.set(g,h)}Rs.delete(u),m!==t&&((p=m.parentNode)==null||p.removeChild(m))}});return ju.set(f,v),f}let ju=new WeakMap;const qs=0,Ol=1,Fs=2;function Os(l,e,t,s,a){var o=l,c=Vr(),d=ot,u=Et,f,v,m,g=c?vn(void 0):Ns(void 0,!1,!1),h=c?vn(void 0):Ns(void 0,!1,!1),p=!1;function _(y,S){p=!0,S&&(Sr(b),ar(b),Ln(d));try{y===qs&&t&&(f?$n(f):f=kr(()=>t(o))),y===Fs&&a&&(m?$n(m):m=kr(()=>a(o,h))),y!==qs&&f&&Hr(f,()=>f=null),y!==Ol&&v&&Hr(v,()=>v=null),y!==Fs&&m&&Hr(m,()=>m=null)}finally{S&&(Ln(null),ar(null),Sr(null),mu())}}var b=Rn(()=>{if(u!==(u=e())){if(Ec(u)){var y=u;p=!1,y.then(S=>{y===u&&(Wr(g,S),_(Ol,!0))},S=>{if(y===u&&(Wr(h,S),_(Fs,!0),!a))throw h.v}),Kn(()=>{p||_(qs,!0)})}else Wr(g,u),_(Ol,!1);return()=>u=Et}})}function Y(l,e,t=!1){var s=l,a=null,o=null,c=Et,d=t?Pn:0,u=!1;const f=(h,p=!0)=>{u=!0,g(p,h)};var v=null;function m(){v!==null&&(v.lastChild.remove(),s.before(v),v=null);var h=c?a:o,p=c?o:a;h&&$n(h),p&&Hr(p,()=>{c?o=null:a=null})}const g=(h,p)=>{if(c!==(c=h)){var _=Rl(),b=s;if(_&&(v=document.createDocumentFragment(),v.append(b=Ur())),c?a??(a=p&&kr(()=>p(b))):o??(o=p&&kr(()=>p(b))),_){var y=tt,S=c?a:o,E=c?o:a;S&&y.skipped_effects.delete(S),E&&y.skipped_effects.add(E),y.add_callback(m)}else m()}};Rn(()=>{u=!1,e(f),u||g(null,null)},d)}function bn(l,e,t){var s=l,a=Et,o,c,d=null,u=Vr()?Zc:Xa;function f(){o&&Hr(o),d!==null&&(d.lastChild.remove(),s.before(d),d=null),o=c}Rn(()=>{if(u(a,a=e())){var v=s,m=Rl();m&&(d=document.createDocumentFragment(),d.append(v=Ur())),c=kr(()=>t(v)),m?tt.add_callback(f):f()}})}function Qe(l,e){return e}function qu(l,e,t){for(var s=l.items,a=[],o=e.length,c=0;c<o;c++)zs(e[c].e,a,!0);var d=o>0&&a.length===0&&t!==null;if(d){var u=t.parentNode;pu(u),u.append(t),s.clear(),Ar(l,e[0].prev,e[o-1].next)}bo(a,()=>{for(var f=0;f<o;f++){var v=e[f];d||(s.delete(v.k),Ar(l,v.prev,v.next)),Er(v.e,!d)}})}function Xe(l,e,t,s,a,o=null){var c=l,d={flags:e,items:new Map,first:null},u=(e&Ua)!==0;if(u){var f=l;c=f.appendChild(Ur())}var v=null,m=!1,g=new Map,h=Cs(()=>{var y=t();return sn(y)?y:y==null?[]:ms(y)}),p,_;function b(){Fu(_,p,d,g,c,a,e,s,t),o!==null&&(p.length===0?v?$n(v):v=kr(()=>o(c)):v!==null&&Hr(v,()=>{v=null}))}Rn(()=>{_??(_=He),p=r(h);var y=p.length;if(!(m&&y===0)){m=y===0;var S,E,k,C;if(Rl()){var A=new Set,P=tt;for(E=0;E<y;E+=1){k=p[E],C=s(k,E);var M=d.items.get(C)??g.get(C);M?(e&(Sl|Al))!==0&&Po(M,k,E,e):(S=zo(null,d,null,null,k,C,E,a,e,t,!0),g.set(C,S)),A.add(C)}for(const[N,I]of d.items)A.has(N)||P.skipped_effects.add(I.e);P.add_callback(b)}else b();r(h)}})}function Fu(l,e,t,s,a,o,c,d,u){var K,Z,G,$;var f=(c&Oc)!==0,v=(c&(Sl|Al))!==0,m=e.length,g=t.items,h=t.first,p=h,_,b=null,y,S=[],E=[],k,C,A,P;if(f)for(P=0;P<m;P+=1)k=e[P],C=d(k,P),A=g.get(C),A!==void 0&&((K=A.a)==null||K.measure(),(y??(y=new Set)).add(A));for(P=0;P<m;P+=1){if(k=e[P],C=d(k,P),A=g.get(C),A===void 0){var M=s.get(C);if(M!==void 0){s.delete(C),g.set(C,M);var N=b?b.next:p;Ar(t,b,M),Ar(t,M,N),Bs(M,N,a),b=M}else{var I=p?p.e.nodes_start:a;b=zo(I,t,b,b===null?t.first:b.next,k,C,P,o,c,u)}g.set(C,b),S=[],E=[],p=b.next;continue}if(v&&Po(A,k,P,c),(A.e.f&dr)!==0&&($n(A.e),f&&((Z=A.a)==null||Z.unfix(),(y??(y=new Set)).delete(A))),A!==p){if(_!==void 0&&_.has(A)){if(S.length<E.length){var L=E[0],F;b=L.prev;var U=S[0],O=S[S.length-1];for(F=0;F<S.length;F+=1)Bs(S[F],L,a);for(F=0;F<E.length;F+=1)_.delete(E[F]);Ar(t,U.prev,O.next),Ar(t,b,U),Ar(t,O,L),p=L,b=O,P-=1,S=[],E=[]}else _.delete(A),Bs(A,p,a),Ar(t,A.prev,A.next),Ar(t,A,b===null?t.first:b.next),Ar(t,b,A),b=A;continue}for(S=[],E=[];p!==null&&p.k!==C;)(p.e.f&dr)===0&&(_??(_=new Set)).add(p),E.push(p),p=p.next;if(p===null)continue;A=p}S.push(A),b=A,p=A.next}if(p!==null||_!==void 0){for(var R=_===void 0?[]:ms(_);p!==null;)(p.e.f&dr)===0&&R.push(p),p=p.next;var q=R.length;if(q>0){var W=(c&Ua)!==0&&m===0?a:null;if(f){for(P=0;P<q;P+=1)(G=R[P].a)==null||G.measure();for(P=0;P<q;P+=1)($=R[P].a)==null||$.fix()}qu(t,R,W)}}f&&Kn(()=>{var ne;if(y!==void 0)for(A of y)(ne=A.a)==null||ne.apply()}),l.first=t.first&&t.first.e,l.last=b&&b.e;for(var D of s.values())Er(D.e);s.clear()}function Po(l,e,t,s){(s&Sl)!==0&&Wr(l.v,e),(s&Al)!==0?Wr(l.i,t):l.i=t}function zo(l,e,t,s,a,o,c,d,u,f,v){var m=(u&Sl)!==0,g=(u&Bc)===0,h=m?g?Ns(a,!1,!1):vn(a):a,p=(u&Al)===0?c:vn(c),_={i:p,v:h,k:o,a:null,e:null,prev:t,next:s};try{if(l===null){var b=document.createDocumentFragment();b.append(l=Ur())}return _.e=kr(()=>d(l,h,p,f),Qc),_.e.prev=t&&t.e,_.e.next=s&&s.e,t===null?v||(e.first=_):(t.next=_,t.e.next=_.e),s!==null&&(s.prev=_,s.e.prev=_.e),_}finally{}}function Bs(l,e,t){for(var s=l.next?l.next.e.nodes_start:t,a=e?e.e.nodes_start:t,o=l.e.nodes_start;o!==null&&o!==s;){var c=Ll(o);a.before(o),o=c}}function Ar(l,e,t){e===null?l.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function Mt(l,e,t=!1,s=!1,a=!1){var o=l,c="";ae(()=>{var d=He;if(c!==(c=e()??"")&&(d.nodes_start!==null&&(go(d.nodes_start,d.nodes_end),d.nodes_start=d.nodes_end=null),c!=="")){var u=c+"";t?u=`<svg>${u}</svg>`:s&&(u=`<math>${u}</math>`);var f=Is(u);if((t||s)&&(f=Jt(f)),pn(Jt(f),f.lastChild),t||s)for(;Jt(f);)o.before(Jt(f));else o.before(f)}})}function Rr(l,e,...t){var s=l,a=kt,o;Rn(()=>{a!==(a=e())&&(o&&(Er(o),o=null),o=kr(()=>a(s,...t)))},Pn)}function nl(l,e,t){var s=l,a,o,c=null,d=null;function u(){o&&(Hr(o),o=null),c&&(c.lastChild.remove(),s.before(c),c=null),o=d,d=null}Rn(()=>{if(a!==(a=e())){var f=Rl();if(a){var v=s;f&&(c=document.createDocumentFragment(),c.append(v=Ur())),d=kr(()=>t(v,a))}f?tt.add_callback(u):u()}},Pn)}function Lo(l){var e,t,s="";if(typeof l=="string"||typeof l=="number")s+=l;else if(typeof l=="object")if(Array.isArray(l)){var a=l.length;for(e=0;e<a;e++)l[e]&&(t=Lo(l[e]))&&(s&&(s+=" "),s+=t)}else for(t in l)l[t]&&(s&&(s+=" "),s+=t);return s}function Ou(){for(var l,e,t=0,s="",a=arguments.length;t<a;t++)(l=arguments[t])&&(e=Lo(l))&&(s&&(s+=" "),s+=e);return s}function Bu(l){return typeof l=="object"?Ou(l):l??""}const Ro=[...`
\r\f \v\uFEFF`];function Du(l,e,t){var s=l==null?"":""+l;if(e&&(s=s?s+" "+e:e),t){for(var a in t)if(t[a])s=s?s+" "+a:a;else if(s.length)for(var o=a.length,c=0;(c=s.indexOf(a,c))>=0;){var d=c+o;(c===0||Ro.includes(s[c-1]))&&(d===s.length||Ro.includes(s[d]))?s=(c===0?"":s.substring(0,c))+s.substring(d+1):c=d}}return s===""?null:s}function Vu(l,e){return l==null?null:String(l)}function pt(l,e,t,s,a,o){var c=l.__className;if(c!==t||c===void 0){var d=Du(t,s,o);d==null?l.removeAttribute("class"):e?l.className=d:l.setAttribute("class",d),l.__className=t}else if(o&&a!==o)for(var u in o){var f=!!o[u];(a==null||f!==!!a[u])&&l.classList.toggle(u,f)}return o}function bt(l,e,t,s){var a=l.__style;if(a!==e){var o=Vu(e);o==null?l.removeAttribute("style"):l.style.cssText=o,l.__style=e}return s}const Yu=Symbol("is custom element"),Wu=Symbol("is html");function H(l,e,t,s){var a=Uu(l);a[e]!==(a[e]=t)&&(e==="loading"&&(l[Nc]=t),t==null?l.removeAttribute(e):typeof t!="string"&&Hu(l).includes(e)?l[e]=t:l.setAttribute(e,t))}function Uu(l){return l.__attributes??(l.__attributes={[Yu]:l.nodeName.includes("-"),[Wu]:l.namespaceURI===Jc})}var Io=new Map;function Hu(l){var e=Io.get(l.nodeName);if(e)return e;Io.set(l.nodeName,e=[]);for(var t,s=l,a=Element.prototype;a!==s;){t=Fa(s);for(var o in t)t[o].set&&e.push(o);s=yl(s)}return e}const Gu=()=>performance.now(),Ir={tick:l=>requestAnimationFrame(l),now:()=>Gu(),tasks:new Set};function jo(){const l=Ir.now();Ir.tasks.forEach(e=>{e.c(l)||(Ir.tasks.delete(e),e.f())}),Ir.tasks.size!==0&&Ir.tick(jo)}function Xu(l){let e;return Ir.tasks.size===0&&Ir.tick(jo),{promise:new Promise(t=>{Ir.tasks.add(e={c:l,f:t})}),abort(){Ir.tasks.delete(e)}}}function Bl(l,e){Fl(()=>{l.dispatchEvent(new CustomEvent(e))})}function Ku(l){if(l==="float")return"cssFloat";if(l==="offset")return"cssOffset";if(l.startsWith("--"))return l;const e=l.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function qo(l){const e={},t=l.split(";");for(const s of t){const[a,o]=s.split(":");if(!a||o===void 0)break;const c=Ku(a.trim());e[c]=o.trim()}return e}const Ju=l=>l;function Fo(l,e,t,s){var a=(l&Hc)!==0,o=(l&Gc)!==0,c=a&&o,d=(l&Xc)!==0,u=c?"both":a?"in":"out",f,v=e.inert,m=e.style.overflow,g,h;function p(){return Fl(()=>f??(f=t()(e,(s==null?void 0:s())??{},{direction:u})))}var _={is_global:d,in(){var E;if(e.inert=v,!a){h==null||h.abort(),(E=h==null?void 0:h.reset)==null||E.call(h);return}o||g==null||g.abort(),Bl(e,"introstart"),g=Ds(e,p(),h,1,()=>{Bl(e,"introend"),g==null||g.abort(),g=f=void 0,e.style.overflow=m})},out(E){if(!o){E==null||E(),f=void 0;return}e.inert=!0,Bl(e,"outrostart"),h=Ds(e,p(),g,0,()=>{Bl(e,"outroend"),E==null||E()})},stop:()=>{g==null||g.abort(),h==null||h.abort()}},b=He;if((b.transitions??(b.transitions=[])).push(_),a&&js){var y=d;if(!y){for(var S=b.parent;S&&(S.f&Pn)!==0;)for(;(S=S.parent)&&(S.f&Tn)===0;);y=!S||(S.f&Cl)!==0}y&&Ps(()=>{Yt(()=>_.in())})}}function Ds(l,e,t,s,a){var o=s===1;if(Mn(e)){var c,d=!1;return Kn(()=>{if(!d){var b=e({direction:o?"in":"out"});c=Ds(l,b,t,s,a)}}),{abort:()=>{d=!0,c==null||c.abort()},deactivate:()=>c.deactivate(),reset:()=>c.reset(),t:()=>c.t()}}if(t==null||t.deactivate(),!(e!=null&&e.duration))return a(),{abort:kt,deactivate:kt,reset:kt,t:()=>s};const{delay:u=0,css:f,tick:v,easing:m=Ju}=e;var g=[];if(o&&t===void 0&&(v&&v(0,1),f)){var h=qo(f(0,1));g.push(h,h)}var p=()=>1-s,_=l.animate(g,{duration:u,fill:"forwards"});return _.onfinish=()=>{_.cancel();var b=(t==null?void 0:t.t())??1-s;t==null||t.abort();var y=s-b,S=e.duration*Math.abs(y),E=[];if(S>0){var k=!1;if(f)for(var C=Math.ceil(S/16.666666666666668),A=0;A<=C;A+=1){var P=b+y*m(A/C),M=qo(f(P,1-P));E.push(M),k||(k=M.overflow==="hidden")}k&&(l.style.overflow="hidden"),p=()=>{var N=_.currentTime;return b+y*m(N/S)},v&&Xu(()=>{if(_.playState!=="running")return!1;var N=p();return v(N,1-N),!0})}_=l.animate(E,{duration:S,fill:"forwards"}),_.onfinish=()=>{p=()=>s,v==null||v(s,1-s),a()}},{abort:()=>{_&&(_.cancel(),_.effect=null,_.onfinish=kt)},deactivate:()=>{a=kt},reset:()=>{s===0&&(v==null||v(1,0))},t:()=>p()}}function Vs(l,e,t=e){var s=Vr(),a=new WeakSet;Tu(l,"input",o=>{var c=o?l.defaultValue:l.value;if(c=Ys(l)?Ws(c):c,t(c),tt!==null&&a.add(tt),s&&c!==(c=e())){var d=l.selectionStart,u=l.selectionEnd;l.value=c??"",u!==null&&(l.selectionStart=d,l.selectionEnd=Math.min(u,l.value.length))}}),Yt(e)==null&&l.value&&(t(Ys(l)?Ws(l.value):l.value),tt!==null&&a.add(tt)),vo(()=>{var o=e();if(l===document.activeElement){var c=Ml??tt;if(a.has(c))return}Ys(l)&&o===Ws(l.value)||l.type==="date"&&!o&&!l.value||o!==l.value&&(l.value=o??"")})}function Ys(l){var e=l.type;return e==="number"||e==="range"}function Ws(l){return l===""?null:+l}const fs=class fs{constructor(e){zt(this,us);zt(this,rn,new WeakMap);zt(this,Gn);zt(this,bl);Xt(this,bl,e)}observe(e,t){var s=Ue(this,rn).get(e)||new Set;return s.add(t),Ue(this,rn).set(e,s),ln(this,us,yc).call(this).observe(e,Ue(this,bl)),()=>{var a=Ue(this,rn).get(e);a.delete(t),a.size===0&&(Ue(this,rn).delete(e),Ue(this,Gn).unobserve(e))}}};rn=new WeakMap,Gn=new WeakMap,bl=new WeakMap,us=new WeakSet,yc=function(){return Ue(this,Gn)??Xt(this,Gn,new ResizeObserver(e=>{for(var t of e){fs.entries.set(t.target,t);for(var s of Ue(this,rn).get(t.target)||[])s(t)}}))},yr(fs,"entries",new WeakMap);let Us=fs;var Qu=new Us({box:"border-box"});function Oo(l,e,t){var s=Qu.observe(l,()=>t(l[e]));Ps(()=>(Yt(()=>t(l[e])),s))}function Bo(l,e){return l===e||(l==null?void 0:l[Dr])===e}function _n(l={},e,t,s){return Ps(()=>{var a,o;return vo(()=>{a=o,o=[],Yt(()=>{l!==t(...o)&&(e(l,...o),a&&Bo(t(...a),l)&&e(null,...a))})}),()=>{Kn(()=>{o&&Bo(t(...o),l)&&e(null,...o)})}}),l}function Zu(l=!1){const e=ot,t=e.l.u;if(!t)return;let s=()=>Su(e.s);if(l){let a=0,o={};const c=Jn(()=>{let d=!1;const u=e.s;for(const f in u)u[f]!==o[f]&&(o[f]=u[f],d=!0);return d&&a++,a});s=()=>r(c)}t.b.length&&Il(()=>{Do(e,s),xl(t.b)}),ue(()=>{const a=Yt(()=>t.m.map(Cc));return()=>{for(const o of a)typeof o=="function"&&o()}}),t.a.length&&ue(()=>{Do(e,s),xl(t.a)})}function Do(l,e){if(l.l.s)for(const t of l.l.s)r(t);e()}let Dl=!1;function $u(l){var e=Dl;try{return Dl=!1,[l(),Dl]}finally{Dl=e}}const ef={get(l,e){if(!l.exclude.includes(e))return l.props[e]},set(l,e){return!1},getOwnPropertyDescriptor(l,e){if(!l.exclude.includes(e)&&e in l.props)return{enumerable:!0,configurable:!0,value:l.props[e]}},has(l,e){return l.exclude.includes(e)?!1:e in l.props},ownKeys(l){return Reflect.ownKeys(l.props).filter(e=>!l.exclude.includes(e))}};function wn(l,e,t){return new Proxy({props:l,exclude:e},ef)}const tf={get(l,e){let t=l.props.length;for(;t--;){let s=l.props[t];if(Mn(s)&&(s=s()),typeof s=="object"&&s!==null&&e in s)return s[e]}},set(l,e,t){let s=l.props.length;for(;s--;){let a=l.props[s];Mn(a)&&(a=a());const o=Or(a,e);if(o&&o.set)return o.set(t),!0}return!1},getOwnPropertyDescriptor(l,e){let t=l.props.length;for(;t--;){let s=l.props[t];if(Mn(s)&&(s=s()),typeof s=="object"&&s!==null&&e in s){const a=Or(s,e);return a&&!a.configurable&&(a.configurable=!0),a}}},has(l,e){if(e===Dr||e===Ya)return!1;for(let t of l.props)if(Mn(t)&&(t=t()),t!=null&&e in t)return!0;return!1},ownKeys(l){const e=[];for(let t of l.props)if(Mn(t)&&(t=t()),!!t){for(const s in t)e.includes(s)||e.push(s);for(const s of Object.getOwnPropertySymbols(t))e.includes(s)||e.push(s)}return e}};function Zt(...l){return new Proxy({props:l},tf)}function V(l,e,t,s){var E;var a=!zn||(t&Vc)!==0,o=(t&Wc)!==0,c=(t&Uc)!==0,d=s,u=!0,f=()=>(u&&(u=!1,d=c?Yt(s):s),d),v;if(o){var m=Dr in l||Ya in l;v=((E=Or(l,e))==null?void 0:E.set)??(m&&e in l?k=>l[e]=k:void 0)}var g,h=!1;o?[g,h]=$u(()=>l[e]):g=l[e],g===void 0&&s!==void 0&&(g=f(),v&&(a&&Ic(),v(g)));var p;if(a?p=()=>{var k=l[e];return k===void 0?f():(u=!0,k)}:p=()=>{var k=l[e];return k!==void 0&&(d=void 0),k===void 0?d:k},a&&(t&Yc)===0)return p;if(v){var _=l.$$legacy;return function(k,C){return arguments.length>0?((!a||!C||_||h)&&v(C?p():k),k):p()}}var b=!1,y=((t&Dc)!==0?Jn:Cs)(()=>(b=!1,p()));o&&r(y);var S=He;return function(k,C){if(arguments.length>0){const A=C?r(y):a&&o?De(k):k;return B(y,A),b=!0,d!==void 0&&(d=A),k}return mn&&b||(S.f&on)!==0?y.v:r(y)}}function rf(l){ot===null&&Wa(),zn&&ot.l!==null?nf(ot).m.push(l):ue(()=>{const e=Yt(l);if(typeof e=="function")return e})}function nf(l){var e=l.l;return e.u??(e.u={a:[],b:[],m:[]})}const lf="5";typeof window<"u"&&((gc=window.__svelte??(window.__svelte={})).v??(gc.v=new Set)).add(lf),eu();function Vo(l,e){Je(l)&&Vo(l.v,e);const t=jr(l);if(t[0]===t[1])throw new Error('split: values in a vector "x" should vary.');const s=(t[1]-t[0])/e;return ze.seq(t[0],t[1],s)}function Yo(l){if(Je(l))return Yo(l.v);const e=new ze.valuesConstructor(l.length-1);for(let t=0;t<l.length-1;t++)e[t]=l[t+1]-l[t];return new ze(e)}function Vl(l,e){if(Je(l))return Vl(l.v,e);e===void 0&&(e=.1);const t=jr(l),s=(t[1]-t[0])*e;return[t[0]-s,t[1]+s]}function jr(l){if(Je(l))return jr(l.v);let e=l[0],t=l[0];for(let s=1;s<l.length;s++)l[s]<e&&(e=l[s]),l[s]>t&&(t=l[s]);return[e,t]}function Wo(l,e){return Je(l)?Wo(l.v,e):Math.sqrt(Hs(l,e))}function Hs(l,e){if(e===void 0&&(e=!1),Je(l))return Hs(l.v);const t=Yl(l);let s=0;for(let a=0;a<l.length;a++){const o=l[a]-t;s=s+o*o}return s/(e?l.length:l.length-1)}function Yl(l){return Je(l)?Yl(l.v):Uo(l)/l.length}function Uo(l){if(Je(l))return Uo(l.v);let e=0;for(let t=0;t<l.length;t++)e=e+l[t];return e}function Ho(l){if(Je(l))return Ho(l.v);let e=1;for(let t=0;t<l.length;t++)e=e*l[t];return e}function qn(l){return Je(l)||hr(l)?l.v[Gs(l.v)-1]:l[Gs(l)-1]}function Gs(l){if(Je(l)||hr(l))return Gs(l.v);let e=1,t=l[0];for(let s=2;s<=l.length;s++)l[s-1]<t&&(e=s,t=l[s-1]);return e}function $t(l){return Je(l)||hr(l)?l.v[Xs(l.v)-1]:l[Xs(l)-1]}function Xs(l){if(Je(l)||hr(l))return Xs(l.v);let e=1,t=l[0];for(let s=2;s<=l.length;s++)l[s-1]>t&&(e=s,t=l[s-1]);return e}const Ks=30,sf=1e-7,af=1e-7,Go=1e-13,Xo=1e3,of=100;function Ko(l,e,t,s,a){s===void 0&&(s=Xo),t===void 0&&(t=Go),a===void 0&&(a=of);let o=t,c=s,d=(c-o)/a;for(let u=0;u<a;u++){let f,v;for(let h=0;h<a;h++){f=o+h*d,v=o+(h+1)*d;const p=e(f),_=e(v);if(p<=l&&_>=l)break}const m=(f+v)/2,g=e(m);if(Math.abs(g-l)<sf||(o=f,c=v,d=(c-o)/a,d/c<af))return m}return(o+c)/2}function Jo(l,e=0,t=1){let s=ze.zeros(l);for(let a=0;a<l;a++)s.v[a]=e+Math.random()*(t-e);return s}function Qo(l,e=0,t=1){let s=ze.zeros(l);for(let a=0;a<l;a++){const o=Math.sqrt(-2*Math.log(Math.random())),c=2*Math.PI*Math.random();s.v[a]=o*Math.sin(c)*t+e}return s}function Wl(l,e=0,t=1){if(Je(l))return l.apply(a=>Wl(a,e,t));const s=1/(Math.sqrt(2)*t);return .5*(1+uf((l-e)*s))}function Ul(l,e=0,t=1){if(Je(l))return l.apply(U=>Ul(U,e,t));if(e!==0||t!==1)return Ul(l)*t+e;if(l<0||l>1)throw Error('Parameter "p" must be between 0 and 1.');if(l<1e-10)return-1/0;if(l>.9999999999)return 1/0;const s=.425,a=5,o=.180625,c=1.6,d=3.3871327179,u=5.0434271938*10,f=1.5929113202*100,v=5.910937472*10,m=1.7895169469*10,g=7.8757757664*10,h=6.71875636*10,p=1.4234372777,_=2.75681539,b=1.3067284816,y=1.7023821103*.1,S=7.370016425*.1,E=1.2021132975*.1,k=6.657905115,C=3.081226386,A=4.2868294337*.1,P=1.7337203997*.01,M=2.4197894225*.1,N=1.2258202635*.01,I=l-.5;let L;if(Math.abs(I)<=s)return L=o-I*I,I*(((v*L+f)*L+u)*L+d)/(((h*L+g)*L+m)*L+1);L=I<0?l:1-l,L=Math.sqrt(-Math.log(L));let F;return L<=a?(L=L-c,F=(((y*L+b)*L+_)*L+p)/((E*L+S)*L+1)):(L=L-a,F=((P*L+A)*L+C+k)/((N*L+M)*L+1)),I<0?-F:F}function Js(l,e,t){if(t<=0)throw new Error('pf: parameters "df1" and "df2" must be positive numbers.');if(Array.isArray(l))return Js(ct(l),e,t);if(Je(l))return l.apply(s=>Js(s,e,t));if(l<=0)return 0;if(t<=0&&ML_ERR_return_NAN,t==Number.POSITIVE_INFINITY){if(e==Number.POSITIVE_INFINITY){if(l<1)return 0;if(l==1)return .5;if(l>1)return 1}return Hl(l*e,e)}return e==Number.POSITIVE_INFINITY?1-Hl(t/l,t):e*l>t?1-Gl(t/(t+e*l),t/2,e/2):Gl(e*l/(t+e*l),e/2,t/2)}function Zo(l,e,t){if(l===0)return 0;if(l===1)return Inf;if(t<=0)return NaN;let s=Xo,a=Go;if(l>.9997&&t===1?(s=1e7,a=6e5,l=.9997):l>.9992&&t===1?(s=1e7,a=6e5):l>.997&&t===1?(s=1e6,a=45e3):l>.992&&t===1?(s=1e5,a=5e3):l>.97&&t===1&&(s=1e4,a=400),Array.isArray(l))return Zo(ct(l),e,t);const o=d=>Js(d,e,t);function c(d,u,f){return d===0?0:d===1?Inf:u===0?NaN:f===0?NaN:Ko(d,o,a,s)}return Je(l)?l.apply(c,e,t):c(l,e,t)}function Hl(l,e){if(Array.isArray(l))return Hl(ct(l),e);const t=5/6-1/(9*e)-7/(648*e*e)+25/(2187*e*e*e),s=1/(18*e)+1/(162*e*e)-37/(1164*e*e*e),a=Math.sqrt(s);function o(u){if(u===0)return 0;if(e===0||e>100&&u>e*2||e>50&&u>e*3||e>10&&u>e*5||e>5&&u>e*8||u>e*30)return 1;const f=u/e,v=Math.pow(f,1/6)-.5*Math.pow(f,1/3)+1/3*Math.pow(f,1/2);return Wl(v,t,a)}function c(u){return u===0?0:e===0||e>100&&u>e*2||e>50&&u>e*3||e>10&&u>e*5||e>5&&u>e*8||u>e*30?1:cf(u/2,e/2)/ll(e/2)}const d=e>Ks?o:c;return Je(l)?l.apply(d):d(l)}function ir(l,e){if(Array.isArray(l))return ir(ct(l),e);const t=5/6-1/(9*e)-7/(648*e*e)+25/(2187*e*e*e),s=1/(18*e)+1/(162*e*e)-37/(1164*e*e*e),a=Math.sqrt(s);function o(u){if(u===0)return 0;if(u===1)return Inf;if(e===0)return 0;const f=Ul(u,t,a),v=Math.pow(Math.sqrt(36*f*f-30*f+13)/4+(3*f-3/2)/2+1/8,1/3);return Math.pow(v-3/(4*v)+.5,6)*e}function c(u){return u===0?0:u===1?Inf:e===0?0:Ko(u,v=>Hl(v,e),0,Ks*10)}const d=e>Ks?o:c;return Je(l)?l.apply(d):d(l)}function Gl(l,e,t){if(Array.isArray(l))return Gl(ct(l),e,t);if(Je(l))return l.apply(a=>Gl(a,e,t));if(l<=0)return 0;if(l>=1)return 1;if(e==0||t==0||!Number.isFinite(e)||!Number.isFinite(t))return e==0&&t==0?.5:e==0||e/t==0?1:t==0||t/e==0||l<.5?0:1;const s=.5-l+.5;return xf(e,t,l,s)}function ll(l){if(Je(l))return l.apply(ll);if(l<=0)throw new Error("gamma: the function only works with arguments > 0.");const e=[676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23];if(l<.5)return Math.PI/(Math.sin(Math.PI*l)+ll(1-l));l=l-1;let t=.9999999999998099;for(let a=0;a<e.length;a++)t=t+e[a]/(l+a+1);const s=l+e.length-.5;return Math.sqrt(2*Math.PI)*Math.pow(s,l+.5)*Math.exp(-s)*t}function cf(l,e){let a=0;for(let o=0;o<1e4;o++){const c=Math.pow(l,o)/ll(e+o+1);if(isNaN(c)||c<1e-18)break;a+=c}return Math.pow(l,e)*ll(e)*Math.exp(-l)*a}function uf(l){const e=l>=0?1:-1;l=Math.abs(l);const t=.254829592,s=-.284496736,a=1.421413741,o=-1.453152027,c=1.061405429,u=1/(1+.3275911*l),f=1-((((c*u+o)*u+a)*u+s)*u+t)*u*Math.exp(-l*l);return e*f}function $o(l,e){const t=.564189583547756,s=[77105849500132e-18,-.00133733772997339,.0323076579225834,.0479137145607681,.128379167095513],a=[.00301048631703895,.0538971687740286,.375795757275549],o=[-136864857382717e-21,.564195517478974,7.21175825088309,43.1622272220567,152.98928504694,339.320816734344,451.918953711873,300.459261020162],c=[1,12.7827273196294,77.0001529352295,277.585444743988,638.980264465631,931.35409485061,790.950925327898,300.459260956983],d=[2.10144126479064,26.2370141675169,21.3688200555087,4.6580782871847,.282094791773523],u=[94.153775055546,187.11481179959,99.0191814623914,18.0124575948747];let f,v,m,g,h=Math.abs(e);if(h<=.5)return v=e*e,g=(((s[0]*v+s[1])*v+s[2])*v+s[3])*v+s[4]+1,m=((a[0]*v+a[1])*v+a[2])*v+1,f=.5-e*(g/m)+.5,f=Math.exp(v)*f,f;if(h<=4)g=((((((o[0]*h+o[1])*h+o[2])*h+o[3])*h+o[4])*h+o[5])*h+o[6])*h+o[7],m=((((((c[0]*h+c[1])*h+c[2])*h+c[3])*h+c[4])*h+c[5])*h+c[6])*h+c[7],f=g/m;else{if(e<=-5.6)return f=2,f=Math.exp(e*e)*2,f;v=1/(e*e),g=(((d[0]*v+d[1])*v+d[2])*v+d[3])*v+d[4],m=(((u[0]*v+u[1])*v+u[2])*v+u[3])*v+1,f=(t-v*g/m)/h}return e<0&&(f=Math.exp(e*e)*2-f),f}function ei(l,e){let t=l+e-2;return t<=.25?cr(t+1):t<=1.25?cr(t)+Kr(t):cr(t-1)+Math.log(t*(t+1))}function Xl(l,e){const t=.0833333333333333,s=-.00277777777760991,a=.00079365066682539,o=-.00059520293135187,c=.000837308034031215,d=-.00165322962780713;let u,f,v,m,g,h,p,_,b,y,S,E,k,C,A;return v=Math.min(l,e),m=Math.max(l,e),h=v/m,g=h/(h+1),b=1/(h+1),E=b*b,y=b+E+1,S=b+E*y+1,k=b+E*S+1,C=b+E*k+1,A=b+E*C+1,f=1/m,p=f*f,_=((((d*A*p+c*C)*p+o*k)*p+a*S)*p+s*y)*p+t,_*=g/m,f=1/v,p=f*f,u=(((((d*p+c)*p+o)*p+a)*p+s)*p+t)/v+_,u}function ht(l){let e,t,s,a,o;if(t=l,e=l-.5,e>0&&(t=e-.5),t<0){const c=[-.422784335098468,-.771330383816272,-.244757765222226,.118378989872749,.000930357293360349,-.0118290993445146,.00223047661158249,.000266505979058923,-.000132674909766242],d=.273076135303957,u=.0559398236957378;return o=(((((((c[8]*t+c[7])*t+c[6])*t+c[5])*t+c[4])*t+c[3])*t+c[2])*t+c[1])*t+c[0],a=(u*t+d)*t+1,s=o/a,e>0?t*s/l:l*(s+.5+.5)}else{if(t==0)return 0;{const c=[.577215664901533,-.409078193005776,-.230975380857675,.0597275330452234,.0076696818164949,-.00514889771323592,.000589597428611429],d=[1,.427569613095214,.158451672430138,.0261132021441447,.00423244297896961];return o=(((((c[6]*t+c[5])*t+c[4])*t+c[3])*t+c[2])*t+c[1])*t+c[0],a=(((d[4]*t+d[3])*t+d[2])*t+d[1])*t+1,s=o/a,e>0?t/l*(s-.5-.5):l*s}}}function ff(l,e,t){let s,a,o,c;if(l<-1.1||l>1.1)return Number.NaN;c=l*2,o=a=0,s=0;for(let d=1;d<=t;d++)o=a,a=s,s=c*a-o+e[t-d];return(s-o)*.5}function ti(l){const e=[1.037869356274377,-.13364301504908918,.019408249135520562,-.0030107551127535777,.0004869461479715485,-8105488189317536e-20,13778847799559525e-21,-2380221089435897e-21,41640416213865184e-23,-7359582837807599e-23,13117611876241675e-24,-23546709317742423e-25,42522773276035e-23,-771908941348408e-25,1407574648135907e-26,-25769072058024682e-28,4734240666629442e-28,-8724901267474264e-29,1612461490274055e-29,-29875652015665774e-31,5548070120908289e-31,-10324619158271569e-32,19250239203049852e-33,-3595507346526515e-33,6726454253787686e-34,-1260262416873522e-34,2364488440860621e-35,-44419377050807936e-37,8354659446403425e-37,-15731559416479563e-38,29653128740247425e-39,-5594958348181595e-39,1056635426883568e-39,-19972483680670205e-41,3778297781883936e-41,-7153158688908174e-42,13552488463674214e-43,-25694673048487566e-44,48747756066216946e-45,-9254211253084972e-45,1757859784176024e-45,-3341002667773101e-46,6353393618023618e-47],t=22,s=-.999999985;if(l==0)return 0;if(l==-1)return Number.NEGATIVE_INFINITY;if(l<-1)return Number.NaN;if(Math.abs(l)<=.375)return Math.abs(l)<.5*Number.EPSILON?l:0<l&&l<1e-8||-1e-9<l&&l<0?l*(1-.5*l):l*(1-l*ff(l/.375,e,t));if(l<s)throw new Error("log1p: error evaluating the functio value.");return Math.log(1+l)}function Xr(l,e){const t=.0833333333333333,s=-.00277777777760991,a=.00079365066682539,o=-.00059520293135187,c=.000837308034031215,d=-.00165322962780713;let u,f,v,m,g,h,p,_,b,y,S,E,k,C;return l>e?(v=e/l,u=1/(v+1),_=v/(v+1),f=l+(e-.5)):(v=l/e,u=v/(v+1),_=1/(v+1),f=e+(l-.5)),S=_*_,b=_+S+1,y=_+S*b+1,E=_+S*y+1,k=_+S*E+1,C=_+S*k+1,m=1/(e*e),p=((((d*C*m+c*k)*m+o*E)*m+a*y)*m+s*b)*m+t,p*=u/e,g=f*Kr(l/e),h=l*(Math.log(e)-1),g>h?p-h-g:p-g-h}function cr(l){if(l<.6){const p=((((((-.00271935708322958*l+-.0673562214325671)*l+-.402055799310489)*l+-.780427615533591)*l+-.168860593646662)*l+.844203922187225)*l+.577215664901533)/((((((.000667465618796164*l+.0325038868253937)*l+.361951990101499)*l+1.56875193295039)*l+3.12755088914843)*l+2.88743195473681)*l+1);return-l*p}else{const e=.422784335098467,t=.848044614534529,s=.565221050691933,a=.156513060486551,o=.017050248402265,c=.000497958207639485,d=1.24313399877507,u=.548042109832463,f=.10155218743983,v=.00713309612391,m=.000116165475989616,g=l-.5-.5,h=(((((c*g+o)*g+a)*g+s)*g+t)*g+e)/(((((m*g+v)*g+f)*g+u)*g+d)*g+1);return g*h}}function vr(l){const e=.418938533204673,t=.0833333333333333,s=-.00277777777760991,a=.00079365066682539,o=-.00059520293135187,c=.000837308034031215,d=-.00165322962780713;if(l<=.8)return cr(l)-Math.log(l);if(l<=2.25)return cr(l-.5-.5);if(l<10){let v=Math.round(l-1.25),m=l,g=1;for(let h=1;h<=v;++h)m+=-1,g*=m;return cr(m-1)+Math.log(g)}let u=1/(l*l),f=(((((d*u+c)*u+o)*u+a)*u+s)*u+t)/l;return e+f+(l-.5)*(Math.log(l)-1)}function Qs(l,e){const t=.918938533204673;let s=Math.min(l,e),a=Math.max(l,e);function o(c,d,u){let f=Math.round(u-1),v=1;for(let m=1;m<=f;++m)u+=-1,v*=u/(d+u);return c+Math.log(v)+(vr(d)+(vr(u)-ei(d,u)))}if(s<8){if(s<1)return a<8?vr(s)+(vr(a)-vr(s+a)):vr(s)+Xr(s,a);let c;if(s<2)return a<=2?vr(s)+vr(a)-ei(s,a):a<8?(c=0,o(c,s,a)):vr(s)+Xr(s,a);if(a<=1e3){let d=Math.round(s-1);c=1;for(let u=1;u<=d;++u){s+=-1;let f=s/a;c*=f/(f+1)}return c=Math.log(c),a>=8?c+vr(s)+Xr(s,a):o(c,s,a)}else{let d=Math.round(s-1);c=1;for(let u=1;u<=d;++u)s+=-1,c*=s/(s/a+1);return log(c)-d*log(a)+(vr(s)+Xr(s,a))}}else{let c=Xl(s,a),d=s/a,u=-(s-.5)*Math.log(d/(d+1)),f=a*Kr(d);return u>f?Math.log(a)*-.5+t+c-f-u:Math.log(a)*-.5+t+c-u-f}}function ri(l){return(l==0?1024:-300)*.69314718055995*.99999}function Fn(l){const e=.0566749439387324,t=.0456512608815524,s=.333333333333333,a=-.224696413112536,o=.00620886815375787,c=-1.27408923933623,d=.354508718369557;let u,f,v,m,g;return l<-.39||l>.57?(m=l+.5+.5,l-Math.log(m)):(l<-.18?(u=l+.3,u/=.7,g=e-u*.3):l>.18?(u=l*.75-.25,g=t+u/3):(u=l,g=0),f=u/(u+2),v=f*f,m=((o*v+a)*v+s)/((d*v+c)*v+1),v*2*(1/(1-f)-f*m)+g)}function Kr(l){if(Math.abs(l)>.375)return Math.log(1+l);const e=-1.29418923021993,t=.405303492862024,s=-.0178874546012214,a=-1.62752256355323,o=.747811014037616,c=-.0845104217945565;let d=l/(l+2),u=d*d,f=(((s*u+t)*u+e)*u+1)/(((c*u+o)*u+a)*u+1);return d*2*f}function df(l){const e=.564189583547756,t=[77105849500132e-18,-.00133733772997339,.0323076579225834,.0479137145607681,.128379167095513],s=[.00301048631703895,.0538971687740286,.375795757275549],a=[-136864857382717e-21,.564195517478974,7.21175825088309,43.1622272220567,152.98928504694,339.320816734344,451.918953711873,300.459261020162],o=[1,12.7827273196294,77.0001529352295,277.585444743988,638.980264465631,931.35409485061,790.950925327898,300.459260956983],c=[2.10144126479064,26.2370141675169,21.3688200555087,4.6580782871847,.282094791773523],d=[94.153775055546,187.11481179959,99.0191814623914,18.0124575948747];let u,f,v,m,g;if(v=Math.abs(l),v<=.5)return u=l*l,g=(((t[0]*u+t[1])*u+t[2])*u+t[3])*u+t[4]+1,m=((s[0]*u+s[1])*u+s[2])*u+1,l*(g/m);if(v<=4){g=((((((a[0]*v+a[1])*v+a[2])*v+a[3])*v+a[4])*v+a[5])*v+a[6])*v+a[7],m=((((((o[0]*v+o[1])*v+o[2])*v+o[3])*v+o[4])*v+o[5])*v+o[6])*v+o[7];let p=.5-Math.exp(-l*l)*g/m+.5;return l<0?-p:p}if(v>=5.8)return l>0?1:-1;f=l*l,u=1/f,g=(((c[0]*u+c[1])*u+c[2])*u+c[3])*u+c[4],m=(((d[0]*u+d[1])*u+d[2])*u+d[3])*u+1,u=(e-g/(f*m))/v;let h=.5-Math.exp(-f)*u+.5;return l<0?-h:h}function vf(l){const e=914041914819518e-24,t=.0238082361044469,s=-.499999999085958,a=.107141568980644,o=-.0119041179760821,c=.000595130811860248;if(Math.abs(l)<=.15)return l*(((t*l+e)*l+1)/((((c*l+o)*l+a)*l+s)*l+1));{let d=Math.exp(l);return l>0?d*(.5-1/d+.5):d-.5-.5}}function sl(l,e){let t;if(e>0){if(l>0||(t=l+e,t<0))return Math.exp(l)*Math.exp(e)}else if(l<0||(t=l+e,t>0))return Math.exp(l)*Math.exp(e);return Math.exp(t)}function mf(l){const e=.785398163397448,t=1.4616321449683622,s=[.0089538502298197,4.77762828042627,142.441585084029,1186.45200713425,3633.51846806499,4138.10161269013,1305.60269827897],a=[44.8452573429826,520.752771467162,2210.0079924783,3641.27349079381,1908.310765963,691091682714533e-20],o=[-2.12940445131011,-7.01677227766759,-4.48616543918019,-.648157123766197],c=[32.2703493791143,89.2920700481861,54.6117738103215,7.77788548522962];let d,u,f,v,m,g,h,p,_,b,y,S,E;if(y=Number.MAX_SAFE_INTEGER,v=.5/(.5*Number.EPSILON),y>v&&(y=v),E=1e-9,p=0,l<.5){if(fabs(l)<=E){if(l==0)return 0;p=-1/l}else{if(m=-l,_=e,m<=0&&(m=-m,_=-_),m>=y)return 0;if(f=Math.round(m),m-=f,f=Math.round(m*4),m=(m-f*.25)*4,u=f/2,u+u!=f&&(m=1-m),g=e*m,d=u/2,d+d!=u&&(_=-_),u=(f+1)/2,d=u/2,d+=d,d==u){if(g==0)return 0;p=_*(cos(g)/sin(g)*4)}else p=_*(sin(g)/cos(g)*4)}l=1-l}if(l<=3){h=l,S=s[0]*l;for(let k=1;k<=5;++k)h=(h+a[k-1])*l,S=(S+s[k])*l;return h=(S+s[6])/(h+a[5]),b=l-t,h*b+p}if(l<y){m=1/(l*l),h=m,S=o[0]*m;for(let k=1;k<=3;++k)h=(h+c[k-1])*m,S=(S+o[k])*m;p=S/(h+c[3])-.5/l+p}return p+log(l)}function hf(l,e,t,s){let a,o,c,d,u,f;if(l>s*.001){if(d=l*Math.log(t),d<Math.exparg(1))return 0;a=Math.exp(d)}else a=1;for(a*=e/l,f=s/l,u=l+1,d=t,c=d/u,u+=1,d=t*d,o=d/u,c+=o;Math.abs(t)>f;)u+=1,d=t*d,o=d/u,c+=o;return a*=l*c+1,a}function gf(l,e,t,s){const a=.577215664901533;let o,c,d,u,f,v,m=e*t;for(f=t-m,c=e*s<=.02?Math.log(t)+mf(e)+a+f:Math.log(m)+a+f,o=s*5*Math.abs(c),d=1,u=0,d+=1,f*=t-m/d,v=f/d,u+=v;Math.abs(v)>o;)d+=1,f*=t-m/d,v=f/d,u+=v;return-l*(c+u)}function Zs(l,e,t,s){let a,o,c,d,u,f,v,m,g;if(t==0)return 0;if(v=Math.min(l,e),v>=1)f=l*Math.log(t)-Qs(l,e),o=Math.exp(f)/l;else if(m=Math.max(l,e),m<8)if(m<=1){if(o=Math.pow(t,l),o==0)return o;g=l+e,g>1?(u=l+e-1,f=(ht(u)+1)/g):f=ht(g)+1,c=(ht(l)+1)*(ht(e)+1)/f,o*=c*(e/g)}else{if(u=cr(v),a=Math.round(m-1),a>=1){c=1;for(let y=1;y<=a;++y)m+=-1,c*=m/(v+m);u+=Math.log(c)}f=l*Math.log(t)-u,m+=-1,g=v+m,g>1?(u=v+m-1,d=(ht(u)+1)/g):d=ht(g)+1,o=Math.exp(f)*(v/l)*(ht(m)+1)/d}else u=cr(v)+Xr(v,m),f=l*Math.log(t)-u,o=v/l*Math.exp(f);if(o==0||l<=s*.1)return o;let h=s/l,p=0,_=0,b;for(c=1,p+=1,c*=(.5-e/p+.5)*t,b=c/(l+p),_+=b;p<1e7&&Math.abs(b)>h;)p+=1,c*=(.5-e/p+.5)*t,b=c/(l+p),_+=b;return l*_>-1?o*=l*_+1:o=0,o}function Kl(l,e,t,s,a,o){let c,d,u,f,v,m=l+e,g=l+1;if(a>1&&l>=1&&m>=g*1.1?(u=Math.round(Math.abs(ri(1))),d=Math.round(ri(0)),u>d&&(u=d),f=Math.exp(-u)):(u=0,f=1),c=_f(u,l,e,t,s)/l,a==1||c==0)return c;let h=a-1,p=f;if(d=0,e>1){if(s>1e-4){let _=(e-1)*t/s-l;_>=1&&(d=_<h?Math.round(_):h)}else d=h;for(let _=0;_<d;++_)v=_,f*=(m+v)/(g+v)*t,p+=f}for(let _=d;_<h&&(v=_,f*=(m+v)/(g+v)*t,p+=f,!(f<=o*p));++_);return c*=p,c}function pf(l,e,t,s,a,o){let c,d,u,f,v,m,g,h,p,_,b,y,S,E,k,C,A,P,M;if(!Number.isFinite(a)||(M=bf(l,e,t,s),Number.isNaN(M)))return Number.NaN;if(M==0)return 0;for(c=a+1,p=e/l,_=1/l+1,E=s+1,u=0,f=1,m=l+1,y=0,S=1,k=1,C=c/_,v=_/c,u+=1,g=u/l,h=u*(e-u)*t,d=l/m,P=f*(f+p)*d*d*(h*t),d=(g+1)/(_+g+g),A=u+h/m+d*(c+u*E),f=g+1,m+=2,g=P*y+A*k,y=k,k=g,g=P*S+A*C,S=C,C=g,b=v,v=k/C,y/=C,S/=C,k=v,C=1;u<1e4&&(u+=1,g=u/l,h=u*(e-u)*t,d=l/m,P=f*(f+p)*d*d*(h*t),d=(g+1)/(_+g+g),A=u+h/m+d*(c+u*E),f=g+1,m+=2,g=P*y+A*k,y=k,k=g,g=P*S+A*C,S=C,C=g,b=v,v=k/C,!(Math.abs(v-b)<=o*v));)y/=C,S/=C,k=v,C=1;return M*v}function bf(l,e,t,s){const a=.398942280401433;let o,c,d,u,f,v,m,g,h;if(t==0||s==0)return 0;if(m=Math.min(l,e),m<8){let p,_;if(t<=.375?(p=Math.log(t),_=Kr(-t)):s>.375?(p=Math.log(t),_=Math.log(s)):(p=Kr(-s),_=Math.log(s)),v=l*p+e*_,m>=1)return v-=Qs(l,e),Math.exp(v);if(g=Math.max(l,e),g>=8)return u=cr(m)+Xr(m,g),m*Math.exp(v-u);if(g<=1){let y=Math.exp(v);return y==0?0:(h=l+e,h>1?(u=l+e-1,v=(ht(u)+1)/h):v=ht(h)+1,c=(ht(l)+1)*(ht(e)+1)/v,y*(m*c)/(m/g+1))}if(u=cr(m),o=Math.round(g-1),o>=1){c=1;for(let y=1;y<=o;++y)g+=-1,c*=g/(m+g);u=Math.log(c)+u}v-=u,g+=-1,h=m+g;let b;return h>1?(u=m+g-1,b=(ht(u)+1)/h):b=ht(h)+1,m*Math.exp(v)*(ht(g)+1)/b}else{let p,_,b,y;return l<=e?(p=l/e,_=p/(p+1),b=1/(p+1),y=l-(l+e)*t):(p=e/l,_=1/(p+1),b=p/(p+1),y=(l+e)*s-e),d=-y/l,u=Math.abs(d)>.6?d-Math.log(t/_):Fn(d),d=y/e,f=Math.abs(d)<=.6?Fn(d):d-Math.log(s/b),v=Math.exp(-(l*u+e*f)),a*Math.sqrt(e*_)*v*Math.exp(-Xl(l,e))}}function _f(l,e,t,s,a){const o=.398942280401433;let c,d,u,f,v,m,g,h;if(m=Math.min(e,t),m<8){let p,_;if(s<=.375?(p=Math.log(s),_=Kr(-s)):a>.375?(p=Math.log(s),_=Math.log(a)):(p=Kr(-a),_=Math.log(a)),v=e*p+t*_,m>=1)return v-=Qs(e,t),sl(l,v);if(g=Math.max(e,t),g>=8)return u=cr(m)+Xr(m,g),m*sl(l,v-u);if(g<=1){let y=sl(l,v);return y==0?y:(h=e+t,h>1?(u=e+t-1,v=(ht(u)+1)/h):v=ht(h)+1,c=(ht(e)+1)*(ht(t)+1)/v,y*(m*c)/(m/g+1))}u=cr(m);let b=Math.round(g-1);if(b>=1){c=1;for(let y=1;y<=b;++y)g+=-1,c*=g/(m+g);u+=Math.log(c)}return v-=u,g+=-1,h=m+g,d=h>1?(ht(h-1)+1)/h:ht(h)+1,m*sl(l,v)*(ht(g)+1)/d}else{let p,_,b,y;e>t?(p=t/e,_=1/(p+1),b=p/(p+1),y=(e+t)*a-t):(p=e/t,_=p/(p+1),b=1/(p+1),y=e-(e+t)*s),-ti(t/e);let S=-y/e;return u=Math.abs(S)>.6?S-Math.log(s/_):Fn(S),S=y/t,f=Math.abs(S)>.6?S-Math.log(a/b):Fn(S),v=sl(l,-(e*u+t*f)),o*Math.sqrt(t*_)*v*Math.exp(-Xl(e,t))}}function $s(l,e,t,s,a,o){let d=Array(30),u=Array(30),f=e-.5-.5,v=l+f*.5,m=s>.375?Math.log(t):Kr(-s),g=-v*m;if(e*g==0)throw new Error("bgrat: expansion can not be computed.");let h=Math.log(e)+ti(ht(e))+e*Math.log(g)+v*m,p=h-(Xr(e,l)+e*Math.log(v)),_=Math.exp(p);if(p==Number.NEGATIVE_INFINITY)throw new Error("bgrat: expansion can not be computed.");let b=_==0,y=a==0?0:Math.exp(Math.log(a)-p),S=wf(e,g,h,o),E=.25/(v*v),k=m*.25*m,C=S,A=C,P=1,M=1,N=0;for(let I=1;I<=30;++I){let L=e+N;C=(L*(L+1)*C+(g+L+1)*P)*E,N+=2,P*=k,M/=N*(N+1);let F=I-1;d[F]=M;let U=0;if(I>1){let R=e-I;for(let q=1;q<=F;++q)U+=R*d[q-1]*u[F-q],R+=e}u[F]=f*M+U/I;let O=u[F]*C;if(A+=O,A<=0)throw new Error("bgrat: expansion can not be computed.");if(Math.abs(O)<=o*(A+y))break}return a+=b?Math.exp(p+Math.log(A)):_*A,a}function wf(l,e,t,s){const a=1.772453850905516;if(l*e==0)return e<=l?Math.exp(-t):0;if(l==.5){if(e<.25)return(.5-df(Math.sqrt(e))+.5)*Math.exp(-t);{let o=Math.sqrt(e);return $o(1,o)/o*a}}else if(e<1.1){let o=3,c=e,d=e/(l+3),u=s*.1/(l+1),f;for(o+=1,c*=-(e/o),f=c/(l+o),d+=f;Math.abs(f)>u;)o+=1,c*=-(e/o),f=c/(l+o),d+=f;let v=l*e*((d/6-.5/(l+2))*e+1/(l+1)),m=l*Math.log(e),g=ht(l),h=g+1;if(e>=.25&&l<e/2.59||m>-.13394){let p=vf(m),_=((p+.5+.5)*v-p)*h-g;return _<=0?0:_*Math.exp(-t)}else return(.5-Math.exp(m)*h*(.5-v+.5)+.5)*Math.exp(-t)}else{let o=1,c=1,d=e,u=e+(1-l),f=1,v,m;o=e*c+f*o,d=e*u+f*d,v=o/d,f+=1;let g=f-l;for(c=o+g*c,u=d+g*u,m=c/u;Math.abs(m-v)>=s*m;)o=e*c+f*o,d=e*u+f*d,v=o/d,f+=1,g=f-l,c=o+g*c,u=d+g*u,m=c/u;return m}}function yf(l,e,t,s){const o=1.12837916709551,c=.353553390593274,d=Array(21),u=Array(21),f=Array(21),v=Array(21);let m=l*Fn(-t/l)+e*Fn(t/e),g;if(g=Math.exp(-m),g==0)return 0;let h=Math.sqrt(m),p=h/c*.5,_=m+m,b,y,S,E;l<e?(b=l/e,y=1/(b+1),S=(e-l)/e,E=1/Math.sqrt(l*(b+1))):(b=e/l,y=1/(b+1),S=(e-l)/l,E=1/Math.sqrt(e*(b+1))),d[0]=S*.6666666666666666,f[0]=d[0]*-.5,v[0]=-f[0];let k=.5/o*$o(1,h),C=c,A=k+v[0]*E*C,P=1,M=b*b,N=1,I=E,L=p,F=_;for(let O=2;O<=20;O+=2){N*=M,d[O-1]=y*2*(b*N+1)/(O+2);let R=O+1;P+=N,d[R-1]=S*2*P/(O+3);for(let D=O;D<=R;++D){let K=(D+1)*-.5;u[0]=K*d[0];for(let G=2;G<=D;++G){let $=0;for(let ne=1;ne<=G-1;++ne){let ee=G-ne;$+=(ne*K-ee)*d[ne-1]*u[ee-1]}u[G-1]=K*d[G-1]+$/G}f[D-1]=u[D-1]/(D+1);let Z=0;for(let G=1;G<=D-1;++G)Z+=v[D-G-1]*f[G-1];v[D-1]=-(Z+f[D-1])}k=c*L+(O-1)*k,C=c*F+O*C,L=_*L,F=_*F,I*=E;let q=v[O-1]*I*k;I*=E;let W=v[R-1]*I*C;if(A+=q+W,Math.abs(q)+Math.abs(W)<=s*A)break}let U=Math.exp(-Xl(l,e));return o*g*U*A}function xf(l,e,t,s){let o=0,c=0;function d(b,y,S,E){const k=Zs(b,y,S,1e-15);return E?.5-k+.5:k}function u(b,y,S,E){const k=Zs(y,b,S,1e-15);return E?k:.5-k+.5}function f(b,y,S,E,k,C){const A=pf(b,y,S,E,k,15000000000000002e-30);return C?.5-A+.5:A}function v(b,y,S,E,k){let C=Math.round(y);y=y-C,y===0&&(C=C-1,y=1);let A=Kl(y,b,E,S,C,1e-15);return S<=.7?(A=A+Zs(b,y,S,1e-15),k?.5-A+.5:A):(b<=15&&(C=20,A=A+Kl(b,y,S,E,C,1e-15),b=b+C),A=$s(b,y,S,E,A,15*1e-15),k?.5-A+.5:A)}if(l<1e-15*.001&&e<1e-15*.001)return e/(l+e);let m,g,h,p,_;if(l<=1||e<=1){if(t>.5?(_=!0,m=e,h=s,g=l,p=t):(_=!1,m=l,h=t,g=e,p=s),g<Math.min(1e-15,1e-15*m))return o=hf(m,g,h,1e-15),_?.5-o+.5:o;if(m<Math.min(1e-15,1e-15*g)&&g*h<=1)return c=gf(m,g,h,1e-15),_?c:.5-c+.5;if(Math.max(m,g)>1){if(g<=1)return d(m,g,h,_);if(h>=.29)return u(m,g,p,_);if(h<.1&&Math.pow(h*g,m)<=.7)return d(m,g,h,_)}else{if(m>=Math.min(.2,g)||Math.pow(h,m)<=.9)return d(m,g,h,_);if(h>=.3)return u(m,g,p,_)}let b=!1;return Math.max(m,g)>1&&g>15?c=0:(b=!0,c=Kl(g,m,p,h,20,1e-15),g+=20),c=$s(g,m,p,h,c,15*1e-15),c==0||0<c&&c<Number.MIN_VALUE?(b?c=Kl(g-n,m,p,h,n,1e-15):c=Number.NEGATIVE_INFINITY,c=$s(g,m,p,h,c,15*1e-15),o=-expm1(c),_?.5-o+.5:o):(o=.5-c+.5,_?.5-o+.5:o)}else{let b=Number.isFinite(l+e)?l>e?(l+e)*s-e:l-(l+e)*t:l*s-e*t;const y=b<0;let S,E,k,C;if(y?(b=-b,S=e,k=s,E=l,C=t):(S=l,k=t,E=e,C=s),E<40)return E*k<=.7?d(S,E,k,y):v(S,E,k,C,y);if(S>E){if(E<=100||b>E*.03)return f(S,E,k,C,b,y)}else{if(S<=100)return f(S,E,k,C,b,y);if(b>S*.03)return f(S,E,k,C,b,y)}return o=yf(S,E,b,1e-15*100),y?.5-o+.5:o}}function ni(l){const e=l.nrows,t=l.ncols;if(e<t){const c=ni(l.subset([],Tt.seq(1,e)));return{Q:c.Q,R:Ef(c.Q,l)}}let s=Lt.eye(e),a=l.t();for(let c=1;c<=t;c++)for(let d=e;d>=c+1;d--){const u=a.v.subarray((d-2)*t,d*t),f=s.v.subarray((d-2)*e,d*e),v=u.slice(),m=f.slice(),[g,h,p]=kf(v[c-1],v[c-1+t]);for(let _=0;_<t;_++)u[_]=v[_]*g+v[_+t]*h,u[_+t]=v[_]*-h+v[_+t]*g,f[_]=m[_]*g+m[_+e]*h,f[_+e]=m[_]*-h+m[_+e]*g;for(let _=t;_<e;_++)f[_]=m[_]*g+m[_+e]*h,f[_+e]=m[_]*-h+m[_+e]*g}const o=Tt.seq(1,t);return{Q:e===t?s:s.subset([],o),R:e===t?a.t():a.subset([],o).t()}}function kf(l,e){if(l==0)return[0,1,e];if(Math.abs(l)>Math.abs(e)){const o=e/l,c=Math.sqrt(1+o*o),d=1/c;return[d,o*d,l*c]}const t=l/e,s=Math.sqrt(1+t*t),a=1/s;return[t*a,a,e*s]}function li(l){return typeof l=="number"}function si(l,e){e===void 0&&(e=l);const t=l.nrows,s=l.ncols,a=e.nrows;e.ncols;const o=t,c=a,d=s,u=new Float64Array(o*c);for(let f=0;f<d;f++){const v=l.v.subarray(f*t,(f+1)*t),m=e.v.subarray(f*a,(f+1)*a);for(let g=0;g<c;g++){const h=u.subarray(g*o,(g+1)*o);for(let p=0;p<o;p++)h[p]+=v[p]*m[g]}}return new Lt(u,o,c)}function Ef(l,e){if(e===void 0&&(e=l),!mr(l)||!mr(e))throw Error("crossprod: both X and Y must be instance of Matrix class.");const t=l.nrows,s=l.ncols,a=e.nrows,o=e.ncols,c=s,d=o,u=t,f=new Float64Array(c*d);for(let v=0;v<d;v++){const m=e.v.subarray(v*a,(v+1)*a),g=f.subarray(v*c,(v+1)*c);for(let h=0;h<c;h++){const p=l.v.subarray(h*t,(h+1)*t);let _=0;for(let b=0;b<u;b++)_+=p[b]*m[b];g[h]=_}}return new Lt(f,c,d)}function ai(l,e,t){if(t===void 0){if(e!==l.v.length)throw Error("reshape: provided dimension does not match number of values in the object.");return new ze(l.v)}if(l.v.length!==e*t)throw Error("reshape: provided dimension does not match number of values in the object.");return new Lt(l.v,e,t)}function mr(l){return l&&l.constructor===Lt}function Cf(l,e,t){return new Lt(new Float64Array(l),e,t)}const Ye=class Ye{constructor(e,t,s){if(!ArrayBuffer.isView(e)||e.constructor!==Ye.valuesConstructor)throw Error('Matrix: parameter "values" must be Float64Array.');if(t===0||s===0)throw Error("Matrix: can not create matrix with zero rows or columns.");if(e.length!==t*s)throw Error('Matrix: number elements in "values" is not equal to "nrows" x "ncols".');this.v=e,this.nrows=t,this.ncols=s}inv(){if(this.nrows!==this.ncols)throw Error("inv: only squared matrices can be inverted.");const e=this.ncols;if(this.isuppertriangular()){if(this.islowertriangular())return Ye.diagm(this.diag().apply(u=>Math.abs(u)>Number.EPSILON?1/u:x));const s=Ye.eye(e),a=Ye.eye(e),o=this.t(),c=o.v[(e-1)*e+(e-1)],d=e-1;for(let u=0;u<e;u++)a.v[d*e+u]=s.v[d*e+u]/c;for(let u=e-2;u>=0;u--){let f=s.getcolumn(u+1);const v=o.getcolref(u+1);for(let m=u+1;m<e;m++){const g=a.getcolumn(m+1);f=f.subtract(g.mult(v[m]))}a.v.set(f.divide(v[u]).v,u*e)}return a.t()}if(this.islowertriangular()){const s=this.diag();if(Ho(s)<Number.EPSILON)throw Error("inv: the matrix is not invertible.");const a=Ye.eye(e),o=Ye.eye(e),c=this.t(),d=0,u=c.v[0];for(let f=0;f<e;f++)o.v[d*e+f]=a.v[d*e+f]/u;for(let f=1;f<e;f++){let v=a.getcolumn(f+1);const m=c.getcolref(f+1);for(let g=0;g<f;g++){const h=o.getcolumn(g+1);v=v.subtract(h.mult(m[g]))}o.v.set(v.divide(m[f]).v,f*e)}return o.t()}const t=ni(this);if(!t.R.isuppertriangular())throw Error("inv: QR decomposition of the matrix returned incorrect result.");return t.R.inv().dot(t.Q.t())}islowertriangular(){if(this.nrows!==this.ncols)return!1;for(let e=1;e<this.ncols;e++)for(let t=0;t<e;t++)if(Math.abs(this.v[e*this.nrows+t])>Ye.TOLERANCE)return!1;return!0}isuppertriangular(){if(this.nrows!==this.ncols)return!1;for(let e=0;e<this.ncols;e++)for(let t=e+1;t<this.nrows;t++)if(Math.abs(this.v[e*this.nrows+t])>Ye.TOLERANCE)return!1;return!0}diag(){const e=Math.min(this.nrows,this.ncols),t=new Float64Array(e);for(let s=0;s<e;s++)t[s]=this.getcolref(s+1)[s];return new ze(t)}t(){const e=this.nrows,t=this.ncols,s=new Ye.valuesConstructor(this.v.length);if(this.ncols<this.nrows){for(let a=0;a<this.ncols;a++){const o=this.v.subarray(a*this.nrows,(a+1)*this.nrows);for(let c=0;c<this.nrows;c++)s[c*t+a]=o[c]}return new Ye(s,t,e)}for(let a=0;a<this.nrows;a++){const o=s.subarray(a*t,(a+1)*t);for(let c=0;c<this.ncols;c++)o[c]=this.v[c*this.nrows+a]}return new Ye(s,t,e)}dot(e){if(Je(e))return new Ye(ra(this.v,e.v,this.nrows,this.ncols,e.length,1),this.nrows,1);if(mr(e))return new Ye(ra(this.v,e.v,this.nrows,this.ncols,e.nrows,e.ncols),this.nrows,e.ncols);throw Error("dot: argument 'X' must be a matrix or a vector.")}op(e,t,s){if(mr(e))return new Ye(ea(this.v,e.v,t),this.nrows,this.ncols);if(li(e))return new Ye(ta(this.v,e,t),this.nrows,this.ncols);if(!Je(e))throw new Error('op: argument "x" must be a matrix, a vector or a number.');if(s===void 0&&(s=e.length===this.ncols?2:1),s===2&&e.length===this.ncols){const a=new Ye.valuesConstructor(this.v.length);for(let o=0;o<this.ncols;o++)a.set(ta(this.getcolref(o+1),e.v[o],t),o*this.nrows);return new Ye(a,this.nrows,this.ncols)}if(s===1&&e.length===this.nrows){const a=new Ye.valuesConstructor(this.v.length);for(let o=0;o<this.ncols;o++)a.set(ea(this.getcolref(o+1),e.v,t),o*this.nrows);return new Ye(a,this.nrows,this.ncols)}throw new Error('op: length of vector "X" does not match number of rows nor number of columns of the maytrix.')}add(e){return this.op(e,(t,s)=>t+s)}subtract(e){return this.op(e,(t,s)=>t-s)}mult(e){return this.op(e,(t,s)=>t*s)}divide(e){return this.op(e,(t,s)=>t/s)}apply(e,t){if(t===void 0&&(t=2),t==2){const s=this.ncols,a=new Ye.valuesConstructor(s);for(let o=0;o<s;o++)a[o]=e(this.getcolref(o+1));return new ze(a)}if(t==1)return this.t().apply(e,2);if(t==0){const s=this.v.length,a=new Ye.valuesConstructor(s);for(let o=0;o<s;o++)a[o]=e(this.v[o]);return new Ye(a,this.nrows,this.ncols)}}replace(e,t,s){typeof t=="number"&&(t=[t]),t.length===0&&(t=Tt.seq(1,this.nrows)),hr(t)||(t=gr(t)),typeof s=="number"&&(s=[s]),s.length===0&&(s=Tt.seq(1,this.ncols)),hr(s)||(s=gr(s));const a=t.length,o=s.length;if(qn(t)<1||$t(t)>this.nrows)throw Error("Matrix.replace: row indices do not match the dimension of matrix.");if(qn(s)<1||$t(s)>this.ncols)throw Error("Matrix.replace: column indices do not match the dimension of matrix.");if(e.nrows!==a||e.ncols!==o)throw Error('Matrix.replace: dimension of "X" does not match the indices.');for(let c=0;c<s.length;c++){const d=e.getcolref(c+1),u=(s.v[c]-1)*this.nrows;for(let f=0;f<t.length;f++){const v=t.v[f];this.v[u+v-1]=d[f]}}return this}copy(){return new Ye(this.v.slice(),this.nrows,this.ncols)}getrow(e){if(e<1||e>this.nrows)throw Error("getrow: wrong row index.");const t=new ze.valuesConstructor(this.ncols);for(let s=0;s<this.ncols;s++)t[s]=this.getcolref(s+1)[e-1];return new ze(t)}getcolumn(e){if(e<1||e>this.ncols)throw Error("getcolumn: wrong column index.");return new ze(this.v.slice((e-1)*this.nrows,e*this.nrows))}getcolref(e){return this.v.subarray((e-1)*this.nrows,e*this.nrows)}subset(e,t){if(typeof e=="number"&&(e=gr([e])),typeof t=="number"&&(t=gr([t])),Array.isArray(e)&&(e=e.length===0?null:gr(e)),Array.isArray(t)&&(t=t.length===0?null:gr(t)),e!==null&&!hr(e))throw Error('subset: parameter "rind" can be a number, null or instance of Index.');if(t!==null&&!hr(t))throw Error('subset: parameter "cind" can be a number, null or instance of Index.');if(e!==null&&(qn(e)<1||$t(e)>this.nrows))throw Error('subset: parameter "rind" does not match size of the matrix.');if(t!==null&&(qn(t)<1||$t(t)>this.ncols))throw Error('subset: parameter "cind" does not match size of the matrix.');if(e===null){const d=t.length,u=this.nrows,f=new Ye.valuesConstructor(u*d);for(let v=0;v<t.length;v++)f.set(this.v.slice((t.v[v]-1)*this.nrows,t.v[v]*this.nrows),v*this.nrows);return new Ye(f,u,d)}if(t==null)return this.t().subset(t,e).t();const s=e.length,a=t.length,o=new Ye.valuesConstructor(s*a);let c=new Ye.valuesConstructor(s);for(let d=0;d<a;d++){const u=this.v.subarray((t.v[d]-1)*this.nrows,t.v[d]*this.nrows);for(let f=0;f<s;f++)c[f]=u[e.v[f]-1];o.set(c,d*s)}return new Ye(o,s,a)}toString(e){function t(c,d){return" ".repeat(d-c.length)+c}e===void 0&&(e=2),this.ncols;const s=Math.round(Math.abs(Math.log10($t(this.v))))+e+3;let a="";const o=this.t();for(let c=1;c<=o.ncols;c++)a+=Array.from(o.getcolref(c)).map(d=>t(d.toFixed(e),s)).join(" ")+`
`;return a}toCSV(e,t,s,a){e===void 0&&(e=","),t===void 0&&(t=e===";"?",":".");const o=a!=null&&a.length>0,c=s!=null&&s.length>0;if(o&&a.length!==this.nrows)throw Error("Matrix.toCSV: number of elements in labels array must match number of rows in the matrix.");if(c&&s.length!==this.ncols+(o?1:0))throw Error("Matrix.toCSV: number of elements in header must match number of columns in the matrix.");const d=this.t();let u=c?s.join(e)+`
`:"";for(let f=1;f<=d.ncols;f++)u=u+(o?a[f-1]+e:"")+d.getcolref(f).join(e)+`
`;return u=u.replace(/\./g,t),u}static randn(e,t,s,a){return ai(Qo(e*t,s,a),e,t)}static rand(e,t,s,a){return ai(Jo(e*t,s,a),e,t)}static eye(e,t){t===void 0&&(t=e);const s=new Float64Array(e*t);for(let a=0;a<Math.min(e,t);a++)s[a*e+a]=1;return new Ye(s,e,t)}static diagm(e){if(!Je(e))throw Error('diagm: the argument "x" must be a Vector.');const t=e.length,s=new Float64Array(t*t);for(let a=0;a<t;a++)s[a*t+a]=e.v[a];return new Ye(s,t,t)}static zeros(e,t){return t===void 0&&(t=e),new Ye(new Float64Array(e*t),e,t)}static ones(e,t){return Ye.fill(1,e,t)}static fill(e,t,s){s===void 0&&(s=t);const a=new Float64Array(t*s);for(let o=0;o<a.length;o++)a[o]=e;return new Ye(a,t,s)}static outer(e,t,s){if(Array.isArray(e)&&(e=ct(e)),Array.isArray(t)&&(t=ct(t)),!Je(e))throw Error('Matrix.outer: parameter "x" must be a vector or an array with numbers.');if(!Je(t))throw Error('Matrix.outer: parameter "y" must be a vector or an array with numbers.');const a=Ye.zeros(e.length,t.length);for(let o=0;o<t.length;o++){const c=t.v[o],d=a.getcolref(o+1);for(let u=0;u<e.length;u++)d[u]=s(e.v[u],c)}return a}static parseCSV(e,t,s,a){function o(b){return b.some(y=>Number.isNaN(Number.parseFloat(y.trim())))}t===void 0&&(t=",");const c=t===";"?",":".";e=e.replace(/^\uFEFF/gm,"").replace(/^\u00EF?\u00BB\u00BF/gm,""),e=e.replace(/\r/gm,"");let d=e.split(/\n/),u=[],f=0;const v=d[0].split(t);(s||s===void 0&&o(v))&&(u=v,f=1),d=d.filter(b=>b.trim().length>1);let m=[],g=0;a&&(g=1);const h=d.length-f,p=v.length-g;if(h<1)throw Error("Data file should contain at least 1 row with values.");if(p<1)throw Error("Data file should contain at least 1 column with values.");const _=Ye.zeros(p,h);for(let b=f;b<h+f;b++){const y=d[b].split(t);let S;if(a?(m[b-f]=y[0],S=y.slice(1).map(E=>Number.parseFloat(E.trim().replace(c,".")))):S=y.map(E=>Number.parseFloat(E.trim().replace(c,"."))),S.some(E=>Number.isNaN(E)))throw Error("Some of the values can not be converted to numbers, check your CSV file and try again.");if(S.length!=p)throw Error("Wrong number of values in row #"+b);_.v.set(new Float64Array(S),(b-f)*p)}return{values:_.t(),header:u,labels:m,sep:t,dec:c}}};yr(Ye,"valuesConstructor",Float64Array),yr(Ye,"TOLERANCE",Math.pow(10,-9));let Lt=Ye;function Je(l){return l&&l.constructor===ze}function ct(l){return new ze(new Float64Array(l))}const gt=class gt{constructor(e){if(!ArrayBuffer.isView(e)||e.constructor!==Float64Array)throw Error('Vector: parameter "values" must be Float64Array.');this.v=e,this.length=e.length}which(e){const t=new Tt.valuesConstructor(this.length);let s=0;for(let a=0;a<this.length;a++)e(this.v[a],a)&&(t[s]=a+1,s=s+1);return new Tt(t.subarray(0,s))}filter(e){const t=new gt.valuesConstructor(this.length);let s=0;for(let a=0;a<this.length;a++)e(this.v[a],a)&&(t[s]=this.v[a],s=s+1);return new gt(t.subarray(0,s))}shuffle(){return new gt(ui(this.v))}sort(e){return new gt(fi(this.v,e))}sortind(e){return new Tt(di(this.v,e))}rep(e){return ii(this,e)}repeach(e){return ci(this,e)}replace(e,t){typeof t=="number"&&(t=[t]),t.length===0&&(t=Tt.seq(1,this.length)),hr(t)||(t=gr(t));const s=t.length;if(qn(t)<1||$t(t)>this.length)throw Error("Vector.replace: indices do not match the lenght of the vector.");if(e.length!==s)throw Error('Vector.replace: length of "x" does not match the indices.');for(let a=0;a<t.length;a++){const o=t.v[a];this.v[o-1]=e.v[a]}return this}subset(e){if(typeof e=="number"&&(e=gr([e])),Array.isArray(e)&&(e=typeof e[0]=="boolean"?Tt.bool2ind(e):gr(e)),!hr(e))throw Error('subset: parameter "ind" must be number, array of instance of class Index.');const t=e.length,s=gt.zeros(t);for(let a=0;a<t;a++){if(e.v[a]<1)throw Error("subset: indices must start with 1 (not 0).");if(e.v[a]>this.length)throw Error("subset: index exceeds the length of the vector.");s.v[a]=this.v[e.v[a]-1]}return s}slice(e,t){if(e===null&&(e=1),t==null&&(t=this.length),e<1)throw Error("slice: indices must start with 1 (not 0).");if(t>this.length)throw Error("slice: index exceeds the length of the vector.");if(t<e)throw Error('slice: "end" must not be smaller than "start".');return new gt(this.v.slice(e-1,t))}copy(){return new gt(this.v.slice())}dot(e){return e===void 0&&(e=this),ra(this.v,e.v,1,this.length,e.length,1)[0]}op(e,t){if(Je(e))return new gt(ea(this.v,e.v,t));if(li(e))return new gt(ta(this.v,e,t));throw new Error('op: argument "x" must be a vector or a number.')}add(e){return this.op(e,(t,s)=>t+s)}subtract(e){return this.op(e,(t,s)=>t-s)}mult(e){return this.op(e,(t,s)=>t*s)}divide(e){return this.op(e,(t,s)=>t/s)}apply(e){const t=this.v.length,s=gt.zeros(t);for(let a=0;a<t;a++)s.v[a]=e(this.v[a]);return s}static c(...e){if(e.length===1)return e[0];const t=e.reduce((o,c)=>o+(typeof c=="number"?1:c.length),0),s=new gt.valuesConstructor(t);let a=0;for(const o of e)typeof o=="number"?(s[a]=o,a+=1):(s.set(Je(o)?o.v:new gt.valuesConstructor(o),a),a+=typeof o=="number"?1:o.length);return new gt(s)}static seq(e,t,s){return oi(e,t,s,gt)}static randn(e,t,s){return Qo(e,t,s)}static rand(e,t,s){return Jo(e,t,s)}static zeros(e){return new gt(new gt.valuesConstructor(e))}static ones(e){return gt.fill(1,e)}static fill(e,t){const s=new gt.valuesConstructor(t);for(let a=0;a<s.length;a++)s[a]=e;return new gt(s)}};yr(gt,"valuesConstructor",Float64Array);let ze=gt;function hr(l){return l.constructor===Tt}function gr(l){return new Tt(new Int32Array(l))}const Nt=class Nt{constructor(e){if(!ArrayBuffer.isView(e)||e.constructor!==Int32Array)throw Error('Index: parameter "values" must be Int32Array.');this.v=e,this.length=e.length}which(e){const t=new Nt.valuesConstructor(this.length);let s=0;for(let a=0;a<this.length;a++)e(this.v[a],a)&&(t[s]=a+1,s=s+1);return new Nt(t.subarray(0,s))}filter(e){const t=new Nt.valuesConstructor(this.length);let s=0;for(let a=0;a<this.length;a++)e(this.v[a],a)&&(t[s]=this.v[a],s=s+1);return new Nt(t.subarray(0,s))}shuffle(){return new Nt(ui(this.v))}sort(e){return new Nt(fi(this.v,e))}sortind(e){return new Nt(di(this.v,e))}rep(e){return ii(this,e)}repeach(e){return ci(this,e)}subset(e){if(typeof e=="number"&&(e=gr([e])),Array.isArray(e)&&(e=gr(e)),!hr(e))throw Error('subset: parameter "ind" must be number, array of instance of class Index.');const t=e.length,s=new Nt.valuesConstructor(t);for(let a=0;a<t;a++){if(e.v[a]<1)throw Error("subset: indices must start with 1 (not 0).");if(e.v[a]>this.length)throw Error("subset: index exceeds the length of the vector.");s[a]=this.v[e.v[a]-1]}return new Nt(s)}slice(e,t){if(e===null&&(e=1),t==null&&(t=this.length),e<1)throw Error("slice: indices must start with 1 (not 0).");if(t>this.length)throw Error("slice: index exceeds the length of the vector.");if(t<e)throw Error('slice: "end" must not be smaller than "start".');return new Nt(this.v.slice(e-1,t))}static seq(e,t,s){return oi(e,t,s,Nt)}static ones(e){return Nt.fill(1,e)}static fill(e,t){const s=new Nt.valuesConstructor(t);for(let a=0;a<s.length;a++)s[a]=e;return new Nt(s)}static bool2ind(e){let t=0;const s=new Nt.valuesConstructor(e.length);for(let a=0;a<e.length;a++)e[a]&&(s[t]=a+1,t=t+1);return new Nt(s.subarray(0,t))}};yr(Nt,"valuesConstructor",Int32Array);let Tt=Nt;function oi(l,e,t,s){t===void 0&&(t=l<=e?1:-1);const a=Math.floor((e-l)/t)+1;if(a<1)throw Error("seq: wrong combination of parameters.");const o=new s.valuesConstructor(a);for(let c=0;c<a;c++)o[c]=l+c*t;return new s(o)}function ii(l,e){const t=l.length*e,s=new l.constructor.valuesConstructor(t);for(let a=1;a<=e;a++)for(let o=0;o<l.length;o++)s[(a-1)*l.length+o]=l.v[o];return new l.constructor(s)}function ci(l,e){if(e<1||Math.round(e)!==e)throw Error('rep: parameter "n" must be an integer number > 1.');const t=l.length*e,s=new l.constructor.valuesConstructor(t);for(let a=0;a<l.length;a++)for(let o=0;o<e;o++)s[a*e+o]=l.v[a];return new l.constructor(s)}function ea(l,e,t){if(l.length!==e.length)throw new Error("_opvv: arrays sizes do not match.");if(l.constructor!==e.constructor)throw new Error("_opvv: array types do not match.");const s=new l.constructor(l.length);for(let a=0;a<l.length;a++)s[a]=t(l[a],e[a]);return s}function ta(l,e,t){const s=new l.constructor(l.length);for(let a=0;a<l.length;a++)s[a]=t(l[a],e);return s}function ra(l,e,t,s,a,o){if(s!==a)throw Error("_dot: matrix dimensions do not much.");const c=t,d=o,u=s,f=new l.constructor(c*d);for(let v=0;v<d;v++){const m=e.subarray(v*a,(v+1)*a),g=f.subarray(v*c,(v+1)*c);for(let h=0;h<u;h++){const p=m[h],_=l.subarray(h*t,(h+1)*t);for(let b=0;b<c;b++)g[b]+=_[b]*p}}return f}function ui(l){let e=l.slice(),t=e.length,s,a;for(;t;)a=Math.floor(Math.random()*t--),s=e[t],e[t]=e[a],e[a]=s;return e}function fi(l,e=!1){return e?l.slice().sort((t,s)=>s-t):l.slice().sort((t,s)=>t-s)}function di(l,e=!1){const t=Tt.seq(1,l.length).v;return e?t.sort((s,a)=>l[a-1]-l[s-1]):t.sort((s,a)=>l[s-1]-l[a-1])}function Sf(l,e,t){return 5*l*e+e+4*t*e+l*t}function Af(l,e){return 2+2*l+l*e+17*e}function nt(l,e,t){if(!l||!l.class||!l.class.includes("pcamodel"))throw new Error('pcamodel_get: parameter "m" must be JSON with PCA model.');const s=l.ncols,a=l.ncomp;let o,c;switch(e){case"mX":o=2,c=s;break;case"sX":o=2+s,c=s;break;case"loadings":case"xloadings":o=2+2*s+(t-1)*s,c=s;break;case"P":o=2+2*s,c=a*s;break;case"eigenvals":case"xeigenvals":o=2+2*s+s*a,c=a;break;case"cq0":o=2+2*s+s*a+a,c=a;break;case"cNq":o=2+2*s+s*a+2*a,c=a;break;case"rq0":o=2+2*s+s*a+3*a,c=a;break;case"rNq":o=2+2*s+s*a+4*a,c=a;break;case"ch0":o=2+2*s+s*a+5*a,c=a;break;case"cNh":o=2+2*s+s*a+6*a,c=a;break;case"rh0":o=2+2*s+s*a+7*a,c=a;break;case"rNh":o=2+2*s+s*a+8*a,c=a;break;case"cr0":o=2+2*s+s*a+9*a,c=a;break;case"cNr":o=2+2*s+s*a+10*a,c=a;break;case"rr0":o=2+2*s+s*a+11*a,c=a;break;case"rNr":o=2+2*s+s*a+12*a,c=a;break;case"cg0":o=2+2*s+s*a+13*a,c=a;break;case"cNg":o=2+2*s+s*a+14*a,c=a;break;case"rg0":o=2+2*s+s*a+15*a,c=a;break;case"rNg":o=2+2*s+s*a+16*a,c=a;break;default:throw Error("pcamodel_get: wrong outcome name.")}return l.v.subarray(o,o+c)}function er(l,e,t){if(!l||!l.class||!l.class.includes("pcares"))throw new Error('pcares_get: parameter "r" must be JSON with PCA results.');const s=l.ncols,a=l.nrows,o=l.ncomp;let c,d;switch(e){case"scores":case"xscores":c=(t-1)*a,d=a;break;case"T":c=0,d=a*o;break;case"hdist":c=a*o+(t-1)*a,d=a;break;case"qdist":c=2*a*o+(t-1)*a,d=a;break;case"xcumexpvar":case"cumexpvar":c=3*a*o,d=o;break;case"fdistc":c=3*a*o+o+(t-1)*a,d=a;break;case"fdistr":c=4*a*o+o+(t-1)*a,d=a;break;case"gdist":c=5*a*o+o+(t-1)*s,d=s;break;case"rdist":c=5*a*o+o+s*o+(t-1)*s,d=s;break;case"idistc":c=5*a*o+o+2*s*o+(t-1)*s,d=s;break;case"idistr":c=5*a*o+o+3*s*o+(t-1)*s,d=s;break;case"E":c=5*a*o+o+3*s*o+o*s,d=a*s;break;default:throw new Error("pcares_get: wrong outcome name.")}return l.v.subarray(c,c+d)}function Jl(l,e,t){if(!Array.isArray(l))return!1;if(l.length===0)return!0;for(let s=0;s<l.length;s++){const a=l[s];if(a<e||a>t)return!1}return!0}function Nf(l,e,t,s,a,o,c){if(!mr(e))throw new Error("pca_fit: X must be a matrix.");o||(o=[]);const d=o&&Array.isArray(o)?o.length:0;if(!Jl(o,0,e.nrows-1))throw new Error('pca_fit: some indices in "outliers" array are outside the expected range.');c||(c=[]);const u=c&&Array.isArray(c)?c.length:0;if(!Jl(c,0,e.ncols-1))throw new Error('pca_fit: some indices in "exclvars" array are outside the expected range.');const f=e.nrows-d,v=e.ncols-u;if(f<3||v<2)throw new Error("pca_fit: X must have at least 3 rows and 2 columns.");if(s===void 0&&(s=!0),a===void 0&&(a=!1),t===void 0&&(t=Math.min(f-1,v)),t<1||t>Math.min(f-1,v))throw new Error('pca_fit: the value of "ncomp" does not match the dimension of X.');const m=l._malloc(e.v.length*e.v.BYTES_PER_ELEMENT);l.HEAPF64.set(e.v,m/e.v.BYTES_PER_ELEMENT);let g=null;if(d>0){const E=new Int32Array(o);g=l._malloc(E.length*E.BYTES_PER_ELEMENT),l.HEAP32.set(E,g/E.BYTES_PER_ELEMENT)}let h=null;if(u>0){const E=new Int32Array(c);h=l._malloc(E.length*E.BYTES_PER_ELEMENT),l.HEAP32.set(E,h/E.BYTES_PER_ELEMENT)}const p=Af(v,t),_=Float64Array,b=l._malloc(p*_.BYTES_PER_ELEMENT);if(l.ccall("pcafit_wasm",["number"],["number","number","number","number","number","number","number","number","number","number","number"],[m,e.nrows,e.ncols,t,s,a,b,g,d,h,u])!==1)throw new Error("pca_fit: PCA failed.");const S=l.HEAPF64.slice(b/_.BYTES_PER_ELEMENT,b/_.BYTES_PER_ELEMENT+p);return l._free(m),l._free(b),g&&l._free(g),h&&l._free(h),{class:["pcamodel"],v:S,ncomp:t,nrows:f,ncols:v,exclvars:c,center:s,scale:a}}function Mf(l,e,t,s){if(!e||!e.class||!e.class.includes("pcamodel"))throw new Error('pca_predict: parameter "m" must be JSON with PCA model.');if(!mr(t))throw new Error("pca_predict: X must be a matrix.");s||(s=[]);const a=s&&Array.isArray(s)?s.length:0;if(!Jl(s,0,t.nrows-1))throw new Error('pca_predict: some indices in "outliers" array are outside the expected range.');const o=t.nrows-a;let c=e.exclvars;t.ncols===e.ncols&&(c=[]);const d=c.length,u=t.ncols-d;if(o<1)throw new Error("pca_predict: X must have at least 1 row.");if(u!==e.ncols)throw new Error("pca_predict: X must have the same number of columns (without excluded ones) as the training set.");const f=l._malloc(t.v.length*t.v.BYTES_PER_ELEMENT);l.HEAPF64.set(t.v,f/t.v.BYTES_PER_ELEMENT);let v=null;if(a>0){const N=new Int32Array(s);v=l._malloc(N.length*N.BYTES_PER_ELEMENT),l.HEAP32.set(N,v/N.BYTES_PER_ELEMENT)}let m=null;if(d>0){const N=new Int32Array(c);m=l._malloc(N.length*N.BYTES_PER_ELEMENT),l.HEAP32.set(N,m/N.BYTES_PER_ELEMENT)}const g=l._malloc(e.v.length*e.v.BYTES_PER_ELEMENT);l.HEAPF64.set(e.v,g/e.v.BYTES_PER_ELEMENT);const h=Sf(o,e.ncomp,u),p=Float64Array,_=l._malloc(h*p.BYTES_PER_ELEMENT);if(l.ccall("pcapredict_wasm",["number"],["number","number","number","number","number","number","number","number","number"],[f,t.nrows,t.ncols,g,_,v,a,m,d])!==1)throw new Error("pca_predict: PCA prediction failed.");const y=l.HEAPF64.slice(_/p.BYTES_PER_ELEMENT,_/p.BYTES_PER_ELEMENT+h);l._free(f),l._free(g),l._free(_),v&&l._free(v),m&&l._free(m);const S={class:["pcares"],v:y,ncomp:e.ncomp,nrows:o,ncols:u,npred:u,outliers:s,exclvars:e.exclvars,center:e.center,scale:e.scale},E=new Array(e.ncomp),k=new Array(e.ncomp),C=new Array(e.ncomp),A=new Array(e.ncomp),P=new Array(e.ncomp),M=er(S,"xcumexpvar");P[0]=1,A[0]=M[0],C[0]=1-M[0],E[0]=M[0],k[0]=1-M[0];for(let N=1;N<e.ncomp;N++)P[N]=N+1,A[N]=M[N],C[N]=1-M[N],E[N]=M[N]-M[N-1],k[N]=1-E[N];return S.stat={components:P,resvar:k,expvar:E,cumexpvar:A,cumresvar:C},S}function Tf(l,e,t,s,a,o,c,d){if(!e||!e.class||!e.class.includes("pcamodel"))throw new Error('pcapcv: parameter "m" must be JSON with PCA results.');if(!mr(t))throw new Error("pcapcv: X must be a matrix.");d||(d=[]);const u=d&&Array.isArray(d)?d.length:0;if(!Jl(d,0,t.nrows-1))throw new Error('pca_predict: some indices in "outliers" array are outside the expected range.');const f=e.exclvars.length,v=t.nrows-u,m=t.ncols-f;if(v<3)throw new Error("pcapcv: X must have at least 3 rows.");if(m!==e.ncols)throw new Error("pcapcv: X must have the same number of columns as the training set.");if(!Number.isInteger(o)||![0,1,2].includes(o))throw new Error('pcapcv: parameter "cv_type" must be one of 0 ("loo"), 1 ("ven"), 2 ("rand).');if(!Number.isInteger(c)||![0,1].includes(c))throw new Error('pcapcv: parameter "cv_scope" must be 0 ("global") or 1 ("local").');if(o>0&&(!Number.isInteger(a)||a<2))throw new Error('pcapcv: parameter "cv_nseg" must be a number ≥ 2.');if(o>0&&a>v)throw new Error('pcapcv: the value of "cv_nseg" is too large for the given X.');if(!Number.isInteger(s)||s<1)throw new Error('pcapcv: the value of "ncomp" must be a number >= 1.');const g=Math.min(o===0?v-2:v-Math.ceil(v/a)-1,m,e.ncomp);if(s>g)throw new Error('pcapcv: the value of "ncomp" is too large.');const h=l._malloc(t.v.length*t.v.BYTES_PER_ELEMENT);l.HEAPF64.set(t.v,h/t.v.BYTES_PER_ELEMENT);let p=null;if(u>0){const A=new Int32Array(d);p=l._malloc(A.length*A.BYTES_PER_ELEMENT),l.HEAP32.set(A,p/A.BYTES_PER_ELEMENT)}let _=null;if(f>0){const A=new Int32Array(e.exclvars);_=l._malloc(A.length*A.BYTES_PER_ELEMENT),l.HEAP32.set(A,_/A.BYTES_PER_ELEMENT)}const b=l._malloc(e.v.length*e.v.BYTES_PER_ELEMENT);l.HEAPF64.set(e.v,b/e.v.BYTES_PER_ELEMENT);const y=v*m,S=t.v.constructor,E=l._malloc(y*S.BYTES_PER_ELEMENT);if(l.ccall("pcvpca_wasm",["number"],["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"],[h,t.nrows,t.ncols,s,e.center,e.scale,o,a,c,b,E,p,u,_,f])!==1)throw new Error("pcapcv: PCVPCA failed.");const C=l.HEAPF64.slice(E/S.BYTES_PER_ELEMENT,E/S.BYTES_PER_ELEMENT+y);return l._free(h),l._free(b),l._free(E),p&&l._free(p),_&&l._free(_),new Lt(C,v,m)}function Pf(l,e){if(e[0]===0){const t=e[1]+2;return 2+l*t+2*l+t}return 3+l}const Jr=[{id:"norm",title:"Normalization",mpl:2,get_mpl_new:(l,e)=>2,mp:[0,0]},{id:"savgol",title:"Savitzky-Golay",mpl:3,get_mpl_new:(l,e)=>e[0]*e[0],mp:[3,1,0]},{id:"scale",title:"Scaling",mpl:2,get_mpl_new:(l,e)=>2*l,mp:[1,0]},{id:"baseline",title:"Baseline",mpl:3,get_mpl_new:Pf,mp:[0,0,0]},{id:"trim",title:"Trim tails",mpl:2,get_mpl_new:(l,e)=>2,mp:[0,0]},{id:"spikes",title:"Spike removal",mpl:2,get_mpl_new:(l,e)=>2+3*l+e[0],mp:[5,5]}];function zf(l){let e="<ul>";for(let t=0;t<l.ml.length;t++){const s=Jr[l.ml[t]].title;e=e+"<li>"+s+" <span>"+l.info[t]+"</span></li>"}return e=e+"</ul>",e}function vi(l,e,t){const s=Jr.findIndex(m=>m.id==="trim");let a=0,o=l.ncols-e,c=0;for(let m=0;m<t.ml.length;m++){if(t.ml[m]!==s){c+=t.mpl_new[m];continue}a=Math.max(a,t.mp_new[c]),o=Math.min(o,t.mp_new[c+1]),c+=t.mpl_new[m]}const d=l.nrows,f=o-a+e,v=Lt.zeros(d,f);return c=0,e>0&&(v.v.set(l.v.slice(0,e*d),c),c+=e*d),v.v.set(l.v.slice((e+a)*d,(e+o)*d),c),[a,o,v]}function Lf(l,e){if(!l||!e||typeof e!="object"||Object.keys(e).length===0)return l;const t=Jr.findIndex(d=>d.id==="trim");if(e.ml.findIndex(d=>d===t)<0)return l;const[a,o,c]=vi(l.values,l.nresp,e);return l.values=c,l.varlabels=l.nresp>0?l.varlabels.slice(0,l.nresp).concat(l.varlabels.slice(l.nresp+a,l.nresp+o)):l.varlabels.slice(a,o),l.varindices=l.nresp>0?Nr(0,l.nresp-1).concat(Nr(0,o-a-1)):Nr(0,o-a-1),l.varvalues=l.nresp>0?l.varvalues.slice(0,l.nresp).concat(l.varvalues.slice(l.nresp+a,l.nresp+o)):l.varvalues.slice(a,o),l}function mi(l,e,t,s,a=!0,o=[]){if(!mr(e))throw new Error("prep: D must be a matrix.");if(!Array.isArray(s)||s.length<1)throw new Error("prep_fit: list with methods is not correct.");let c,d;a?(c=e.ncols,d=e.nrows-t):(c=e.nrows,d=e.ncols-t);const u=s.length;if(u<1)throw new Error("prep_fit: no preprocessing methods are provided.");const f=new Int32Array(u),v=new Int32Array(u),m=new Int32Array(u);let g=0,h=0;for(let F=0;F<s.length;F++){const U=s[F].id,O=s[F].params,R=Jr.findIndex(W=>W.id==U);if(R<0)throw new Error("prep_fit: wrong method name: "+U+".");const q=Jr[R];if(O.length!==q.mpl)throw new Error("prep_fit: wrong number of parameters for method: "+U+".");f[F]=R,v[F]=q.mpl,m[F]=q.get_mpl_new(d,O),g=g+v[F],h=h+m[F]}const p=new Float64Array(g);let _=0;for(let F=0;F<s.length;F++){const U=s[F].id,O=s[F].params;Jr.findIndex(R=>R.id==U),p.set(O,_),_=_+v[F]}const b=l._malloc(e.v.length*e.v.BYTES_PER_ELEMENT);l.HEAPF64.set(e.v,b/e.v.BYTES_PER_ELEMENT);const y=l._malloc(f.length*f.BYTES_PER_ELEMENT);l.HEAP32.set(f,y/f.BYTES_PER_ELEMENT);const S=l._malloc(v.length*v.BYTES_PER_ELEMENT);l.HEAP32.set(v,S/v.BYTES_PER_ELEMENT);const E=l._malloc(m.length*m.BYTES_PER_ELEMENT);l.HEAP32.set(m,E/m.BYTES_PER_ELEMENT);const k=l._malloc(p.length*p.BYTES_PER_ELEMENT);l.HEAPF64.set(p,k/p.BYTES_PER_ELEMENT);const C=l._malloc(h*p.BYTES_PER_ELEMENT),A=new Int32Array(o),P=A.length,M=l._malloc(P*A.BYTES_PER_ELEMENT);if(l.HEAP32.set(A,M/A.BYTES_PER_ELEMENT),l.ccall("prepfit_wasm",["number"],["number","number","number","number","number","number","number","number","number","number","number","number","numbers"],[b,c,d,t,u,y,S,k,E,C,a,M,P])!==1)throw new Error("prep_fit: unexpected error.");const I=l.HEAPF64.slice(C/p.BYTES_PER_ELEMENT,C/p.BYTES_PER_ELEMENT+h);return l._free(b),l._free(y),l._free(k),l._free(S),l._free(M),l._free(C),l._free(E),{ml:f,mpl:v,mp:p,mpl_new:m,mp_new:I,npred:d,class:["prepmodel"]}}function na(l,e,t,s,a=!0,o=!1){if(!mr(e))throw new Error("prep_apply: D must be a matrix.");let c,d;if(a?(c=e.ncols,d=e.nrows-t):(c=e.nrows,d=e.ncols-t),d!==s.npred)throw new Error("prep_apply: D has wrong number of predictors (expected "+s.npred+" got "+d+").");const u=s.ml,f=s.mpl_new,v=s.mp_new,m=f.reduce((C,A)=>C+A,0);if(!u||u.length<1||!f||f.length!==u.length||v.length!==m)throw console.log(c,d,v.length,m),new Error("prep_apply: wrong structure of the model object.");const g=u.length,h=l._malloc(e.v.length*e.v.BYTES_PER_ELEMENT);l.HEAPF64.set(e.v,h/e.v.BYTES_PER_ELEMENT);const p=l._malloc(u.length*u.BYTES_PER_ELEMENT);l.HEAP32.set(u,p/u.BYTES_PER_ELEMENT);const _=l._malloc(f.length*f.BYTES_PER_ELEMENT);l.HEAP32.set(f,_/f.BYTES_PER_ELEMENT);const b=l._malloc(v.length*v.BYTES_PER_ELEMENT);l.HEAPF64.set(v,b/v.BYTES_PER_ELEMENT);const y=l._malloc(e.v.length*e.v.BYTES_PER_ELEMENT);if(l.ccall("prepapply_wasm",["number"],["number","number","number","number","number","number","number","number","number","number"],[h,c,d,t,g,p,_,b,y,a])!==1)throw new Error("prep_apply: unexpected error.");const E=l.HEAPF64.slice(y/e.v.BYTES_PER_ELEMENT,y/e.v.BYTES_PER_ELEMENT+e.v.length);l._free(h),l._free(p),l._free(_),l._free(b),l._free(y);const k=new Lt(E,e.nrows,e.ncols);if(o){const[C,A,P]=vi(k,t,s);return P}return k}function Nr(l,e,t=1){const s=Math.round((e-l+1)/t),a=Array(s);for(let o=0;o<s;o++)a[o]=l+o*t;return a}function Rf(l,e){let t,s,a;if(e.length>0){const o=l.values.nrows,c=l.objindices,d=o-e.length;t=Array(d),s=Array(d),a=Array(d);let u=0;for(let f=0;f<o;f++)e.includes(f)||(t[u]=c[f],s[u]=l.classes[f],a[u]=l.objlabels[f],u=u+1)}else t=l.objindices,a=l.objlabels,s=l.classes;return[t,a,s]}function la(){const l=new Date;return`${l.getFullYear()}${(l.getMonth()+1).toString().padStart(2,"0")}${l.getDate().toString().padStart(2,"0")}${l.getHours().toString().padStart(2,"0")}${l.getMinutes().toString().padStart(2,"0")}${l.getSeconds().toString().padStart(2,"0")}${l.getMilliseconds().toString().padStart(3,"0")}`}function sa(l,e,t,s,a=!1){const[o,c,d]=Rf(t,s),u=a&&e.prep&&e.prep.ml&&e.prep.ml.length>0?na(l,t.values,0,e.prep,!1,!0):t.values,f=Mf(l,e,u,s);f.hash=la(),f.objindices=o,f.objlabels=c,f.classes=d,f.classNames=t.classNames,f.varlabels=t.varlabels,f.eigenvals=nt(e,"eigenvals"),f.cNh=nt(e,"cNh"),f.cNq=nt(e,"cNq"),f.ch0=nt(e,"ch0"),f.cq0=nt(e,"cq0"),f.rNh=nt(e,"rNh"),f.rNq=nt(e,"rNq"),f.rh0=nt(e,"rh0"),f.rq0=nt(e,"rq0");const v=e.nrows;return f.T2lim=2*(v-1)/(v-2)*Zo(.95,2,v-2),f}function If(l,e="."){return Array.isArray(l)&&l.length>0?e==="."?l.map(t=>Number.parseFloat(t.trim())):l.map(t=>Number.parseFloat(t.trim().replace(e,"."))):e==="."?Number.parseFloat(l.trim()):Number.parseFloat(l.trim().replace(e,"."))}function al(l){return l.some(e=>Number.isNaN(e))}function yn(l){return l.replace("	","").trim().replace(/^(['"])(.*)\1$/,"$2")}function hi(l){let e=l.replace(/^\uFEFF/gm,"").replace(/^\u00EF?\u00BB\u00BF/gm,"");return e=e.replace(/\r/gm,""),e.split(/\n/).filter(t=>t.trim().length>1)}function jf(l,e,t,s,a,o,c,d=0){if(e===void 0&&(e=","),!(e===","||e===";"))throw new Error("Values separator can be either comma or semicolon.");const u=e===";"?",":".";let f=hi(l);if(f.length<1)throw new Error("Could not find non-empty rows with values, check your CSV file and try again.");f=f.filter(R=>R.replaceAll(e,"").trim().length>0);const v=f[0].split(e);if(v.length<2)throw new Error("Found only one column, looks like your delimiter is not correct.");let m=0,g;const h=t!=="no";(h||h===void 0&&al(firstRow))&&(g=v,m=1);const p=f.length-m;if(p<1)throw new Error("Data file should contain at least 1 row with values.");let _,b,y,S=Array(p);s?(_=h?yn(g[0]):"",y=Array(p),b=1):(_="",y=[],b=0);let E,k=[],C;a?(E=h?yn(g[b]):"",C=Array(p),b=b+1):(E="",C=[]);const A=v.length-b;if(A<1)throw new Error("Data file should contain at least 1 column with values.");const P=Lt.zeros(A,p);for(let R=m;R<p+m;R++){const q=R-m;S[q]=q;let W=f[R].split(e);if(s&&(y[q]=W[0],W.shift()),a){const K=W[0];C[q]=K,W.shift(),(k.length===0||k.indexOf(K)<0)&&k.push(K)}const D=u==="."?W.map((K,Z)=>Number.parseFloat(K.trim())):W.map((K,Z)=>Number.parseFloat(K.trim().replace(u,".")));if(D.some(K=>Number.isNaN(K)))throw new Error("Some of the values can not be converted to numbers, check your CSV file and try again.");if(D.length!=A)throw new Error("Wrong number of values in row #"+R);P.v.set(new Float64Array(D),(R-m)*A)}if(!s||y.length!==p){y=Array(p);for(let R=0;R<p;R++)y[R]="O"+(R+1)}y=y.map(R=>yn(R)),C=C.map(R=>yn(R)),k=k.map(R=>yn(R));let M,N=Array(A),I=Array(A);if(g&&g.length===A+b){M=g.map(R=>yn(R)).slice(b);for(let R=0;R<A;R++)N[R]=R>=d?R-d:R,I[R]=R>=d?R-d+1:R+1}else{M=Array(A);for(let R=0;R<A;R++)N[R]=R>=d?R-d:R,M[R]=R>=d?"V"+(R-d+1):"Y"+(R+1),I[R]=R>=d?R-d+1:R+1}let L;if(t==="values"){if(L=u==="."?M.map((R,q)=>q<d?q:Number.parseFloat(R.trim())):M.map((R,q)=>q<d?q:Number.parseFloat(R.trim().replace(u,"."))),L.some(R=>Number.isNaN(R)))throw new Error("Some of the header values can not be converted to numbers, check your CSV file and try again.")}else L=I;Array.isArray(L)||(L=[]),o||(o=""),c||(c=""),o=L.length>0&&o.length>0?o:"Variables",c=L.length>0&&c.length>0?c:"";const F=o+(c.length>0?", "+c:""),U=L[1]<L[0];return{values:P.t(),nresp:d,header:t,hasLabels:s,hasClassNames:a,labelsVarname:_,classLabelsVarname:E,objlabels:y,objindices:S,varlabels:M,varvalues:L,varindices:N,varrev:U,classes:C,classNames:k,sep:e,dec:u,varvaluesName:o,varvaluesUnits:c,varAxisTitle:F}}function qf(l){if(al(l[0].slice(2)))return!0;const e=l[0].length,t=[];for(let s=2;s<e;s++){let a=[];for(let f=1;f<l.length;f++)a.push(l[f][s]);const o=l[0][s],c=Yl(a),d=Wo(a),u=Math.abs((o-c)/d);t.push(u)}return t.every(s=>s>5)}function Ff(l){const t=l[0].split(","),s=l[1].split(","),a=t.length,o=s.length,c=";",d=l[0].split(c),u=l[1].split(c),f=d.length,v=u.length;let m,g;if(a>1&&o>1&&a===o&&a>f)g=",",m=a;else if(f>1&&v>1&&f===v)g=c,m=f;else throw new Error("Values in the CSV file should be separated by coma or by semicolon.");return[g,g===","?".":",",m]}function Of(l,e=0){const t=hi(l),s=t.length;if(s<3)throw new Error("It looks like the dataset has less then three rows, minimum three is needed, check your CSV file and try again.");const[a,o,c]=Ff(t),d=Math.min(c,5),u=Math.min(s,5);let f=t[0].split(a).length,v=t.slice(0,u).map(N=>N.split(a).slice(0,d));v=v.map(N=>N.map(I=>yn(I)));const m=v.map(N=>If(N.slice(),o));for(let N=1;N<u;N++)if(al(m[N].slice(2)))throw new Error("Some of the data values expected to be numeric are not, check your CSV file.");const g=qf(m);let h=0;const p=g?1:0,_=p+1,b=v[p][0],y=v[_][0],S=m[p][0],E=m[_][0],k=m[p][1],C=m[_][1];let A=!1,P=!1;if(Number.isNaN(S)&&Number.isNaN(E)&&b!==y?(A=!0,h=h+1):Number.isNaN(k)&&Number.isNaN(C)&&b!==y&&(A=!0,P=!0,h=h+2),!P){const N=A?1:0,I=m[p][N],L=m[_][N];P=al([I,L]),h=h+P}let M="no";if(g){h>0?v[0].slice(h+e):v[e];const N=h>0?m[0].slice(h+e):m[e];M=al(N)?"labels":"values"}return[a,A,P,M,f]}function Bf(l){const e=l.values.t(),t=l.sep,s=l.dec;let a=null;l.header!=="no"&&(a=l.header==="values"?l.nresp&&l.nresp>0?l.varlabels.slice(0,l.nresp).concat(l.varvalues.slice(l.nresp)):l.varvalues.slice():l.varlabels.slice()),a&&l.hasClassNames&&(a=[l.classLabelsVarname,...a]),a&&l.hasLabels&&(a=[l.labelsVarname,...a]);const o=l.classes&&l.classes.length===e.ncols,c=l.objlabels&&l.objlabels.length===e.ncols;let d=a?a.join(t):"";for(let u=0;u<e.ncols;u++){let f=e.getcolref(u+1).join(t);s!=="."&&(f=f.replace(".",s)),o&&(f=l.classes[u]+l.sep+f),c&&(f=l.objlabels[u]+l.sep+f),d=d+`
`+f}return d=d+`
`,s!=="."&&(d=d.replace(/\./g,s)),d}function Df(l,e){const t=Bf(l),s=new Blob([t],{type:"text/csv"}),a=window.URL.createObjectURL(s),o=document.createElement("a");o.setAttribute("href",a),o.setAttribute("download",`${e}.csv`),o.click()}function Vf(l){if(!l.length)return"";l.sort((a,o)=>a-o);let e=[],t=l[0],s=t;for(let a=1;a<l.length;a++)l[a]===s+1?s=l[a]:(t===s?e.push(`${t}`):e.push(`${t}-${s}`),t=l[a],s=t);return t===s?e.push(`${t}`):e.push(`${t}-${s}`),e.join(" ")}function ol(l,e){return mr(e)?{__type:"matrix",nrows:e.nrows,ncols:e.ncols,v:Array.from(e.v)}:Je(e)?{__type:"vector",length:e.length,v:Array.from(e.v)}:ArrayBuffer.isView(e)?{__type:e.constructor.name,data:Array.from(e)}:e}function aa(l,e){if(e&&typeof e=="object"&&e.__type){if(e.__type==="matrix")return Cf(e.v,e.nrows,e.ncols);if(e.__type==="vector")return ct(e.v);const t=globalThis[e.__type];if(typeof t=="function")return new t(e.data)}return e}function oa(l){const e=l.getFullYear(),t=String(l.getMonth()+1).padStart(2,"0"),s=String(l.getDate()).padStart(2,"0"),a=String(l.getHours()).padStart(2,"0"),o=String(l.getMinutes()).padStart(2,"0"),c=String(l.getSeconds()).padStart(2,"0");return`${e}${t}${s}${a}${o}${c}`}function Ql(l,e){return Object.keys(l).reduce((t,s)=>(t[s]=e(l,s),t),{})}function gi(l){return Array.from({length:8},(e,t)=>l>>7-t&1).reverse()}function Zl(l,e,t){let s="";for(let a=0;a<e;a++){const o=l.getUint8(t++);if(o===0)break;s+=String.fromCharCode(o)}return s}function Yf(l){const e=["A.U.","cm^–1","µm","nm","s","min","Hz","KHz","MHz","M/z","ppm","days","years","cm^–1","eV","","","","","F","C","K","","msec","µsec","nsec","GHz","cm","m","mm","h",""],t=["Arbitrary","Wavenumber","Micrometers","Nanometers","Seconds","Minutes","Hertz","Kilohertz","Megahertz","Mass","Parts per million","Days","Years","Raman shift","Electron Volts","X,Y,Z text labels in fcatxt (old 4Dh version only)","Diode Number","Channel","Degrees","Temperature","Temperature","Temperature","Data Points","Milliseconds","Microseconds","Nanoseconds","Gigahertz","Centimeters","Meters","Millimeters","Hours","Double interferogram (no display labels)"],s=["Arbitrary Intensity","Interferogram","Absorbance","Kubelka-Munk","Counts","Volts","Degrees","Milliamps","Millimeters","Millivolts","Log (1/R)","Percent","Intensity","Relative Intensity","Energy",null,"Decibel",null,null,"Temperature (F)","Temperature (C)","Temperature (K)","Index of Refraction [N]","Extinction Coeff. [K]","Real","Imaginary","Complex"],a=["Transmission","Reflectance","Arbitrary or Single Beam with Valley Peaks","Emission"];let o=0;const c=l.getUint8(o);o+=1;const d=l.getUint8(o);if(o+=1,d===77)throw new Error("SPC file has old format which is not supported.");const u=d===75,f=l.getUint8(o);o+=1;const v=l.getInt8(o);o+=1;const m=l.getUint32(o,u);o+=4;const g=l.getFloat64(o,u);o+=8;const h=l.getFloat64(o,u);o+=8;const p=l.getUint32(o,u);o+=4;const _=l.getUint8(o);o+=1;const b=l.getUint8(o);o+=1;const y=l.getUint8(o);o+=1;const S=l.getUint8(o);o+=1;const E=l.getUint32(o,u);o+=4;const k=Zl(l,9,o);o+=9;const C=Zl(l,9,o);o+=9;const A=l.getUint16(o,u);o+=2;const P=Array.from({length:8},()=>{const $=l.getFloat32(o,u);return o+=4,$}),M=Zl(l,130,o);o+=130;const N=Zl(l,30,o);o+=30;const I=l.getUint32(o,u);o+=4;const[L,F,U,O,R,q,W,D]=gi(c),K=_===255?t[31]:t[_],Z=_===255?e[31]:e[_],G=b<=26?s[b]:b>=128&&b<=131?a[b]:"Unknown";return{ftflgsv:c,ftflgs:{TSPREC:L,TCGRAM:F,TMULTI:U,TRANDM:O,TORDRD:R,TALABS:q,TXYXYS:W,TXVALS:D},fexper:f,fexp:v,fnpts:m,ffirst:g,flast:h,fnsub:p,fxtype:_,fytype:b,fztype:y,fpost:S,fdate:E,fres:k,fsource:C,fpeakpt:A,fspare:P,fcmnt:M,fcatxt:N,flogoff:I,xaxisName:K,xaxisUnit:Z,yaxisName:G}}function Wf(l,e){const t=gi(l.getUint8(e));e+=1;const s=l.getInt8(e);e+=1;const a=l.getUint16(e,!0);e+=2;const o=l.getFloat32(e,!0);e+=4;const c=l.getFloat32(e,!0);e+=4;const d=l.getFloat32(e,!0);e+=4;const u=l.getInt32(e,!0);e+=4;const f=l.getInt32(e,!0);e+=4;const v=l.getFloat32(e,!0);return e+=4,{flags:t,exp:s,index:a,time:o,next:c,noise:d,nPoints:u,nScans:f,wAxis:v}}async function pi(l){if(l.name.slice(-3).toLowerCase()!=="spc")throw new Error(`One of the selected files is not SPC (${l.name}).`);const t=l.name.slice(0,-4),s=await l.arrayBuffer(),a=new DataView(s);let o=0;const c=Yf(a);o+=512;const d=c.fnpts;if(d<2)throw new Error(`Error reading SPC file (${l.name}).`);let u=new Array(d);if(c.ftflgs.TXVALS)for(let m=0;m<d;m++){const g=a.getFloat32(o,!0);o=o+4,u[m]=g}else{(c.flast-c.ffirst)/(d-1);for(let m=0;m<d;m++)u[m]=c.ffirst+m*c.flast}const f=new Float64Array(d*c.fnsub);for(let m=0;m<c.fnsub;m++){Wf(a,o),o=o+32;for(let g=0;g<d;g++){const h=a.getFloat32(o,!0);o=o+4,f[m*d+g]=h}}const v=[];return c.fnsub>1?Nr(1,c.fnsub).forEach(g=>{v.push(t+"_"+g)}):v.push(t),{hdr:c,xvalues:u,yvalues:f,objlabels:v}}async function Uf(l){if(!(l instanceof FileList||Array.isArray(l)))throw new Error("readSPCFiles: expected FileList or array of files.");const e=l.length,t=[];let s=[],a=[];const o=await pi(l[0]),c=o.xvalues.length;if(t.push(o.yvalues),s=s.concat(o.objlabels),a.push(o.hdr.fnsub),e>1)for(let p=1;p<e;p++){const _=await pi(l[p]);if(_.xvalues.length!==c)throw new Error("Number of spectral values in SPC files is different.");t.push(_.yvalues),s=s.concat(_.objlabels),a.push(_.hdr.fnsub)}const d=a.reduce((p,_)=>p+_,0),u=new Float64Array(d*c);let f=0;for(let p=0;p<t.length;p++)u.set(t[p].slice(),f),f+=a[p]*c;const v=new Lt(u,c,d),m=Nr(0,c-1),g=Nr(0,d-1),h=o.xvalues.map(p=>p.toFixed(1));return{values:v.t(),nresp:0,header:"values",hasLabels:!0,hasClassNames:!1,labelsVarname:"",classLabelsVarname:"",classes:[],classNames:[],objlabels:s,objindices:g,varlabels:h,varvalues:o.xvalues,varindices:m,varev:o.xvalues[1]<o.xvalues[0],sep:",",dec:".",varvaluesName:o.hdr.xaxisName,varvaluesUnits:o.hdr.xaxisUnit,varAxisTitle:"",fileName:`${e} SPC files`}}function bi(l,e){const t=1-e/100,a=1.96*Math.sqrt(l*t*(1-t))/l;return[t,a]}var Hf=X('<button tabindex="0" class="button svelte-ymtj5z"> </button>');function lt(l,e){let t=V(e,"text",3,"button");var s=Hf();s.__click=function(...o){var c;(c=e.onclick)==null||c.apply(this,o)};var a=j(s);ae(()=>me(a,t())),T(l,s)}mt(["click"]);var Gf=X('<button tabindex="0"></button>');function xn(l,e){V(e,"disable",3,!1);var t=Gf();t.__click=function(...s){var a;(a=e.onclick)==null||a.apply(this,s)},ae(()=>{H(t,"title",e.title),H(t,"aria-label",e.title),H(t,"alt",e.title),pt(t,1,`button ${e.className??""}`,"svelte-bx9fh5")}),T(l,t)}mt(["click"]);function Mr(l,e){let t=V(e,"title",3,"Reset");xn(l,{get title(){return t()},get onclick(){return e.onclick},className:"button-cancel"})}function Xf(l,e){let t=V(e,"title",3,"Undo");xn(l,{get title(){return t()},get onclick(){return e.onclick},className:"button-undo"})}function Kf(l,e){let t=V(e,"title",3,"Download");xn(l,{get title(){return t()},get onclick(){return e.onclick},className:"button-download"})}function Jf(l,e){let t=V(e,"title",3,"Add");xn(l,{get title(){return t()},get onclick(){return e.onclick},className:"button-add"})}function _i(l,e){let t=V(e,"title",3,"Settings");xn(l,{get title(){return t()},get onclick(){return e.onclick},className:"button-settings"})}function Qf(l,e){let t=V(e,"title",3,"Move up");xn(l,{get title(){return t()},get onclick(){return e.onclick},className:"button-up"})}function Zf(l,e){let t=V(e,"title",3,"Move down");xn(l,{get title(){return t()},get onclick(){return e.onclick},className:"button-down"})}function Rt(l){const e={};for(const t of Object.keys(l))e[t]=l[t].default;return e}var $f=X('<span class="label svelte-1986c5z"> </span>'),ed=X("<div><!> <!></div>");function ie(l,e){let t=V(e,"label",3,null),s=V(e,"name",3,""),a=V(e,"status",3,""),o=V(e,"colors",3,""),c=V(e,"labelWidth",3,12);var d=ed(),u=j(d);{var f=m=>{var g=$f(),h=j(g);ae(()=>{bt(g,`flex-basis:${c()??""}ch;`),me(h,t())}),T(m,g)};Y(u,m=>{t()&&m(f)})}var v=z(u,2);Rr(v,()=>e.children??kt),ae(()=>{pt(d,1,`control-element ${s()??""} ${a()??""}`,"svelte-1986c5z"),bt(d,o())}),T(l,d)}const wi=(l,e,t,s)=>{const a=e(l);a<0||a>1||B(t,a*100>r(s)-5&&a*100<r(s)+5,!0)},yi=(l,e,t,s,a,o)=>{B(e,!1);const c=t(l);c<0||c>1||(s(a(c)),o()&&o()(s()))},xi=(l,e,t,s,a,o)=>{if(!r(e))return;const c=t(l);c<0||c>1||(s(a(c)),o()&&o()(s()))},td=(l,e,t,s,a,o)=>{if(l.key==="ArrowLeft"){e(e()-t()<s()?s():e()-t()),a()&&a()(e());return}if(l.key==="ArrowRight"){e(e()+t()>o()?o():e()+t()),a()&&a()(e());return}};var rd=X('<div role="slider" class="range-slider-container svelte-vhx0r0" tabindex="0"><div><span> </span></div></div>');function On(l,e){be(e,!0);let t=V(e,"min",7,0),s=V(e,"max",3,100),a=V(e,"value",31,()=>De(t())),o=V(e,"decNum",3,1),c=V(e,"step",19,()=>+((s()-t())/100).toFixed(4)),d=V(e,"onchange",3,null);ue(()=>{a()<t()&&(a(t()),d()&&d()(a())),a()>s()&&(a(s()),d()&&d()(a())),t()>s()&&t(s())});let u=re(void 0),f=re(void 0),v=re(!1);const m=A=>{const P=t()+A*(s()-t());return+(Math.round(P/c())*c()).toFixed(4)},g=A=>{const P=r(u).getBoundingClientRect(),M=r(f).getBoundingClientRect(),N=P.x,I=M.x+M.width;return(A.clientX-N)/(I-N)},h=A=>{B(v,!1)},p=A=>{let P=a()+c()*A.deltaY*.5;P<t()&&(P=t()),P>s()&&(P=s()),a(+(Math.round(P/c())*c()).toFixed(4)),A.preventDefault(),d()&&d()(a())},_=w(()=>t()===s()?100:(a()-t())/(s()-t())*100);var b=rd();b.__keydown=[td,a,c,t,d,s],b.__mousemove=[xi,v,g,a,m,d],b.__mousedown=[wi,g,v,_],b.__mouseup=[yi,v,g,a,m,d],b.__touchmove=[xi,v,g,a,m,d],b.__touchstart=[wi,g,v,_],b.__touchend=[yi,v,g,a,m,d];var y=j(b);let S;var E=j(y);let k;var C=j(E);_n(y,A=>B(u,A),()=>r(u)),_n(b,A=>B(f,A),()=>r(f)),ae((A,P,M)=>{H(b,"aria-valuenow",a()),H(b,"aria-valuemin",t()),H(b,"aria-valuemax",s()),S=pt(y,1,"range-slider svelte-vhx0r0",null,S,A),bt(y,`width:${r(_)??""}%`),k=pt(E,1,"range-value svelte-vhx0r0",null,k,P),me(C,M)},[()=>({"range-slider_right":r(_)<50}),()=>({"range-value_right":r(_)<50}),()=>a().toFixed(o())]),gn("mousewheel",b,p),gn("mouseleave",b,h),gn("touchcancel",b,h),T(l,b),_e()}mt(["keydown","mousemove","mousedown","mouseup","touchmove","touchstart","touchend"]);const ki=(l,e,t,s,a)=>{const o=e(l);o<0||o>1||B(t,o>r(s)&&o<r(a)+r(s),!0)},Ei=(l,e,t,s,a)=>{B(e,!1);const o=t(l);if(o<0||o>1)return;const c=s(o);a()!==c&&a(c)},Ci=(l,e,t,s,a)=>{if(!r(e))return;const o=t(l);if(o<0||o>1)return;const c=s(o);c!=a()&&a(c)},nd=(l,e,t,s,a)=>{if(l.key==="ArrowLeft"){e(e()-t()<s()?s():e()-t());return}if(l.key==="ArrowRight"){e(e()+t()>a()?a():e()+t());return}};var ld=X('<div role="slider" class="range-slider-container range-slider-container_discrete svelte-xdlm7u" tabindex="0"><div><span> </span></div></div>');function Tr(l,e){be(e,!0);let t=V(e,"min",3,0),s=V(e,"max",3,10),a=V(e,"value",31,()=>De(t())),o=V(e,"step",3,1);a()<t()&&(console.log('RangeDiscrete: the "value" is outside of the provided range.'),a(t())),a()>s()&&(console.log('RangeDiscrete: the "value" is outside of the provided range.'),a(s())),t()>s()&&console.error("The min and max values must be distinct.");let c=re(void 0),d=re(void 0),u=re(!1);const f=w(()=>t()===s()?0:(a()-t())/(s()-t()+o())),v=w(()=>o()/(s()-t()+o())),m=w(()=>s()<100?`background: repeating-linear-gradient(to right, var(--bg-color-light, #f4f4f4), var(--bg-color-light, #f4f4f4), var(--bg-color-light, #f4f4f4) ${r(v)*100}%, var(--bg-color-light2, #e8e8e8) ${r(v)*100}%, var(--bg-color-light2, #e8e8e8) ${200*r(v)}%)`:"background: #f0f0f0"),g=A=>{if(A<0||A>1)return a();let P=a();return Math.round(r(v)/A),A<r(f)&&r(f)>0&&(P=a()-o()*Math.ceil((r(f)-A)/r(v))),A>r(f)+r(v)&&r(f)+r(v)<1&&(P=a()+o()*Math.ceil((A-(r(f)+r(v)))/r(v))),P<t()&&(P=t()),P>s()&&(P=s()),P},h=A=>{const P=r(d).getBoundingClientRect(),M=P.x,N=P.x+P.width;return(A.clientX-M)/(N-M)},p=A=>{B(u,!1)},_=A=>{let P=a()+Math.round(A.deltaY*.5)*o();P<t()&&(P=t()),P>s()&&(P=s()),a(P),A.preventDefault()};var b=ld();b.__keydown=[nd,a,o,t,s],b.__mousemove=[Ci,u,h,g,a],b.__mousedown=[ki,h,u,f,v],b.__mouseup=[Ei,u,h,g,a],b.__touchmove=[Ci,u,h,g,a],b.__touchstart=[ki,h,u,f,v],b.__touchend=[Ei,u,h,g,a];var y=j(b);let S;var E=j(y);let k;var C=j(E);_n(y,A=>B(c,A),()=>r(c)),_n(b,A=>B(d,A),()=>r(d)),ae((A,P,M)=>{H(b,"aria-valuenow",a()),H(b,"aria-valuemin",t()),H(b,"aria-valuemax",s()),bt(b,r(m)),S=pt(y,1,"range-slider svelte-xdlm7u",null,S,A),bt(y,`width: max(2px, ${r(v)*100}%);left:${r(f)*100}%;`),k=pt(E,1,"range-value svelte-xdlm7u",null,k,P),me(C,M)},[()=>({"range-slider_left":r(v)<.1&&r(f)<.5,"range-slider_right":r(v)<.1&&r(f)>=.5}),()=>({"range-value_right":r(v)<.1&&r(f)>.5,"range-value_left":r(v)<.1&&r(f)<=.5}),()=>a().toFixed(0)]),gn("mousewheel",b,_),gn("mouseleave",b,p),gn("touchcancel",b,p),T(l,b),_e()}mt(["keydown","mousemove","mousedown","mouseup","touchmove","touchstart","touchend"]);const sd=(l,e,t)=>{if(l.key==="ArrowLeft"){const s=e.options.findIndex(a=>a===t());s>0&&t(e.options[s-1]);return}if(l.key==="ArrowRight"){const s=e.options.findIndex(a=>a===t());s<e.options.length-1&&t(e.options[s+1]);return}};var ad=(l,e,t)=>e(t),od=X('<button tabindex="-1"><!></button>'),id=X('<div role="radiogroup" tabindex="0"></div> <input class="svelte-1i17tox"/>',1);function Ke(l,e){be(e,!0);let t=V(e,"value",31,()=>De(e.options[0])),s=V(e,"className",3,"");var a=id(),o=J(a);o.__keydown=[sd,e,t],Xe(o,20,()=>e.options,d=>d,(d,u)=>{var f=od();f.__click=[ad,t,u];let v;var m=j(f);Mt(m,()=>u),ae((g,h)=>v=pt(f,1,`option option_${g??""}`,"svelte-1i17tox",v,h),[()=>u.toString().replace(".","_"),()=>({selected:u==t()})]),T(d,f)});var c=z(o,2);ae(()=>pt(o,1,`selector ${s()??""}`,"svelte-1i17tox")),Vs(c,t),T(l,a),_e()}mt(["keydown","click"]);function tr(l,e){be(e,!0);let t=V(e,"options",19,()=>["no","yes"]),s=V(e,"value",15,!1),a=re(!0);const o=w(()=>t().length!=2?(console.error('Switch: parameter "option" must gave two values.'),null):t());ue(()=>B(a,s()?t()[1]:t()[0],!0)),ue(()=>s(r(a)===t()[1]));var c=he(),d=J(c);{var u=f=>{Ke(f,{get options(){return r(o)},get value(){return r(a)},set value(v){B(a,v,!0)}})};Y(d,f=>{r(o)&&f(u)})}T(l,c),_e()}function Si(l,e,t){r(e)&&r(e).files.length>0?t(r(e).files.length===1?r(e).files[0]:r(e).files):t(null)}function Ai(l,e){(l.type==="click"||l.type==="keydown"&&(l.code==="Space"||l.code==="Enter"))&&r(e).click()}var cd=X('<input type="file" multiple class="svelte-1k0x7uv"/>'),ud=X('<input type="file" class="svelte-1k0x7uv"/>'),fd=X('<div tabindex="0" role="radiogroup"> <!></div> <!>',1);function $l(l,e){be(e,!0);let t=V(e,"file",15),s=V(e,"message",3,"Select CSV file with dataset"),a=V(e,"acceptType",3,".csv"),o=V(e,"multiple",3,!1),c=re(void 0);function d(y){r(c).value=null,t(null)}var u=fd(),f=J(u);f.__keydown=[Ai,c],f.__click=[Ai,c];let v;var m=j(f),g=z(m);{var h=y=>{var S=cd();S.__change=[Si,c,t],_n(S,E=>B(c,E),()=>r(c)),ae(()=>H(S,"accept",a())),T(y,S)},p=y=>{var S=ud();S.__change=[Si,c,t],_n(S,E=>B(c,E),()=>r(c)),ae(()=>H(S,"accept",a())),T(y,S)};Y(g,y=>{o()?y(h):y(p,!1)})}var _=z(f,2);{var b=y=>{Mr(y,{onclick:d})};Y(_,y=>{t()&&y(b)})}ae(y=>{v=pt(f,1,"file-selector svelte-1k0x7uv",null,v,y),me(m,`${(t()?t().name:s())??""} `)},[()=>({selected:t()})]),T(l,u),_e()}mt(["keydown","click","change"]);function dd(l,e,t,s){e()&&B(t,e()(s()),!0)}var vd=X('<div class="error-message svelte-1qtiwcs"> </div>'),md=X('<div><input type="text" class="svelte-1qtiwcs"/> <!></div>');function Ni(l,e){be(e,!0);let t=V(e,"value",15,""),s=V(e,"className",3,""),a=V(e,"placeholder",3,""),o=V(e,"maxLength",3,25),c=V(e,"validator",3,null),d=re("");var u=md();let f;var v=j(u);v.__input=[dd,c,d,t];var m=z(v,2);{var g=h=>{var p=vd(),_=j(p);ae(()=>me(_,r(d))),T(h,p)};Y(m,h=>{r(d)&&r(d).length>0&&h(g)})}ae(h=>{f=pt(u,1,`textinput ${s()??""}`,"svelte-1qtiwcs",f,h),H(v,"placeholder",a()),H(v,"maxlength",o())},[()=>({error:r(d)&&r(d).length>0})]),Vs(v,t),T(l,u),_e()}mt(["input"]);var hd=X('<div class="spinner svelte-n48urb"></div>');function ia(l){var e=hd();T(l,e)}const gd=(l,e,t)=>{if(l.key==="ArrowLeft"){const s=e().findIndex(a=>a===t());s>0&&t(e()[s-1]);return}if(l.key==="ArrowRight"){const s=e().findIndex(a=>a===t());s<e().length-1&&t(e()[s+1]);return}};var pd=(l,e,t)=>e(t),bd=X('<button tabindex="-1"><!></button>'),_d=X('<div role="radiogroup" tabindex="0" class="selector plot-selector svelte-yf64an"></div> <input class="svelte-yf64an"/>',1);function Mi(l,e){be(e,!0);let t=V(e,"options",19,()=>["p","l","b","h","qq"]),s=V(e,"value",31,()=>De(t()[0]));const a='<svg width="3em" height="1.5em" viewBox="0 0 32 20" fill="transparent" xmlns="http://www.w3.org/2000/svg">',o={bp:'<rect x="8" y="5" width="16" height="10" stroke-width="2"/><line x1="15" y1="14" x2="15" y2="4" stroke-width="2"/><line x1="30" y1="10" x2="25" y2="10" stroke-width="2"/><line x1="8" y1="10" x2="2" y2="10" stroke-width="2"/>',hm:'<rect x="5" y="4" width="23" height="12"stroke-width="2"/><line x1="13" y1="16" x2="13" y2="3" stroke-width="2"/><line x1="21" y1="16" x2="21" y2="3" stroke-width="2"/><line x1="28" y1="10" x2="5" y2="10" stroke-width="2"/>',l:'<path d="M4.23178 14.3598L15.5 5" stroke-width="2"/><line x1="14.4846" y1="5.17692" x2="26.4846" y2="10.1769" stroke-width="2"/>',p:'<circle cx="6.5" cy="12.5" r="1" stroke-width="4"/><circle cx="15.2" cy="5.8" r="1" stroke-width="4"/><circle cx="25" cy="10" r="1" stroke-width="4"/>',h:'<line x1="9" y1="15" x2="9" y2="9" stroke-width="6"/><line x1="17" y1="15" x2="17" y2="3" stroke-width="6"/><line x1="25" y1="15" x2="25" y2="7" stroke-width="6"/>',qq:'<circle cx="6.5" cy="15.0" r="1" stroke-width="4"/><circle cx="15.2" cy="10" r="1" stroke-width="4"/><circle cx="25" cy="5.8" r="1" stroke-width="4"/>'};o.b=o.l+o.p;const c={bp:"boxplot",hm:"heatmap",l:"line",p:"scatter",b:"line + scatter",h:"bar",qq:"qq-plot"};var d=_d(),u=J(d);u.__keydown=[gd,t,s],Xe(u,20,t,v=>v,(v,m)=>{var g=bd();g.__click=[pd,s,m];let h;var p=j(g);Mt(p,()=>a+o[m]+"</svg"),ae(_=>{h=pt(g,1,"option svelte-yf64an",null,h,_),H(g,"title",c[m])},[()=>({selected:m==s()})]),T(v,g)});var f=z(u,2);Vs(f,s),T(l,d),_e()}mt(["keydown","click"]),mt(["keydown","click"]);var wd=X("<h2> </h2>"),yd=X("<!> <!>",1),xd=X('<div class="widget"><!></div>');function kd(l,e){be(e,!0);let t=V(e,"title",3,""),s=V(e,"value",15),a=V(e,"labelWidth",3,13);function o(f){const v={};for(const m of Object.keys(f))v[m]=f[m].default;return v}ue(()=>{!s()&&e.options&&s(o(e.options))});var c=xd(),d=j(c);{var u=f=>{var v=yd(),m=J(v);{var g=p=>{ie(p,{children:(_,b)=>{var y=wd(),S=j(y);ae(()=>me(S,t())),T(_,y)},$$slots:{default:!0}})};Y(m,p=>{t()&&p(g)})}var h=z(m,2);Xe(h,17,()=>Object.keys(e.options),Qe,(p,_)=>{var b=he();const y=w(()=>e.options[r(_)]);var S=J(b);{var E=k=>{ie(k,{get name(){return r(y).name},get label(){return r(y).label},get labelWidth(){return a()},children:(C,A)=>{var P=he(),M=J(P);nl(M,()=>r(y).el,(N,I)=>{I(N,Zt(()=>r(y).props,{get value(){return s()[r(_)]},set value(L){s(s()[r(_)]=L,!0)}}))}),T(C,P)},$$slots:{default:!0}})};Y(S,k=>{r(y).hidden||k(E)})}T(p,b)}),T(f,v)};Y(d,f=>{s()&&f(u)})}T(l,c),_e()}function Ti(l,e,t){return l<e?["regular","in"]:l>t?["outlier","out"]:["extreme","out"]}function Ed(l,e,t,s,a,o,c,d){if(!d||d.length===0)return[0,0];let u=0,f=0;for(let v of d){const m=l[v],[g,h]=Ti(m,e,t);o[g]+=1,c[h]+=1,s[v]=g,a[v]=h,u=u+(h==="in"),f=f+(h!=="in")}return[u,f]}function Pi(l,e,t,s,a,o,c,d,u){if(!u||u.length===0)return[0,0,0,0,0,0,0,0,0,0];let f=0,v=0;for(let U of u){const O=l[U],[R,q]=Ti(O,t,s);d[q]+=1,a[U]="alien",c.alien+=1,o[U]=q,f=f+(q!=="in"),v=v+(q==="in")}const m=u.slice();m.sort((U,O)=>l[U]-l[O]);let g=m.length;const h=m.map(U=>l[U]);let p=-1,_=0,b=0,y=0,S=0;for(;p<0;)_>0&&(a[m[g-1]]="external",c.alien=c.alien-1,c.external=c.external+1,g=g-1,m.pop(),h.pop()),b=Yl(h),y=Hs(h),S=y/(b*b),p=4-2*e*S,_=_+1;const E=(2+Math.sqrt(p))/S,k=E-e,C=b/E,A=t/C,P=1-2*(e+k)*(e+3*k)/(3*(e+2*k)**2),M=(P-1)*(1-3*P),N=(e+2*k)/(e+k)**2,I=1+P*N*(P-1-.5*(2-P)*M*N),L=P*Math.sqrt(2*N)*(1+.5*M*N),F=Wl((Math.pow(A/(e+k),P)-I)/L);return[f,v,F,k,C,P,I,L,e,b]}function es(l,e,t,s,a){const o=l.ncomp,c=l.nrows;let d,u,f;a?(d=a.members.length,u=a.strangers.length,f=0):(a={members:[],strangers:[],unknown:Nr(0,c-1)},d=0,u=0,f=c);const v=new Array(o),m=new Array(o),g=new Array(o),h=new Array(o),p=new Array(o),_=new Array(o),b=new Array(o),y=e==="robust"?l.rNq:l.cNq,S=e==="robust"?l.rNh:l.cNh;for(let E=0;E<o;E++){const k=S[E]+y[E],C=er(l,e==="robust"?"fdistr":"fdistc",E+1),A=new Array(c),P=new Array(c),M={regular:0,extreme:0,outlier:0,alien:0,external:0},N={in:0,out:0},[I,L]=Ed(C,t[E],s[E],P,A,M,N,a.members),[F,U,O,R,q,W,D,K,Z,G]=Pi(C,k,t[E],s[E],P,A,M,N,a.strangers);f>0&&Pi(C,k,t[E],s[E],P,A,M,N,a.unknown),m[E]=I>0?I/(I+L):0,g[E]=F>0?F/(F+U):0,h[E]=1-O,p[E]=Math.sqrt(m[E]*g[E]),_[E]=I>0&&F>0?(I+F)/(I+F+U+L):0,b[E]=E+1,v[E]={f:C,decs:A,rols:P,decsNum:N,rolsNum:M,TP:I,FN:L,TN:F,FP:U,beta:O,s:R,f0:q,hz:W,Mz:D,Sz:K,k:Z,m:G}}return{class:["simcares"],classes:l.classes,classNames:l.classNames,ind:a,nMembers:d,nStrangers:u,nUnknown:f,v,nrows:l.nrows,stat:{sensitivity:m,specificity:g,selectivity:h,efficiency:p,accuracy:_,components:b}}}function ts(l,e,t,s,a,o){(!o||!Array.isArray(o))&&(o=[]);let c=l.exclvars;(!c||!Array.isArray(c))&&(c=[]);const d=s.values.nrows,u=o.length,f=d-u,v=e.ncomp,m=er(t.pca,"qdist",v),g=er(t.pca,"hdist",v),h=e.limType==="classic"?"c":"r",p=er(t.pca,"fdist"+h,v),_=nt(l,h+"Nh")[v-1],b=nt(l,h+"Nq")[v-1],y=nt(l,h+"h0")[v-1],S=nt(l,h+"q0")[v-1],E=_+b,k=t.simca.v[v-1],C=s.sep,A=t.simca.classes&&t.simca.classes.length===f,P=A?["","","","",""]:["","","",""];let M="";if(M+=["Reference classes:",A?"provided":"not provided",...P].join(C)+`
`,M+=["Number of components:",v,...P].join(C)+`
`,M+=["Alpha:",(e.alpha/100).toFixed(3),...P].join(C)+`
`,M+=["Limits estimator:",e.limType,...P].join(C)+`
`,M+=`
`,M+=["Nh:",_,...P].join(C)+`
`,M+=["Nq:",b,...P].join(C)+`
`,M+=["Nf:",E,...P].join(C)+`
`,M+=`
`,M+=["F crit (extremes):",e.eCrit[v-1],...P].join(C)+`
`,M+=["F crit (outliers):",e.oCrit[v-1],...P].join(C)+`
`,M+=`
`,c.length>0&&(M+=["Number of excluded variables:",c.length,...P].join(C)+`
`,M+=["Indices of excluded variables:",Vf(c),...P].join(C)+`
`,M+=`
`),M+=["Objects:",d,...P].join(C)+`
`,M+=["In:",k.decsNum.in,...P].join(C)+`
`,M+=["Out:",k.decsNum.out,...P].join(C)+`
`,t.simca.nMembers>0&&(M+=`
`,M+=["Members:",t.simca.nMembers,...P].join(C)+`
`,M+=["Regular:",k.rolsNum.regular,...P].join(C)+`
`,M+=["Extreme:",k.rolsNum.extreme,...P].join(C)+`
`,M+=["Outliers:",k.rolsNum.outlier,...P].join(C)+`
`,M+=["Sensitivity:",t.simca.stat.sensitivity[v-1],...P].join(C)+`
`),t.simca.nStrangers>0&&(M+=`
`,M+=["Strangers:",t.simca.nStrangers,...P].join(C)+`
`,M+=["In:",k.decsNum.in-k.rolsNum.regular,...P].join(C)+`
`,M+=["Aliens:",k.rolsNum.alien,...P].join(C)+`
`,M+=["External:",k.rolsNum.external,...P].join(C)+`
`,M+=["Specificity:",t.simca.stat.specificity[v-1],...P].join(C)+`
`,M+=["Selectivity:",t.simca.stat.selectivity[v-1],...P].join(C)+`
`,M+=`
`,M+=["Beta:",k.beta,...P].join(C)+`
`,M+=["Non-centrality, s:",k.s,...P].join(C)+`
`,M+=["Scaling, f0:",k.f0,...P].join(C)+`
`,t.simca.nMembers>0)){const O=k.TP/(k.TP+k.FP),R=t.simca.stat.sensitivity[v-1],q=1-t.simca.stat.specificity[v-1],W=2*O*R/(O+R),D=R/q,K=(1-R)/(1-q);M+=`
`,M+=["Efficiency:",t.simca.stat.efficiency[v-1],...P].join(C)+`
`,M+=["Accuracy:",t.simca.stat.accuracy[v-1],...P].join(C)+`
`,M+=["Precision:",O,...P].join(C)+`
`,M+=["F1-score:",W,...P].join(C)+`
`,M+=["PLR:",D,...P].join(C)+`
`,M+=["NLR:",K,...P].join(C)+`
`}M+=`
`,M+=["","object","class","role","decision","h/h0","q/q0","f"].join(C)+`
`;let N=0;k.rols?k.rols:new Array(d).fill("-");for(let O=0;O<d;O++){if(u>0&&o.includes(O)){M+=["",s.objlabels[O],"-","removed","-","-","-","-"].join(C)+`
`;continue}M+=["",s.objlabels[N],t.pca.classes[N],k.rols[N],k.decs[N],g[N]/y,m[N]/S,p[N]].join(C)+`
`,N=N+1}M+=`
`,s.dec!=="."&&(M=M.replace(/\./g,s.dec)),M=["Target class:",e.className,...P].join(C)+`
`+M,M=["Data filename:",s.fileName,...P].join(C)+`
`+M;let I=["DD-SIMCA results ("+a+")","https://mda.tools/ddsimca/",...P].join(C)+`

`;const L=new Blob([I+M],{type:"text/csv"}),F=window.URL.createObjectURL(L),U=document.createElement("a");U.setAttribute("href",F),U.setAttribute("download",`ddsimca-results-${a}.csv`),U.click()}function ca(l,e,t){t&&(l.prep=t);const s=new Blob([JSON.stringify({pca:l,simca:e},ol)],{type:"application/json"}),a=window.URL.createObjectURL(s),o=document.createElement("a");o.setAttribute("href",a),o.setAttribute("download","ddsimca-model.json"),o.click()}var Cd=X('<span class="item svelte-1ggez3e"> </span>'),Sd=X('<p class="outliers svelte-1ggez3e"><span style="color:#a0a0a0;">Removed:</span> <!></p> <!> <!>',1);function ua(l,e){be(e,!0);var t=he(),s=J(t);{var a=o=>{ie(o,{children:(c,d)=>{var u=Sd(),f=J(u),v=z(j(f),2);Xe(v,17,()=>e.outliers,Qe,(p,_)=>{var b=Cd(),y=j(b);ae(()=>me(y,e.dataset.objlabels[r(_)])),T(p,b)});var m=z(f,2);{var g=p=>{Xf(p,{get onclick(){return e.undoOutliers}})};Y(m,p=>{e.outliers.length>1&&p(g)})}var h=z(m,2);Mr(h,{get onclick(){return e.resetOutliers}}),T(c,u)},$$slots:{default:!0}})};Y(s,o=>{e.dataset&&e.outliers&&e.outliers.length>0&&o(a)})}T(l,t),_e()}const Ad={small:30,medium:40,large:50,xlarge:60},Nd={small:5,medium:8,large:12,xlarge:15},Md={small:6,medium:10,large:14,xlarge:18},fa={small:4,medium:6,large:8,xlarge:10},Td={small:12,medium:15,large:19,xlarge:21},da={small:11,medium:15,large:17,xlarge:19},il={small:["0","3,3","1,1","3,1,1,1"],medium:["0","5,5","2,2","5,2,2,2"],large:["0","7,7","3,3","7,3,2,3"],xlarge:["0","9,9","4,4","9,3,3,3"]},Bn=["●","◼","▲","▼","⬥","＋","✳","✕"],Pd=.8,zi=.5,zd={small:5,medium:8,large:12,xlarge:15},It={MIDDLEGRAY:"#dadada",DARKGRAY:"#606060",LEGEND:"#303030",PRIMARY:"#2679B2",PRIMARY_TEXT:"#333",CLEGEND_LABELS:"#808080"};function Li(l,e){return Array.isArray(l)&&l.length===e&&!l.some(t=>t===void 0)&&!l.some(t=>isNaN(t))}function Ri(l,e){if(l!=null&&(Array.isArray(l)&&(l=ct(l)),!(!Je(l)||l.length<1)))return l.apply(t=>ba((t-e[1])*e[0]+e[2])).v}function _t(l,e){return Ri(l,e.coords)}function va(l,e){return Ri(l,e.objects)}function Ii(l,e){if(l!=null&&(Array.isArray(l)&&(l=ct(l)),!(!Je(l)||l.length<1)))return l.apply(t=>(t-e[2])/e[0]+e[1]).v}function ji(l,e){return Ii(l,e.coords)}function qi(l,e){return Ii(l,e.objects)}function ma(l){return l===0?"":`<tspan>&times;10</tspan><tspan font-size="0.75em" dy="-0.5em">${l.toString()}</tspan>`}function kn(l){if(l===Math.round(l))return l;if(Math.abs(l)>10**6)return Math.round(l);if(Math.abs(l)<10**-6)return l;let e=l.toPrecision(10);return e=e.replace(/\.?0+$/,""),parseFloat(e)}function ha(l){if(l===void 0)return[0,void 0];if(l.length<1)return[0,void 0];if(l.length===1)return[0,[l[0].toString()]];let e=kn(Math.abs(qn(Yo(l)))),t=0;if(e>=1)return e<100?[0,Array.from(l).map(o=>o.toFixed(0))]:(t=Math.ceil(kn(Math.log10(e)))-2,[t,Array.from(l).map(o=>(o/Math.pow(10,t)).toFixed(0))]);let s=Math.ceil(-kn(Math.log10(e)));return s<=2?[0,Array.from(l).map(a=>a.toFixed(s))]:(t=s-2,s=2,kn(Math.abs($t(l)))<=10?[-t,Array.from(l).map(a=>(a*Math.pow(10,t)).toFixed(s))]:[-t,Array.from(l).map(a=>(a/Math.pow(10,t)).toString())])}function Bt(l,e,t){return Array.isArray(l)&&(l=ct(l)),Je(l)?l.length<1?(console.error(e+": vector with coordinates is empty."),null):t&&l.length!==t?(console.error(e+": vector does not have the expected length of "+t+"."),null):l:(console.error(e+": coordinates must be provided as array or instance of Vector class."),null)}function ga(l,e,t,s){if(!l||!e||l.length!==e.length)return console.error("val2p: provided coordinate values are not correct."),null;const a=t.coords,o=s.coords;let c="";for(let d=0;d<l.length;d++){const u=ba((l.v[d]-a[1])*a[0]+a[2]),f=ba((e.v[d]-o[1])*o[0]+o[2]);c+=u+","+f+" "}return c}function Fi(l,e){return l?Array.isArray(l)?!e||e.length<1?[null,"tick labels must be accompanied with tick values."]:e.v.length!==l.length?[null,"number of tick labels and values should be the same."]:[l.map(t=>Qr(t)),""]:[null,"tick labels must be provided as array."]:[null,""]}function Oi(l,e){if(Array.isArray(l)&&(l=ct(l)),!Je(l))return[null,"tick values must be provided as an array or as a vector."];if(l.v.some(c=>isNaN(c)))return[null,"tick values must be numeric"];const t=new Set(l.v);if(l.length!==t.size)return[null,"ticks values must be unique."];const s=e[0]<e[1]?e[0]:e[1],a=e[0]<e[1]?e[1]:e[0],o=l.filter(c=>c>=s&c<=a);return o.length!==l.length?[null,"some of ticks values are outside axis limits."]:[o,""]}function pa(l,e,t,s,a,o){a==null&&(a=!1),o===void 0&&(o=1e-4);const c=e[0]<e[1]?e:[e[1],e[0]];if(l)return l;if(typeof c!="object"||c[0]===void 0||c[1]===void 0){console.error("getAxisTicks: provided axis limits are not valid.");return}const d=Math.abs(c[1]-c[0])*o,u=c[1]-c[0]-2*d,f=Math.floor(Math.log10(u)),v=1/Math.pow(10,f-1),m=Math.round(u*v)/v;let g=Ld(m/t);a&&(Math.abs(c[1]-c[0])<=1?console.error('getAxisTicks: parameter "whole" will be ignored as axis limits are too narrow to fit whole ticks.'):(g<1&&(g=1),g=Math.round(g)));let h=Math.ceil((c[0]+d)/g)*g,p=Math.floor((c[1]-d)/g)*g;Math.abs(c[0]-h)<g/10&&(h=h+g),Math.abs(c[1]-p)<g/10&&(p=p-g),t=Math.ceil(kn((p-h)/g))+1,l=ze.zeros(t);for(let _=0;_<t;_++)l.v[_]=h+g*_;if(Math.abs(g)<1){const _=Math.pow(10,1+Math.round(-Math.log10(g)));l=l.apply(b=>Math.round((b+Number.EPSILON)*_)/_)}return l.filter(_=>_>=c[0]&_<=c[1])}function Ld(l,e){const t=Math.floor(Math.log10(l)),s=l/Math.pow(10,t);let a;return s<=1?a=1:s<=2?a=2:s<=5?a=5:a=10,a*Math.pow(10,t)}function ba(l){return Math.round(l*10)/10}function Rd(l,e){return e<300.2||l<400.2?"small":e<400.2||l<700.2?"medium":e<650.2||l<850.2?"large":"xlarge"}function Bi(l,e){return l<400.2?"small":l<700.2?"medium":l<900.2?"large":"xlarge"}function Id(){const l=new Int32Array(256);for(let e=0;e<256;e++){let t=e;for(let s=0;s<8;s++)t=t&1?3988292384^t>>>1:t>>>1;l[e]=t}return l}function jd(l){let e=-1,t=Id();for(let s=0;s<l.length;s++)e=t[(e^l[s])&255]^e>>>8;return e^-1}function qd(l,e){const t=new Uint8Array(13);e*=39.3701,t[0]=112,t[1]=72,t[2]=89,t[3]=115,t[4]=e>>>24,t[5]=e>>>16,t[6]=e>>>8,t[7]=e&255,t[8]=t[4],t[9]=t[5],t[10]=t[6],t[11]=t[7],t[12]=1;const s=jd(t),a=new Uint8Array(4);a[0]=s>>>24,a[1]=s>>>16,a[2]=s>>>8,a[3]=s&255;const o=new Uint8Array(4);o[0]=0,o[1]=0,o[2]=0,o[3]=9;const c=new Uint8Array(54);return c.set(l,0),c.set(o,33),c.set(t,37),c.set(a,50),c}function Fd(l,e){const t=l.split(","),s=t[0],a=t[1],o=33/3*4,c=a.substring(0,o),d=a.substring(o),u=atob(c),f=new Uint8Array(u.length);for(let g=0;g<f.length;g++)f[g]=u.charCodeAt(g);const v=qd(f,e),m=btoa(String.fromCharCode(...v));return[s,",",m,d].join("")}function Od(l,e,t,s,a){if(t||(t=10),s||(s=10),a||(a=300),t<1||t>30)return console.error('Parameter "width" must be between 1 and 30 (cm).'),null;if(s<1||s>30)return console.error('Parameter "height" must be between 1 and 30 (cm).'),null;if(a<50||a>1200)return console.error('Parameter "res" must be between 50 and 1200 (ppi).'),null;if(!l||!(l instanceof SVGElement))return console.error('Parameter "svg" is not an instance of SVGElement.'),null;(!e||e.trim()==="")&&(e="plot");const o=t/2.54*a,c=s/2.54*a;setTimeout(()=>{const d=l.clientHeight,u=l.clientWidth;let f=Math.max(o/u,c/d),v=1;f<1&&(v=f,f=1);const m=document.createElement("canvas"),g=m.getContext("2d");m.width=u*(v<1?v:f),m.height=d*(v<1?v:f),l.setAttribute("width",u*f),l.setAttribute("height",d*f),g.fillStyle="white",g.fillRect(0,0,m.width,m.height),g.scale(f,f);const h=new XMLSerializer().serializeToString(l),p=new Blob([h],{type:"image/svg+xml;charset=utf-8"}),_=URL.createObjectURL(p),b=new Image;b.onload=function(){v<0&&(b.width=b.width*v,b.height=b.height*v),g.drawImage(b,0,0,m.width,m.height);const y=m.toDataURL("image/png"),S=Fd(y,a),E=document.createElement("a");E.href=S,E.download=`${e}.png`,E.click()},b.src=_},20)}function Bd(l,e){if(!l||!(l instanceof SVGElement))return console.error('Variable "svg" is not an instance of SVGElement.'),null;(!e||e.trim()==="")&&(e="plot");const t=l.clientHeight,s=l.clientWidth;l.setAttribute("width",s+"px"),l.setAttribute("height",t+"px"),l.setAttribute("viewBox",`0 0 ${s} ${t}`);const a=new Blob([l.outerHTML],{type:"image/svg+xml"}),o=window.URL.createObjectURL(a),c=document.createElement("a");c.setAttribute("href",o),c.setAttribute("download",`${e}.svg`),c.click()}function Dd(l,e,t,s){const a=l.textContent;navigator.clipboard.write([new ClipboardItem({"image/png":Vd(e,t,s)})]).then(()=>{l.classList.add("copied"),l.textContent="✓ done",setTimeout(()=>{l.classList.remove("copied"),l.textContent=a},500)},o=>{console.error(o),l.classList.add("error"),l.textContent="x copy",setTimeout(()=>{l.classList.remove("error"),l.textContent=a},500)}).catch(o=>console.error(o))}async function Vd(l,e,t){const s=l.clientHeight,a=l.clientWidth,o=Math.max(e/a,t/s),c=document.createElement("canvas"),d=c.getContext("2d");return c.width=a*o,c.height=s*o,d.scale(o,o),l.setAttribute("width",c.width),l.setAttribute("height",c.height),await new Promise((f,v)=>{const m=new XMLSerializer().serializeToString(l),g=new Blob([m],{type:"image/svg+xml;charset=utf-8"}),h=window.URL||window.webkitURL||window,p=h.createObjectURL(g),_=new Image;_.onload=function(){d.drawImage(_,0,0,c.width,c.height),h.revokeObjectURL(p),c.toBlob(function(b){b?f(b):v(new Error("Failed to create blob"))},"image/png")},_.onerror=function(b){v(b)},_.src=p})}function rs(l,e){return l>16&&(l=16),[["#2679B2"],["#2679B2","#D22C2F"],["#2679B2","#92B42A","#D22C2F"],["#2679B2","#2E9658","#F2B825","#D22C2F"],["#2679B2","#22988A","#92B42A","#F79426","#D22C2F"],["#2679B2","#1C9AA8","#379531","#EED524","#FB7F28","#D22C2F"],["#2679B2","#1D94A9","#2E9658","#92B42A","#F2B825","#F47129","#D22C2F"],["#2679B2","#1E90AA","#279775","#519E2F","#D3CB25","#F5A326","#EF672A","#D22C2F"],["#2679B2","#1F8DAB","#22988A","#33953F","#92B42A","#EFCA24","#F79426","#EB5F2A","#D22C2F"],["#2679B2","#208BAC","#1E999A","#2E9658","#5FA32E","#C5C626","#F2B825","#F98827","#E85A2B","#D22C2F"],["#2679B2","#2089AD","#1C9AA8","#29976C","#379531","#92B42A","#EED524","#F4AA26","#FB7F28","#E6552B","#D22C2F"],["#2679B2","#2188AD","#1C97A8","#25987C","#329546","#68A62D","#BCC327","#F0C524","#F69E26","#F77728","#E4512B","#D22C2F"],["#2679B2","#2186AD","#1D94A9","#22988A","#2E9658","#469A2F","#92B42A","#DECF25","#F2B825","#F79426","#F47129","#E34E2C","#D22C2F"],["#2679B2","#2285AE","#1E92AA","#209995","#2A9767","#34953A","#6FA82D","#B5C128","#EFCE24","#F3AD25","#F98C27","#F16B29","#E14B2C","#D22C2F"],["#2679B2","#2284AE","#1E90AA","#1D999F","#279775","#31964A","#519E2F","#92B42A","#D3CB25","#F0C224","#F5A326","#FA8527","#EF672A","#E0492C","#D22C2F"],["#2679B2","#2283AE","#1F8FAB","#1C9AA8","#249880","#2E9658","#379531","#73AA2C","#B0BF28","#EDD424","#F2B825","#F69B26","#FB7F28","#ED632A","#DF472C","#D22C2F"]][l-1]}function Yd(l,e,t,s,a){let o=a.ticks,c=a.tickLabels,d=0;const u=pa(o,l,Nd[t.x],!0,a.whole),f=u.length,v=qi([fa[t.plot]],s)[0],m=ze.fill(e[0],f),g=m.add(v),h=ze.fill(e[1],f);if(c||(o?(d=0,c=o.v.map(M=>kn(M).toString())):[d,c]=ha(u.v)),!c||c.length!==u.length)return console.error('XAxis: "tickLabels" must be a array of the same size as ticks.'),null;const p=[[u,m],[u,h]],_=[[ct([l[0]]),ct([e[0]])],[ct([l[1]]),ct([e[0]])]],b=[[u,g],[u,m]],y=(l[1]-l[0])*.01,S=[[null,null],[[l[1]-(d>9?1:0)*y],[m.v[f-1]]]],E=ma(d),k=c.length,C=Math.abs(l[1]>l[0]?l[1]-u.v[k-1]:l[1]-u.v[0]),A=Math.abs(l[1]-l[0]),P=Math.abs(u.v[1]-u.v[0]);if(E.length>0&&C<A*.1&&C<P*.5){const M=l[1]>l[0]?k-1:0;c[M]=" "}return{grid:p,axisLine:_,tickCoords:b,tfCoords:S,ticks:o,tickLabels:c,tickFactor:d,tfLabel:E}}function Wd(l,e,t,s,a){let o=a.ticks,c=a.tickLabels,d=0;const u=pa(a.ticks,e,Md[t.y],!0,a.whole),f=u.length,v=qi([fa[t.plot]],s)[0],m=ze.fill(l[0],f),g=m.add(v),h=ze.fill(l[1],f);if(c||(o?(d=0,c=o.v.map(P=>kn(P).toString())):[d,c]=ha(u.v)),c.length!==u.length)return console.error('YAxis: "tickLabels" must be a array of the same size as ticks.'),null;const p=[[m,u],[h,u]],_=[[ct([l[0]]),ct([e[0]])],[ct([l[0]]),ct([e[1]])]],b=[[m,u],[g,u]],y=[[[],[]],[[g.v[f-1]+(Math.abs(d)>9?3:2)*v],[e[1]]]],S=ma(d),E=c.length,k=Math.abs(e[1]>e[0]?e[1]-u.v[E-1]:e[1]-u.v[0]),C=Math.abs(e[1]-e[0]),A=Math.abs(u.v[1]-u.v[0]);if(S.length>0&&k<C*.1&&k<A*.5){const P=e[1]>e[0]?E-1:0;c[P]=" "}return{grid:p,axisLine:_,tickCoords:b,tfCoords:y,ticks:o,tickLabels:c,tickFactor:d,tfLabel:S}}function Ud(l){if(!l.breaks)return console.error("ColormapLegend: breaks values must be provided."),null;const e=Je(l.breaks)?l.breaks.v:l.breaks;if(e.length<2)return console.error("ColormapLegend: incorrect breaks values."),null;if(!l.colmap)return console.error('ColormapLegend: values for "colmap" parameter must be provided.'),null;if(!Array.isArray(l.colmap))return console.error('ColormapLegend: parameter "colmap" must be array with colors.'),null;if(l.colmap.length!==e.length-1)return console.error('ColormapLegend: number of color values in "colmap" does not match number of intervals defined by breaks.'),null;const t=l.colmap;let s,a;if(l.labels?(s=l.labels,a=0):[a,s]=ha(e),!(s.length===e.length-1||s.length===e.length))return console.error('ColormapLegend: number of values in "labels" should be equal to or by one less than number of values in "breaks".'),null;const o=s.length===t.length;return{colmap:t,breaks:e,labels:s,isCentered:o,labelsFactor:a,fontSize:l.fontSize,labelColor:l.labelColor}}function Hd(l,e,t,s){const a=l.colmap.length,o=e*Pd,c=o/a,d=t[1]+(e-o)*.5,u=zd[s.y],f=t[2]+u*zi,v=f+u*(1+zi),m=l.isCentered?c/2:0;return{start:d,top:f,height:u,width:c,dxl:m,ltop:v}}function En(l,e,t){if(!l||!e||!t||typeof t!="function")return;const s=l.target;if(s.tagName===e){const a=Array.prototype.indexOf.call(s.parentNode.children,s);if(a<0)return;t(a),l.stopPropagation()}}function Gd(l,e){const s=document.createElement("canvas").getContext("2d");return s.font=e,s.measureText(l.replace(/<(.|\n)*?>/g,"")).width}function Xd(l,e){const t="Arial",s=e/8,a=e*1.5,o=Array(l.length),c=Array(l.length);let d=0,u=0,f=0;for(let m=0;m<l.length;m++){const g=Gd("  "+l[m].label+"  ",e+"px "+t);f=g>f?g:f;const h=e*l[m].labelHeight+2*s;o[m]=h,c[m]=d,d=d+h,u=u+h}const v=a+2*s+f;return[c,o,a,s,u,v]}function Kd(l,e,t,s,a){const[o,c,d,u,f,v]=Xd(l.items,s*l.fontSize),m=l.position.includes("left")?e[0]+a:l.position.includes("right")?e[1]-v-a:(e[1]+e[0]-v)*.5,g=l.position.includes("top")?t[1]+a:l.position.includes("bottom")?t[0]-f-a:(t[1]+t[0]-f)*.5;return{lgl:m,lgt:g,lgw:v,lgh:f,ely:o,elh:c,elw:d,elp:u}}function Qr(l){if(!l||l.length<1)return l;function e(o){return'<tspan font-size="0.75em" dy="-0.5em">'+o+'</tspan><tspan dy="0.4em"> </tspan>'}function t(o){return'<tspan font-size="0.75em" dy="0.5em">'+o+'</tspan><tspan dy="-0.4em"> </tspan>'}let s=0,a="";for(;s<l.length;){const o=l[s];if((o==="^"||o==="_")&&s<l.length-1){const c=o==="^";if(s++,l[s]==="("){let d=s+1;for(;d<l.length&&l[d]!==")";)d++;const u=l.slice(s+1,d);a+=c?e(u):t(u),s=d+1}else if(l[s]==="-"||l[s]==="–"){const d=l.slice(s,s+2);a+=c?e(d):t(d),s=s+2}else a+=c?e(l[s]):t(l[s]),s++}else a+=o,s++}return a}var Jd=Ne('<line vector-effect="non-scaling-stroke"></line>'),Qd=Ne("<g></g>");function _a(l,e){be(e,!0);let t=V(e,"lineCoords",19,()=>[]),s=V(e,"lineColor",19,()=>It.DARKGRAY),a=V(e,"lineType",3,1),o=V(e,"lineWidth",3,1),c=V(e,"className",3,"");const d=Vt("axes");let u=w(()=>_t(t()[0][0],d.tX())),f=w(()=>_t(t()[1][0],d.tX())),v=w(()=>_t(t()[0][1],d.tY())),m=w(()=>_t(t()[1][1],d.tY())),g=w(()=>`stroke:${s()};stroke-width: ${o()}px;stroke-dasharray:${il[d.scales().plot][a()-1]}`);var h=he(),p=J(h);{var _=b=>{var y=Qd();Xe(y,21,()=>r(u),Qe,(S,E,k)=>{var C=Jd();ae(()=>{H(C,"x1",r(u)[k]),H(C,"x2",r(f)[k]),H(C,"y1",r(v)[k]),H(C,"y2",r(m)[k]),bt(C,r(g))}),T(S,C)}),ae(()=>pt(y,0,Bu(c()))),T(b,y)};Y(p,b=>{r(u)&&r(v)&&r(f)&&b(_)})}T(l,h),_e()}var Zd=Ne('<text text-anchor="middle"><!></text>'),$d=Ne("<text><!></text>"),ev=Ne("<text><!></text>"),tv=Ne('<g class="tick-labels"><!></g>');function Di(l,e){be(e,!0);let t=V(e,"pos",3,1),s=V(e,"las",3,1),a=w(()=>["middle","middle","start","middle","end"][t()]),o=w(()=>`fill:${e.textColor};`);const c=Vt("axes");let d=w(()=>_t(e.tickCoords[1][0],c.tX())),u=w(()=>_t(e.tickCoords[1][1],c.tY())),f=w(()=>da[c.scales().plot]),v=w(()=>[0,0,r(f),0,-r(f)][t()]),m=w(()=>[0,r(f),0,-r(f),0][t()]);var g=tv(),h=j(g);{var p=b=>{var y=he(),S=J(y);Xe(S,17,()=>r(d),Qe,(E,k,C)=>{var A=Zd();H(A,"data-id",C),H(A,"dx",0);var P=j(A);Mt(P,()=>e.tickLabels[C],!0),ae(()=>{H(A,"x",r(d)[C]),H(A,"y",r(u)[C]),H(A,"dy",r(v)*1.25),H(A,"transform",`rotate(-90, ${r(d)[C]}, ${r(u)[C]})`)}),T(E,A)}),T(b,y)},_=b=>{var y=he(),S=J(y);{var E=C=>{var A=he(),P=J(A);Xe(P,17,()=>r(d),Qe,(M,N,I)=>{var L=$d();H(L,"data-id",I),H(L,"dy",0),H(L,"text-anchor","end");var F=j(L);Mt(F,()=>e.tickLabels[I],!0),ae(()=>{H(L,"x",r(d)[I]),H(L,"y",r(u)[I]),H(L,"dx",-r(m)/2),H(L,"transform",`rotate(-90, ${r(d)[I]}, ${r(u)[I]})`)}),T(M,L)}),T(C,A)},k=C=>{var A=he(),P=J(A);Xe(P,17,()=>r(d),Qe,(M,N,I)=>{var L=ev();H(L,"data-id",I);var F=j(L);Mt(F,()=>e.tickLabels[I],!0),ae(()=>{H(L,"x",r(d)[I]),H(L,"y",r(u)[I]),H(L,"dx",r(v)),H(L,"dy",r(m)),H(L,"text-anchor",r(a))}),T(M,L)}),T(C,A)};Y(S,C=>{s()===2&&t()===1?C(E):C(k,!1)},!0)}T(b,y)};Y(h,b=>{s()===2&&t()===4?b(p):b(_,!1)})}ae(()=>bt(g,r(o))),T(l,g),_e()}const rv=(l,e=kt,t=kt)=>{var s=cv();const a=w(()=>e().colmap.length);var o=J(s);Xe(o,17,()=>e().colmap,Qe,(v,m,g)=>{var h=av();const p=w(()=>t().start+g*t().width);var _=J(h),b=z(_);H(b,"dy",0);var y=j(b);Mt(y,()=>e().labels[g],!0),ae(()=>{H(_,"x",r(p)),H(_,"y",t().top),H(_,"width",t().width),H(_,"height",t().height),H(_,"fill",r(m)),H(b,"x",r(p)),H(b,"y",t().ltop),H(b,"dx",t().dxl),H(b,"fill",e().labelColor),H(b,"font-size",e().fontSize+"em")}),T(v,h)});var c=z(o);{var d=v=>{var m=ov();const g=w(()=>t().start+r(a)*t().width);H(m,"dx",0),H(m,"dy",0);var h=j(m);Mt(h,()=>e().labels[r(a)],!0),ae(()=>{H(m,"x",r(g)),H(m,"y",t().ltop),H(m,"fill",e().labelColor),H(m,"font-size",`${e().fontSize??""}em`)}),T(v,m)};Y(c,v=>{e().isCentered||v(d)})}var u=z(c);{var f=v=>{var m=iv();const g=w(()=>t().start+r(a)*t().width);var h=j(m);Mt(h,()=>ma(e().labelsFactor),!0),ae(()=>{H(m,"x",r(g)),H(m,"y",t().ltop),H(m,"fill",e().labelColor),H(m,"font-size",`${e().fontSize??""}em`)}),T(v,m)};Y(u,v=>{e().labelsFactor!==0&&v(f)})}T(l,s)};function Vi(l,e,t){l.preventDefault(),e(l,t())}function Yi(l,e,t){l.preventDefault(),e(l,t())}function Wi(l,e,t){l.preventDefault(),e(l,t())}function ns(l,e,t){l.preventDefault(),e(l,t())}async function Ui(l,e,t,s){Dd(l.target,r(e),t(),s())}function Hi(l,e,t){Bd(r(e),t())}function Gi(l,e,t,s,a,o){Od(r(e),t(),s(),a(),o())}var nv=Ne('<text fill="crimson" text-anchor="middle"> </text>'),lv=Ne('<text dy="10px" fill="crimson" text-anchor="middle" dominant-baseline="hanging"> </text>'),sv=Ne("<!><!><!><!><!>",1),av=Ne('<rect></rect><text dominant-baseline="hanging" text-anchor="middle"><!></text>',1),ov=Ne('<text dominant-baseline="hanging" text-anchor="middle"><!></text>'),iv=Ne('<text dx="1.2em" dy="-0.25em" dominant-baseline="hanging" text-anchor="right"><!></text>'),cv=Ne("<!><!><!>",1),uv=Ne("<line></line>"),fv=Ne('<text dominant-baseline="middle" text-anchor="middle"> </text>'),dv=Ne('<svg><!><!><text class="legend-text" xml:space="preserve" dominant-baseline="middle" text-anchor="start"><!></text></svg>'),vv=Ne('<svg><rect height="100%" width="100%"></rect><!></svg>'),mv=Ne('<text dominant-baseline="middle" style="font-size:1.1em;"><!></text>'),hv=Ne('<text dominant-baseline="middle" style="font-size:1.1em;"><!></text>'),gv=Ne('<text dominant-baseline="middle" style="font-size:1.2em;"><!></text>'),pv=Ne('<g class="plot-labels"><!><!><!></g>'),bv=Ne('<g class="axis x-axis"><!></g>'),_v=Ne('<g class="axis y-axis"><!></g>'),wv=Ne('<rect fill="transparent" id="axes-box"></rect>'),yv=Ne('<rect stroke="transparent" fill="transparent" id="axes-box"></rect>'),xv=Ne('<g class="colormap-legend" style="stroke:0;stroke-width:0px;"><!></g>'),kv=Ne('<g class="group-legend" style="stroke:0;stroke-width:0px;"><!></g>'),Ev=Ne('<!><!><g class="axes-box"><!></g><g class="axes-content svelte-1jtdxd0"><!></g><!><!>',1),Cv=X('<p class="message-error svelte-1jtdxd0">Axes component was not properly initialized. <br/> Check that you defined axes limits and margins correctly.</p>'),Sv=X('<div class="download-links svelte-1jtdxd0"><button class="svelte-1jtdxd0">⇩ svg</button> <button class="svelte-1jtdxd0">⇩ png</button> <button class="svelte-1jtdxd0">⧉ copy</button></div>'),Av=X(`<div><svg class="plot svelte-1jtdxd0" xmlns="http://www.w3.org/2000/svg"><style>.plot {
            font-family: Arial, Helvetica, sans-serif;
         }

         .plot-labels text {
            font-weight:bold;
            text-anchor:middle;
            user-select: none;
         }

         .series-points text {
            /* dominant-baseline: central;
            alignment-baseline: central */
         }

         .tick-labels text,
         .tick-labels tspan,
         .series-textlabels text,
         .series-textlabels tspan,
         .series-text text,
         .series-text tspan {
            dominant-baseline: middle;
            cursor: default;
            user-select: none;
            -webkit-user-select: none;
         }


         .colormap-legend text,
         .colormap-legend tspan,
         .series-points text,
         .series-points tspan {
            cursor: default;
            user-select: none;
            -webkit-user-select: none;
         }

         .series-points1 text,
         .series-points1 tspan {
            dominant-baseline: middle;
            alignment-baseline: middle;
         }

         .series-points2 text,
         .series-points2 tspan {
            dominant-baseline: central;
            alignment-baseline: central;
         }

         .series-text text,
         .series-text tspan {
            dominant-baseline: middle;
            alignment-baseline: middle;
            text-anchor: middle;
            user-select: none;
            -webkit-user-select: none;
         }

         .tick-labels text,
         .tick-labels tspan {
            user-select: none;
            -webkit-user-select: none;
         }</style><!><svg preserveAspectRatio="none" class="axes"><defs><clipPath><rect></rect></clipPath></defs><!></svg></svg> <!></div>`);function Xi(l,e){be(e,!0);const t=(Se,qe=kt,Re=kt)=>{var Ve=he(),wt=J(Ve);{var _r=Gt=>{var it=he(),et=J(it);{var jt=yt=>{var dt=nv(),fr=j(dt);ae(()=>{H(dt,"x",r(ee)[0]-10),H(dt,"y",r($)),H(dt,"transform",`rotate(-90, ${r(ee)[0]-10}, ${r($)})`),me(fr,Re().error)}),T(yt,dt)},Ct=yt=>{var dt=lv(),fr=j(dt);ae(()=>{H(dt,"x",r(ne)),H(dt,"y",r(se)[0]),me(fr,Re().error)}),T(yt,dt)};Y(et,yt=>{Re().pos===4?yt(jt):yt(Ct,!1)})}T(Gt,it)},Dt=Gt=>{var it=sv(),et=J(it);{var jt=Ie=>{_a(Ie,{get lineCoords(){return qe().grid},get lineColor(){return It.MIDDLEGRAY},lineType:3})};Y(et,Ie=>{Re().showGrid&&Ie(jt)})}var Ct=z(et);_a(Ct,{get lineCoords(){return qe().axisLine},get lineColor(){return It.DARKGRAY},lineType:1});var yt=z(Ct);_a(yt,{get lineCoords(){return qe().tickCoords},get lineColor(){return It.DARKGRAY},lineType:1});var dt=z(yt);{var fr=Ie=>{Di(Ie,{get las(){return Re().las},get pos(){return Re().pos},get tickCoords(){return qe().tickCoords},get tickLabels(){return qe().tickLabels},get tickColor(){return It.DARKGRAY},get hideLast(){return Re().hideLast}})};Y(dt,Ie=>{qe().tickCoords.length===2&&qe().tickLabels.length===qe().tickCoords[1][0].length&&Ie(fr)})}var nn=z(dt);{var st=Ie=>{{let Pt=w(()=>[qe().tfLabel]);Di(Ie,{get pos(){return Re().pos},get tickCoords(){return qe().tfCoords},get tickLabels(){return r(Pt)},get textColor(){return It.DARKGRAY}})}};Y(nn,Ie=>{qe().tickFactor!==0&&Ie(st)})}T(Gt,it)};Y(wt,Gt=>{Re().error?Gt(_r):Gt(Dt,!1)})}T(Se,Ve)},s=(Se,qe=kt,Re=kt)=>{var Ve=vv();const wt=w(()=>Re().elw+2*Re().elp),_r=w(()=>Re().elp),Dt=w(()=>Re().elh),Gt=w(()=>Re().ely);var it=j(Ve),et=z(it);Xe(et,17,()=>qe().items,Qe,(jt,Ct,yt)=>{var dt=dv();H(dt,"x",0);var fr=j(dt);{var nn=zr=>{var St=uv();ae(()=>{H(St,"x1",r(_r)),H(St,"x2",r(wt)-r(_r)),H(St,"y1",r(Dt)[yt]/2),H(St,"y2",r(Dt)[yt]/2),H(St,"stroke",r(Ct).line.lineColor),H(St,"stroke-width",r(Ct).line.lineWidth),H(St,"stroke-dasharray",r(L)[r(Ct).line.lineType-1])}),T(zr,St)};Y(fr,zr=>{r(Ct).line&&zr(nn)})}var st=z(fr);{var Ie=zr=>{var St=fv(),La=j(St);ae(()=>{H(St,"x",r(wt)/2),H(St,"y",r(Dt)[yt]/2),H(St,"fill",r(Ct).point.faceColor),H(St,"stroke-width",r(Ct).point.lineWidth),H(St,"stroke",r(Ct).point.lineColor),H(St,"font-size",`${r(Ct).point.markerSize??""}em`),me(La,Bn[r(Ct).point.marker-1])}),T(zr,St)};Y(st,zr=>{r(Ct).point&&zr(Ie)})}var Pt=z(st),ds=j(Pt);Mt(ds,()=>r(Ct).label,!0),ae(()=>{H(dt,"y",r(Gt)[yt]),H(dt,"width",Re().lgw),H(dt,"height",r(Dt)[yt]),H(Pt,"x",r(wt)+r(_r)),H(Pt,"y",r(Dt)[yt]/2),H(Pt,"fill",It.LEGEND),H(Pt,"font-size",`${qe().fontSize??""}em`)}),T(jt,dt)}),ae(()=>{H(Ve,"x",Re().lgl),H(Ve,"y",Re().lgt),H(Ve,"height",Re().lgh),H(Ve,"width",Re().lgw),H(it,"fill",qe().faceColor),H(it,"stroke",qe().lineColor),H(it,"stroke-width",qe().lineWidth)}),T(Se,Ve)};let a=V(e,"limX",19,()=>[0,1]),o=V(e,"limY",19,()=>[0,1]),c=V(e,"margins",19,()=>[1,1.1,.55,.6]),d=V(e,"downloadLinks",3,"none"),u=V(e,"fileName",3,"plot"),f=V(e,"pngWidth",3,8),v=V(e,"pngHeight",3,8),m=V(e,"pngRes",3,300),g=V(e,"clipboardWidth",3,1200),h=V(e,"clipboardHeight",3,800),p=V(e,"onclick",3,null),_=V(e,"onmousemove",3,null),b=V(e,"onmousedown",3,null),y=V(e,"onmouseup",3,null);function S(Se,qe){if(qe&&Se.target.id=="axes-box"){const Re=ji([Se.offsetX-r(U)],r(Z))[0],Ve=ji([Se.offsetY-r(O)],r(G))[0];qe(Re,Ve)}}const E="plottingArea"+Math.round(Math.random()*1e4);let k=re(0),C=re(0),A=re(0);const P=w(()=>({plot:Rd(r(C),r(A)),x:Bi(r(C)),y:Bi(r(A))})),M=w(()=>c().map(Se=>Se*Ad[r(P).plot])),N=w(()=>Td[r(P).plot]),I=w(()=>fa[r(P).plot]),L=w(()=>il[r(P).plot]),F=w(()=>r(de).show&&r(de).label!==""?r(N)*1.5:0),U=w(()=>r(ce).show&&r(ce).label!==""?r(N)*1.5:0),O=w(()=>e.title&&e.title!==""?r(N)*1.5:0),R=w(()=>r(C)>r(U)?r(C)-r(U):0),q=w(()=>r(A)>r(F)+r(O)?r(A)-r(F)-r(O):0),W=w(()=>r(q)-r(M)[0]-r(M)[2]),D=w(()=>r(R)-r(M)[1]-r(M)[3]),K=w(()=>Li(a(),2)&&Li(o(),2)&&r(R)>r(M)[1]+r(M)[3]&&r(q)>r(M)[0]+r(M)[2]),Z=w(()=>r(K)?{coords:[r(D)/(a()[1]-a()[0]),a()[0],r(M)[1]],objects:[r(D)/(a()[1]-a()[0]),0,0]}:{coords:[1,0,0],objects:[1,0,0]}),G=w(()=>r(K)?{coords:[-r(W)/(o()[1]-o()[0]),o()[1],r(M)[2]],objects:[r(W)/(o()[1]-o()[0]),0,0]}:{coords:[0,1,0],objects:[0,1,0]}),$=w(()=>r(W)*.5+r(O)+r(M)[2]),ne=w(()=>r(D)*.5+r(U)+r(M)[1]),ee=w(()=>r(K)?_t(a(),r(Z)):[0,1]),se=w(()=>r(K)?_t(o(),r(G)):[1,0]),pe=w(()=>Qr(e.title)),Me=w(()=>r(pe)?r(pe).length===e.title.left?1:1.4:0);let Le=re(De({show:!1})),de=re(De({show:!1,error:""})),ce=re(De({show:!1,error:""})),Ce=re(De({show:!1,colmap:null,breaks:null})),fe=re(De({show:!1,items:null,position:null}));const ye=w(()=>r(K)&&r(Ce)&&r(Ce).show?Ud(r(Ce)):null),le=w(()=>r(K)&&r(de).show?Yd(a(),o(),r(P),r(G),r(de)):null),ve=w(()=>r(K)&&r(ce).show?Wd(a(),o(),r(P),r(Z),r(ce)):null),oe=w(()=>r(K)&&r(ye)?Hd(r(ye),r(D),r(M),r(P)):null),xe=w(()=>r(K)&&r(fe)&&r(fe).show&&r(ee)?Kd(r(fe),r(ee),r(se),r(N),r(I)):null);nu("axes",{setBox:Se=>B(Le,Se,!0),setXAxis:Se=>B(de,Se,!0),setYAxis:Se=>B(ce,Se,!0),setColmapLegend:Se=>B(Ce,Se,!0),setGroupLegend:Se=>B(fe,Se,!0),scales:()=>r(P),tX:()=>r(Z),tY:()=>r(G),limX:()=>a(),limY:()=>o()});var ke=Av();let ge;var je=j(ke),Pe=z(j(je));{var We=Se=>{var qe=pv(),Re=j(qe);{var Ve=it=>{var et=mv();H(et,"dx",0),H(et,"dy",0);var jt=j(et);Mt(jt,()=>r(de).label,!0),ae(()=>{H(et,"x",r(ne)),H(et,"y",r(q)+r(O))}),T(it,et)};Y(Re,it=>{r(de).show&&r(de).label&&r(de).label!==""&&it(Ve)})}var wt=z(Re);{var _r=it=>{var et=hv();H(et,"dx",0),H(et,"dy",0);var jt=j(et);Mt(jt,()=>r(ce).label,!0),ae(()=>{H(et,"x",r(N)/1.1*r(ce).labelHeight),H(et,"y",r($)),H(et,"transform",`rotate(-90, ${r(N)*r(ce).labelHeight/1.1}, ${r($)})`)}),T(it,et)};Y(wt,it=>{r(ce).show&&r(ce).label&&r(ce).label!==""&&it(_r)})}var Dt=z(wt);{var Gt=it=>{var et=gv();H(et,"dx",0),H(et,"dy",0);var jt=j(et);Mt(jt,()=>r(pe),!0),ae(()=>{H(et,"x",r(ne)),H(et,"y",r(N)*r(Me))}),T(it,et)};Y(Dt,it=>{r(pe)&&r(pe)!==""&&it(Gt)})}T(Se,qe)};Y(Pe,Se=>{r(K)&&Se(We)})}var Ae=z(Pe),Te=j(Ae),Oe=j(Te),Ee=j(Oe),Be=z(Te);{var Fe=Se=>{var qe=Ev(),Re=J(qe);{var Ve=st=>{var Ie=bv(),Pt=j(Ie);t(Pt,()=>r(le),()=>r(de)),T(st,Ie)};Y(Re,st=>{r(de).show&&r(le)&&st(Ve)})}var wt=z(Re);{var _r=st=>{var Ie=_v(),Pt=j(Ie);t(Pt,()=>r(ve),()=>r(ce)),T(st,Ie)};Y(wt,st=>{r(ce).show&&r(ve)&&st(_r)})}var Dt=z(wt),Gt=j(Dt);{var it=st=>{var Ie=wv();Ie.__keydown=[ns,S,p],Ie.__click=[ns,S,p],Ie.__mousemove=[Wi,S,_],Ie.__mousedown=[Vi,S,b],Ie.__mouseup=[Yi,S,y],ae(()=>{H(Ie,"stroke",r(Le).lineColor),H(Ie,"stroke-width",`${r(Le).lineWidth??""}px`),H(Ie,"x",r(ee)[0]),H(Ie,"y",r(se)[1]),H(Ie,"width",r(ee)[1]-r(ee)[0]),H(Ie,"height",r(se)[0]-r(se)[1])}),T(st,Ie)},et=st=>{var Ie=yv();Ie.__keydown=[ns,S,p],Ie.__click=[ns,S,p],Ie.__mousemove=[Wi,S,_],Ie.__mousedown=[Vi,S,b],Ie.__mouseup=[Yi,S,y],ae(()=>{H(Ie,"x",r(ee)[0]),H(Ie,"y",r(se)[1]),H(Ie,"width",r(ee)[1]-r(ee)[0]),H(Ie,"height",r(se)[0]-r(se)[1])}),T(st,Ie)};Y(Gt,st=>{r(Le).show?st(it):st(et,!1)})}var jt=z(Dt),Ct=j(jt);Rr(Ct,()=>e.children??kt);var yt=z(jt);{var dt=st=>{var Ie=xv(),Pt=j(Ie);rv(Pt,()=>r(ye),()=>r(oe)),T(st,Ie)};Y(yt,st=>{r(oe)&&st(dt)})}var fr=z(yt);{var nn=st=>{var Ie=kv(),Pt=j(Ie);s(Pt,()=>r(fe),()=>r(xe)),T(st,Ie)};Y(fr,st=>{r(xe)&&st(nn)})}ae(()=>H(jt,"clip-path",`url(#${E})`)),T(Se,qe)};Y(Be,Se=>{r(K)&&Se(Fe)})}_n(je,Se=>B(k,Se),()=>r(k));var rr=z(je,2);{var qr=Se=>{var qe=Cv();T(Se,qe)},Fr=Se=>{var qe=Sv(),Re=j(qe);Re.__click=[Hi,k,u],Re.__keydown=[Hi,k,u];var Ve=z(Re,2);Ve.__click=[Gi,k,u,f,v,m],Ve.__keydown=[Gi,k,u,f,v,m];var wt=z(Ve,2);wt.__click=[Ui,k,g,h],wt.__keydown=[Ui,k,g,h],T(Se,qe)};Y(rr,Se=>{r(K)?Se(Fr,!1):Se(qr)})}ae(Se=>{ge=pt(ke,1,`plot-container show-download-links-${d()??""}`,"svelte-1jtdxd0",ge,Se),bt(je,`font-size:${r(N)??""}px`),H(Ae,"x",r(U)),H(Ae,"y",r(O)),H(Ae,"width",r(R)),H(Ae,"height",r(q)),H(Oe,"id",E),H(Ee,"x",r(ee)[0]),H(Ee,"y",r(se)[1]),H(Ee,"width",r(ee)[1]-r(ee)[0]),H(Ee,"height",r(se)[0]-r(se)[1])},[()=>({"plot-error":!r(K)})]),Oo(je,"clientWidth",Se=>B(C,Se)),Oo(je,"clientHeight",Se=>B(A,Se)),T(l,ke),_e()}mt(["keydown","click","mousemove","mousedown","mouseup"]);function Ki(l,e){be(e,!0);let t=V(e,"tickLabels",7),s=V(e,"las",3,1),a=V(e,"whole",3,!1),o=V(e,"show",3,!0),c=V(e,"showGrid",3,!1);const d=Vt("axes");ue(()=>{const u=Qr(e.label),f=u?u.length===e.label.length?1:1.4:0;let v,m="";e.ticks&&([v,m]=Oi(e.ticks,d.limX())),!m&&t()&&(g=>{var h=gs(g,2);t(h[0]),m=h[1]})(Fi(t(),v)),d.setXAxis({show:o(),error:m,label:u,ticks:v,labelHeight:f,showGrid:c(),las:s(),whole:a(),tickLabels:t()})}),_e()}function Ji(l,e){be(e,!0);let t=V(e,"tickLabels",7),s=V(e,"las",3,1),a=V(e,"whole",3,!1),o=V(e,"show",3,!0),c=V(e,"showGrid",3,!1);const d=Vt("axes");ue(()=>{const u=Qr(e.label),f=u?u.length===e.label.length?1:1.4:0;let v,m="";e.ticks&&([v,m]=Oi(e.ticks,d.limY())),!m&&t()&&(g=>{var h=gs(g,2);t(h[0]),m=h[1]})(Fi(t(),v)),d.setYAxis({show:o(),error:m,label:u,ticks:v,labelHeight:f,showGrid:c(),las:s(),whole:a(),tickLabels:t(),pos:4})}),_e()}function Qi(l,e){be(e,!0);let t=V(e,"lineWidth",3,1),s=V(e,"lineColor",3,"#606060");const a=Vt("axes");ue(()=>{a.setBox({show:!0,lineWidth:t(),lineColor:s()})}),_e()}var Nv=(l,e)=>En(l,"rect",e.onclick),Mv=Ne("<rect></rect>"),Tv=Ne("<g></g>");function cl(l,e){be(e,!0);let t=V(e,"faceColor",19,()=>It.PRIMARY),s=V(e,"lineColor",19,t),a=V(e,"lineWidth",3,1),o=V(e,"className",3,"series-rect");const c=w(()=>Bt(e.left,"Rectangles (left)")),d=w(()=>r(c)?Bt(e.top,"Rectangles (top)",r(c).length):null),u=w(()=>r(d)?typeof e.width!="object"?ze.fill(e.width,r(c).length):e.width:null),f=w(()=>r(d)?typeof e.height!="object"?ze.fill(e.height,r(c).length):e.height:null),v=Vt("axes"),m=w(()=>r(c)?_t(r(c),v.tX()):null),g=w(()=>r(d)?_t(r(d),v.tY()):null),h=w(()=>r(u)?va(r(u),v.tX()):null),p=w(()=>r(f)?va(r(f),v.tY()):null),_=w(()=>`fill:${t()};stroke:${s()};stroke-width:${a()}px;`),b=w(()=>r(m)&&r(g)&&r(h)&&r(p)&&r(h).length===r(m).length&&r(p).length===r(m).length);var y=he(),S=J(y);{var E=k=>{var C=Tv();C.__click=[Nv,e],Xe(C,21,()=>e.left,Qe,(A,P,M)=>{var N=Mv();ae(()=>{H(N,"x",r(m)[M]),H(N,"y",r(g)[M]),H(N,"width",r(h)[M]),H(N,"height",r(p)[M])}),T(A,N)}),ae(()=>{pt(C,0,`series ${o()??""}`),bt(C,r(_))}),T(k,C)};Y(S,k=>{r(b)&&k(E)})}T(l,y),_e()}mt(["click"]);var Pv=(l,e)=>En(l,"line",e.onclick),zv=Ne("<line></line>"),Lv=Ne('<g class="series series-segment"></g>');function pr(l,e){be(e,!0);let t=V(e,"lineColor",19,()=>It.PRIMARY),s=V(e,"lineType",3,1),a=V(e,"lineWidth",3,1);const o=w(()=>Bt(e.xStart,"Segments")),c=w(()=>r(o)?Bt(e.yStart,"Segments",r(o).length):null),d=w(()=>r(c)?Bt(e.xEnd,"Segments",r(o).length):null),u=w(()=>r(d)?Bt(e.yEnd,"Segments",r(o).length):null),f=Vt("axes"),v=w(()=>r(o)?_t(r(o),f.tX()):null),m=w(()=>r(d)?_t(r(d),f.tX()):null),g=w(()=>r(c)?_t(r(c),f.tY()):null),h=w(()=>r(u)?_t(r(u),f.tY()):null),p=w(()=>`stroke:${t()};stroke-width: ${a()}px;stroke-dasharray:${il[f.scales().plot][s()-1]}`),_=w(()=>r(v)&&r(m)&&r(g)&&r(h));var b=he(),y=J(b);{var S=E=>{var k=Lv();k.__click=[Pv,e],Xe(k,21,()=>r(v),Qe,(C,A,P)=>{var M=zv();ae(()=>{H(M,"x1",r(v)[P]),H(M,"x2",r(m)[P]),H(M,"y1",r(g)[P]),H(M,"y2",r(h)[P])}),T(C,M)}),ae(()=>bt(k,r(p))),T(E,k)};Y(y,E=>{r(_)&&E(S)})}T(l,b),_e()}mt(["click"]);var Rv=(l,e)=>En(l,"text",e.onclick),Iv=Ne("<text><!></text>"),jv=Ne("<text><!></text>"),qv=Ne("<text><!></text>"),Fv=Ne('<g class="series series-textlabels"><!></g>');function ls(l,e){be(e,!0);let t=V(e,"pos",3,0),s=V(e,"faceColor",19,()=>It.PRIMARY_TEXT),a=V(e,"lineColor",3,"transparent"),o=V(e,"lineWidth",3,0),c=V(e,"textSize",3,1),d=V(e,"rotateAngle",3,0);const u=["middle","middle","start","middle","end"],f=w(()=>Bt(e.xValues,"TextLabels")),v=w(()=>r(f)?Bt(e.yValues,"TextLabels",r(f).length):null),m=w(()=>r(v)?Array.isArray(e.labels)&&e.labels.length!==r(v).length?(console.error('TextLabels: number of elements in "labels" does not match number of coordinates'),null):e.labels:null),g=w(()=>r(m)?typeof e.labels=="string"&&typeof t()!="number"?(console.error('TextLabels: parameter "labels" is provided as single string, so "pos" must be a single number.'),null):t():null),h=Vt("axes"),p=w(()=>r(f)&&r(g)!==null?_t(r(f),h.tX()):null),_=w(()=>r(v)&&r(p)?_t(r(v),h.tY()):null),b=w(()=>da[h.scales().plot]),y=w(()=>[0,0,-r(b),0,r(b),r(b)]),S=w(()=>[0,r(b),0,-r(b),0,r(b)]),E=w(()=>`fill:${s()};stroke-width:${o()}px;stroke:${a()};font-size:${c()}em;`),k=w(()=>r(p)&&r(_)&&r(g)!==null&&r(m)&&r(p).length===r(_).length);var C=he(),A=J(C);{var P=M=>{var N=Fv();N.__click=[Rv,e];var I=j(N);{var L=U=>{var O=he(),R=J(O);Xe(R,17,()=>r(p),Qe,(q,W,D)=>{var K=Iv();H(K,"data-id",D);var Z=j(K);Mt(Z,()=>e.labels,!0),ae(()=>{H(K,"x",r(p)[D]),H(K,"y",r(_)[D]),H(K,"dx",r(y)[t()]),H(K,"dy",r(S)[t()]),H(K,"transform",d()!==void 0?`rotate(${d()}, ${r(p)[D]+r(y)[t()]}, ${r(_)[D]+r(S)[t()]})`:""),H(K,"text-anchor",u[t()[D]])}),T(q,K)}),T(U,O)},F=U=>{var O=he(),R=J(O);{var q=D=>{var K=he(),Z=J(K);Xe(Z,17,()=>r(p),Qe,(G,$,ne)=>{var ee=jv();H(ee,"data-id",ne);var se=j(ee);Mt(se,()=>e.labels[ne],!0),ae(()=>{H(ee,"x",r(p)[ne]),H(ee,"y",r(_)[ne]),H(ee,"dx",r(y)[t()[ne]]),H(ee,"dy",r(S)[t()[ne]]),H(ee,"transform",d()!==void 0?`rotate(${d()}, ${r(p)[ne]+r(y)[t()]}, ${r(_)[ne]+r(S)[t()]})`:""),H(ee,"text-anchor",u[t()[ne]])}),T(G,ee)}),T(D,K)},W=D=>{var K=he(),Z=J(K);Xe(Z,17,()=>r(p),Qe,(G,$,ne)=>{var ee=qv();H(ee,"data-id",ne);var se=j(ee);Mt(se,()=>e.labels[ne],!0),ae(()=>{H(ee,"x",r(p)[ne]),H(ee,"y",r(_)[ne]),H(ee,"dx",r(y)[t()]),H(ee,"dy",r(S)[t()]),H(ee,"transform",d()!==void 0?`rotate(${d()}, ${r(p)[ne]+r(y)[t()]}, ${r(_)[ne]+r(S)[t()]})`:""),H(ee,"text-anchor",u[t()])}),T(G,ee)}),T(D,K)};Y(R,D=>{Array.isArray(t())||ArrayBuffer.isView(t())?D(q):D(W,!1)},!0)}T(U,O)};Y(I,U=>{typeof e.labels=="string"?U(L):U(F,!1)})}ae(()=>bt(N,r(E))),T(M,N)};Y(A,M=>{r(k)&&M(P)})}T(l,C),_e()}mt(["click"]),mt(["click"]);var Ov=(l,e)=>En(l,"text",e.onclick),Bv=Ne("<text> </text>"),Dv=Ne('<g text-anchor="middle"></g>');function Zi(l,e){be(e,!0);let t=V(e,"marker",3,1),s=V(e,"faceColor",3,"transparent"),a=V(e,"lineColor",19,()=>It.PRIMARY),o=V(e,"lineWidth",3,1),c=V(e,"markerSize",3,1);const d=w(()=>typeof t()!="number"||t()<1||t()>Bn.length?(console.error('Points: parameter "marker" must be a number from 1 to '+Bn.length+"."),null):Bn[t()-1]),u=w(()=>Bt(e.xValues,"Points")),f=w(()=>r(u)?Bt(e.yValues,"Points",r(u).length):null),v=Vt("axes"),m=w(()=>r(u)?_t(r(u),v.tX()):null),g=w(()=>r(m)&&r(f)?_t(r(f),v.tY()):null),h=w(()=>["＋","✳","✕"].includes(r(d))?`fill:${a()&&a()!=="transparent"?a():s()};stroke-width:0px;font-size:${c()}em;`:`fill:${s()};stroke-width:${o()}px;stroke:${a()}; font-size:${c()}em;`),p=w(()=>["◼","⬥","＋","✳","✕"].includes(r(d))?"series-points2":"series-points1"),_=w(()=>r(m)&&r(g)&&r(m).length===r(g).length);var b=he(),y=J(b);{var S=E=>{var k=Dv();k.__click=[Ov,e],Xe(k,21,()=>r(m),Qe,(C,A,P)=>{var M=Bv(),N=j(M);ae(()=>{H(M,"x",r(m)[P]),H(M,"y",r(g)[P]),me(N,r(d))}),T(C,M)}),ae(()=>{pt(k,0,`series series-points ${r(p)??""}`),bt(k,r(h))}),T(E,k)};Y(y,E=>{r(_)&&E(S)})}T(l,b),_e()}mt(["click"]);var Vv=(l,e)=>En(l,"polyline",e.onclick),Yv=Ne('<g class="series series-line"><polyline class="line"></polyline></g>');function Ut(l,e){be(e,!0);let t=V(e,"lineColor",19,()=>It.PRIMARY),s=V(e,"lineType",3,1),a=V(e,"lineWidth",3,1);const o=w(()=>Bt(e.xValues,"Lines")),c=w(()=>r(o)?Bt(e.yValues,"Lines",r(o).length):null),d=Vt("axes"),u=w(()=>r(o)&&r(c)?ga(r(o),r(c),d.tX(),d.tY()):null),f=w(()=>`fill:transparent;stroke:${t()};stroke-width: ${a()}px; stroke-dasharray:${il[d.scales().plot][s()-1]}`);var v=he(),m=J(v);{var g=h=>{var p=Yv();p.__click=[Vv,e];var _=j(p);ae(()=>{bt(p,r(f)),H(_,"points",r(u))}),T(h,p)};Y(m,h=>{r(u)&&h(g)})}T(l,v),_e()}mt(["click"]);var Wv=(l,e)=>En(l,"polyline",e.onclick),Uv=Ne('<polyline class="line"></polyline>'),Hv=Ne('<g class="series series-multiline"></g>');function $i(l,e){be(e,!0);let t=V(e,"lineColor",19,()=>It.PRIMARY),s=V(e,"lineType",3,1),a=V(e,"lineWidth",3,1);const o=w(()=>Bt(e.xValues,"Multilines")),c=w(()=>r(o)?mr(e.yValues)?(r(o).length!==e.yValues.nrows&&console.error('Multilines: parameter "xValues" must have the same number of values as number of rows in "yValues".'),e.yValues):(console.error('Multilines: parameter "yValues" must be a matrix.'),null):null),d=Vt("axes"),u=w(()=>{if(!r(o)||!r(c))return null;const h=new Array(r(c).ncols);for(let p=0;p<h.length;p++)h[p]=ga(r(o),r(c).getcolumn(p+1),d.tX(),d.tY());return h}),f=w(()=>`fill:transparent;stroke:${t()};stroke-width: ${a()}px; stroke-dasharray:${il[d.scales().plot][s()-1]}`);var v=he(),m=J(v);{var g=h=>{var p=Hv();p.__click=[Wv,e],Xe(p,21,()=>r(u),Qe,(_,b)=>{var y=Uv();ae(()=>H(y,"points",r(b))),T(_,y)}),ae(()=>bt(p,r(f))),T(h,p)};Y(m,h=>{r(u)&&r(u).length>0&&h(g)})}T(l,v),_e()}mt(["click"]);function Dn(l,e){be(e,!0);let t=V(e,"show",3,!0),s=V(e,"position",3,"topleft"),a=V(e,"lineColor",19,()=>It.LEGEND),o=V(e,"lineWidth",3,1),c=V(e,"faceColor",3,"#fff"),d=V(e,"fontSize",3,.85);function u(m){return typeof m!="string"?(console.error('Legend: value of "position" must be a string.'),null):["top","left","right","topleft","topright","bottom","bottomleft","bottomright"].includes(m)?m:(console.error('Legend: wrong value of "position" property'),null)}function f(m){if(!m||!Array.isArray(m)||m.length<1)return console.error('Legend: property "items" must be provided as array of JSONs.'),null;for(let g=0;g<m.length;g++){const h=m[g];if(!h.label)return console.error('Legend: all elements of "items" must include at least one field: "label".'),null;const p=Qr(h.label),_=p.length===h.label?1:1.4;h.label=p,h.labelHeight=_,h.line&&(h.line.lineType||(h.line.lineType=1),h.line.lineType>0&&h.line.lineType<=4||console.error('Legend: parameter "lineType" for legend item '+(g+1)+" is incorrect."),h.line.lineColor=h.line.lineColor?h.line.lineColor:It.PRIMARY,h.line.lineWidth=h.line.lineWidth?h.line.lineWidth:1),h.point&&(h.point.marker||(h.point.marker=1),h.point.marker>0&&h.point.marker<=Bn.length||console.error('Legend: parameter "marker" for legend item '+(g+1)+" is incorrect."),h.point.faceColor=h.point.faceColor?h.point.faceColor:"transparent",h.point.lineWidth=h.point.lineWidth?h.point.lineWidth:1,h.point.markerSize=h.point.markerSize?h.point.markerSize:1,h.point.lineColor=h.point.lineColor?h.point.lineColor:It.PRIMARY)}return m}const v=Vt("axes");ue(()=>{const m=f(e.items),g=u(s());v.setGroupLegend(m&&g?{show:t(),position:s(),items:e.items,lineColor:a(),faceColor:c(),lineWidth:o(),fontSize:d()}:{show:!1,position:null,items:null})}),_e()}function ss(l,e){be(e,!0);let t=V(e,"show",3,!0),s=V(e,"labels",3,null),a=V(e,"labelColor",19,()=>It.CLEGEND_LABELS),o=V(e,"fontSize",3,.85);const c=Vt("axes");ue(()=>{c.setColmapLegend({show:t(),breaks:e.breaks,colmap:e.colmap,labels:s(),labelColor:a(),fontSize:o()})}),_e()}const Gv=l=>l;function ec(l,{delay:e=0,duration:t=400,easing:s=Gv}={}){const a=+getComputedStyle(l).opacity;return{delay:e,duration:t,easing:s,css:o=>`opacity: ${o*a}`}}var Xv=X('<div><div class="modal svelte-q7wo60"><div class="header svelte-q7wo60"><button class="close-button svelte-q7wo60">✕</button></div> <div class="body svelte-q7wo60"><!></div></div></div>');function wa(l,e){be(e,!0);let t=V(e,"isDark",3,!1);function s(m){m.key==="Escape"&&e.closeModal()}var a=Xv();gn("keydown",Ts,s);let o;var c=j(a),d=j(c),u=j(d);u.__click=function(...m){var g;(g=e.closeModal)==null||g.apply(this,m)};var f=z(d,2),v=j(f);Rr(v,()=>e.children),ae(m=>o=pt(a,1,"drop svelte-q7wo60",null,o,m),[()=>({isdark:t()})]),Fo(7,a,()=>ec),T(l,a),_e()}mt(["click"]);const Kv=[1,1.1,.45,.4],Zr={regular:"#2679B2",extreme:"#F2B825",outlier:"#D22C2F",alien:"#2679B2",external:"#D22C2F"},Ht={cal:1,pv:2,test:2,new:2},At={cal:"#2679B2",pv:"#D22C2F",test:"#a05e5e",new:"#5e85a0"},ya={cal:"#f0f8ff",pv:"#f4e5e5",test:"#fff0f8",new:"#f0f8ff"},$r={cal:"#2679B230",pv:"#D22C2F30",test:"#f05e5e30",new:"#5e85a030"},tc="#808090",rc="#a0a0a0",nc="#909090",as="#909090",ul=8,Jv=8,Qv=8,Zv=600;function lc(l,e){return!l||!e||e<0||e>l.ncomp?"":`PC${e} (${(l.stat.expvar[e-1]*100).toFixed(1)}%)`}function $v(l,e){if(l.length===e.length)return l;const t=e.length,s=new l.constructor(t);for(let a in e)s[a]=l[e[a]];return s}function e1(l,e){let t=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY;for(let c=0;c<l.length;c++)s=Math.min(s,l[c]),t=Math.max(t,l[c]);let a=pa(void 0,[s,t],e-1,!0,!1,0).v;const o=a[1]-a[0];if(a[0]>s){const c=a[0]-o;a=[c<s?c:s,...a]}if(a[a.length-1]<t){const c=a[a.length-1]+o;a=[...a,c>t?c:t]}return a}function t1(l){const e=l.length;if(e<1||e>16)throw Error("getClassColors: can not create color map for more than 16 categories.");const t=rs(e);return l.reduce((a,o,c)=>(a[o]=t[c],a),{})}function sc(l,e,t){const s=e.length,a=new Array(l.length),o=e[1]-e[0];for(let c=0;c<l.length;c++)for(let d=0;d<s-1;d++){const u=l[c]>=e[d],f=d===s-2?l[c]<e[d+1]+o:l[c]<e[d+1];if(u&&f){a[c]=t[d];break}}return a}function os(l,e,t,s,a="cal",o){if(!e)return null;let c,d,u,f,v,m,g=!0;if((t==="groups"||t==="classes")&&e.classNames){const h=t1(e.classNames);d=Object.keys(h).map(p=>h[p]),c=e.classNames,f=e.classes.map(p=>h[p]),u=new Array(c.length+1).map((p,_)=>_-.5),v=null}else if(t==="variable"){const h=$v(l.values.getcolref(s),e.objindices);v=l.varlabels[s-1],v.length>30&&(v=v.substring(0,29)+"..."),u=e1(h,10),d=rs(u.length-1),f=sc(h,u,d)}else if(o){const h=o.values;c=o.labels;const p=o.classColmap;d=Object.keys(p).map(_=>p[_]),f=h.map(_=>p[_]),u=new Array(c.length+1).map((_,b)=>b-.5),v=null,o.filled&&o.filled.length===h.length&&(m=o.filled),o.showBar!==void 0&&(g=o.showBar)}else c=null,u=null,d=null,f=Array(e.nrows).fill(At[a]);return{labels:c,map:d,breaks:u,colors:f,varname:v,filled:m,showBar:g,mainColor:At[a],faceColor:ya[a],faceTColor:$r[a]}}function r1(l,e,t=.95){const a=2*Math.PI/99,[o,c,d]=l,u=Math.sqrt((o+d)**2-4*(o*d-c*c));let f=.5*(o+d-u),v=.5*(o+d+u);if(f<v){let P=f;f=v,v=P}const m=ir(t,2),g=Math.sqrt(m*f),h=Math.sqrt(m*v);let p;if(Math.abs(c)<1e-7)p=0;else{let P=-c/(o-f),M=1;const N=Math.sqrt(P*P+M*M);P=P/N,M=M/N,p=Math.atan2(M,P),p<0&&(p=p+2*Math.PI)}const _=Math.cos(p),b=Math.sin(p),y=ze.zeros(100),S=ze.zeros(100);let E=Number.POSITIVE_INFINITY,k=Number.NEGATIVE_INFINITY,C=Number.POSITIVE_INFINITY,A=Number.NEGATIVE_INFINITY;for(let P=0;P<100;P++){const M=P*a,N=g*Math.cos(M),I=h*Math.sin(M),L=N*_-I*b+e[0],F=N*b+I*_+e[1];y.v[P]=L,S.v[P]=F,E=Math.min(E,L),k=Math.max(k,L),C=Math.min(C,F),A=Math.max(A,F)}return[y,S,E,k,C,A]}function n1(l,e,t,s,a,o){if(!l||!e||!t||!s||!a)return null;const c=l.length,d=s.length,u=new Array(d).fill(0),f=new Array(d*2).fill(0);for(let b=0;b<c;b++){const y=s.indexOf(t[b]);u[y]+=1,f[y*2]+=l.v[b],f[y*2+1]+=e.v[b]}for(let b=0;b<d;b++)f[b*2]=f[b*2]/u[b],f[b*2+1]=f[b*2+1]/u[b];const v=new Array(d*3).fill(0);for(let b=0;b<c;b++){const y=s.indexOf(t[b]),S=l.v[b]-f[y*2],E=e.v[b]-f[y*2+1];v[y*3]+=S*S,v[y*3+1]+=S*E,v[y*3+2]+=E*E}let m=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,h=Number.POSITIVE_INFINITY,p=Number.NEGATIVE_INFINITY;const _=Array(d);for(let b=0;b<d;b++){const[y,S,E,k,C,A]=r1([v[b*3]/(u[b]-1),v[b*3+1]/(u[b]-1),v[b*3+2]/(u[b]-1)],[f[b*2],f[b*2+1]],o);_[b]={x:y,y:S,c:a[b]},m=Math.min(m,E),g=Math.max(g,k),h=Math.min(h,C),p=Math.max(p,A)}return{ellipses:_,xRange:[m,g],yRange:[h,p]}}function l1(l){const e=l.charAt(0),t=l.substring(1);return e.toUpperCase()+t}function ac(l,e,t,s){if(!l||!e)return null;const a=l.length;let o=ze.zeros(a),c=Number.NEGATIVE_INFINITY,d=Number.POSITIVE_INFINITY;if(s==="log")for(let u=0;u<a;u++){const f=Math.log(1+l[u]/t);o.v[u]=f,c=Math.max(c,f),d=Math.min(d,f)}else for(let u=0;u<a;u++){const f=l[u]/t;o.v[u]=f,c=Math.max(c,f),d=Math.min(d,f)}return{values:o,min:d,max:c}}function oc(l,e){return{z:"Full y-distance",f:"Full x-distance",q:"Orthogonal distance",h:"Score distance"}[l]+", "+(e==="log"?"log(1 + "+l+"/"+l+"0)":l+"/"+l+"0")}function ic(l,e,t,s){const o=e+t,d=ir(l,o)/t,u=-e/t,f=-d/u,v=ze.seq(0,f*1,f/100),m=v.apply(g=>g*u+d);return{x:s==="log"?v.apply(g=>Math.log(1+g)):v,y:s==="log"?m.apply(g=>Math.log(1+g)):m}}function s1(l,e=$r){return l?l.map(t=>({id:t,label:t,point:{marker:Ht[t],faceColor:e[t],lineColor:At[t],markerSize:Ht[t]===1?.85:.65,lineWidth:1.5}})):null}var a1=X("<!> <!> <!> <!>",1);function Pr(l,e){let t=V(e,"whole",3,!1),s=wn(e,["$$slots","$$events","$$legacy","title","limX","limY","xLabel","yLabel","whole","fileName","children"]);Xi(l,Zt({get title(){return e.title},get limX(){return e.limX},get limY(){return e.limY},get fileName(){return e.fileName},downloadLinks:"hover",get margins(){return Kv},get pngWidth(){return Jv},get pngHeight(){return Qv},get pngRes(){return Zv}},()=>s,{children:(a,o)=>{var c=a1(),d=J(c);Rr(d,()=>e.children);var u=z(d,2);Ki(u,{showGrid:!0,get label(){return e.xLabel},get whole(){return t()}});var f=z(u,2);Ji(f,{showGrid:!0,get label(){return e.yLabel}});var v=z(f,2);Qi(v,{}),T(a,c)},$$slots:{default:!0}}))}function o1(l,e){if(l.target.tagName!=="rect"){B(e,-1);return}const t=Array.from(l.target.parentNode.children).indexOf(l.target);if(t<0){B(e,-1);return}r(e)!==t&&B(e,t,!0)}var i1=X("<!> <!> <!>",1),c1=X("<!> <!> <!> <!> <!>",1),u1=X("<div><!></div>"),f1=X('<div class="wrapper svelte-ha02r1"><div class="plot-container svelte-ha02r1" role="tooltip"><!></div> <div class="msg-select svelte-ha02r1">click inside the plot to see a variable label</div> <div class="plot-controls svelte-ha02r1"><div><!></div> <!></div></div>');function xa(l,e){be(e,!0);let t=V(e,"outliers",19,()=>[]),s=V(e,"model_getter",3,nt),a=V(e,"res_getter",3,er),o=re("residual"),c=re(-1);const d=w(()=>e.res?Object.keys(e.res):null);let u=re(De(r(d)?r(d)[0]:null));const f=w(()=>{if(!e.model)return null;const Z=e.model.nresp?e.model.nresp:0,G=ct(e.model.varvalues.filter((Le,de)=>de>=Z)),$=G.length,ne=(G.v[1]-G.v[0])/2,ee=(G.v[$-1]-G.v[$-2])/2,se=[G.v[0],G.v[$-1]],pe=[se[0]-ne,se[1]+ee],Me=(se[1]-se[0])/$;return{values:G,lim:pe,width:Me,hwidth:Me*.5}}),v=w(()=>r(f)?r(f).values.apply(Z=>Z-r(f).hwidth):null),m=w(()=>r(u)?e.res[r(u)]:null),g=w(()=>r(m)?new Lt(a()(r(m),"T"),r(m).nrows,r(m).ncomp):null),h=w(()=>r(m)?new Lt(a()(r(m),"E"),r(m).nrows,r(m).npred).t():null),p=w(()=>e.model?new Lt(s()(e.model,"P"),e.model.npred?e.model.npred:e.model.ncols,e.model.ncomp):null),_=w(()=>e.ncomp?Tt.seq(1,e.ncomp):null),b=w(()=>e.ncomp<e.model.ncomp?Tt.seq(e.ncomp+1,e.model.ncomp):null),y=w(()=>r(g)&&r(_)?r(g).subset(null,r(_)):null),S=w(()=>r(g)&&r(_)?r(p).subset(null,r(_)):null),E=w(()=>r(g)&&r(b)?r(g).subset(null,r(b)):null),k=w(()=>r(g)&&r(b)?r(p).subset(null,r(b)):null),C=w(()=>r(y)&&r(S)?si(r(S),r(y)):null),A=w(()=>r(E)&&r(k)?si(r(k),r(E)).add(r(h)):r(h)),P=w(()=>r(C)&&r(A)?r(C).add(r(A)):null);let M=w(()=>r(C)?r(C).getcolumn(e.selected+1):null),N=w(()=>r(A)?r(A).getcolumn(e.selected+1):null),I=w(()=>r(P)?r(P).getcolumn(e.selected+1):null),L=w(()=>{if(!r(M)||!r(N)||!r(I))return null;const Z=r(o)==="explained"?{all:r(C),sel:r(M),label:"Explained part, TP^T"}:r(o)==="residual"?{all:r(A),sel:r(N),label:"Residuals, E"}:{all:r(P),sel:r(I),label:"Preprocessed data, X"},G=jr(Z.all.v),$=G[1]-G[0],ne=[G[0]-$/50,G[1]+$/12],ee=ze.fill(G[1],Z.sel.length);return Z.lim=ne,Z.top=ee,Z.height=$,Z});const F=w(()=>r(f)&&r(c)>=0?r(f).values.v[r(c)]:null),U=w(()=>r(L)&&r(c)>=0?r(L).sel.v[r(c)]:null),O=w(()=>e.model&&r(c)>=0?e.model.varlabels[r(c)]:null),R=w(()=>r(m)&&e.selected>=0?`Object ${r(m).objlabels[e.selected].replace("_","-")}`:null),q=w(()=>e.model?e.model.varvaluesName+(e.model.varvaluesUnits?", "+e.model.varvaluesUnits:""):null);var W=he(),D=J(W);{var K=Z=>{wa(Z,{get closeModal(){return e.closeModal},children:(G,$)=>{var ne=f1(),ee=j(ne);ee.__click=[o1,c];var se=j(ee);Pr(se,{get title(){return r(R)},get yLabel(){return r(L).label},get xLabel(){return r(q)},get limY(){return r(L).lim},get limX(){return r(f).lim},fileName:"plot-contributions",children:(Ce,fe)=>{var ye=c1(),le=J(ye);$i(le,{get xValues(){return r(f).values},get yValues(){return r(L).all},lineColor:"#e0e0e0"});var ve=z(le,2);{var oe=Pe=>{var We=he(),Ae=J(We);Xe(Ae,17,t,Qe,(Te,Oe)=>{{let Ee=w(()=>r(L).all.getcolumn(r(Oe)+1));Ut(Te,{get xValues(){return r(f).values},get yValues(){return r(Ee)},lineColor:"#ffdd88"})}}),T(Pe,We)};Y(ve,Pe=>{t().length>0&&Pe(oe)})}var xe=z(ve,2);Ut(xe,{get xValues(){return r(f).values},get yValues(){return r(L).sel},lineColor:"crimson"});var ke=z(xe,2);cl(ke,{get left(){return r(v)},get top(){return r(L).top},get height(){return r(L).height},get width(){return r(f).width},faceColor:"transparent",borderColor:"transparent"});var ge=z(ke,2);{var je=Pe=>{var We=i1(),Ae=J(We);{let Ee=w(()=>[r(F)]),Be=w(()=>[r(L).top.v[0]]),Fe=w(()=>[r(O)]);ls(Ae,{get xValues(){return r(Ee)},get yValues(){return r(Be)},get labels(){return r(Fe)},pos:3,textSize:.85})}var Te=z(Ae,2);{let Ee=w(()=>[r(F)]),Be=w(()=>[r(U)]);Zi(Te,{get xValues(){return r(Ee)},get yValues(){return r(Be)},faceColor:"crimson",lineColor:"crimson"})}var Oe=z(Te,2);{let Ee=w(()=>[r(v).v[r(c)]]),Be=w(()=>[r(L).top.v[r(c)]]);cl(Oe,{get left(){return r(Ee)},get top(){return r(Be)},get height(){return r(L).height},get width(){return r(f).width},faceColor:"#ff000015"})}T(Pe,We)};Y(ge,Pe=>{r(c)>=0&&Pe(je)})}T(Ce,ye)},$$slots:{default:!0}});var pe=z(ee,4),Me=j(pe),Le=j(Me);ie(Le,{label:"Show",children:(Ce,fe)=>{Ke(Ce,{id:"type",options:["full","explained","residual"],get value(){return r(o)},set value(ye){B(o,ye,!0)}})},$$slots:{default:!0}});var de=z(Me,2);{var ce=Ce=>{var fe=u1(),ye=j(fe);ie(ye,{label:"For",children:(le,ve)=>{Ke(le,{id:"type",get options(){return r(d)},get value(){return r(u)},set value(oe){B(u,oe,!0)}})},$$slots:{default:!0}}),T(Ce,fe)};Y(de,Ce=>{r(d).length>1&&Ce(ce)})}T(G,ne)},$$slots:{default:!0}})};Y(D,Z=>{r(f)&&r(L)&&Z(K)})}T(l,W),_e()}mt(["click"]);function d1(l,e){let t=0,s=0;l.nresp>0&&(t=new ze(l.values.v.slice(0,l.values.nrows)),s=1);const a=new Lt(l.values.v.slice(s*l.values.nrows),l.values.nrows,l.values.ncols-s).t(),o=a.ncols<e?1:Math.round(a.ncols/e),c=Tt.seq(1,a.ncols,o),d=a.subset(null,c),u=t?t.subset(c):null,f=l.classes?l.classes.filter((v,m)=>c.v.includes(m)):null;return{classNames:l.classNames,classes:f,resp:u,values:d,varvalues:l.varvalues.filter((v,m)=>m>=s),varindices:l.varindices.filter((v,m)=>m>=s),varaxisLabel:l.varvaluesUnits?l.varvaluesName+" "+l.varvaluesUnits:l.varvaluesName,varaxisUnits:l.varvaluesUnits}}function ka(l,e){return{values:e||l.values.copy(),varvalues:l.varvalues,varindices:l.varindices,varaxisLabel:l.varaxisLabel}}function v1(l,e){if(!e||e.nrows!==l.values.nrows||e.ncols!==l.values.ncols)throw new Error("Object with values seems to be wrong for cloning.");const t=structuredClone(l);return t.values=e,t}var m1=X('<span class="info-details svelte-1l1cvmx"> <span class="svelte-1l1cvmx"><!></span></span>');function Ea(l,e){be(e,!0);var t=he(),s=J(t);{var a=c=>{var d=m1(),u=j(d),f=z(u),v=j(f);Mt(v,()=>zf(e.prepmodel)),ae(()=>me(u,`${e.prepmodel.ml.length+" method"+(e.prepmodel.ml.length>1?"s":"")} `)),T(c,d)},o=c=>{var d=Lu("skipped");T(c,d)};Y(s,c=>{e.prepmodel.ml?c(a):c(o,!1)})}T(l,t),_e()}var h1=X('<span>file:</span> <span class="file-name svelte-1dxrrpt"> </span><br/>',1),g1=X('<p class="info-text svelte-1dxrrpt"><span style="display:inline-block;font-weight:bold;padding-bottom: 0.25em;">Preprocessing model</span><br/> <!> <span style="color:#a0a0a0;">variables</span>, <!></p> <!>',1);function p1(l,e){be(e,!0);var t=he(),s=J(t);{var a=o=>{ie(o,{name:"info",children:(c,d)=>{var u=g1(),f=J(u),v=z(j(f),3);{var m=b=>{var y=h1(),S=z(J(y),2),E=j(S);ae(()=>{H(S,"title",e.model.fileName),me(E,e.model.fileName)}),T(b,y)};Y(v,b=>{e.model.fileName&&b(m)})}var g=z(v),h=z(g,3);Ea(h,{get prepmodel(){return e.model}});var p=z(f,2);{var _=b=>{Mr(b,{get onclick(){return e.reset}})};Y(p,b=>{e.reset&&b(_)})}ae(()=>me(g,` ${e.model.npred??""} `)),T(c,u)},$$slots:{default:!0}})};Y(s,o=>{e.model&&o(a)})}T(l,t),_e()}var b1=X("<!> <!>",1),_1=X("<p><!></p>"),w1=X("<!> <!>",1);function y1(l,e){be(e,!0);let t=V(e,"model",15),s=re(""),a=re("neutral"),o=re("");function c(b){try{const y=JSON.parse(b,aa);if(Array.isArray(y.v)&&(y.v=Float64Array.from(y.v)),!Object.keys(y).includes("class")||y.class[0]!=="prepmodel")throw Error("The JSON file you selected does not contain preprocessing model.");y.fileName=r(f),t(y),B(a,"success"),B(o,"")}catch(y){console.log(y),t(null),B(a,"error"),B(o,y,!0)}}function d(b){const y=new FileReader;y.onload=()=>{c(y.result)},y.readAsText(r(s))}function u(){B(s,""),t(null),B(a,"neutral"),B(o,"")}ue(()=>{r(s)===null?(t(null),B(a,"neutral"),B(o,"")):(B(a,"neutral"),B(o,""))}),ue(()=>{(t()===null||t()===0)&&B(s,"")});let f=w(()=>r(s)?r(s).name.replace(/\.[^/.]+$/,""):"");var v=w1(),m=J(v);{var g=b=>{var y=b1(),S=J(y);bn(S,()=>r(s),C=>{ie(C,{name:"file-selector",children:(A,P)=>{$l(A,{id:"modelFile",acceptType:".json",message:"Select file with model",get file(){return r(s)},set file(M){B(s,M,!0)}})},$$slots:{default:!0}})});var E=z(S,2);{var k=C=>{ie(C,{name:"load-button",label:" ",children:(A,P)=>{lt(A,{onclick:d,text:"Load"})},$$slots:{default:!0}})};Y(E,C=>{r(s)&&C(k)})}T(b,y)},h=b=>{p1(b,{get model(){return t()},reset:u})};Y(m,b=>{t()?b(h,!1):b(g)})}var p=z(m,2);{var _=b=>{ie(b,{name:"error",status:"error",children:(y,S)=>{var E=_1(),k=j(E);Mt(k,()=>r(o)),T(y,E)},$$slots:{default:!0}})};Y(p,b=>{(r(a)==="error"||r(o))&&b(_)})}T(l,v),_e()}var x1=X('<p class="title"> </p>'),k1=X("<!>&nbsp;",1),E1=X("<!> <!>",1),C1=X('<div class="method-open svelte-2gffce"><!> <!> <!></div>'),S1=(l,e)=>e.open(e.pos),A1=X('<p> <span title="Edit" class="svelte-2gffce"> </span></p> <!> <!> <!>',1);function Vn(l,e){be(e,!0);let t=V(e,"cancel",3,null);var s=he(),a=J(s);{var o=d=>{var u=C1(),f=j(u);ie(f,{children:(g,h)=>{var p=x1(),_=j(p);ae(()=>me(_,e.title)),T(g,p)},$$slots:{default:!0}});var v=z(f,2);Rr(v,()=>e.children);var m=z(v,2);ie(m,{label:" ",children:(g,h)=>{var p=E1(),_=J(p);{var b=S=>{var E=k1(),k=J(E);lt(k,{text:"Cancel",get onclick(){return t()}}),T(S,E)};Y(_,S=>{t()&&S(b)})}var y=z(_,2);lt(y,{text:"Save",get onclick(){return e.apply}}),T(g,p)},$$slots:{default:!0}}),Fo(3,u,()=>ec,()=>({duration:10})),T(d,u)},c=d=>{ie(d,{children:(u,f)=>{var v=A1(),m=J(v),g=j(m),h=z(g);h.__click=[S1,e];var p=j(h),_=z(m,2);Qf(_,{onclick:()=>e.moveUp(e.pos)});var b=z(_,2);Zf(b,{onclick:()=>e.moveDown(e.pos)});var y=z(b,2);Mr(y,{onclick:()=>e.remove(e.pos)}),ae(()=>{me(g,`${e.title??""} `),me(p,e.settings)}),T(u,v)},$$slots:{default:!0}})};Y(a,d=>{e.isOpen?d(o):d(c,!1)})}T(l,s),_e()}mt(["click"]);var N1=X("<!> <!>",1);function M1(l,e){be(e,!0);let t=V(e,"params",31,()=>De([0,0])),s=V(e,"varind",15),a=V(e,"settings",15),o=V(e,"nvars",3,0),c=wn(e,["$$slots","$$events","$$legacy","params","varind","settings","isOpen","nvars"]);const d={snv:0,area:1,length:2,var:3},u=Object.keys(d);let f=re(De(u[t()[0]])),v=re(t()[1]+1);const m="Normalization";ue(()=>{a(r(f)+(r(f)==="var"?" #"+r(v):""))}),ue(()=>{r(f)==="var"?s(s()[0]=t()[1]>0?t()[1]:1,!0):s(s()[0]=-1,!0)}),ue(()=>{r(f)==="var"&&e.isOpen?s(s()[0]=t()[1],!0):s(s()[0]=-1,!0)}),ue(()=>{r(f)&&t(t()[0]=d[r(f)],!0)}),ue(()=>{r(v)&&t(t()[1]=r(v)-1,!0)}),Vn(l,Zt({id:"norm",title:m,get settings(){return a()},get isOpen(){return e.isOpen}},()=>c,{children:(g,h)=>{var p=N1(),_=J(p);ie(_,{label:"Type",children:(S,E)=>{Ke(S,{get options(){return u},get value(){return r(f)},set value(k){B(f,k,!0)}})},$$slots:{default:!0}});var b=z(_,2);{var y=S=>{ie(S,{label:"Variable index",children:(E,k)=>{Tr(E,{min:1,get max(){return o()},step:1,get value(){return r(v)},set value(C){B(v,C,!0)}})},$$slots:{default:!0}})};Y(b,S=>{r(f)==="var"&&S(y)})}T(g,p)},$$slots:{default:!0}})),_e()}var T1=X("<!> <!> <!>",1);function P1(l,e){be(e,!0);let t=V(e,"params",31,()=>De([3,1,0])),s=V(e,"settings",15),a=wn(e,["$$slots","$$events","$$legacy","params","settings","nvars"]);const o=w(()=>{if(!e.nvars)return 3;const f=Math.round(e.nvars*.25);return f>39?39:f%2<1?f+1:f}),c=w(()=>t()[1]<2?[0,1]:[0,1,2]),d=w(()=>t()[0]<5?[1,2]:[1,2,3]);ue(()=>{t()[0]<5&&t()[1]>2&&t(t()[1]=2,!0)}),ue(()=>{t()[2]>t()[1]&&t(t()[2]=t()[1],!0)}),ue(()=>{s(t()[0]+", "+t()[1]+", "+t()[2])}),Vn(l,Zt({id:"savgol",title:"Savitzkiy-Golay",get settings(){return s()}},()=>a,{children:(f,v)=>{var m=T1(),g=J(m);ie(g,{label:"Width",children:(_,b)=>{Tr(_,{min:3,get max(){return r(o)},step:2,get value(){return t()[0]},set value(y){t(t()[0]=y,!0)}})},$$slots:{default:!0}});var h=z(g,2);ie(h,{label:"Polynomial",children:(_,b)=>{Ke(_,{get options(){return r(d)},get value(){return t()[1]},set value(y){t(t()[1]=y,!0)}})},$$slots:{default:!0}});var p=z(h,2);ie(p,{label:"Derivative",children:(_,b)=>{Ke(_,{get options(){return r(c)},get value(){return t()[2]},set value(y){t(t()[2]=y,!0)}})},$$slots:{default:!0}}),T(f,m)},$$slots:{default:!0}})),_e()}var z1=X("<!> <!>",1);function L1(l,e){be(e,!0);let t=V(e,"params",31,()=>De([1,0]));V(e,"varind",27,()=>-1);let s=V(e,"settings",15);V(e,"nvars",3,0);let a=wn(e,["$$slots","$$events","$$legacy","params","varind","settings","nvars"]);const o={no:0,mean:1,median:2},c={no:0,sd:1,iqr:2,range:3,pareto:4},d=Object.keys(o),u=Object.keys(c);let f=re(De(d[t()[0]])),v=re(De(u[t()[1]]));const m="Scaling";ue(()=>{s(r(f)+"/"+r(v))}),ue(()=>{r(f)&&t(t()[0]=o[r(f)],!0)}),ue(()=>{r(v)&&t(t()[1]=c[r(v)],!0)}),Vn(l,Zt({id:"scale",title:m,get settings(){return s()}},()=>a,{children:(g,h)=>{var p=z1(),_=J(p);ie(_,{label:"Center",children:(y,S)=>{Ke(y,{get options(){return d},get value(){return r(f)},set value(E){B(f,E,!0)}})},$$slots:{default:!0}});var b=z(_,2);ie(b,{label:"Scale",children:(y,S)=>{Ke(y,{get options(){return u},get value(){return r(v)},set value(E){B(v,E,!0)}})},$$slots:{default:!0}}),T(g,p)},$$slots:{default:!0}})),_e()}var R1=X("<!> <!> <!>",1),I1=X("<!> <!> <!>",1);function j1(l,e){be(e,!0);let t=V(e,"params",31,()=>De([0,1,.1]));V(e,"varind",27,()=>-1);let s=V(e,"settings",15,"");V(e,"nvars",3,0);let a=wn(e,["$$slots","$$events","$$legacy","params","varind","settings","nvars"]);const o="Baseline correction",c={emsc:0,als:1},d=Object.keys(c);function u(p){const _=Math.ceil(Math.log10(p));return Math.pow(10,_)}let f=re(De(d[t()[0]])),v=re(De(t()[2]>0?u(t()[2]).toString():"0.1")),m=w(()=>parseFloat(r(v))),g=w(()=>r(m)/10),h=w(()=>Math.ceil(-Math.log10(r(m)))+1);ue(()=>{if(r(f)!=="als")return;const p=parseFloat(r(v));(t()[2]<r(g)||t()[2]>p-r(g))&&t(t()[2]=r(g),!0)}),ue(()=>{s(r(f)+" ("+(r(f)=="emsc"?t()[1].toFixed(0):t()[1].toFixed(1)+","+t()[2].toFixed(3))+")")}),ue(()=>{r(f)&&t(t()[0]=c[r(f)],!0)}),Vn(l,Zt({id:"scale",title:o,get settings(){return s()}},()=>a,{children:(p,_)=>{var b=I1(),y=J(b);ie(y,{label:"Type",children:(A,P)=>{Ke(A,{get options(){return d},get value(){return r(f)},set value(M){B(f,M,!0)}})},$$slots:{default:!0}});var S=z(y,2);{var E=A=>{var P=R1(),M=J(P);ie(M,{label:"Lambda",children:(L,F)=>{On(L,{min:1,max:7,step:.1,get value(){return t()[1]},set value(U){t(t()[1]=U,!0)}})},$$slots:{default:!0}});var N=z(M,2);ie(N,{label:"Penalty range",children:(L,F)=>{Ke(L,{options:["1","0.1","0.01"],get value(){return r(v)},set value(U){B(v,U,!0)}})},$$slots:{default:!0}});var I=z(N,2);ie(I,{label:"Penalty",children:(L,F)=>{{let U=w(()=>r(m)-r(g));On(L,{get min(){return r(g)},get max(){return r(U)},get step(){return r(g)},get decNum(){return r(h)},get value(){return t()[2]},set value(O){t(t()[2]=O,!0)}})}},$$slots:{default:!0}}),T(A,P)};Y(S,A=>{r(f)==="als"&&A(E)})}var k=z(S,2);{var C=A=>{ie(A,{label:"Polynomial",children:(P,M)=>{Tr(P,{min:0,max:5,step:1,decNum:0,get value(){return t()[1]},set value(N){t(t()[1]=N,!0)}})},$$slots:{default:!0}})};Y(k,A=>{r(f)==="emsc"&&A(C)})}T(p,b)},$$slots:{default:!0}})),_e()}var q1=X("<!> <!>",1);function F1(l,e){be(e,!0);let t=V(e,"params",15),s=V(e,"varind",15),a=V(e,"settings",15),o=wn(e,["$$slots","$$events","$$legacy","params","varind","settings","isOpen","left","right","nvars"]);const c="Trim tails";let d=re(!1);const u=w(()=>e.nvars?Math.round(e.nvars*.1):1);ue(()=>{e.isOpen?((t()[0]===void 0||t()[0]===null||t()[0]<e.left||t()[0]>e.right-r(u))&&t(t()[0]=e.left,!0),(t()[1]===void 0||t()[1]===null||t()[1]>e.right||t()[1]<e.left+r(u))&&t(t()[1]=e.right,!0),s(s()[1]=t()[0],!0),s(s()[2]=t()[1],!0),B(d,!0)):(s(s()[1]=-1,!0),s(s()[2]=-1,!0),B(d,!1))}),ue(()=>{a("left: "+t()[0]+" right: "+t()[1])}),Vn(l,Zt({id:"norm",title:c,get settings(){return a()},get isOpen(){return e.isOpen}},()=>o,{children:(f,v)=>{var m=he(),g=J(m);{var h=p=>{var _=q1(),b=J(_);ie(b,{label:"Left",children:(S,E)=>{{let k=w(()=>e.right-r(u));On(S,{get min(){return e.left},get max(){return r(k)},step:1,decNum:0,get value(){return t()[0]},set value(C){t(t()[0]=C,!0)}})}},$$slots:{default:!0}});var y=z(b,2);ie(y,{label:"Right",children:(S,E)=>{{let k=w(()=>e.left+r(u));On(S,{get min(){return r(k)},get max(){return e.right},step:1,decNum:0,get value(){return t()[1]},set value(C){t(t()[1]=C,!0)}})}},$$slots:{default:!0}}),T(p,_)};Y(g,p=>{r(d)&&p(h)})}T(f,m)},$$slots:{default:!0}})),_e()}var O1=X("<!> <!>",1);function B1(l,e){be(e,!0);let t=V(e,"params",31,()=>De([3,5]));V(e,"varind",27,()=>-1);let s=V(e,"settings",15);V(e,"nvars",3,0);let a=wn(e,["$$slots","$$events","$$legacy","params","varind","settings","nvars"]);const o="Spike removal";ue(()=>{s(t()[0]+"/"+t()[1])}),Vn(l,Zt({id:"scale",title:o,get settings(){return s()}},()=>a,{children:(c,d)=>{var u=O1(),f=J(u);ie(f,{label:"Window",children:(m,g)=>{Tr(m,{min:3,max:15,step:2,get value(){return t()[0]},set value(h){t(t()[0]=h,!0)}})},$$slots:{default:!0}});var v=z(f,2);ie(v,{label:"Threshold",children:(m,g)=>{Tr(m,{min:3,max:50,get value(){return t()[1]},set value(h){t(t()[1]=h,!0)}})},$$slots:{default:!0}}),T(c,u)},$$slots:{default:!0}})),_e()}var D1=X("<h2>Selected methods</h2> <!>",1),V1=X("<p>No methods selected</p>"),Y1=X("<p> </p>"),W1=X("<h2>Available methods</h2>"),U1=X("<p>Maximum number of methods is selected.</p>"),H1=X("<p> </p> <!>",1),G1=X('<div><!> <!> <!></div> <div class="downloads-block"><!></div> <div class="methods-list svelte-15cx0gr"><!> <!></div>',1);function X1(l,e){be(e,!0);let t=V(e,"prepobj",31,()=>De([])),s=V(e,"meta",15),a=V(e,"varind",31,()=>-1),o=V(e,"rawdataShort",15),c=V(e,"prepdataShort",15),d=V(e,"prepmodel",3,null),u=V(e,"reset",3,null),f=V(e,"finalize",3,null);const v=30,m=8,g={savgol:P1,norm:M1,scale:L1,baseline:j1,trim:F1,spikes:B1};let h=re("neutral"),p=re(""),_=re(void 0),b=re(""),y=re(De([])),S=re(!1),E=re(De([])),k=re(De([]));s(new Array(m).fill(""));const C=w(()=>e.rawdata.values.ncols-e.rawdata.nresp);let A=De(e.rawdata.values.nrows<3?Object.keys(g).filter(le=>le!=="scale"):Object.keys(g));M(),t().length!==0&&P();async function P(){t().length!==0&&B(_,e.WASM().then(le=>{B(h,"applying");const ve=mi(le,o().values,0,t(),!0,[]),oe=na(le,o().values,0,ve,!0);c(ka(o(),oe)),B(h,"success")}).catch(le=>{c(ka(o())),console.error(le),B(h,"error"),B(p,le,!0)}),!0)}function M(){const le=e.rawdata.values.ncols-e.rawdata.nresp;if(!e.rawdata)return;if(!t()||t().length<1){e.setLeft(0),e.setRight(le),B(E,[],!0),B(k,[],!0);return}let ve=[],oe=[],xe=0,ke=le;for(let ge of t())ge.id==="trim"?(ve.push(xe),oe.push(ke),ge.params[0]<xe&&(ge.params[0]=xe),ge.params[1]>ke&&(ge.params[1]=ke),xe=ge.params[0]>xe?ge.params[0]:xe,ke=ge.params[1]>0&&ge.params[1]<ke?ge.params[1]:ke):(ve.push(xe),oe.push(ke));B(E,ve,!0),B(k,oe,!0),e.setLeft(xe),e.setRight(ke)}function N(le){const ve=Jr.find(oe=>oe.id===le);ve&&(r(E).push(e.left),r(k).push(e.right),t().push({id:ve.id,params:ve.mp}),B(S,!0),B(b,t().length-1))}function I(){t().length<1||(r(E).pop(),r(k).pop(),t().pop(),B(S,!1),B(b,-1))}function L(le){if(le<=0)return;const ve=t()[le],oe=t()[le-1];t(t()[le-1]=ve,!0),t(t()[le]=oe,!0),q()}function F(le){if(le<0||le===t().length-1)return;const ve=t()[le],oe=t()[le+1];t(t()[le+1]=ve,!0),t(t()[le]=oe,!0),q()}function U(le){le<0||le>=t().length||(t(t().filter((ve,oe)=>oe!==le)),q())}function O(le){B(b,le,!0)}function R(){B(b,null)}function q(){B(h,"neutral"),B(p,""),B(S,!1),B(b,null),d()&&u()(),M(),P(),a(a()[1]=-1,!0),a(a()[2]=-1,!0)}ue(()=>{e.rawdata&&!o()&&o(d1(e.rawdata,v))}),ue(()=>{o()&&!c()&&c(ka(o()))}),ue(()=>{(!t()||t().length===0)&&(B(y,[],!0),c(null),B(E,[],!0),B(k,[],!0),B(b,""),s(new Array(m).fill("")))});var W=G1(),D=J(W);let K;var Z=j(D);ie(Z,{label:"",children:(le,ve)=>{var oe=D1(),xe=z(J(oe),2);{var ke=ge=>{_i(ge,{text:"edit",get onclick(){return u()}})};Y(xe,ge=>{d()&&u()&&ge(ke)})}T(le,oe)},$$slots:{default:!0}});var G=z(Z,2);{var $=le=>{ie(le,{label:"",children:(ve,oe)=>{var xe=V1();T(ve,xe)},$$slots:{default:!0}})},ne=le=>{var ve=he(),oe=J(ve);Xe(oe,17,t,Qe,(xe,ke,ge)=>{var je=he();const Pe=w(()=>g[r(ke).id]);var We=J(je);{var Ae=Oe=>{var Ee=he(),Be=J(Ee);{let Fe=w(()=>ge===r(b)),rr=w(()=>r(S)?I:null);nl(Be,()=>r(Pe),(qr,Fr)=>{Fr(qr,{get isOpen(){return r(Fe)},get left(){return r(E)[ge]},get right(){return r(k)[ge]},pos:ge,get nvars(){return r(C)},moveUp:L,moveDown:F,apply:q,open:O,close:R,remove:U,get cancel(){return r(rr)},get params(){return r(ke).params},set params(Se){r(ke).params=Se},get varind(){return a()},set varind(Se){a(Se)},get settings(){return s()[ge]},set settings(Se){s(s()[ge]=Se,!0)}})})}T(Oe,Ee)},Te=Oe=>{var Ee=he(),Be=J(Ee);{let Fe=w(()=>ge===r(b)),rr=w(()=>r(S)?I:null);nl(Be,()=>r(Pe),(qr,Fr)=>{Fr(qr,{pos:ge,get isOpen(){return r(Fe)},get left(){return r(E)[ge]},get right(){return r(k)[ge]},get nvars(){return r(C)},moveUp:L,moveDown:F,apply:q,open:O,close:R,remove:U,get cancel(){return r(rr)},get params(){return r(ke).params},set params(Se){r(ke).params=Se},get settings(){return s()[ge]},set settings(Se){s(s()[ge]=Se,!0)}})})}T(Oe,Ee)};Y(We,Oe=>{r(ke).id==="norm"||r(ke).id==="trim"?Oe(Ae):Oe(Te,!1)})}T(xe,je)}),T(le,ve)};Y(G,le=>{t().length===0?le($):le(ne,!1)})}var ee=z(G,2);{var se=le=>{ie(le,{status:"error",children:(ve,oe)=>{var xe=Y1(),ke=j(xe);ae(()=>me(ke,r(p))),T(ve,xe)},$$slots:{default:!0}})};Y(ee,le=>{(r(h)==="error"||r(p))&&le(se)})}var pe=z(D,2),Me=j(pe);{var Le=le=>{ie(le,{label:" ",children:(ve,oe)=>{lt(ve,{get onclick(){return f()},text:"Finalize"})},$$slots:{default:!0}})};Y(Me,le=>{!d()&&!r(b)&&t().length>0&&le(Le)})}var de=z(pe,2),ce=j(de);ie(ce,{label:"",children:(le,ve)=>{var oe=W1();T(le,oe)},$$slots:{default:!0}});var Ce=z(ce,2);{var fe=le=>{ie(le,{label:"",children:(ve,oe)=>{var xe=U1();T(ve,xe)},$$slots:{default:!0}})},ye=le=>{var ve=he(),oe=J(ve);Xe(oe,17,()=>A,Qe,(xe,ke)=>{const ge=w(()=>Jr.find(je=>je.id===r(ke)));ie(xe,{children:(je,Pe)=>{var We=H1(),Ae=J(We),Te=j(Ae),Oe=z(Ae,2);Jf(Oe,{onclick:()=>N(r(ge).id)}),ae(()=>me(Te,r(ge).title)),T(je,We)},$$slots:{default:!0}})}),T(le,ve)};Y(Ce,le=>{t().length>=m?le(fe):le(ye,!1)})}ae(le=>K=pt(D,1,"selected-methods-list svelte-15cx0gr",null,K,le),[()=>({final:d()!==null&&d()!==void 0})]),T(l,W),_e()}var K1=X("<!> <!>",1),J1=X("<!> <!>",1),Q1=X("<!> <!>",1),Z1=X("<!> <!> <!> <!> <!> <!> <!> <!>",1),$1=X("<h2>Plot settings</h2>"),em=X('<div class="plot-area svelte-x8qn01"><div class="plot svelte-x8qn01"><!></div></div> <div class="plot-controls-area svelte-x8qn01"><!> <!> <!> <!></div>',1),tm=X('<div class="plot-panel svelte-x8qn01"><!></div>');function rm(l,e){be(e,!0);let t=re(!0),s=re("none"),a=re(!1);const o=w(()=>(r(t)?"Preprocessed":"Raw")+" data (selected rows)"),c=w(()=>r(t)&&e.prepdata?e.prepdata:e.rawdata),d=w(()=>r(c)?r(c).varaxisLabel:"Variables"),u=w(()=>e.rawdata.varaxisUnits),f=w(()=>e.left>=0||e.right>0&&e.right<r(c).values.nrows),v=w(()=>e.left>=0?e.left+1:1),m=w(()=>e.right>0&&e.right<r(c).values.nrows?e.right:r(c).values.nrows),g=w(()=>r(t)&&r(c)&&r(f)?Tt.seq(r(v),r(m)):null),h=w(()=>r(g)?r(c).varvalues.filter((M,N)=>N>=r(v)-1&&N<r(m)):r(c).varvalues),p=w(()=>r(g)?r(c).values.subset(r(g),null):r(c).values),_=w(()=>r(p)?Vl(r(p).v):null),b=w(()=>r(_)?(r(_)[1]-r(_)[0])*.05:null),y=w(()=>r(_)?[r(_)[0],r(_)[1]+(r(s)!=="none")*r(b)]:[0,1]),S=w(()=>r(c)?Vl(r(c).varvalues,r(a)?.005:.1):[0,1]),E=w(()=>r(a)&&r(f)?[r(c).varvalues[r(v)-1],r(c).varvalues[r(m)-1]]:r(S)),k=w(()=>{if(!e.rawdata)return null;const M={none:{colors:"#ff0000"}};if(e.rawdata.classes&&e.rawdata.classNames&&e.rawdata.classNames.length>1){const N=rs(e.rawdata.classNames.length);M.groups={colors:e.rawdata.classes.map(I=>N[e.rawdata.classNames.findIndex(L=>L===I)]),breaks:Nr(0,e.rawdata.classNames.length),labels:e.rawdata.classNames,map:N}}if(e.rawdata.resp&&e.rawdata.resp.length===e.rawdata.values.ncols){const N=Vo(e.rawdata.resp,8),I=rs(N.length-1);M.response={colors:sc(e.rawdata.resp.v,N.v,I),labels:null,breaks:N,map:I}}return M});ue(()=>{(e.left<1||e.right<1||e.right>=e.left)&&B(a,!1)});var C=tm(),A=j(C);{var P=M=>{var N=em(),I=J(N),L=j(I),F=j(L);Xi(F,{get title(){return r(o)},get limY(){return r(y)},get limX(){return r(E)},fileName:"plot-preprocessed",children:(Z,G)=>{var $=Z1(),ne=J($);{var ee=oe=>{$i(oe,{get xValues(){return r(h)},get yValues(){return r(p)}})},se=oe=>{var xe=he(),ke=J(xe);Xe(ke,17,()=>r(k)[r(s)].colors,Qe,(ge,je,Pe)=>{{let We=w(()=>r(p).getcolumn(Pe+1));Ut(ge,{get xValues(){return r(h)},get yValues(){return r(We)},get lineColor(){return r(je)}})}}),T(oe,xe)};Y(ne,oe=>{r(s)==="none"?oe(ee):oe(se,!1)})}var pe=z(ne,2);{var Me=oe=>{var xe=K1();const ke=w(()=>r(c).varvalues[e.varind[0]]);var ge=J(xe);{let Pe=w(()=>[r(ke),r(ke)]);Ut(ge,{get xValues(){return r(Pe)},get yValues(){return r(y)},lineColor:"#00000060"})}var je=z(ge,2);{let Pe=w(()=>[r(ke)]),We=w(()=>[r(y)[1]-r(b)*(r(s)==="none"?1:2)]),Ae=w(()=>Qr(r(ke).toFixed(2)+" "+r(u)));ls(je,{get xValues(){return r(Pe)},get yValues(){return r(We)},get labels(){return r(Ae)},textColor:"#a0a0a0",textSize:.8,pos:2})}T(oe,xe)};Y(pe,oe=>{e.varind&&e.varind[0]>0&&oe(Me)})}var Le=z(pe,2);{var de=oe=>{var xe=J1();const ke=w(()=>r(c).varvalues[e.varind[1]]);var ge=J(xe);{let Pe=w(()=>[r(E)[0]]),We=w(()=>[r(c).varvalues[e.varind[1]]-r(E)[0]]),Ae=w(()=>[r(y)[1]]),Te=w(()=>[r(y)[1]-r(y)[0]]);cl(ge,{get left(){return r(Pe)},get width(){return r(We)},get top(){return r(Ae)},get height(){return r(Te)},lineColor:"transparent",faceColor:"#00000040"})}var je=z(ge,2);{let Pe=w(()=>[r(ke)]),We=w(()=>[r(y)[1]-r(b)*(r(s)==="none"?1:2)]),Ae=w(()=>Qr(r(ke).toFixed(2)+" "+r(u)));ls(je,{get xValues(){return r(Pe)},get yValues(){return r(We)},get labels(){return r(Ae)},textColor:"#a0a0a0",textSize:.8,pos:2})}T(oe,xe)};Y(Le,oe=>{e.varind&&e.varind[1]>0&&oe(de)})}var ce=z(Le,2);{var Ce=oe=>{var xe=Q1();const ke=w(()=>r(c).varvalues[e.varind[2]-1]);var ge=J(xe);{let Pe=w(()=>[r(c).varvalues[e.varind[2]-1]]),We=w(()=>[r(E)[1]-r(c).varvalues[e.varind[2]-1]]),Ae=w(()=>[r(y)[1]]),Te=w(()=>[r(y)[1]-r(y)[0]]);cl(ge,{get left(){return r(Pe)},get width(){return r(We)},get top(){return r(Ae)},get height(){return r(Te)},lineColor:"transparent",faceColor:"#00000040"})}var je=z(ge,2);{let Pe=w(()=>[r(ke)]),We=w(()=>[r(y)[1]-r(b)*(r(s)==="none"?1:2)]),Ae=w(()=>Qr(r(ke).toFixed(2)+" "+r(u)));ls(je,{get xValues(){return r(Pe)},get yValues(){return r(We)},get labels(){return r(Ae)},textColor:"#a0a0a0",textSize:.8,pos:2})}T(oe,xe)};Y(ce,oe=>{e.varind&&e.varind[2]<r(c).varvalues.length&&e.varind[2]>0&&oe(Ce)})}var fe=z(ce,2);{let oe=w(()=>r(s)!=="none");ss(fe,{get show(){return r(oe)},get labels(){return r(k)[r(s)].labels},get breaks(){return r(k)[r(s)].breaks},get colmap(){return r(k)[r(s)].map}})}var ye=z(fe,2);Ki(ye,{get label(){return r(d)},showGrid:!0});var le=z(ye,2);Ji(le,{showGrid:!0});var ve=z(le,2);Qi(ve,{}),T(Z,$)},$$slots:{default:!0}});var U=z(I,2),O=j(U);ie(O,{label:"",children:(Z,G)=>{var $=$1();T(Z,$)},$$slots:{default:!0}});var R=z(O,2);ie(R,{label:"Show",children:(Z,G)=>{tr(Z,{options:["raw","preprocessed"],get value(){return r(t)},set value($){B(t,$,!0)}})},$$slots:{default:!0}});var q=z(R,2);{var W=Z=>{ie(Z,{label:"Color by",children:(G,$)=>{{let ne=w(()=>Object.keys(r(k)));Ke(G,{get options(){return r(ne)},get value(){return r(s)},set value(ee){B(s,ee,!0)}})}},$$slots:{default:!0}})};Y(q,Z=>{Object.keys(r(k)).length>1&&Z(W)})}var D=z(q,2);{var K=Z=>{ie(Z,{label:"Zoom (x-axis)",children:(G,$)=>{tr(G,{options:["off","on"],get value(){return r(a)},set value(ne){B(a,ne,!0)}})},$$slots:{default:!0}})};Y(D,Z=>{e.left>0&&e.right>e.left&&Z(K)})}T(M,N)};Y(A,M=>{r(h)&&r(p)&&M(P)})}T(l,C),_e()}var nm=X('<div class="widget-container svelte-1soqt9v"><div class="app-controls svelte-1soqt9v"><div class="prep-creator svelte-1soqt9v"><!></div></div> <div class="app-content svelte-1soqt9v"><!></div></div>');function lm(l,e){be(e,!0);let t=V(e,"left",15),s=V(e,"right",15),a=V(e,"prepobj",15),o=V(e,"meta",15),c=V(e,"finalize",3,null),d=re(De([-1,0,0])),u=re(null),f=re(null);function v(E){const k=e.rawdata.values.ncols-e.rawdata.nresp;e.rawdata&&E>=0&&E<k&&E<s()&&t(E)}function m(E){const k=e.rawdata.values.ncols-e.rawdata.nresp;e.rawdata&&E<=k&&E>t()&&s(E)}var g=nm(),h=j(g),p=j(h),_=j(p);X1(_,{get WASM(){return e.WASM},get rawdata(){return e.rawdata},get outliers(){return e.outliers},get left(){return t()},get right(){return s()},setLeft:v,",":!0,setRight:m,get finalize(){return c()},get varind(){return r(d)},set varind(E){B(d,E,!0)},get prepobj(){return a()},set prepobj(E){a(E)},get rawdataShort(){return r(u)},set rawdataShort(E){B(u,E,!0)},get prepdataShort(){return r(f)},set prepdataShort(E){B(f,E,!0)},get meta(){return o()},set meta(E){o(E)}});var b=z(h,2),y=j(b);{var S=E=>{rm(E,{get rawdata(){return r(u)},get prepdata(){return r(f)},get left(){return t()},get right(){return s()},get varind(){return r(d)}})};Y(y,E=>{r(u)&&E(S)})}T(l,g),_e()}var sm=X('<p class="info-text"><span style="color:#a0a0a0;">Preprocessing:</span> <!></p>'),am=X("<!> <!> <!>",1),om=X('<p class="info-text"><span style="color:#a0a0a0;">Preprocessing:</span> skipped</p> <div><!></div>',1),im=X("<!> <!> <!>",1),cm=X("<p><strong>Preprocessing model</strong></p>"),um=X("<!> <!>",1),fm=X("<p> </p>"),dm=X('<div class="prep-widget"><!></div> <!> <!>',1);function vm(l,e){be(e,!0);let t=V(e,"prepType",15),s=V(e,"prepobj",15),a=V(e,"prepdata",15),o=V(e,"prepmodel",15),c=V(e,"prepmeta",15),d=re(!1),u=re(0),f=re(De(e.rawdata?e.rawdata.values.ncols-e.rawdata.nresp:0)),v=re("neutral"),m=re(""),g=re(void 0);async function h(F,U,O){!U||!F||U.length===0||B(g,e.WASM().then(R=>{B(v,"applying");const q=mi(R,F.values,F.nresp,U,!1,O);q.info=c(),o(q)}).catch(R=>{o(null),console.error(R),B(v,"error"),B(m,R,!0)}),!0)}async function p(F,U){if(!U||typeof U!="object"){a(null);return}if(Object.keys(U).length===0){a(F);return}B(g,e.WASM().then(O=>{B(v,"applying");const R=na(O,F.values,F.nresp,U,!1,!1),q=v1(ru(F),R);a(Lf(q,U))}).catch(O=>{a(null),console.error(O),B(v,"error"),B(m,O,!0)}),!0)}function _(){t(null),a(null),o(null),s([]),setLeft(0),setRight(e.rawdata.values.ncols-e.rawdata.nresp)}function b(){s()&&s().length>0?h(e.rawdata,s(),e.outliers):(t(null),o(null)),B(d,!1)}function y(){t("create"),a(null),o(null),B(d,!0)}function S(){t("skip"),o({})}ue(()=>{o(),e.rawdata&&p(e.rawdata,o())}),ue(()=>{t()==="create"&&s()&&!o()&&h(e.rawdata,s(),e.outliers)}),ue(()=>{t()==="skip"&&a()===null&&(o({}),s([]),a(e.rawdata))});var E=dm(),k=J(E),C=j(k);{var A=F=>{ie(F,{name:"info",children:(U,O)=>{var R=am(),q=J(R);{var W=G=>{var $=sm(),ne=z(j($),2);Ea(ne,{get prepmodel(){return o()}}),T(G,$)};Y(q,G=>{r(d)||G(W)})}var D=z(q,2);{var K=G=>{_i(G,{onclick:y})};Y(D,G=>{t()==="create"&&G(K)})}var Z=z(D,2);Mr(Z,{onclick:_}),T(U,R)},$$slots:{default:!0}})},P=F=>{var U=he(),O=J(U);{var R=W=>{ie(W,{name:"prep-info",children:(D,K)=>{var Z=om(),G=z(J(Z),2),$=j(G);Mr($,{onclick:_}),T(D,Z)},$$slots:{default:!0}})},q=W=>{var D=he(),K=J(D);{var Z=$=>{ie($,{label:"Preprocessing",name:"prep-container",children:(ne,ee)=>{var se=im(),pe=J(se);lt(pe,{text:"Skip",onclick:S});var Me=z(pe,2);lt(Me,{text:"Load",onclick:()=>t("file")});var Le=z(Me,2);lt(Le,{text:"Create",onclick:y}),T(ne,se)},$$slots:{default:!0}})},G=$=>{var ne=he(),ee=J(ne);{var se=pe=>{var Me=um(),Le=J(Me);ie(Le,{children:(ce,Ce)=>{var fe=cm();T(ce,fe)},$$slots:{default:!0}});var de=z(Le,2);y1(de,{get model(){return o()},set model(ce){o(ce)},get prepobj(){return s()},set prepobj(ce){s(ce)},get left(){return r(u)},set left(ce){B(u,ce,!0)},get right(){return r(f)},set right(ce){B(f,ce,!0)}}),T(pe,Me)};Y(ee,pe=>{t()==="file"&&pe(se)},!0)}T($,ne)};Y(K,$=>{t()?$(G,!1):$(Z)},!0)}T(W,D)};Y(O,W=>{t()==="skip"?W(R):W(q,!1)},!0)}T(F,U)};Y(C,F=>{o()&&a()&&o().ml?F(A):F(P,!1)})}var M=z(k,2);{var N=F=>{wa(F,{closeModal:b,isDark:!0,children:(U,O)=>{lm(U,{get WASM(){return e.WASM},get rawdata(){return e.rawdata},get outliers(){return e.outliers},finalize:b,get prepobj(){return s()},set prepobj(R){s(R)},get left(){return r(u)},set left(R){B(u,R,!0)},get right(){return r(f)},set right(R){B(f,R,!0)},get meta(){return c()},set meta(R){c(R)}})},$$slots:{default:!0}})};Y(M,F=>{r(d)&&F(N)})}var I=z(M,2);{var L=F=>{ie(F,{status:"error",children:(U,O)=>{var R=fm(),q=j(R);ae(()=>me(q,r(m))),T(U,R)},$$slots:{default:!0}})};Y(I,F=>{(r(v)==="error"||r(m))&&F(L)})}T(l,E),_e()}var mm=X('<span style="font-weight:bold"> </span><br/>',1),hm=X('<span class="file-size svelte-gdjwex"> </span> <span>(X)</span>, <span class="file-size svelte-gdjwex"> </span> <span>(Y)</span>',1),gm=X('<span class="file-size svelte-gdjwex"> </span>'),pm=X('<p class="dataset-info svelte-gdjwex"><!> <span>Data file:</span> <span class="file-name svelte-gdjwex"> </span><br/> <span>Size:</span> <!></p> <!>',1);function bm(l,e){be(e,!0);let t=V(e,"title",3,"");var s=he(),a=J(s);{var o=c=>{ie(c,{children:(d,u)=>{var f=pm(),v=J(f),m=j(v);{var g=E=>{var k=mm(),C=J(k),A=j(C);ae(()=>me(A,t())),T(E,k)};Y(m,E=>{t()&&t()!==""&&E(g)})}var h=z(m,4),p=j(h),_=z(h,5);{var b=E=>{var k=hm(),C=J(k),A=j(C),P=z(C,4),M=j(P);ae(()=>{me(A,`${e.dataset.values.nrows??""}×${e.dataset.values.ncols-e.dataset.nresp}`),me(M,`${e.dataset.values.nrows??""}×${e.dataset.nresp??""}`)}),T(E,k)},y=E=>{var k=gm(),C=j(k);ae(()=>me(C,`${e.dataset.values.nrows??""}×${e.dataset.values.ncols??""}`)),T(E,k)};Y(_,E=>{e.dataset.nresp&&e.dataset.nresp>0?E(b):E(y,!1)})}var S=z(v,2);Mr(S,{get onclick(){return e.reset}}),ae(()=>{H(h,"title",e.dataset.fileName),me(p,e.dataset.fileName)}),T(d,f)},$$slots:{default:!0}})};Y(a,c=>{e.dataset&&c(o)})}T(l,s),_e()}var _m=X("<!> <!>",1),wm=X("<!> <!> <!> <!> <!> <!>",1),ym=X("<!> <!>",1),xm=X("<p> </p>"),km=X("<!> <p> </p>",1),Em=X("<p> </p>"),Cm=X("<!> <!> <!>",1);function Ca(l,e){be(e,!0);let t=V(e,"model",3,null),s=V(e,"outliers",19,()=>[]),a=V(e,"className",3,"Class"),o=V(e,"classMandatory",3,!1),c=V(e,"classUnique",3,!1),d=V(e,"title",3,""),u=V(e,"dataset",15),f=V(e,"resobj",15),v=V(e,"csvOnly",3,!0);const m=[",",";"],g=w(()=>t()?["no","yes"]:["no","labels","values"]);let h=re(void 0),p=re(""),_=re(""),b=re(","),y=re("no"),S=re(!1),E=re(!1),k=re(null),C=re("neutral"),A=re("");function P(ee){B(C,"error"),B(A,ee,!0),console.error(ee)}function M(){B(C,"neural"),B(A,"")}function N(){B(C,"success"),B(A,"")}function I(ee,se,pe){B(k,e.WASM().then(Me=>{f(sa(Me,ee,se,pe,!0)),N()}).catch(Me=>{f(null),P(Me)}),!0)}function L(ee,se){if(!ee||ee.size<10)return;const Me=ee.slice(0,1e5),Le=new FileReader;Le.onload=()=>{const de=Le.result;!de||de.length<0||((ce=>{var Ce=gs(ce,4);B(b,Ce[0],!0),B(S,Ce[1],!0),B(E,Ce[2],!0),B(y,Ce[3],!0)})(Of(de)),B(E,o()||r(E),!0),se&&r(y)!=="no"&&B(y,"yes"))},Le.onerror=function(de){csvString=null,B(C,"error"),B(A,de,!0),console.error("Error reading CSV file.",de)},Le.readAsText(Me)}function F(ee){try{const se=jf(ee,r(b),r(y)==="yes"?"labels":r(y),r(S),r(E),r(p),r(_));if(se.values.nrows<1)throw new Error("Dataset must have at least 1 row.");const pe=t()?t().prep&&Object.keys(t().prep).length>0?t().prep.npred:t().ncols+t().exclvars.length:0;if(t()&&se.values.ncols!==pe)throw new Error("Dataset has different number of columns than the training set.");if(se.classNames.length>se.values.nrows/2)throw new Error("Dataset has too many unique "+a().toLowerCase()+" labels ("+se.classNames.length+"), check your CSV file.");if(o()&&se.classNames.length===0)throw new Error("Dataset set must have a column filled with class names.");if(c()&&se.classNames.length>1)throw new Error("Dataset set must have a column filled with only single (target) class name.");se.fileName=r(h).name.replace(/\.[^/.]+$/,""),t()&&(se.varrev=t().varrev,se.header=t().header,se.varlabels=t().varlabels,se.varvalues=t().varvalues,se.varvaluesName=t().varvaluesName,se.varvaluesUnits=t().varvaluesUnits),u(se),N()}catch(se){u(null),P(se)}}function U(ee){const se=new FileReader;se.onload=()=>{F(se.result)},se.readAsText(r(h))}async function O(ee){try{const se=r(h)instanceof FileList?r(h):[r(h)];u(await Uf(se)),N()}catch(se){P("Failed to read SPC file: "+se)}}function R(){B(h,""),u(null),f(null),B(p,""),B(_,""),M()}ue(()=>{if(!(r(h)===0||r(h)===void 0||u())){if(r(h)===null||r(h)===""){R();return}if(Array.isArray(r(h))){if(r(h).filter(ee=>ee.slice(-4)===".spc").length!==r(h).length){P("Multiple file selection is allowed only for SPC files.");return}O(r(h));return}r(h)&&(r(h).type==="text/csv"||r(h).type==="application/vnd.ms-excel")?(L(r(h),t()),M()):O([r(h)])}}),ue(()=>{r(b)&&M()}),ue(()=>{if(u()&&t()&&!f()&&!r(A))try{f(I(t(),u(),s())),N()}catch(ee){u(null),f(null),P(ee)}});var q=Cm(),W=J(q);{var D=ee=>{var se=ym(),pe=J(se);bn(pe,()=>r(h)===void 0,de=>{ie(de,{children:(ce,Ce)=>{var fe=he(),ye=J(fe);{var le=oe=>{$l(oe,{id:"dataFile",message:"Select CSV file with dataset",get file(){return r(h)},set file(xe){B(h,xe,!0)}})},ve=oe=>{$l(oe,{id:"dataFile",message:"Select CSV or SPC file with dataset",acceptType:".csv, .spc",multiple:!0,get file(){return r(h)},set file(xe){B(h,xe,!0)}})};Y(ye,oe=>{v()?oe(le):oe(ve,!1)})}T(ce,fe)},$$slots:{default:!0}})});var Me=z(pe,2);{var Le=de=>{var ce=wm(),Ce=J(ce);ie(Ce,{label:"Delimiter",children:(ge,je)=>{Ke(ge,{id:"sep",get options(){return m},get value(){return r(b)},set value(Pe){B(b,Pe,!0)}})},$$slots:{default:!0}});var fe=z(Ce,2);ie(fe,{label:"Row labels",children:(ge,je)=>{tr(ge,{id:"hasLabels",options:["no","yes"],get value(){return r(S)},set value(Pe){B(S,Pe,!0)}})},$$slots:{default:!0}});var ye=z(fe,2);{var le=ge=>{ie(ge,{get label(){return`${a()??""} labels`},children:(je,Pe)=>{tr(je,{id:"hasLabels",options:["no","yes"],get value(){return r(E)},set value(We){B(E,We,!0)}})},$$slots:{default:!0}})};Y(ye,ge=>{o()||ge(le)})}var ve=z(ye,2);ie(ve,{label:"Header",children:(ge,je)=>{Ke(ge,{id:"header",get options(){return r(g)},get value(){return r(y)},set value(Pe){B(y,Pe,!0)}})},$$slots:{default:!0}});var oe=z(ve,2);{var xe=ge=>{var je=_m(),Pe=J(je);ie(Pe,{label:"Header name",children:(Ae,Te)=>{Ni(Ae,{id:"varvaluesName",placeholder:"e.g. Wavelength",get value(){return r(p)},set value(Oe){B(p,Oe,!0)}})},$$slots:{default:!0}});var We=z(Pe,2);ie(We,{label:"Header units",children:(Ae,Te)=>{Ni(Ae,{id:"varvaluesUnits",maxLength:10,placeholder:"e.g. nm",get value(){return r(_)},set value(Oe){B(_,Oe,!0)}})},$$slots:{default:!0}}),T(ge,je)};Y(oe,ge=>{r(y)==="values"&&ge(xe)})}var ke=z(oe,2);ie(ke,{label:" ",children:(ge,je)=>{lt(ge,{text:"Load",onclick:U})},$$slots:{default:!0}}),T(de,ce)};Y(Me,de=>{r(h)&&!Array.isArray(r(h))&&(r(h).type==="text/csv"||r(h).type==="application/vnd.ms-excel")&&de(Le)})}T(ee,se)},K=ee=>{var se=he(),pe=J(se);{var Me=Le=>{var de=he(),ce=J(de);Os(ce,()=>r(k),Ce=>{ie(Ce,{children:(fe,ye)=>{var le=km(),ve=J(le);ia(ve);var oe=z(ve,2),xe=j(oe);ae(()=>me(xe,t()?"Loading data and apply model...":"Loading data...")),T(fe,le)},$$slots:{default:!0}})},void 0,(Ce,fe)=>{ie(Ce,{status:"error",children:(ye,le)=>{var ve=xm(),oe=j(ve);ae(()=>me(oe,r(fe))),T(ye,ve)},$$slots:{default:!0}})}),T(Le,de)};Y(pe,Le=>{r(k)&&Le(Me)})}T(ee,se)};Y(W,ee=>{u()?ee(K,!1):ee(D)})}var Z=z(W,2);{var G=ee=>{bm(ee,{get dataset(){return u()},reset:R,get title(){return d()}})};Y(Z,ee=>{u()&&ee(G)})}var $=z(Z,2);{var ne=ee=>{ie(ee,{status:"error",children:(se,pe)=>{var Me=Em(),Le=j(Me);ae(()=>me(Le,r(A))),T(se,Me)},$$slots:{default:!0}})};Y($,ee=>{(r(C)==="error"||r(A))&&ee(ne)})}T(l,q),_e()}var Sm=X("<!> <!> <!> <!>",1),Am=X("<p> </p>"),Nm=X("<!> <p>Computing global model...</p>",1),Mm=X('<p><span style="color:#a0a0a0;">PCA model:</span> </p> <!>',1),Tm=X('<div class="buttons"><!> <!></div>'),Pm=X("<!> <!>",1),zm=X("<p> </p>"),Lm=X("<!> <!> <!> <!>",1);function Rm(l,e){be(e,!0);let t=V(e,"outliers",19,()=>[]),s=V(e,"resobj",15),a=V(e,"model",15),o=V(e,"downloadModel",3,null),c=V(e,"downloadResults",3,null),d=re("neutral"),u=re(""),f=re(1),v=re(!0),m=re(!1),g=re(void 0);async function h(I,L,F,U){B(g,e.WASM().then(O=>{B(d,"computing");const R=Nf(O,I.values,L,F,U,t());R.hash=la(),R.exclvars=[],R.varlabels=I.varlabels,R.varindices=I.varindices,R.varvalues=I.varvalues,R.varvaluesName=I.varvaluesName,R.varvaluesUnits=I.varvaluesUnits,R.varrev=I.varrev,R.prep=[];const q=sa(O,R,I,t());a(R),s(q),B(d,"success")}).catch(O=>{console.error(O),a(null),B(d,"error"),B(u,O,!0)}),!0)}function p(I){B(d,"neutral"),B(u,null),h(e.dataset,r(f),r(v),r(m))}function _(){B(d,"neutral"),B(g,null),s(null),a(null),B(u,null)}let b=w(()=>e.dataset?Math.min(e.dataset.values.nrows-2-t().length,e.dataset.values.ncols-1,50):null);ue(()=>{e.dataset===null&&_()}),ue(()=>{B(f,r(b)?Math.min(r(b),20):null,!0)});var y=Lm(),S=J(y);{var E=I=>{var L=Sm(),F=J(L);ie(F,{name:"ncomp",label:"# of PCs",children:(q,W)=>{On(q,{id:"ncomp",min:1,get max(){return r(b)},step:1,decNum:0,get value(){return r(f)},set value(D){B(f,D,!0)}})},$$slots:{default:!0}});var U=z(F,2);ie(U,{name:"center",label:"Center",children:(q,W)=>{tr(q,{id:"center",options:["no","yes"],get value(){return r(v)},set value(D){B(v,D,!0)}})},$$slots:{default:!0}});var O=z(U,2);ie(O,{name:"scale",label:"Scale",children:(q,W)=>{tr(q,{id:"scale",options:["no","yes"],get value(){return r(m)},set value(D){B(m,D,!0)}})},$$slots:{default:!0}});var R=z(O,2);ie(R,{name:"create-model",label:" ",children:(q,W)=>{lt(q,{onclick:p,text:"Create model"})},$$slots:{default:!0}}),T(I,L)};Y(S,I=>{e.dataset&&!a()&&r(d)!=="computing"&&I(E)})}var k=z(S,2);{var C=I=>{var L=he(),F=J(L);Os(F,()=>r(g),U=>{ie(U,{name:"spinner",children:(O,R)=>{var q=Nm(),W=J(q);ia(W),T(O,q)},$$slots:{default:!0}})},void 0,(U,O)=>{ie(U,{name:"error",status:"error",children:(R,q)=>{var W=Am(),D=j(W);ae(()=>me(D,r(O))),T(R,W)},$$slots:{default:!0}})}),T(I,L)};Y(k,I=>{r(g)&&I(C)})}var A=z(k,2);{var P=I=>{var L=Pm(),F=J(L);ie(F,{name:"info",children:(R,q)=>{var W=Mm(),D=J(W),K=z(j(D)),Z=z(D,2);Mr(Z,{onclick:_}),ae(()=>me(K,` ${a().ncomp??""} PCs${a().center?", centered":""}${a().scale?", scaled":""}`)),T(R,W)},$$slots:{default:!0}});var U=z(F,2);{var O=R=>{ie(R,{name:"download-buttons",label:"Download",children:(q,W)=>{var D=Tm(),K=j(D);lt(K,{onclick:()=>c()(s(),e.dataset,"train",t(),a()),text:"Results"});var Z=z(K,2);lt(Z,{onclick:()=>o()(a()),text:"Model"}),T(q,D)},$$slots:{default:!0}})};Y(U,R=>{o()&&c()&&R(O)})}T(I,L)};Y(A,I=>{a()&&I(P)})}var M=z(A,2);{var N=I=>{ie(I,{name:"error",status:"error",children:(L,F)=>{var U=zm(),O=j(U);ae(()=>me(O,r(u))),T(L,U)},$$slots:{default:!0}})};Y(M,I=>{(r(d)==="error"||r(u))&&I(N)})}T(l,y),_e()}var Im=X("<!> <!> <!>",1),jm=X("<p> </p>"),qm=X("<!> <p>Computing PV-set...</p>",1),Fm=X('<p><span style="color:#a0a0a0;">PV-set:</span> </p> <!> <!>',1),Om=X("<p> </p>"),Bm=X("<!> <!> <!> <!>",1);function Dm(l,e){be(e,!0);let t=V(e,"outliers",19,()=>[]),s=V(e,"pvset",15),a=V(e,"pvres",15),o=re("neutral"),c=re(""),d=re(De(["ven","rand","loo"])),u=re("ven"),f=re(void 0),v=e.calset.values.nrows-t().length,m=e.calset&&e.calset.values.nrows>0?[3,4,5,10,20].filter(N=>N>=v/(v-e.model.ncomp-1)&&N<=v/2):[],g=re(De(m.length>0?m[0]:0));ue(()=>{m.length===0&&(B(d,["loo"],!0),B(u,"loo"))});async function h(N,I,L){B(f,e.WASM().then(F=>{const U=L.type=="loo"?0:L.type=="rand"?2:1,O=Tf(F,I,N.values,I.ncomp,L.nseg,U,0,t());s({classLabelsVarname:N.classLabelsVarname,classNames:N.classNames,dec:N.dec,fileName:N.fileName+"-pcv",hasClassNames:N.hasClassNames,hasLabels:N.hasLabels,header:N.header,labelsVarname:N.labelsVarname,classes:e.calres.classes,objindices:e.calres.objindices,objlabels:e.calres.objlabels,responses:e.calres.responses,sep:N.sep,values:O,varAxisTitle:N.varAxisTitle,varindices:I.varindices,varlabels:I.varlabels,varrev:I.varrev,varvalues:I.varvalues,varvaluesName:I.varvaluesName,varvaluesUnits:I.varvaluesUnits}),a(sa(F,I,s(),[]))}).catch(F=>{console.error(F),s(null),a(null),B(o,"error"),B(c,F,!0)}),!0)}function p(N){B(o,"neutral"),B(c,""),h(e.calset,e.model,{type:r(u),nseg:r(g)})}function _(){B(o,"neutral"),B(c,""),B(f,null),s(null),a(null)}ue(()=>{e.model===null&&_()});var b=Bm(),y=J(b);{var S=N=>{var I=Im(),L=J(I);ie(L,{name:"split",label:"Split type:",children:(R,q)=>{Ke(R,{id:"cvType",get options(){return r(d)},get value(){return r(u)},set value(W){B(u,W,!0)}})},$$slots:{default:!0}});var F=z(L,2);{var U=R=>{ie(R,{name:"nseg",label:"Segments:",children:(q,W)=>{Ke(q,{id:"nseg",get options(){return m},get value(){return r(g)},set value(D){B(g,D,!0)}})},$$slots:{default:!0}})};Y(F,R=>{r(u)!=="loo"&&R(U)})}var O=z(F,2);ie(O,{name:"run-button",label:" ",children:(R,q)=>{lt(R,{onclick:p,text:"Compute PV-set"})},$$slots:{default:!0}}),T(N,I)};Y(y,N=>{e.model&&!s()&&r(o)!=="busy"&&N(S)})}var E=z(y,2);{var k=N=>{var I=he(),L=J(I);Os(L,()=>r(f),F=>{ie(F,{name:"spinner",children:(U,O)=>{var R=qm(),q=J(R);ia(q),T(U,R)},$$slots:{default:!0}})},void 0,(F,U)=>{ie(F,{name:"error",status:"error",children:(O,R)=>{var q=jm(),W=j(q);ae(()=>me(W,r(U))),T(O,q)},$$slots:{default:!0}})}),T(N,I)};Y(E,N=>{r(f)&&N(k)})}var C=z(E,2);{var A=N=>{ie(N,{name:"info",children:(I,L)=>{var F=Fm(),U=J(F),O=z(j(U)),R=z(U,2);Kf(R,{onclick:()=>Df(s(),e.calset.fileName+"-pv")});var q=z(R,2);Mr(q,{onclick:_}),ae(()=>me(O,` ${s().values.nrows??""} × ${s().values.ncols??""}, ${r(u)??""}
      ${r(u)!=="loo"?r(g)+" seg":""}`)),T(I,F)},$$slots:{default:!0}})};Y(C,N=>{s()&&N(A)})}var P=z(C,2);{var M=N=>{ie(N,{name:"error",status:"error",children:(I,L)=>{var F=Om(),U=j(F);ae(()=>me(U,r(c))),T(I,F)},$$slots:{default:!0}})};Y(P,N=>{r(o)==="error"&&r(c)&&N(M)})}T(l,b),_e()}var Vm=X('<tr class="svelte-kg0b31"><td class="label svelte-kg0b31">Crit (outliers)</td><td class="svelte-kg0b31"></td><td class="svelte-kg0b31"></td><td class="svelte-kg0b31"> </td></tr>'),Ym=X('<table class="svelte-kg0b31"><thead><tr class="svelte-kg0b31"><th class="svelte-kg0b31"></th><th class="svelte-kg0b31">h</th><th class="svelte-kg0b31">q</th><th class="svelte-kg0b31">f</th></tr></thead><tbody><tr class="svelte-kg0b31"><td class="label svelte-kg0b31">DoF (Nu)</td><td class="svelte-kg0b31"> </td><td class="svelte-kg0b31"> </td><td class="svelte-kg0b31"> </td></tr><tr class="svelte-kg0b31"><td class="label svelte-kg0b31">Mean (u0)</td><td class="svelte-kg0b31"> </td><td class="svelte-kg0b31"> </td><td class="svelte-kg0b31"></td></tr><tr class="svelte-kg0b31"><td class="label svelte-kg0b31">Crit (extreme)</td><td class="svelte-kg0b31"></td><td class="svelte-kg0b31"></td><td class="svelte-kg0b31"> </td></tr><!></tbody></table>');function Sa(l,e){be(e,!0);let t=V(e,"isAlt",3,!1),s=w(()=>e.simca?e.simca.limType==="classic"?"c":"r":null),a=w(()=>e.model&&r(s)?nt(e.model,r(s)+"Nh"):null),o=w(()=>e.model&&r(s)?nt(e.model,r(s)+"Nq"):null),c=w(()=>e.model&&r(s)?nt(e.model,r(s)+"h0"):null),d=w(()=>e.model&&r(s)?nt(e.model,r(s)+"q0"):null),u=w(()=>e.simca?e.simca.ncomp:null);var f=he(),v=J(f);{var m=g=>{var h=Ym(),p=z(j(h)),_=j(p),b=z(j(_)),y=j(b),S=z(b),E=j(S),k=z(S),C=j(k),A=z(_),P=z(j(A)),M=j(P),N=z(P),I=j(N),L=z(A),F=z(j(L),3),U=j(F),O=z(L);{var R=q=>{var W=Vm(),D=z(j(W),3),K=j(D);ae(Z=>me(K,Z),[()=>e.simca.oCrit[r(u)-1].toFixed(1)]),T(q,W)};Y(O,q=>{t()||q(R)})}ae((q,W,D)=>{me(y,r(a)[r(u)-1]),me(E,r(o)[r(u)-1]),me(C,r(a)[r(u)-1]+r(o)[r(u)-1]),me(M,q),me(I,W),me(U,D)},[()=>r(c)[r(u)-1].toFixed(3),()=>r(d)[r(u)-1].toFixed(r(d)[r(u)-1]>99?0:3),()=>e.simca.eCrit[r(u)-1].toFixed(1)]),T(g,h)};Y(v,g=>{e.model&&e.simca&&r(u)>0&&g(m)})}T(l,f),_e()}var Wm=X('<p class="title"> </p>'),Um=X("<!> <!> <!> <!> <!>",1);function Aa(l,e){be(e,!0);let t=V(e,"isAlt",3,!1),s=V(e,"simca",15),a=re(void 0),o=re(void 0);if(!s()&&e.model){const h="classic",p=nt(e.model,"cNh"),_=nt(e.model,"cNq"),b=p.map((C,A)=>C+_[A]),y=1-5/100,S=Math.pow(1-1/100,1/e.model.nrows),E=b.map(C=>ir(y,C)),k=b.map(C=>ir(S,C));B(a,5),B(o,1),s({ncomp:1,alpha:5,gamma:1,limType:h,Nf:b,eCrit:E,oCrit:k,className:e.className,hash:la()})}const c=[10,5,1,.1],d=[5,1,.1,.01];ue(()=>{if(s().alpha&&r(a)!==s().alpha){const m=1-s().alpha/100;s(s().eCrit=s().Nf.map(g=>ir(m,g)),!0),B(a,s().alpha,!0)}if(s().gamma&&r(o)!==s().gamma){const m=Math.pow(1-s().gamma/100,1/e.model.nrows);s(s().oCrit=s().Nf.map(g=>ir(m,g)),!0),B(o,s().gamma,!0)}}),ue(()=>{const m=s().limType.charAt(0),g=nt(e.model,m+"Nh"),h=nt(e.model,m+"Nq"),p=g.map((E,k)=>E+h[k]),_=1-s().alpha/100,b=Math.pow(1-s().gamma/100,1/e.model.nrows),y=p.map(E=>ir(_,E)),S=p.map(E=>ir(b,E));s(s().Nf=p,!0),s(s().eCrit=y,!0),s(s().oCrit=S,!0)});var u=he(),f=J(u);{var v=m=>{var g=Um(),h=J(g);ie(h,{name:"target-class",label:"",children:(E,k)=>{var C=Wm(),A=j(C);ae(()=>me(A,`Target class: ${s().className??""}`)),T(E,C)},$$slots:{default:!0}});var p=z(h,2);ie(p,{name:"ncomp",label:"# of PCs",children:(E,k)=>{On(E,{min:1,get max(){return e.model.ncomp},step:1,decNum:0,get value(){return s().ncomp},set value(C){s(s().ncomp=C,!0)}})},$$slots:{default:!0}});var _=z(p,2);ie(_,{name:"alpha",label:"Alpha, %:",children:(E,k)=>{Ke(E,{get options(){return c},get value(){return s().alpha},set value(C){s(s().alpha=C,!0)}})},$$slots:{default:!0}});var b=z(_,2);{var y=E=>{ie(E,{name:"gamma",label:"Gamma, %:",children:(k,C)=>{Ke(k,{get options(){return d},get value(){return s().gamma},set value(A){s(s().gamma=A,!0)}})},$$slots:{default:!0}})};Y(b,E=>{t()||E(y)})}var S=z(b,2);ie(S,{name:"limits",label:"Limits:",children:(E,k)=>{Ke(E,{options:["classic","robust"],get value(){return s().limType},set value(C){s(s().limType=C,!0)}})},$$slots:{default:!0}}),T(m,g)};Y(f,m=>{s()&&m(v)})}T(l,u),_e()}var Hm=X('<table class="svelte-kg0b31"><thead><tr class="svelte-kg0b31"><th class="svelte-kg0b31"></th><th class="svelte-kg0b31">Cal</th><th class="svelte-kg0b31">PV</th></tr></thead><tbody><tr class="svelte-kg0b31"><td class="label svelte-kg0b31">Objects</td><td class="svelte-kg0b31"> </td><td class="svelte-kg0b31"> </td></tr><tr class="svelte-kg0b31"><td class="label svelte-kg0b31">Extremes</td><td class="svelte-kg0b31"> </td><td class="svelte-kg0b31"> </td></tr><tr class="svelte-kg0b31"><td class="label svelte-kg0b31">Outliers</td><td class="svelte-kg0b31"> </td><td class="svelte-kg0b31"> </td></tr><tr class="svelte-kg0b31"><td class="label svelte-kg0b31">Sensitivity</td><td class="svelte-kg0b31"> </td><td class="svelte-kg0b31"> </td></tr></tbody></table>');function Gm(l,e){be(e,!0);let t=w(()=>e.calres?e.calres.v[0].rols.length:0);var s=he(),a=J(s);{var o=c=>{var d=Hm(),u=z(j(d)),f=j(u),v=z(j(f)),m=j(v),g=z(v),h=j(g),p=z(f),_=z(j(p)),b=j(_),y=z(_),S=j(y),E=z(p),k=z(j(E)),C=j(k),A=z(k),P=j(A),M=z(E),N=z(j(M)),I=j(N),L=z(N),F=j(L);ae((U,O)=>{me(m,r(t)),me(h,r(t)),me(b,e.calres.v[e.ncomp-1].rolsNum.extreme),me(S,e.pvres.v[e.ncomp-1].rolsNum.extreme),me(C,e.calres.v[e.ncomp-1].rolsNum.outlier),me(P,e.pvres.v[e.ncomp-1].rolsNum.outlier),me(I,U),me(F,O)},[()=>e.calres.stat.sensitivity[e.ncomp-1].toFixed(3),()=>e.pvres.stat.sensitivity[e.ncomp-1].toFixed(3)]),T(c,d)};Y(a,c=>{e.calres&&e.pvres&&c(o)})}T(l,s),_e()}var Xm=X('<div class="msg-select"> </div>'),Km=X('<div class="msg-select"> </div>'),Jm=X('<div class="msg-select"> </div>'),Qm=X('<div class="msg-select"> </div>'),Zm=X('<div class="selected-buttons svelte-8mh2yv"><!></div>'),$m=X('<div class="selected-buttons svelte-8mh2yv"><!></div>'),e0=X("<!> <!> <!>",1),t0=()=>switchPlot(i),r0=(l,e,t)=>B(e,r(t),!0),n0=X("<button> </button>"),l0=X('<div class="plot-panel svelte-8mh2yv"><div class="plot-area svelte-8mh2yv"><div class="plot svelte-8mh2yv"><!></div> <div class="plot-select-msg svelte-8mh2yv"><!> <!></div></div> <div class="plot-controls-area svelte-8mh2yv"></div></div>');function Na(l,e){be(e,!0);let t=V(e,"selobjText",3,"Click to select an object..."),s=V(e,"selvarText",3,"Make rectangular selection of variable to exclude ..."),a=V(e,"clearText",3,"Click anywhere to remove selection..."),o=V(e,"params",15),c=De({objects:-1,variables:[]}),d=re(De(Object.keys(e.plots)[0]));function u(N,I){c.objects=I?I[N]:N}function f(N){c.objects=-1}function v(N){c.variables=N}function m(N){c.variables=[]}let g={objects:{select:u,unselect:f},variables:{select:v,unselect:m},stats:{}},h=w(()=>r(d)?e.plots[r(d)]:null),p=w(()=>r(h)?r(h).component:null);var _=l0(),b=j(_),y=j(b),S=j(y);nl(S,()=>r(p),(N,I)=>{I(N,{get params(){return o()[r(d)]},get callbacks(){return g[r(h).scope]},get selected(){return c[r(h).scope]},get props(){return e.props}})});var E=z(y,2),k=j(E);{var C=N=>{var I=he(),L=J(I);{var F=O=>{var R=Xm(),q=j(R);ae(()=>me(q,t())),T(O,R)},U=O=>{var R=Km(),q=j(R);ae(()=>me(q,a())),T(O,R)};Y(L,O=>{c[r(h).scope]<0?O(F):O(U,!1)})}T(N,I)};Y(k,N=>{r(h).scope==="objects"&&o()[r(d)].plotType!=="l"&&t().length>0&&N(C)})}var A=z(k,2);{var P=N=>{var I=he(),L=J(I);{var F=O=>{var R=Jm(),q=j(R);ae(()=>me(q,s())),T(O,R)},U=O=>{var R=Qm(),q=j(R);ae(()=>me(q,a())),T(O,R)};Y(L,O=>{c[r(h).scope].length===0?O(F):O(U,!1)})}T(N,I)};Y(A,N=>{r(h).scope==="variables"&&o()[r(d)].plotType!=="l"&&s().length>0&&N(P)})}var M=z(b,2);Xe(M,21,()=>Object.keys(e.plots),Qe,(N,I)=>{var L=he(),F=J(L);{var U=R=>{var q=e0(),W=J(q);kd(W,{get title(){return r(h).label},labelWidth:12,get options(){return e.controls[r(d)]},get value(){return o()[r(d)]},set value($){o(o()[r(d)]=$,!0)}});var D=z(W,2);{var K=$=>{var ne=Zm(),ee=j(ne);Rr(ee,()=>r(h).buttons,()=>c.objects),T($,ne)};Y(D,$=>{r(h).scope==="objects"&&r(h).buttons&&c.objects>=0&&$(K)})}var Z=z(D,2);{var G=$=>{var ne=$m(),ee=j(ne);Rr(ee,()=>r(h).buttons,()=>c.variables),T($,ne)};Y(Z,$=>{r(h).scope==="variables"&&r(h).buttons&&c.variables.length>0&&$(G)})}T(R,q)},O=R=>{var q=n0();q.__keydown=[t0],q.__click=[r0,d,I];var W=j(q);ae(()=>{pt(q,1,`plot-selector plot-selector-${r(I)??""}`,"svelte-8mh2yv"),me(W,e.plots[r(I)].label)}),T(R,q)};Y(F,R=>{r(h)&&r(d)===r(I)?R(U):R(O,!1)})}T(N,L)}),T(l,_),_e()}mt(["keydown","click"]);function cc(l,e,t){!e.callbacks||!e.callbacks.select||En(l,l.target.tagName,s=>e.callbacks.select(s,t()))}function s0(l,e){!e.callbacks||!e.callbacks.unselect||e.callbacks.unselect()}var a0=Ne("<text> </text>"),o0=Ne('<g class="series series-textlabels"></g>'),i0=Ne('<g class="series series-line"><polyline class="line"></polyline></g>'),c0=Ne("<rect></rect>"),u0=Ne('<g class="series series-bar"></g>'),f0=Ne("<text> </text>"),d0=Ne('<g class="series series-points series-points1"></g>'),v0=Ne('<rect width="100%" height="100%" fill="#ffffff00"></rect>'),m0=Ne('<g class="series series-points series-points1"><text> </text></g>'),h0=Ne('<g class="series series-bar"><rect></rect></g>'),g0=Ne('<g class="series series-text"><text> </text></g>'),p0=Ne("<!><!><!>",1),b0=Ne("<!><!><!><!><!>",1);function ur(l,e){be(e,!0);let t=V(e,"shortenLabels",3,!0),s=V(e,"lineWidth",3,1),a=V(e,"nBars",3,1),o=V(e,"barNum",3,1),c=V(e,"markerSize",3,null),d=V(e,"markerWidth",3,2),u=V(e,"marker",3,1),f=V(e,"colors",3,void 0),v=V(e,"filled",3,void 0),m=V(e,"mainColor",19,()=>At.cal),g=V(e,"faceColor",3,null),h=V(e,"selected",19,()=>-1),p=V(e,"maskSelected",3,!0),_=V(e,"xRange",15),b=V(e,"yRange",15),y=V(e,"ind",3,null);const S=Vt("axes"),E=w(()=>Bt(e.xValues,"PlotSeries")),k=w(()=>r(E)?Bt(e.yValues,"PlotSeries",r(E).length):null);ue(()=>{if(y()){const fe=y().map(ye=>ye+1);_(r(E)?jr(r(E).subset(fe)):null),b(r(k)?jr(r(k).subset(fe)):null)}else _(r(E)?jr(r(E)):null),b(r(k)?jr(r(k)):null)});const C=w(()=>g()===null?e.plotType==="p"?"transparent":"white":g()),A=[1,.8,.8,.8,.8,.8,.8,.8],P=[.85,.65,.65,.65,.65,.65,.65,.65],M=w(()=>c()?c():e.plotType==="p"?A[u()-1]:P[u()-1]),N=w(()=>Bn[u()-1]),I=w(()=>da[S.scales().plot]),L=w(()=>_t([0],S.tY())[0]),F=w(()=>va([.8],S.tX())[0]),U=w(()=>e.plotType==="h"?r(F)/a():0),O=w(()=>e.plotType==="h"?r(F)/2-(o()-1)*r(U):0),R=w(()=>r(I));let q=w(()=>e.plotType==="l"||e.plotType==="b"?ga(r(E),r(k),S.tX(),S.tY()):null),W=w(()=>r(E)?_t(r(E),S.tX()):null),D=w(()=>r(k)?_t(r(k),S.tY()):null),K=w(()=>e.labels&&Array.isArray(e.labels)?t()?e.labels.map(fe=>fe.slice(0,ul)):e.labels:null);const Z=w(()=>y()?y():Nr(0,r(W).length-1));let G=w(()=>f()&&f().length===r(E).length?f():Array(r(E).length).fill(m())),$=w(()=>v()&&v().length===r(E).length?v().map(fe=>fe?"ff":"30"):Array(r(E).length).fill("30")),ne=w(()=>f()&&f().length===r(E).length?f().map((fe,ye)=>fe+r($)[ye]):Array(r(E).length).fill(g()));const ee=w(()=>`font-size:${r(M)}em;fill:${r(C)};cursor:default;text-anchor:middle;stroke-width:${d()}px;user-select:none;`),se=`font-size:0.85em;fill:${rc};cursor:default;text-anchor:middle;stroke:${rc};stroke-width:0.1px;user-select:none;`,pe=w(()=>`font-size:${r(M)}em;fill:none;text-anchor:middle;text-anchor:middle;cursor:default;stroke-width:2px;user-select:none;`),Me=`fill:transparent;stroke-width:${s()}px;`,Le=`stroke-width:${s()}px;`;ue(()=>{h()&&y()&&y().indexOf(h())<0&&e.callbacks.unselect()});var de=he(),ce=J(de);{var Ce=fe=>{var ye=b0(),le=J(ye);{var ve=Te=>{var Oe=o0();Xe(Oe,21,()=>r(Z),Qe,(Ee,Be)=>{var Fe=a0(),rr=j(Fe);ae(()=>{H(Fe,"opacity",r(Be)===h()),H(Fe,"x",r(W)[r(Be)]-r(O)+r(U)/2),H(Fe,"y",r(D)[r(Be)]),H(Fe,"dy",r(k).v[r(Be)]<0?r(R):-r(R)),me(rr,r(K)[r(Be)])}),T(Ee,Fe)}),ae(()=>bt(Oe,se+(h()>=0?"opacity:0.2;":""))),T(Te,Oe)};Y(le,Te=>{e.showLabels&&r(K)&&Te(ve)})}var oe=z(le);{var xe=Te=>{var Oe=i0(),Ee=j(Oe);ae(()=>{bt(Oe,Me),H(Ee,"points",r(q)),H(Ee,"stroke",m())}),T(Te,Oe)};Y(oe,Te=>{(e.plotType==="l"||e.plotType==="b")&&Te(xe)})}var ke=z(oe);{var ge=Te=>{var Oe=u0();Oe.__click=[cc,e,y],Xe(Oe,21,()=>r(Z),Qe,(Ee,Be)=>{var Fe=c0();ae(()=>{H(Fe,"x",r(W)[r(Be)]-r(O)),H(Fe,"y",r(k).v[r(Be)]<0?r(L):r(D)[r(Be)]),H(Fe,"fill",r(G)[r(Be)]),H(Fe,"width",r(U)),H(Fe,"height",r(k).v[r(Be)]<0?r(D)[r(Be)]-r(L):r(L)-r(D)[r(Be)])}),T(Ee,Fe)}),ae(()=>bt(Oe,Le+(h()>=0?"opacity:0.2;":""))),T(Te,Oe)};Y(ke,Te=>{e.plotType==="h"&&Te(ge)})}var je=z(ke);{var Pe=Te=>{var Oe=d0();Oe.__click=[cc,e,y],Xe(Oe,21,()=>r(Z),Qe,(Ee,Be)=>{var Fe=f0(),rr=j(Fe);ae(()=>{H(Fe,"x",r(W)[r(Be)]),H(Fe,"y",r(D)[r(Be)]),H(Fe,"fill",r(ne)[r(Be)]),H(Fe,"stroke",r(G)[r(Be)]),me(rr,r(N))}),T(Ee,Fe)}),ae(()=>bt(Oe,r(ee)+(h()>=0?"opacity:0.2;":""))),T(Te,Oe)};Y(je,Te=>{(e.plotType==="p"||e.plotType==="b")&&Te(Pe)})}var We=z(je);{var Ae=Te=>{var Oe=p0(),Ee=J(Oe);{var Be=qe=>{var Re=v0();H(Re,"x",0),H(Re,"y",0),Re.__click=[s0,e],T(qe,Re)};Y(Ee,qe=>{p()&&qe(Be)})}var Fe=z(Ee);{var rr=qe=>{var Re=m0(),Ve=j(Re),wt=j(Ve);ae(()=>{bt(Re,r(pe)),H(Ve,"x",r(W)[h()]),H(Ve,"y",r(D)[h()]),H(Ve,"stroke",r(G)[h()]),H(Ve,"fill",r(ne)[h()]),me(wt,r(N))}),T(qe,Re)},qr=qe=>{var Re=h0(),Ve=j(Re);ae(()=>{bt(Re,Le),H(Ve,"stroke",r(G)[h()]),H(Ve,"fill",r(G)[h()]),H(Ve,"x",r(W)[h()]-r(O)),H(Ve,"y",r(k).v[h()]<0?r(L):r(D)[h()]),H(Ve,"width",r(U)),H(Ve,"height",r(k).v[h()]<0?r(D)[h()]-r(L):r(L)-r(D)[h()])}),T(qe,Re)};Y(Fe,qe=>{e.plotType!=="h"?qe(rr):qe(qr,!1)})}var Fr=z(Fe);{var Se=qe=>{var Re=g0(),Ve=j(Re),wt=j(Ve);ae(()=>{bt(Re,se),H(Ve,"stroke",nc),H(Ve,"fill",nc),H(Ve,"x",r(W)[h()]),H(Ve,"y",r(D)[h()]),H(Ve,"dy",r(k).v[h()]<0?r(R):-r(R)),me(wt,r(K)[h()])}),T(qe,Re)};Y(Fr,qe=>{e.showLabels&&r(K)&&r(K).length>0&&qe(Se)})}T(Te,Oe)};Y(We,Te=>{h()>=0&&Te(Ae)})}T(fe,ye)};Y(ce,fe=>{r(W)&&r(D)&&fe(Ce)})}T(l,de),_e()}mt(["click"]);var _0=X("<!> <!> <!> <!>",1);function fl(l,e){be(e,!0);const t=w(()=>e.props&&e.props.data?e.props.data:null),s=w(()=>e.props&&e.props.res?e.props.res:null),a=w(()=>r(s)&&e.params.resID?r(s)[e.params.resID]:null),o=w(()=>r(s)&&e.params.resID?r(t)[e.params.resID]:null),c=w(()=>e.props&&e.props.model?e.props.model:null),d="#909090",u=100;let f=w(()=>e.params.limType==="classic"?{h:r(a).cNh,q:r(a).cNq}:{h:r(a).rNh,q:r(a).rNq}),v=w(()=>e.params.limType==="classic"?{h:r(a).ch0,q:r(a).cq0}:{h:r(a).rh0,q:r(a).rq0}),m=w(()=>({h:r(f).h[e.params.ncomp-1],q:r(f).q[e.params.ncomp-1]})),g=w(()=>({h:r(v).h[e.params.ncomp-1],q:r(v).q[e.params.ncomp-1]})),h=w(()=>e.params.alpha?1-e.params.alpha/100:.95),p=w(()=>e.params.gamma?1-e.params.gamma/100:.99),_=w(()=>ic(r(h),r(m).h,r(m).q,e.params.transType)),b=w(()=>r(c)?ic(Math.pow(r(p),1/r(c).nrows),r(m).h,r(m).q,e.params.transType):null),y=w(()=>r(a)?er(r(a),"hdist",e.params.ncomp):null),S=w(()=>r(a)?er(r(a),"qdist",e.params.ncomp):null),E=w(()=>ac(r(y),r(m).h,r(g).h,e.params.transType)),k=w(()=>ac(r(S),r(m).q,r(g).q,e.params.transType)),C=w(()=>r(a)?r(a).objlabels.map(D=>D.slice(0,ul)):null),A=w(()=>e.params.title?e.params.title:"Distances (A = "+e.params.ncomp+")"),P=w(()=>oc("h",e.params.transType)),M=w(()=>oc("q",e.params.transType)),N=re(void 0),I=re(void 0),L=w(()=>os(r(o),r(a),e.params.colorBy,e.params.colorByVar,e.params.resID,e.params.colorByObj)),F=w(()=>e.params.colorByObj?e.params.colorByObj.ind:null),U=w(()=>{if(!r(b)||!r(N))return[0,1];const D=Math.max(r(N)[1],r(b).x.v[u-1]);return[-.02*(D-r(N)[0]),1.05*D]}),O=w(()=>{if(!r(b)||!r(I))return[0,1];const D=Math.max(r(I)[1],r(b).y.v[0]);return[-.02*(D-r(I)[0]),(1.05+.1*(e.params.colorBy!=="none")+.05*e.params.showLabels)*D]});var R=he(),q=J(R);{var W=D=>{Pr(D,{get title(){return r(A)},get limX(){return r(U)},get limY(){return r(O)},get xLabel(){return r(P)},get yLabel(){return r(M)},fileName:"plot-distance",get onclick(){return e.callbacks.unselectObject},children:(K,Z)=>{var G=_0(),$=J(G);{var ne=de=>{Ut(de,{get xValues(){return r(_).x},get yValues(){return r(_).y},lineColor:d,lineType:2})};Y($,de=>{r(_)&&de(ne)})}var ee=z($,2);{var se=de=>{Ut(de,{get xValues(){return r(b).x},get yValues(){return r(b).y},lineColor:d,lineType:3})};Y(ee,de=>{r(b)&&(e.params.resID!=="test"||e.params.subset&&e.params.subset==="members")&&e.params.resID&&e.params.resID!=="new"&&de(se)})}var pe=z(ee,2);ur(pe,{get labels(){return r(C)},get selected(){return e.selected},get callbacks(){return e.callbacks},get xValues(){return r(E).values},get yValues(){return r(k).values},plotType:"p",get showLabels(){return e.params.showLabels},get marker(){return Ht[e.params.resID]},get colors(){return r(L).colors},get filled(){return r(L).filled},get ind(){return r(F)},get xRange(){return r(N)},set xRange(de){B(N,de,!0)},get yRange(){return r(I)},set yRange(de){B(I,de,!0)}});var Me=z(pe,2);{var Le=de=>{{let ce=w(()=>r(L).breaks!==null);ss(de,{get show(){return r(ce)},get colmap(){return r(L).map},get breaks(){return r(L).breaks},get labels(){return r(L).labels}})}};Y(Me,de=>{r(L)&&r(L).showBar&&de(Le)})}T(K,G)},$$slots:{default:!0}})};Y(q,D=>{r(E)&&r(k)&&D(W)})}T(l,R),_e()}var w0=X("<!> <!> <!> <!> <!>",1);function dl(l,e){be(e,!0);const t="Objects",s="topright",a={q:"Orthogonal distance, q/q0",h:"Score distance, h/h0",f:"Full distance, f/f0"},o={q:"Orthogonal distance, log(1 + q/q0)",h:"Score distance, log(1 + h/h0)",f:"Full distance, log(1 + f/f0)"},c="#909090",d=w(()=>e.props&&e.props.classres?e.props.classres:null),u=w(()=>e.props&&e.props.res?e.props.res:null),f=w(()=>e.props&&e.props.simca?e.props.simca:null),v=w(()=>e.props&&e.props.model?e.props.model:null),m=w(()=>e.props&&e.props.data?e.props.data:null),g=w(()=>r(u)?Object.keys(r(u))[0]:null),h=w(()=>r(g)?r(u)[r(g)]:null),p=w(()=>r(g)?r(m)[r(g)]:null),_=w(()=>r(f)?r(f).ncomp:null),b=w(()=>r(f)?r(f).Nf:null),y=w(()=>r(f)?r(f).limType.charAt(0):null),S=w(()=>r(v)?nt(r(v),r(y)+"h0"):null),E=w(()=>r(v)?nt(r(v),r(y)+"q0"):null),k=(ce,Ce,fe,ye)=>new ze(er(ce,Ce,fe).map(le=>le/ye)),C=w(()=>r(u)&&r(_)?Ql(r(u),(ce,Ce)=>k(ce[Ce],"hdist",r(_),r(S)[r(_)-1])):null),A=w(()=>r(u)&&r(_)?Ql(r(u),(ce,Ce)=>k(ce[Ce],"qdist",r(_),r(E)[r(_)-1])):null),P=w(()=>r(u)&&r(_)?Ql(r(u),(ce,Ce)=>k(ce[Ce],"fdist"+r(y),r(_),r(b)[r(_)-1])):null),M=w(()=>r(C)&&r(A)&&r(P)?{h:r(C),q:r(A),f:r(P)}:null);function N(ce,Ce){return!Ce||Ce=="no"?ce:new ze(ce.v.map(fe=>Math.log(1+fe)))}const I=w(()=>{if(!r(M))return null;if(e.params.resID==="both")return Ql(r(M)[e.params.distType],(fe,ye)=>({values:fe[ye],mainColor:At[ye],faceColor:$r[ye],marker:Ht[ye],max:$t(fe[ye])}));if(e.params.resID==="diff"){const fe=r(M)[e.params.distType].cal,ye=r(M)[e.params.distType].pv,le=fe.subtract(ye).apply(ve=>Math.abs(ve));return{"abs(cal - pv)":{values:le,mainColor:"#a0a0a0",faceColor:"#a0a0a0",max:$t(le)}}}const ce={},Ce=N(r(M)[e.params.distType][e.params.resID],e.params.transType);return ce[e.params.resID]={values:Ce,max:$t(Ce),mainColor:At[e.params.resID],faceColor:$r[e.params.resID],marker:Ht[e.params.resID]},ce});let L=w(()=>r(I)?Object.keys(r(I)).map(ce=>({id:ce,label:ce,point:{marker:e.params.resID==="diff"?2:r(I)[ce].marker,faceColor:r(I)[ce].faceColor,lineColor:r(I)[ce].mainColor,markerSize:.85,lineWidth:1.5}})):null);const F=w(()=>r(f)&&r(_)?r(f).eCrit[r(_)-1]/r(b)[r(_)-1]:null),U=w(()=>r(f)&&r(_)?r(f).oCrit[r(_)-1]/r(b)[r(_)-1]:null),O=w(()=>r(F)?e.params.transType&&e.params.transType==="log"?Math.log(1+r(F)):r(F):null),R=w(()=>r(U)?e.params.transType&&e.params.transType==="log"?Math.log(1+r(U)):r(U):null),q=w(()=>r(O)&&e.params.distType==="f"&&e.params.resID!=="diff"?r(O):0),W=w(()=>r(R)&&e.params.distType==="f"&&e.params.resID!=="diff"?r(R):0);let D=w(()=>os(r(p),r(h),e.params.colorBy,e.params.colorByVar,e.params.resID,null));const K=w(()=>r(I)?$t(Object.keys(r(I)).map(ce=>r(I)[ce].max).concat([r(W)])):null),Z=w(()=>r(h)?ze.seq(1,r(h).nrows):null),G=w(()=>r(h)?[0,r(h).nrows+1]:[0,1]),$=w(()=>r(K)?[-r(K)*.05,r(K)*1.2]:[0,1]),ne=w(()=>!e.params.transType||e.params.transType==="no"?a[e.params.distType]:o[e.params.distType]),ee=w(()=>r(h)?r(h).objlabels.map(ce=>ce.slice(0,ul)):null),se=w(()=>e.params.title?e.params.title:"Distances (A = "+r(_)+")"),pe=w(()=>!r(d)||r(d).length>1?!1:r(d)[Object.keys(r(u))[0]].nMembers<1);var Me=he(),Le=J(Me);{var de=ce=>{Pr(ce,{get title(){return r(se)},get limX(){return r(G)},get limY(){return r($)},xLabel:t,get yLabel(){return r(ne)},fileName:"plot-distances",get onclick(){return e.callbacks.unselectObject},children:(Ce,fe)=>{var ye=w0(),le=J(ye);{var ve=Ae=>{{let Te=w(()=>[r(q),r(q)]);Ut(Ae,{get xValues(){return r(G)},get yValues(){return r(Te)},lineColor:c,lineType:2})}};Y(le,Ae=>{r(q)>0&&Ae(ve)})}var oe=z(le,2);{var xe=Ae=>{{let Te=w(()=>[r(W),r(W)]);Ut(Ae,{get xValues(){return r(G)},get yValues(){return r(Te)},lineColor:c,lineType:3})}};Y(oe,Ae=>{r(W)>0&&e.params.resID&&e.params.resID!=="new"&&!r(pe)&&Ae(xe)})}var ke=z(oe,2);Xe(ke,17,()=>Object.keys(r(I)),Qe,(Ae,Te)=>{{let Oe=w(()=>e.params.colorBy&&e.params.colorBy!=="none"?r(D).colors:null),Ee=w(()=>e.params.resID==="diff"?"h":"p");ur(Ae,{get labels(){return r(ee)},get selected(){return e.selected},get callbacks(){return e.callbacks},get xValues(){return r(Z)},get yValues(){return r(I)[r(Te)].values},get mainColor(){return r(I)[r(Te)].mainColor},get faceColor(){return r(I)[r(Te)].faceColor},get marker(){return r(I)[r(Te)].marker},get colors(){return r(Oe)},get plotType(){return r(Ee)},get showLabels(){return e.params.showLabels}})}});var ge=z(ke,2);{var je=Ae=>{{let Te=w(()=>r(D).breaks!==null);ss(Ae,{get show(){return r(Te)},get colmap(){return r(D).map},get breaks(){return r(D).breaks},get labels(){return r(D).labels}})}};Y(ge,Ae=>{r(D)&&r(D).showBar&&Ae(je)})}var Pe=z(ge,2);{var We=Ae=>{{let Te=w(()=>!e.params.colorBy||e.params.colorBy==="none");Dn(Ae,{get items(){return r(L)},position:s,get show(){return r(Te)}})}};Y(Pe,Ae=>{r(L)&&r(L).length>0&&Ae(We)})}T(Ce,ye)},$$slots:{default:!0}})};Y(Le,ce=>{r(Z)&&r(I)&&ce(de)})}T(l,Me),_e()}var y0=X("<!> <!> <!> <!>",1);function x0(l,e){be(e,!0);const t="Components",s="Degrees of freedom, Nu",a="DoF",o="plot-dof",c={Nh:"#2679B2",Nq:"#D22C2F"},d={Nh:"#f0f8ff",Nq:"#fff8f0"};let u=w(()=>e.props&&e.props.simca?e.props.simca:null),f=w(()=>e.props&&e.props.model?e.props.model:null),v=w(()=>r(u)?r(u).ncomp:null),m=w(()=>e.params.dfID!=="both"?[e.params.dfID]:["Nh","Nq"]),g=w(()=>e.params.legendPosition?e.params.legendPosition:"topleft"),h=w(()=>r(m)?r(m).map(C=>({id:C,label:C,point:{marker:1,lineColor:c[C],faceColor:"white",markerSize:.85,lineWidth:1.5},line:{lineColor:c[C],lineWidth:1.5}})):null),p=w(()=>r(f)?ze.seq(1,r(f).ncomp):null),_=w(()=>r(u)&&r(m)?r(m).reduce((C,A)=>{const P=r(u).limType==="classic"?"c":"r";return C[A]=new ze(nt(r(f),P+A)),C},{}):null),b=w(()=>r(f)?[.5,r(f).ncomp+.5]:[0,1]),y=w(()=>{const C=Object.keys(r(_));if(C.length<1)return[0,1];const A=C.map(P=>$t(r(_)[P]));return[0,$t(A)*1.2]});var S=he(),E=J(S);{var k=C=>{Pr(C,{title:a,xLabel:t,yLabel:s,get limX(){return r(b)},get limY(){return r(y)},fileName:o,whole:!0,children:(A,P)=>{var M=y0(),N=J(M);{var I=q=>{{let W=w(()=>[r(v)]),D=w(()=>[r(v)]),K=w(()=>[r(y)[0]]),Z=w(()=>[r(y)[1]]);pr(q,{get xStart(){return r(W)},get xEnd(){return r(D)},get yStart(){return r(K)},get yEnd(){return r(Z)},lineColor:"#a0a0a0"})}};Y(N,q=>{r(v)&&q(I)})}var L=z(N,2);Xe(L,17,()=>r(m),Qe,(q,W)=>{ur(q,{get xValues(){return r(p)},get yValues(){return r(_)[r(W)]},plotType:"b",showLabels:!1,get faceColor(){return d[r(W)]},get mainColor(){return c[r(W)]},lineWidth:1.5})});var F=z(L,2);{var U=q=>{var W=he(),D=J(W);Xe(D,17,()=>r(m),Qe,(K,Z)=>{{let G=w(()=>[r(p).v[r(v)-1]]),$=w(()=>[r(_)[r(Z)].v[r(v)-1]]);ur(K,{get xValues(){return r(G)},get yValues(){return r($)},plotType:"p",showLabels:!1,get faceColor(){return c[r(Z)]},mainColor:"#a0a0a0",markerSize:1.2,lineWidth:1})}}),T(q,W)};Y(F,q=>{r(v)&&q(U)})}var O=z(F,2);{var R=q=>{Dn(q,{get items(){return r(h)},get position(){return r(g)}})};Y(O,q=>{r(h)&&r(h).length>0&&q(R)})}T(A,M)},$$slots:{default:!0}})};Y(E,C=>{r(p)&&r(_)&&C(k)})}T(l,S),_e()}var k0=X("<!> <!> <!>",1),E0=X("<!> <!> <!>",1);function Ma(l,e){be(e,!0);const t="#e0e0e0",s="Number of extremes (expected)",a="Number of extremes (observed)",o="plot-extremes";function c(N){const I=ze.zeros(N+1),L=ze.zeros(N+1),F=ze.zeros(N+1),U=ze.zeros(N+1);for(let O=1;O<N;O++){const R=O/N,q=2*Math.sqrt(O*(1-R));I.v[O]=O,F.v[O]=O,L.v[O]=O-q,U.v[O]=O+q}return I.v[N]=N,F.v[N]=N,L.v[N]=N,U.v[N]=N,{xStart:I,xEnd:F,yStart:L,yEnd:U}}function d(N,I,L){const F=N.v[L-1].f,U=I.Nf[L-1],O=N.nMembers,R=ze.zeros(O);for(let q=1;q<=O;q++){const W=q/O,D=ir(1-W,U);let K=0;for(let Z=0;Z<O;Z++)F[N.ind.members[Z]]>D&&(K+=1);R.v[q-1]=K}return R}let u=w(()=>e.props&&e.props.classres?e.props.classres:null),f=w(()=>e.props&&e.props.simca?e.props.simca:null),v=w(()=>e.props&&e.props.ncomp?e.props.ncomp:null),m=w(()=>Object.keys(r(u))),g=w(()=>e.params.resID!=="both"?[e.params.resID]:r(m)),h=w(()=>e.params.legendPosition?e.params.legendPosition:"bottomright"),p=w(()=>r(g)?r(g).map(N=>({id:N,label:N,point:{marker:1,lineColor:At[N],faceColor:$r[N],marker:Ht[N],markerSize:.85,lineWidth:1.5}})):null),_=w(()=>r(u)&&r(g)?r(g).reduce((N,I)=>(N[I]=ze.seq(1,r(u)[I].nMembers),N),{}):null),b=w(()=>r(u)&&r(m)&&r(v)?r(m).reduce((N,I)=>(N[I]=d(r(u)[I],r(f),r(v)),N),{}):null),y=w(()=>r(g)?r(g).reduce((N,I)=>Math.max(N,r(_)[I].length),0):1),S=w(()=>r(y)>1?c(r(y)):null),E=w(()=>r(_)?[-1,r(y)+2]:[0,1]),k=w(()=>r(_)?[-1,r(y)+2]:[0,1]),C=w(()=>r(v)?`Extremes (A = ${r(v)})`:"Extremes");var A=he(),P=J(A);{var M=N=>{Pr(N,{get title(){return r(C)},xLabel:s,yLabel:a,get limX(){return r(E)},get limY(){return r(k)},fileName:o,whole:!0,children:(I,L)=>{var F=E0(),U=J(F);{var O=D=>{var K=k0(),Z=J(K);pr(Z,Zt(()=>r(S),{lineColor:t}));var G=z(Z,2);Ut(G,{get xValues(){return r(S).xStart},get yValues(){return r(S).yStart},lineColor:t});var $=z(G,2);Ut($,{get xValues(){return r(S).xEnd},get yValues(){return r(S).yEnd},lineColor:t}),T(D,K)};Y(U,D=>{r(S)&&D(O)})}var R=z(U,2);Xe(R,17,()=>r(g),Qe,(D,K)=>{ur(D,{get xValues(){return r(_)[r(K)]},get yValues(){return r(b)[r(K)]},plotType:"p",showLabels:!1,get faceColor(){return $r[r(K)]},get mainColor(){return At[r(K)]},get marker(){return Ht[r(K)]},lineWidth:1.5})});var q=z(R,2);{var W=D=>{Dn(D,{get items(){return r(p)},get position(){return r(h)}})};Y(q,D=>{r(p)&&r(p).length>0&&D(W)})}T(I,F)},$$slots:{default:!0}})};Y(P,N=>{r(u)&&N(M)})}T(l,A),_e()}var C0=X("<!> <!>",1),S0=X("<!> <!> <!> <!> <!>",1);function is(l,e){be(e,!0);const t={sens:"sensitivity",sel:"selectivity",spec:"specificity",eff:"efficiency"},s=w(()=>t[e.params.statName]),a=w(()=>"plot-"+r(s)),o=w(()=>e.props&&e.props.classres?e.props.classres:null),c=w(()=>e.props&&e.props.ncomp?e.props.ncomp:null),d=w(()=>e.params.resID!=="both"?[e.params.resID]:Object.keys(r(o))),u=w(()=>e.params.legendPosition?e.params.legendPosition:"bottomright"),f=w(()=>r(d)?r(d).map(k=>({id:k,label:k,point:{marker:1,lineColor:At[k],faceColor:ya[k],marker:Ht[k],markerSize:.85,lineWidth:1.5}})):null);let v=w(()=>{if(!e.params.ci||!e.params.ci[e.params.statName])return null;const k=e.params.ci[e.params.statName];return!Array.isArray(k)||k.length!==2?null:k});const m=w(()=>r(o)?r(o)[r(d)[0]].stat.components.length:1),g=w(()=>r(m)>10?r(m)*.05:.5),h=w(()=>r(m)>1?1:0),p=w(()=>r(m)>1?r(m):2),_=w(()=>[r(h)-r(g),r(p)+r(g)]);let b=w(()=>{if(!e.params.zoom)return[0,1.1];if(!r(d)||r(d).length<1)return[0,1];const k=r(d).map(C=>jr(r(o)[C].stat[r(s)]));return Vl(k.flat(),.2)});var y=he(),S=J(y);{var E=k=>{{let C=w(()=>l1(r(s)));Pr(k,{get title(){return r(C)},xLabel:"Components",get yLabel(){return r(s)},get limX(){return r(_)},get limY(){return r(b)},get fileName(){return r(a)},whole:!0,children:(A,P)=>{var M=S0(),N=J(M);{var I=D=>{{let K=w(()=>[r(c)]),Z=w(()=>[r(c)]),G=w(()=>[r(b)[0]]),$=w(()=>[r(b)[1]]);pr(D,{get xStart(){return r(K)},get xEnd(){return r(Z)},get yStart(){return r(G)},get yEnd(){return r($)},lineColor:"#a0a0a0"})}};Y(N,D=>{r(c)&&D(I)})}var L=z(N,2);{var F=D=>{var K=C0();const Z=w(()=>r(_)[1]-r(_)[0]);var G=J(K);{let ne=w(()=>[r(_)[0]]),ee=w(()=>[r(v)[0]+r(v)[1]]),se=w(()=>[2*r(v)[1]]),pe=w(()=>[r(Z)]);cl(G,{get left(){return r(ne)},get top(){return r(ee)},get height(){return r(se)},get width(){return r(pe)},lineColor:"#transparent",faceColor:"#00000010"})}var $=z(G,2);{let ne=w(()=>[r(_)[0]]),ee=w(()=>[r(Z)]),se=w(()=>[r(v)[0]]),pe=w(()=>[r(v)[0]]);pr($,{get xStart(){return r(ne)},get xEnd(){return r(ee)},get yStart(){return r(se)},get yEnd(){return r(pe)},lineColor:"#a0a0a0",lineType:2})}T(D,K)};Y(L,D=>{r(v)&&D(F)})}var U=z(L,2);Xe(U,17,()=>r(d),Qe,(D,K)=>{ur(D,{get xValues(){return r(o)[r(K)].stat.components},get yValues(){return r(o)[r(K)].stat[r(s)]},plotType:"b",showLabels:!1,get faceColor(){return ya[r(K)]},get mainColor(){return At[r(K)]},get marker(){return Ht[r(K)]},lineWidth:1.5})});var O=z(U,2);{var R=D=>{var K=he(),Z=J(K);Xe(Z,17,()=>r(d),Qe,(G,$)=>{{let ne=w(()=>[r(o)[r($)].stat.components[r(c)-1]]),ee=w(()=>[r(o)[r($)].stat[r(s)][r(c)-1]]);ur(G,{get xValues(){return r(ne)},get yValues(){return r(ee)},plotType:"b",showLabels:!1,get faceColor(){return At[r($)]},get mainColor(){return At[r($)]},get marker(){return Ht[r($)]},markerSize:1,lineWidth:1})}}),T(D,K)};Y(O,D=>{r(c)&&D(R)})}var q=z(O,2);{var W=D=>{Dn(D,{get items(){return r(f)},get position(){return r(u)}})};Y(q,D=>{r(f)&&r(f).length>0&&D(W)})}T(A,M)},$$slots:{default:!0}})}};Y(S,k=>{r(o)&&k(E)})}T(l,y),_e()}function A0(l,e){be(e,!0);let t=V(e,"lineColor",3,"#606060"),s=V(e,"lineType",3,2),a=V(e,"alpha",3,.05),o=V(e,"xRange",15),c=V(e,"yRange",15);const d=ze.seq(0,2*Math.PI,.05);function u(b,y,S,E){const k=b.eigenvals[y-1],C=ir(1-a(),2),A=Math.sqrt(C*k),P=ze.zeros(E.length);for(let M=0;M<E.length;M++)P.v[M]=A*S(E.v[M]);return[P,-A,A]}let f=w(()=>e.comp?e.comp[0]:null),v=w(()=>r(f)?u(e.resobj,r(f),Math.cos,d):null);ue(()=>{o(r(v)?[r(v)[1],r(v)[2]]:null)});let m=w(()=>e.comp?e.comp[1]:null),g=w(()=>r(m)?u(e.resobj,r(m),Math.sin,d):null);ue(()=>{c(r(g)?[r(g)[1],r(g)[2]]:null)});var h=he(),p=J(h);{var _=b=>{Ut(b,{get xValues(){return r(v)[0]},get yValues(){return r(g)[0]},get lineColor(){return t()},get lineType(){return s()}})};Y(p,b=>{r(v)&&r(g)&&b(_)})}T(l,h),_e()}function N0(l,e){be(e,!0);let t=V(e,"confLevel",3,.95),s=V(e,"xRange",15),a=V(e,"yRange",15),o=w(()=>n1(e.xValues,e.yValues,e.groups,e.groupNames,e.groupColors,t()));ue(()=>{r(o)?(s(r(o).xRange),a(r(o).yRange)):(s(null),a(null))});var c=he(),d=J(c);{var u=f=>{var v=he(),m=J(v);Xe(m,17,()=>r(o).ellipses,Qe,(g,h,p)=>{Ut(g,{get xValues(){return r(h).x},get yValues(){return r(h).y},get lineColor(){return e.groupColors[p]}})}),T(f,v)};Y(d,f=>{r(o)&&r(o).ellipses&&f(u)})}T(l,c),_e()}var M0=X("<!> <!> <!> <!> <!> <!> <!> <!>",1);function vl(l,e){be(e,!0);let t=V(e,"alpha",3,.05);const s=w(()=>e.props&&e.props.data?e.props.data:null),a=w(()=>e.props&&e.props.res?e.props.res:null),o=w(()=>r(a)&&e.params?e.params.resID==="both"?Object.keys(r(a)):[e.params.resID]:null),c=w(()=>r(o)?r(a)[r(o)[0]]:null),d=w(()=>r(o)&&r(o).length>1?r(a)[r(o)[1]]:null),u=w(()=>r(o)?r(s)[r(o)[0]]:null);function f(de,ce,Ce,fe,ye,le){if(!Ce)return null;let ve=Ce[0],oe=Ce[1];fe&&(ve=Math.min(ve,fe[0]),oe=Math.max(oe,fe[1])),de&&ye&&(ve=Math.min(ve,ye[0]),oe=Math.max(oe,ye[1])),ce!=="none"&&le&&(ve=Math.min(ve,le[0]),oe=Math.max(oe,le[1]));const xe=(oe-ve)*.1;return{min:ve,max:oe,d:xe}}function v(de,ce){if(!(!de||!ce||ce<1||ce>de.ncomp))return new ze(er(de,"scores",ce))}let m=re(void 0),g=re(void 0),h=re(void 0),p=re(void 0),_=re(void 0),b=re(void 0),y=re(void 0),S=re(void 0),E=w(()=>r(c)?ct(r(c).objindices):null),k=w(()=>r(d)?ct(r(d).objindices):null),C=w(()=>r(c)?r(c).objlabels.map(de=>de.slice(0,ul)):null),A=w(()=>r(d)?r(d).objlabels.map(de=>de.slice(0,ul)):null),P=w(()=>v(r(c),e.params.comp1)),M=w(()=>v(r(d),e.params.comp1)),N=w(()=>e.params.plotType==="p"?r(P):r(E)),I=w(()=>e.params.plotType==="p"?r(M):r(k)),L=w(()=>e.params.comp2?e.params.comp2:null),F=w(()=>v(r(c),r(L))),U=w(()=>r(d)?v(r(d),r(L)):null),O=w(()=>os(r(u),r(c),e.params.colorBy,e.params.colorByVar,r(o)[0])),R=w(()=>Ht[r(o)[0]]),q=w(()=>r(o).length>1?os(null,r(d),"none",0,r(o)[1]):null),W=w(()=>r(o).length>1?Ht[r(o)[1]]:null),D=w(()=>e.params.plotType==="p"?lc(r(c),e.params.comp1):"Objects"),K=w(()=>lc(r(c),e.params.comp2)),Z=w(()=>f(e.params.showEllipse,e.params.confEllipse,r(m),r(h),r(_),r(y))),G=w(()=>r(Z)?[r(Z).min-r(Z).d,r(Z).max+r(Z).d]:[0,1]),$=w(()=>f(e.params.showEllipse,e.params.confEllipse,r(g),r(p),r(b),r(S))),ne=w(()=>r($)?[r($).min-r($).d,r($).max+r($).d*(1+(e.params.colorBy!=="none"))]:[0,1]),ee=w(()=>e.params.plotType==="l"||e.params.colorBy==="none"||!r(O)?"Scores":e.params.colorBy==="groups"?"Scores (colored by groups)":"Scores (colored by "+r(O).varname+(r(u).varvaluesUnits?" "+r(u).varvaluesUnits:"")+")");const se=w(()=>s1(r(o)));var pe=he(),Me=J(pe);{var Le=de=>{Pr(de,{get title(){return r(ee)},get limX(){return r(G)},get limY(){return r(ne)},get xLabel(){return r(D)},get yLabel(){return r(K)},fileName:"plot-scores",get onclick(){return e.callbacks.unselectObject},children:(ce,Ce)=>{var fe=M0(),ye=J(fe);{let Ee=w(()=>[r(G)[0]]),Be=w(()=>[r(G)[1]]);pr(ye,{get xStart(){return r(Ee)},get xEnd(){return r(Be)},yStart:[0],yEnd:[0],get lineColor(){return as}})}var le=z(ye,2);{var ve=Ee=>{{let Be=w(()=>[r(ne)[0]]),Fe=w(()=>[r(ne)[1]]);pr(Ee,{xStart:[0],xEnd:[0],get yStart(){return r(Be)},get yEnd(){return r(Fe)},get lineColor(){return as}})}};Y(le,Ee=>{e.params.plotType==="p"&&Ee(ve)})}var oe=z(le,2);{var xe=Ee=>{{let Be=w(()=>[e.params.comp1,e.params.comp2]);A0(Ee,{get alpha(){return t()},get resobj(){return r(c)},get comp(){return r(Be)},get xRange(){return r(_)},set xRange(Fe){B(_,Fe,!0)},get yRange(){return r(b)},set yRange(Fe){B(b,Fe,!0)}})}};Y(oe,Ee=>{e.params.showEllipse&&e.params.plotType==="p"&&Ee(xe)})}var ke=z(oe,2);{var ge=Ee=>{{let Be=w(()=>Number.parseInt(e.params.confEllipse)/100);N0(Ee,{get xValues(){return r(N)},get yValues(){return r(F)},get confLevel(){return r(Be)},get groups(){return r(c).classes},get groupNames(){return r(c).classNames},get groupColors(){return r(O).map},get xRange(){return r(y)},set xRange(Fe){B(y,Fe,!0)},get yRange(){return r(S)},set yRange(Fe){B(S,Fe,!0)}})}};Y(ke,Ee=>{e.params.colorBy==="groups"&&e.params.confEllipse!=="none"&&e.params.plotType==="p"&&r(O)&&Ee(ge)})}var je=z(ke,2);ur(je,{get xValues(){return r(N)},get yValues(){return r(F)},get labels(){return r(C)},get marker(){return r(R)},get nBars(){return r(o).length},barNum:1,get plotType(){return e.params.plotType},get showLabels(){return e.params.showLabels},get colors(){return r(O).colors},get mainColor(){return r(O).mainColor},get faceColor(){return r(O).faceTColor},get selected(){return e.selected},get callbacks(){return e.callbacks},get xRange(){return r(m)},set xRange(Ee){B(m,Ee,!0)},get yRange(){return r(g)},set yRange(Ee){B(g,Ee,!0)}});var Pe=z(je,2);{var We=Ee=>{{let Be=w(()=>e.params.showLabels&&e.params.plotType==="p");ur(Ee,{get xValues(){return r(I)},get yValues(){return r(U)},get labels(){return r(A)},get selected(){return e.selected},get callbacks(){return e.callbacks},get nBars(){return r(o).length},barNum:2,get plotType(){return e.params.plotType},get showLabels(){return r(Be)},get marker(){return r(W)},get colors(){return r(q).colors},get mainColor(){return r(q).mainColor},get faceColor(){return r(q).faceTColor},get xRange(){return r(h)},set xRange(Fe){B(h,Fe,!0)},get yRange(){return r(p)},set yRange(Fe){B(p,Fe,!0)}})}};Y(Pe,Ee=>{r(I)&&r(U)&&Ee(We)})}var Ae=z(Pe,2);{var Te=Ee=>{{let Be=w(()=>r(O).breaks!==null);ss(Ee,{get show(){return r(Be)},get colmap(){return r(O).map},get breaks(){return r(O).breaks},get labels(){return r(O).labels}})}};Y(Ae,Ee=>{r(O)&&Ee(Te)})}var Oe=z(Ae,2);{let Ee=w(()=>e.params.colorBy==="none");Dn(Oe,{get items(){return r(se)},get show(){return r(Ee)}})}T(ce,fe)},$$slots:{default:!0}})};Y(Me,de=>{r(N)&&r(F)&&de(Le)})}T(l,pe),_e()}var T0=X("<!> <!> <!>",1);function P0(l,e){be(e,!0);let t=w(()=>e.props?e.props.model:null);function s(k,C){return!k||!C||C<1||C>k.ncomp?null:new ze(nt(k,"loadings",C))}let a=re(void 0),o=re(void 0),c=w(()=>r(t)?ct(r(t).varvalues):null),d=w(()=>r(t)?ct(r(t).varindices):null),u=w(()=>s(r(t),e.params.comp1)),f=w(()=>!r(t)||!e.params.comp1?null:e.params.plotType==="p"?{values:r(u),label:`PC${e.params.comp1}`}:e.params.plotType==="l"&&r(c)?{values:r(c),label:r(t).varvaluesName+(r(t).varvaluesUnits?", "+r(t).varvaluesUnits:"")}:{values:r(d),label:"Variables"}),v=w(()=>r(f)?r(f).values:null),m=w(()=>r(f)?r(f).label:null),g=w(()=>s(r(t),e.params.comp2)),h=w(()=>`PC${e.params.comp2}`),p=w(()=>{if(r(o)&&r(o)[0]<Number.POSITIVE_INFINITY&&r(o)[1]>Number.NEGATIVE_INFINITY){const k=(r(o)[1]-r(o)[0])*.1;return[r(o)[0]-k,r(o)[1]+k]}else return[0,1]}),_=w(()=>{if(r(a)&&r(a)[0]<Number.POSITIVE_INFINITY&&r(a)[1]>Number.NEGATIVE_INFINITY){const k=(r(a)[1]-r(a)[0])*.1;return e.params.plotType==="l"&&r(t).varrev?[r(a)[1]+k,r(a)[0]-k]:[r(a)[0]-k,r(a)[1]+k]}else return[0,1]}),b=w(()=>{if(e.params.axesEqual)if(e.params.plotType==="p"){const k=Math.max(Math.abs(r(_)[0]),Math.abs(r(p)[0]),r(_)[1],r(p)[1])*1.05;return{x:[-k,k],y:[-k,k]}}else{const k=Math.max(Math.abs(r(p)[0]),r(p)[1])*1.05;return{x:r(_),y:[-k,k]}}return{x:r(_),y:r(p)}});var y=he(),S=J(y);{var E=k=>{Pr(k,{title:"Loadings",fileName:"plot-loadings",get xLabel(){return r(m)},get yLabel(){return r(h)},get limX(){return r(b).x},get limY(){return r(b).y},children:(C,A)=>{var P=T0(),M=J(P);{let F=w(()=>[r(b).x[0]]),U=w(()=>[r(b).x[1]]);pr(M,{get xStart(){return r(F)},get xEnd(){return r(U)},yStart:[0],yEnd:[0],get lineColor(){return as}})}var N=z(M,2);{var I=F=>{{let U=w(()=>[r(b).y[0]]),O=w(()=>[r(b).y[1]]);pr(F,{xStart:[0],xEnd:[0],get yStart(){return r(U)},get yEnd(){return r(O)},get lineColor(){return as}})}};Y(N,F=>{e.params.plotType==="p"&&F(I)})}var L=z(N,2);{let F=w(()=>tc+"30");ur(L,{get xValues(){return r(v)},get yValues(){return r(g)},get selected(){return e.selected},seriesTitle:"loadings",get plotType(){return e.params.plotType},get showLabels(){return e.params.showLabels},get labels(){return r(t).varlabels},shortenLabels:!1,get mainColor(){return tc},get faceColor(){return r(F)},get xRange(){return r(a)},set xRange(U){B(a,U,!0)},get yRange(){return r(o)},set yRange(U){B(o,U,!0)}})}T(C,P)},$$slots:{default:!0}})};Y(S,k=>{r(v)&&r(g)&&k(E)})}T(l,y),_e()}function Ta(l){const e=Object.keys(l),t=l[e[0]],s=t.nMembers>0&&t.nStrangers>0,a=t.nMembers>0?"members":t.nStrangers>0?"strangers":"all",o={resID:{el:Ke,hidden:e.length==1,default:e[0],label:"Show",props:{options:e}},subset:{el:Ke,hidden:!s,default:a,label:"Show",props:{options:["members","strangers","all"]}},transType:{el:Ke,hidden:!1,default:"no",label:"Transform",props:{options:["no","log"]}},showLabels:{el:tr,hidden:!1,default:!1,label:"Labels",props:{options:["hide","show"]}}};return t.nStrangers>0&&t.nStrangers==0&&t.classNames&&t.classNames.length>1&&(o.colorBy={el:Ke,hidden:!1,default:"roles",label:"Color by",props:{options:["roles","classes"]}}),o}function uc(l){const e=Object.keys(l),t=l[e[0]],s=[...e,"both"],a=t.nMembers>0?t.nStrangers>0?["sens","spec","eff","sel"]:["sens"]:["spec","sel"];return{resID:{el:Ke,hidden:e.length==1,default:e[0],label:"Show",props:{options:s}},statName:{el:Ke,hidden:a.length==1,default:a[0],label:"FoM",props:{options:a}},zoom:{el:tr,hidden:!1,default:!1,label:"Zoom",props:{options:["off","on"]}}}}function Pa(l){const e=Object.keys(l),t=l[e[0]],s=e.concat(["both","diff"]),a={resID:{el:Ke,hidden:e.length==1,default:e[0],label:"Result",props:{options:s}},transType:{el:Ke,hidden:e.length>1,default:"no",label:"Transform",props:{options:["no","log"]}},distType:{el:Ke,hidden:!1,default:"h",label:"Distance",props:{options:["h","q","f"]}},showLabels:{el:tr,hidden:!1,default:!1,label:"Labels",props:{options:["hide","show"]}}};return t.classNames&&t.classNames.length>1&&(a.colorBy={el:Ke,hidden:!1,default:"none",label:"Color by",props:{options:["none","groups"]}}),a}function z0(){return{dfID:{el:Ke,hidden:!1,default:"both",label:"DoF type",props:{options:["both","Nh","Nq"]}}}}function L0(l){return{resID:{el:Ke,hidden:l.length==1,default:l[0],label:"Results",props:{options:l}}}}function R0(l){return{resID:{el:Ke,hidden:l.length==1,default:l[0],label:"Results",props:{options:l}}}}function fc(l){return{resID:{el:Ke,hidden:l.length==1,default:l[0],label:"Results",props:{options:l}}}}function I0(l){return{plotType:{el:Mi,hidden:!1,default:"p",label:"Plot type",props:{options:["p","l","h"]}},comp2:{el:Tr,hidden:!1,default:l.ncomp>1?2:1,label:"PC (y-axis)",props:{min:1,max:l.ncomp}},comp1:{el:Tr,hidden:!1,default:1,label:"PC (x-axis)",props:{min:1,max:l.ncomp}},showLabels:{el:tr,hidden:!1,default:!1,label:"Labels",props:{options:["hide","show"]}},axesEqual:{el:tr,hidden:!1,default:!1,label:"Axes",props:{options:["normal","equal"]}}}}function za(l){const e=Object.keys(l),t=l[e[0]],s=t.classNames&&t.classNames.length>1?["none","groups","variable"]:["none","variable"],a=e.concat(["both"]);return{resID:{el:Ke,hidden:e.length==1,default:e[0],label:"Show",props:{options:a}},plotType:{el:Mi,hidden:!1,default:"p",label:"Plot type",props:{options:["p","l","h"]}},comp2:{el:Tr,hidden:!1,default:t.ncomp>1?2:1,label:"PC (y-axis)",props:{min:1,max:t.ncomp}},comp1:{el:Tr,hidden:!1,default:1,label:"PC (x-axis)",props:{min:1,max:t.ncomp}},showLabels:{el:tr,hidden:!1,default:!1,label:"Labels",props:{options:["hide","show"]}},showEllipse:{el:tr,hidden:!1,default:!1,label:"T2 ellipse",props:{options:["hide","show"]}},colorBy:{el:Ke,hidden:!1,default:"none",label:"Color by",props:{options:s}},colorByVar:{el:Tr,hidden:!0,default:1,label:"Variable",props:{min:1,max:t.ncols}},confEllipse:{el:Ke,hidden:!0,default:"none",label:"Conf ellipse",props:{options:["none","90","95","99"]}}}}var j0=X("<!> <!>",1);function q0(l,e){be(e,!0);const t=(h,p=kt)=>{ie(h,{label:"Selected",children:(_,b)=>{lt(_,{onclick:()=>e.markOutlier(p()),text:"remove"})},$$slots:{default:!0}})},s=(h,p=kt)=>{ie(h,{label:"Selected",children:(_,b)=>{var y=j0(),S=J(y);lt(S,{onclick:()=>e.showContributions(p()),text:"plot"});var E=z(S,2);lt(E,{onclick:()=>e.markOutlier(p()),text:"remove"}),T(_,y)},$$slots:{default:!0}})},a={cal:e.calres.pca,pv:e.pvres.pca},o={cal:e.calset,pv:e.pvset},c=w(()=>({cal:e.calres.simca,pv:e.pvres.simca})),d={regular:Zr.regular,extreme:Zr.extreme,outlier:Zr.outlier},u=w(()=>({acceptance:{label:"Acceptance",scope:"objects",component:fl,buttons:s},distances:{label:"Distances",scope:"objects",component:dl,buttons:s},dof:{label:"DoF",scope:"stats",component:x0},extremes:{label:"Extremes",scope:"stats",component:Ma},sensitivity:{label:"Sensitivity",scope:"stats",component:is},loadings:{label:"Loadings",scope:"stats",component:P0},scores:{label:"Scores",scope:"objects",component:vl,buttons:t}})),f=De({acceptance:Ta(a),distances:Pa(a),dof:z0(),extremes:fc(["cal","pv","both"]),sensitivity:uc(r(c)),scores:za(a),loadings:I0(e.model)});let v=re(De({acceptance:Rt(f.acceptance),distances:Rt(f.distances),dof:Rt(f.dof),extremes:Rt(f.extremes),sensitivity:Rt(f.sensitivity),scores:Rt(f.scores),loadings:Rt(f.loadings)}));ue(()=>{const h={};e.calres.simca.nMembers>0&&(h.sens=bi(e.calres.simca.nMembers,e.simca.alpha)),r(v).sensitivity.ci=h}),ue(()=>{r(v).acceptance.ncomp=e.simca.ncomp,r(v).acceptance.title=`Acceptance (A = ${e.simca.ncomp})`,r(v).acceptance.limType=e.simca.limType,r(v).acceptance.alpha=e.simca.alpha,r(v).acceptance.gamma=e.simca.gamma}),ue(()=>{if(e.simca.limType){const p={cal:e.calres.simca,pv:e.pvres.simca}[r(v).acceptance.resID].v[e.simca.ncomp-1];r(v).acceptance.colorByObj={classColmap:d,labels:[`regular: ${p.rolsNum.regular}`,`extreme: ${p.rolsNum.extreme}`,`outliers: ${p.rolsNum.outlier}`],values:p.rols}}}),ue(()=>{r(v).scores.plotType!=="p"?(f.scores.comp1.hidden=!0,f.scores.showEllipse.hidden=!0,r(v).scores.showEllipse=!1):(f.scores.comp1.hidden=!1,f.scores.showEllipse.hidden=!1),r(v).scores.plotType==="l"||r(v).scores.plotType==="b"?(f.scores.colorBy.hidden=!0,r(v).scores.colorBy="none"):f.scores.colorBy.hidden=!1,r(v).scores.colorBy==="variable"?f.scores.colorByVar.hidden=!1:f.scores.colorByVar.hidden=!0,r(v).scores.colorBy==="groups"&&r(v).scores.plotType==="p"?f.scores.confEllipse.hidden=!1:(f.scores.confEllipse.hidden=!0,r(v).scores.confEllipse="none"),r(v).scores.colorBy==="variable"?(r(v).scores.resID==="both"&&(r(v).scores.resID="cal"),f.scores.resID.props.options=["cal","pv"]):f.scores.resID.props.options=["cal","pv","both"]}),ue(()=>{r(v).loadings.plotType!=="p"?f.loadings.comp1.hidden=!0:f.loadings.comp1.hidden=!1});const m=w(()=>({res:a,classres:r(c),model:e.model,simca:e.simca,data:o,ncomp:e.simca.ncomp})),g={markOutlier:e.markOutlier,showContributions:e.showContributions};Na(l,{get plots(){return r(u)},get controls(){return f},get props(){return r(m)},get callbacks(){return g},get params(){return r(v)},set params(h){B(v,h,!0)}}),_e()}var F0=X('<div class="outliers-pane svelte-1v0yar6"><!></div>'),O0=X('<div class="model-calculator svelte-1v0yar6"><!></div>'),B0=X('<div class="pcv-calculator svelte-1v0yar6"><!></div>'),D0=X('<div class="buttons"><!> <!> <!></div>'),V0=X('<div class="model-stats svelte-1v0yar6"><!></div> <div class="result-stats svelte-1v0yar6"><!></div>',1),Y0=X(`<p class="svelte-1v0yar6">In this tab you can train a DD-SIMCA model and optimize its parameters using Procrustes cross-validation. After creating the model you can save it to a file and use it in other tabs. For example, validate and tune it using test set with target class members (tab <strong>Predict: Target</strong>) or apply it to a dataset with non-target class members (tab <strong>Predict: New</strong>).</p> <p class="svelte-1v0yar6"><strong>Step 1.</strong></p> <p class="svelte-1v0yar6">Load your training set from a CSV file. The file should contain data as numeric values delimited
               by comma (with dot as decimal separator) or by semicolon (with comma as decimal separator). Rows correspond to observations or objects, columns — to variables.</p> <p class="svelte-1v0yar6">First column must contain class names for each row. All rows in the training set should belong to the target class, so it is expected that the class names are the same (you will get error message if not).</p> <p class="svelte-1v0yar6">First row can contain variable names (<strong>header</strong>) and first column can contain labels for the objects/observations (<strong>row labels</strong>) — just set the corresponding options after selecting the file. In this case it is assumed that column with the class names is located next to the column with row labels. Here is an example:</p> <div class="svelte-1v0yar6"><table class="svelte-1v0yar6"><thead class="svelte-1v0yar6"><tr class="svelte-1v0yar6"><td class="svelte-1v0yar6">Name</td><td class="svelte-1v0yar6">Class</td><td class="svelte-1v0yar6">x1</td><td class="svelte-1v0yar6">x2</td><td class="svelte-1v0yar6">x3</td></tr></thead><tbody class="svelte-1v0yar6"><tr><td class="svelte-1v0yar6">O1</td><td class="svelte-1v0yar6">A</td><td class="svelte-1v0yar6">3.8</td><td class="svelte-1v0yar6">1.3</td><td class="svelte-1v0yar6">13.6</td></tr><tr><td class="svelte-1v0yar6">O2</td><td class="svelte-1v0yar6">A</td><td class="svelte-1v0yar6">11.1</td><td class="svelte-1v0yar6">12.3</td><td class="svelte-1v0yar6">3.3</td></tr><tr><td class="svelte-1v0yar6">O3</td><td class="svelte-1v0yar6">A</td><td class="svelte-1v0yar6">1.2</td><td class="svelte-1v0yar6">2.3</td><td class="svelte-1v0yar6">4.2</td></tr></tbody></table></div> <p class="svelte-1v0yar6"></p>`,1),W0=X(`<p class="svelte-1v0yar6"><strong>Step 2</strong></p> <p class="svelte-1v0yar6">Next step is to create a global PCA model for the calibration set, which will be the basis for the SIMCA model. Use more components/latent variables (PCs) than you expect to be optimal. You will have possibility to set
               optimal number later.</p>`,1),U0=X('<p class="svelte-1v0yar6"><strong>Step 3</strong></p> <p class="svelte-1v0yar6">Now set necessary parameters for Procrustes cross-validation and click button to compute the PV-set, which will help you to optimize SIMCA model parameters. The parameters are the same as for conventional cross-validation: type of splits and number of segments. It is recommended to use fewer number of segments (e.g. 3, 4 or 5).</p> <p class="svelte-1v0yar6">After this step SIMCA model will be created automatically and you will be able to tune its parameters.</p>',1),H0=X("<!> <!>",1),G0=X('<div class="help-text svelte-1v0yar6"><!></div>'),X0=X('<!> <div class="app-container svelte-1v0yar6"><div class="app-controls svelte-1v0yar6"><div class="data-loader svelte-1v0yar6"><!></div> <!> <!> <!> <!> <div class="simca-settings svelte-1v0yar6"><!> <!></div> <!></div> <div class="app-content svelte-1v0yar6"><!></div></div>',1);function K0(l,e){be(e,!0);const t=w(()=>e.session.train);let s=re(-1),a=re(!1);function o(G){if(G<0||G>r(t).calres.pca.nrows-1)return;const $=r(t).calres.pca.objindices[G];$>=0&&!r(t).outliers.includes($)&&(r(t).outliers.push($),r(t).model=null,r(t).simca=null,r(t).pvres.simca=null,r(t).pvres.pca=null,r(t).calres.simca=null,r(t).calres.pca=null,r(t).calsetp=null,r(t).prepmodel=null,r(t).pvset=null)}function c(){r(t).outliers=[],r(t).model=null,r(t).pvres.simca=null,r(t).pvres.pca=null,r(t).calres.simca=null,r(t).calres.pca=null,r(t).calsetp=null,r(t).prepmodel=null,r(t).pvset=null}function d(){r(t).outliers.pop(),r(t).model=null,r(t).pvres.simca=null,r(t).pvres.pca=null,r(t).calres.simca=null,r(t).calres.pca=null,r(t).calsetp=null,r(t).prepmodel=null,r(t).pvset=null}function u(G){G<0||(B(s,G,!0),B(a,!0))}function f(){B(a,!1),B(s,-1)}let v=w(()=>r(t).calres.pca?{members:Nr(0,r(t).calres.pca.nrows-1),strangers:[]}:null);Il(()=>{r(t).calset===null?(r(t).model=null,r(t).calsetp=null,r(t).className=null,r(t).outliers=[],r(t).pvset=null,r(t).prepmodel=null,r(t).prepobj=[],r(t).prepType=null):r(t).calset&&!r(t).className&&(r(t).className=r(t).calset.classNames[0]),r(t).model===null&&(r(t).calres.simca=null,r(t).simca=null,r(t).calres.pca=null,r(t).pvset=null),r(t).pvset===null&&(r(t).pvres.simca=null,r(t).pvres.pca=null)}),ue(()=>{r(t).calset===null&&(r(t).calsetp=null)}),ue(()=>{r(t).calsetp===null&&(r(t).simca=null,r(t).pvset=null,r(t).model=null)}),ue(()=>{r(t).model===null&&(r(t).pvres={pca:null,scima:null},r(t).calres={pca:null,simca:null},r(t).pvset=null)}),ue(()=>{r(t).pvset===null&&(r(t).pvres.simca=null,r(t).pvres.pca=null)}),ue(()=>{r(t).calres.pca&&r(t).simca&&r(t).simca.eCrit&&r(t).simca.oCrit&&r(v)&&(r(t).calres.simca=es(r(t).calres.pca,Yt(()=>r(t).simca.limType),r(t).simca.eCrit,r(t).simca.oCrit,r(v)))}),ue(()=>{r(t).pvres.pca&&r(t).simca&&r(v)&&(r(t).pvres.simca=es(r(t).pvres.pca,Yt(()=>r(t).simca.limType),r(t).simca.eCrit,r(t).simca.oCrit,r(v)))}),ue(()=>{const G=Yt(()=>JSON.stringify(e.session,ol));r(t).simca?e.backupSession(G,r(t).model,r(t).calset,r(t).pvset,r(t).simca.ncomp,r(t).pvres.simca):e.backupSession(G,r(t).model,r(t).calset,r(t).pvset,r(t).simca,r(t).pvres.simca)});var m=X0(),g=J(m);{var h=G=>{{let $=w(()=>({cal:r(t).calres.pca,pv:r(t).pvres.pca}));xa(G,{get model_getter(){return nt},get res_getter(){return er},get model(){return r(t).model},get res(){return r($)},closeModal:f,get ncomp(){return r(t).simca.ncomp},get selected(){return r(s)}})}};Y(g,G=>{r(a)&&r(t).simca&&r(t).calres.pca&&r(t).pvres.pca&&G(h)})}var p=z(g,2),_=j(p),b=j(_),y=j(b);Ca(y,{className:"Class",classMandatory:!0,classUnique:!0,get dataset(){return r(t).calset},set dataset(G){r(t).calset=G}});var S=z(b,2);{var E=G=>{var $=F0(),ne=j($);ua(ne,{get outliers(){return r(t).outliers},get dataset(){return r(t).calset},resetOutliers:c,undoOutliers:d}),T(G,$)};Y(S,G=>{r(t).outliers&&r(t).outliers.length>0&&G(E)})}var k=z(S,2);{var C=G=>{vm(G,{get WASM(){return e.WASM},get rawdata(){return r(t).calset},get outliers(){return r(t).outliers},get prepType(){return r(t).prepType},set prepType($){r(t).prepType=$},get prepobj(){return r(t).prepobj},set prepobj($){r(t).prepobj=$},get prepdata(){return r(t).calsetp},set prepdata($){r(t).calsetp=$},get prepmeta(){return r(t).prepmeta},set prepmeta($){r(t).prepmeta=$},get prepmodel(){return r(t).prepmodel},set prepmodel($){r(t).prepmodel=$}})};Y(k,G=>{r(t).calset&&G(C)})}var A=z(k,2);{var P=G=>{var $=O0(),ne=j($);Rm(ne,{get WASM(){return e.WASM},get dataset(){return r(t).calsetp},get outliers(){return r(t).outliers},get model(){return r(t).model},set model(ee){r(t).model=ee},get resobj(){return r(t).calres.pca},set resobj(ee){r(t).calres.pca=ee}}),T(G,$)};Y(A,G=>{r(t).calsetp&&G(P)})}var M=z(A,2);{var N=G=>{var $=B0(),ne=j($);Dm(ne,{get WASM(){return e.WASM},get calset(){return r(t).calsetp},get outliers(){return r(t).outliers},get model(){return r(t).model},get calres(){return r(t).calres.pca},get pvset(){return r(t).pvset},set pvset(ee){r(t).pvset=ee},get pvres(){return r(t).pvres.pca},set pvres(ee){r(t).pvres.pca=ee}}),T(G,$)};Y(M,G=>{r(t).model&&r(t).calsetp&&r(t).calres.pca&&G(N)})}var I=z(M,2),L=j(I);{var F=G=>{Aa(G,{get model(){return r(t).model},get className(){return r(t).className},get simca(){return r(t).simca},set simca($){r(t).simca=$}})};Y(L,G=>{r(t).model&&r(t).pvres.pca&&r(t).calres.pca&&G(F)})}var U=z(L,2);{var O=G=>{ie(G,{label:"Download",children:($,ne)=>{var ee=D0(),se=j(ee);lt(se,{onclick:()=>ts(r(t).model,r(t).simca,r(t).calres,r(t).calset,"train",r(t).outliers),text:"Res (cal)"});var pe=z(se,2);lt(pe,{onclick:()=>ts(r(t).model,r(t).simca,r(t).pvres,r(t).pvset,"PV",r(t).outliers),text:"Res (pv)"});var Me=z(pe,2);lt(Me,{onclick:()=>ca(r(t).model,r(t).simca,r(t).prepmodel),text:"Model"}),T($,ee)},$$slots:{default:!0}})};Y(U,G=>{r(t).model&&r(t).pvres.simca&&r(t).calres.simca&&G(O)})}var R=z(I,2);{var q=G=>{var $=V0(),ne=J($),ee=j(ne);Sa(ee,{get model(){return r(t).model},get simca(){return r(t).simca}});var se=z(ne,2),pe=j(se);Gm(pe,{get calres(){return r(t).calres.simca},get pvres(){return r(t).pvres.simca},get ncomp(){return r(t).simca.ncomp}}),T(G,$)};Y(R,G=>{r(t).simca&&r(t).pvres.simca&&r(t).calres.simca&&G(q)})}var W=z(_,2),D=j(W);{var K=G=>{var $=G0(),ne=j($);{var ee=pe=>{var Me=Y0();T(pe,Me)},se=pe=>{var Me=H0(),Le=J(Me);{var de=fe=>{var ye=W0();T(fe,ye)};Y(Le,fe=>{r(t).model||fe(de)})}var ce=z(Le,2);{var Ce=fe=>{var ye=U0();T(fe,ye)};Y(ce,fe=>{r(t).model&&!r(t).pvset&&fe(Ce)})}T(pe,Me)};Y(ne,pe=>{r(t).calset?pe(se,!1):pe(ee)})}T(G,$)},Z=G=>{var $=he(),ne=J($);{var ee=se=>{var pe=he(),Me=J(pe);bn(Me,()=>r(t).pvres.pca,Le=>{q0(Le,Zt({markOutlier:o,showContributions:u},()=>r(t)))}),T(se,pe)};Y(ne,se=>{r(t).model&&r(t).simca&&r(t).pvres.pca&&se(ee)},!0)}T(G,$)};Y(D,G=>{!r(t).pvres.simca||!r(t).calres.simca?G(K):G(Z,!1)})}T(l,m),_e()}var J0=X("<!> <!>",1),Q0=X('<br/><span style="color:#a0a0a0;">Preprocessing:</span> <!>',1),Z0=X('<p class="model-info svelte-14tszjv"><span>Model file:</span> <span class="file-name svelte-14tszjv"> </span><br/> <span style="color:#a0a0a0;">PCA model:</span> <!></p> <!>',1),$0=X("<p><!></p>"),eh=X("<!> <!>",1);function dc(l,e){be(e,!0);let t=V(e,"model",15),s=V(e,"simca",15),a=re(""),o=re("neutral"),c=re("");function d(y){try{const S=JSON.parse(y,aa);if(!Object.keys(S).includes("pca","simca")||S.pca.class[0]!=="pcamodel")throw Error("The JSON file you selected does not contain SIMCA mdel.");if(!Object.keys(S.pca).includes("hash"))throw Error('you try to load model incompatible with this app version, create a new model or use <a href="/ddsimca-old/">old version</a> of the app.');Array.isArray(S.pca.v)&&(S.pca.v=Float64Array.from(S.pca.v)),S.pca.fileName=r(v),t(S.pca),s(S.simca),B(o,"success"),B(c,"")}catch(S){t(null),B(o,"error"),B(c,S,!0)}}function u(y){const S=new FileReader;S.onload=()=>{d(S.result)},S.readAsText(r(a))}function f(){B(a,""),t(null),B(o,"neutral"),B(c,"")}ue(()=>{r(a)===null?(t(null),B(o,"neutral"),B(c,"")):(B(o,"neutral"),B(c,""))});let v=w(()=>r(a)?r(a).name.replace(/\.[^/.]+$/,""):"");var m=eh(),g=J(m);{var h=y=>{var S=J0(),E=J(S);bn(E,()=>r(a),A=>{ie(A,{children:(P,M)=>{$l(P,{id:"modelFile",acceptType:".json",message:"Select file with model",get file(){return r(a)},set file(N){B(a,N,!0)}})},$$slots:{default:!0}})});var k=z(E,2);{var C=A=>{ie(A,{label:" ",children:(P,M)=>{lt(P,{onclick:u,text:"Load"})},$$slots:{default:!0}})};Y(k,A=>{r(a)&&A(C)})}T(y,S)},p=y=>{ie(y,{name:"info",children:(S,E)=>{var k=Z0(),C=J(k),A=z(j(C),2),P=j(A),M=z(A,4),N=z(M);{var I=F=>{var U=Q0(),O=z(J(U),3);Ea(O,{get prepmodel(){return t().prep}}),T(F,U)};Y(N,F=>{t().prep&&F(I)})}var L=z(C,2);Mr(L,{onclick:f}),ae(()=>{H(A,"title",t().fileName),me(P,t().fileName),me(M,` ${t().ncomp??""} PCs${t().center?", centered":""}${t().scale?", scaled":""} `)}),T(S,k)},$$slots:{default:!0}})};Y(g,y=>{t()?y(p,!1):y(h)})}var _=z(g,2);{var b=y=>{ie(y,{status:"error",children:(S,E)=>{var k=$0(),C=j(k);Mt(C,()=>r(c)),T(S,k)},$$slots:{default:!0}})};Y(_,y=>{(r(o)==="error"||r(c))&&y(b)})}T(l,m),_e()}var th=X('<tr class="svelte-1i1bo7x"><td class="label svelte-1i1bo7x">Out</td><td class="svelte-1i1bo7x"> </td></tr> <tr class="svelte-1i1bo7x"><td class="label svelte-1i1bo7x">Sensitivity</td><td class="svelte-1i1bo7x"> </td></tr>',1),rh=X('<tr class="svelte-1i1bo7x"><td class="label svelte-1i1bo7x">In</td><td class="svelte-1i1bo7x"> </td></tr> <tr class="svelte-1i1bo7x"><td class="label svelte-1i1bo7x">Specificity</td><td class="svelte-1i1bo7x"> </td></tr> <tr class="svelte-1i1bo7x"><td class="label svelte-1i1bo7x">Selectivity</td><td class="svelte-1i1bo7x"> </td></tr>',1),nh=X('<tr class="svelte-1i1bo7x"><td class="label svelte-1i1bo7x">Efficiency</td><td class="svelte-1i1bo7x"> </td></tr>'),lh=X('<table class="svelte-1i1bo7x"><thead><tr class="svelte-1i1bo7x"><th class="svelte-1i1bo7x"></th><th class="svelte-1i1bo7x">Test</th></tr></thead><tbody><tr class="svelte-1i1bo7x"><td class="label svelte-1i1bo7x">Members</td><td class="svelte-1i1bo7x"> </td></tr><!><tr class="section svelte-1i1bo7x"><td class="label svelte-1i1bo7x">Strangers</td><td class="svelte-1i1bo7x"> </td></tr><!><!></tbody></table>');function sh(l,e){be(e,!0);var t=he(),s=J(t);{var a=o=>{var c=lh(),d=z(j(c)),u=j(d),f=z(j(u)),v=j(f),m=z(u);{var g=k=>{var C=th(),A=J(C),P=z(j(A)),M=j(P),N=z(A,2),I=z(j(N)),L=j(I);ae(F=>{me(M,e.res.v[e.ncomp-1].rolsNum.outlier+e.res.v[e.ncomp-1].rolsNum.extreme),me(L,F)},[()=>e.res.stat.sensitivity[e.ncomp-1].toFixed(3)]),T(k,C)};Y(m,k=>{e.res.nMembers>0&&k(g)})}var h=z(m),p=z(j(h)),_=j(p),b=z(h);{var y=k=>{var C=rh(),A=J(C),P=z(j(A)),M=j(P),N=z(A,2),I=z(j(N)),L=j(I),F=z(N,2),U=z(j(F)),O=j(U);ae((R,q)=>{me(M,e.res.v[e.ncomp-1].decsNum.in-e.res.v[e.ncomp-1].rolsNum.regular),me(L,R),me(O,q)},[()=>e.res.stat.specificity[e.ncomp-1].toFixed(3),()=>e.res.stat.selectivity[e.ncomp-1].toFixed(3)]),T(k,C)};Y(b,k=>{e.res.nStrangers>0&&k(y)})}var S=z(b);{var E=k=>{var C=nh(),A=z(j(C)),P=j(A);ae(M=>me(P,M),[()=>e.res.stat.efficiency[e.ncomp-1].toFixed(3)]),T(k,C)};Y(S,k=>{e.res.nStrangers>0&&e.res.nMembers>0&&k(E)})}ae(()=>{me(v,e.res.nMembers),me(_,e.res.nStrangers)}),T(o,c)};Y(s,o=>{e.res&&o(a)})}T(l,t),_e()}var ah=X("<!> <!> <!>",1),oh=X("<!> <!> <!>",1);function vc(l,e){be(e,!0);const t="#e0e0e0",s="Number of aliens (expected)",a="Number of aliens (observed)",o="plot-aliens";function c(M){const N=ze.zeros(M+1),I=ze.zeros(M+1),L=ze.zeros(M+1),F=ze.zeros(M+1);for(let U=1;U<M;U++){const O=U/M,R=2*Math.sqrt(U*(1-O));N.v[U]=U,L.v[U]=U,I.v[U]=U-R,F.v[U]=U+R}return N.v[M]=M,L.v[M]=M,I.v[M]=M,F.v[M]=M,{xStart:N,xEnd:L,yStart:I,yEnd:F}}function d(M,N,I){const L=M.v[I-1],F=L.rolsNum.alien,U=ze.zeros(F);for(let O=1;O<=F;O++){const R=O/F,q=Ul(R),W=L.m*Math.pow(L.Sz*q+L.Mz,1/L.hz);let D=0;for(let K of M.ind.strangers)L.rols[K]==="alien"&&L.f[K]<W&&(D+=1);U.v[O-1]=D}return U}let u=w(()=>e.props&&e.props.classres?e.props.classres:null),f=w(()=>e.props&&e.props.simca?e.props.simca:null),v=w(()=>e.props&&e.props.ncomp?e.props.ncomp:null),m=w(()=>e.params.resID!=="both"?[e.params.resID]:Object.keys(r(u))),g=w(()=>e.params.legendPosition?e.params.legendPosition:"bottomright"),h=w(()=>r(m)?r(m).map(M=>({id:M,label:M,point:{marker:1,lineColor:At[M],faceColor:$r[M],marker:Ht[M],markerSize:.85,lineWidth:1.5}})):null),p=w(()=>r(u)&&r(m)?r(m).reduce((M,N)=>(M[N]=ze.seq(1,r(u)[N].v[r(v)-1].rolsNum.alien),M),{}):null),_=w(()=>r(u)&&r(m)&&r(v)?r(m).reduce((M,N)=>(M[N]=d(r(u)[N],r(f),r(v)),M),{}):null),b=w(()=>r(m)?r(m).reduce((M,N)=>Math.max(M,r(p)[N].length),0):1),y=w(()=>r(b)>1?c(r(b)):null),S=w(()=>r(p)?[-1,r(b)+2]:[0,1]),E=w(()=>r(p)?[-1,r(b)+2]:[0,1]),k=w(()=>r(v)?`Aliens (A = ${r(v)})`:"Aliens");var C=he(),A=J(C);{var P=M=>{Pr(M,{get title(){return r(k)},xLabel:s,yLabel:a,get limX(){return r(S)},get limY(){return r(E)},fileName:o,whole:!0,children:(N,I)=>{var L=oh(),F=J(L);{var U=W=>{var D=ah(),K=J(D);pr(K,Zt(()=>r(y),{lineColor:t}));var Z=z(K,2);Ut(Z,{get xValues(){return r(y).xStart},get yValues(){return r(y).yStart},lineColor:t});var G=z(Z,2);Ut(G,{get xValues(){return r(y).xEnd},get yValues(){return r(y).yEnd},lineColor:t}),T(W,D)};Y(F,W=>{r(y)&&W(U)})}var O=z(F,2);Xe(O,17,()=>r(m),Qe,(W,D)=>{ur(W,{get xValues(){return r(p)[r(D)]},get yValues(){return r(_)[r(D)]},plotType:"p",showLabels:!1,get faceColor(){return $r[r(D)]},get mainColor(){return At[r(D)]},get marker(){return Ht[r(D)]},lineWidth:1.5})});var R=z(O,2);{var q=W=>{Dn(W,{get items(){return r(h)},get position(){return r(g)}})};Y(R,W=>{r(h)&&r(h).length>0&&W(q)})}T(N,L)},$$slots:{default:!0}})};Y(A,M=>{r(u)&&M(P)})}T(l,C),_e()}var ih=X("<!> <!> <!> <!>",1);function mc(l,e){be(e,!0);const t="1 – selectivity, β",s="Expected sensitivity, 1 – ɑ",a="plot-selectivity-integral",o=[-.05,1.05],c=[-.05,1.05],d=w(()=>e.props&&e.props.classres?e.props.classres:null),u=w(()=>e.props&&e.props.simca?e.props.simca:null),f=w(()=>r(d)?Object.keys(r(d))[0]:null),v=141;function m(N){const I=ze.zeros(v),L=ze.zeros(v);I.v[0]=1,L.v[0]=1;let F=1,U=0;for(let O=.001;O<.1;O=O+.002){const R=N(O);I.v[F]=R,L.v[F]=1-O,U=U+R*.002,F=F+1}for(let O=.1;O<.9;O=O+.02){const R=N(O);I.v[F]=R,L.v[F]=1-O,U=U+R*.02,F=F+1}for(let O=.9;O<1;O=O+.002){const R=N(O);I.v[F]=R,L.v[F]=1-O,U=U+R*.002,F=F+1}return I.v[F]=0,L.v[F]=0,{x:I,y:L,auc:1-U}}let g=re(void 0),h=re(void 0),p=re(void 0);ue(()=>{(r(h)!==r(u).ncomp||r(p)!==r(u).limType)&&(B(h,r(u).ncomp,!0),B(p,r(u).limType,!0),B(g,r(d)[r(f)].v[r(u).ncomp-1],!0))});const _=w(()=>r(g)?1/(r(g).k+r(g).s):null),b=w(()=>r(g)?1/r(g).Sz:null);function y(N){if(!r(g))return null;const L=ir(1-N,r(g).k)/r(g).f0;return Wl((Math.pow(L*r(_),r(g).hz)-r(g).Mz)*r(b))}const S=w(()=>r(u).alpha/100),E=w(()=>y(r(S))),k=w(()=>m(y));let C=w(()=>r(u).ncomp?`Selecitivity (A = ${r(u).ncomp}, AUC = ${r(k).auc.toFixed(4)})`:"Selectivity");var A=he(),P=J(A);{var M=N=>{Pr(N,{get title(){return r(C)},xLabel:t,yLabel:s,get limX(){return o},get limY(){return c},fileName:a,children:(I,L)=>{var F=ih(),U=J(F);pr(U,{xStart:[0],xEnd:[1],yStart:[0],yEnd:[1],lineColor:"#a0a0a0",lineType:3});var O=z(U,2);ur(O,{get xValues(){return r(k).x},get yValues(){return r(k).y},plotType:"l",showLabels:!1,get mainColor(){return At.test},lineWidth:1.5});var R=z(O,2);{let W=w(()=>[o[0]]),D=w(()=>[o[1]]),K=w(()=>[1-r(S)]),Z=w(()=>[1-r(S)]);pr(R,{get xStart(){return r(W)},get xEnd(){return r(D)},get yStart(){return r(K)},get yEnd(){return r(Z)},lineColor:"#a0a0a0"})}var q=z(R,2);{let W=w(()=>[r(E)]),D=w(()=>[1-r(S)]);Zi(q,{get xValues(){return r(W)},get yValues(){return r(D)},get lineColor(){return At.test},lineWidth:2,get faceColor(){return At.test}})}T(I,F)},$$slots:{default:!0}})};Y(P,N=>{r(k)&&N(M)})}T(l,A),_e()}var ch=X("<!> <!>",1);function uh(l,e){be(e,!0);const t=(E,k=kt)=>{ie(E,{label:"Selected",children:(C,A)=>{lt(C,{onclick:()=>e.markOutlier(k()),text:"remove"})},$$slots:{default:!0}})},s=(E,k=kt)=>{ie(E,{label:"Selected",children:(C,A)=>{var P=ch(),M=J(P);lt(M,{onclick:()=>e.showContributions(k()),text:"plot"});var N=z(M,2);lt(N,{onclick:()=>e.markOutlier(k()),text:"remove"}),T(C,P)},$$slots:{default:!0}})},a={test:e.testres.pca},o={test:e.testres.simca},c={test:e.testset},d=w(()=>({test:e.testres.simca})),u={regular:Zr.regular,extreme:Zr.extreme,outlier:Zr.outlier},f={alien:Zr.alien,external:Zr.external},v=w(()=>{const E=e.testres.simca.v[e.simca.ncomp-1];return{members:{classColmap:u,labels:[`regular: ${E.rolsNum.regular}`,`extreme: ${E.rolsNum.extreme}`,`outliers: ${E.rolsNum.outlier}`],values:E.rols,ind:e.testres.simca.ind.members},strangers:{classColmap:f,labels:[`aliens: ${E.rolsNum.alien}`,`external: ${E.rolsNum.external}`],values:E.rols,ind:e.testres.simca.ind.strangers}}}),m=w(()=>e.testres.simca.nMembers>0&&e.testres.simca.nStrangers>0?{acceptance:{label:"Acceptance",scope:"objects",component:fl,buttons:s},distances:{label:"Distances",scope:"objects",component:dl,buttons:s},extremes:{label:"Extremes",scope:"stats",component:Ma},aliens:{label:"Aliens",scope:"stats",component:vc},foms:{label:"FoMs",scope:"stats",component:is},sel:{label:"Selectivity",scope:"stats",component:mc},scores:{label:"Scores",scope:"objects",component:vl,buttons:t}}:e.testres.simca.nMembers>0?{acceptance:{label:"Acceptance",scope:"objects",component:fl,buttons:s},distances:{label:"Distances",scope:"objects",component:dl,buttons:s},extremes:{label:"Extremes",scope:"stats",component:Ma},foms:{label:"FoMs",scope:"stats",component:is},scores:{label:"Scores",scope:"objects",component:vl,buttons:t}}:{acceptance:{label:"Acceptance",scope:"objects",component:fl,buttons:s},distances:{label:"Distances",scope:"objects",component:dl,buttons:s},aliens:{label:"Aliens",scope:"stats",component:vc},foms:{label:"FoMs",scope:"stats",component:is},sel:{label:"Selectivity",scope:"stats",component:mc},scores:{label:"Scores",scope:"objects",component:vl,buttons:t}}),g=De({acceptance:Ta(o),distances:Pa(a),extremes:fc(["test"]),aliens:R0(["test"]),foms:uc(o),sel:L0(["test"]),scores:za(a)});let h=re(De({acceptance:Rt(g.acceptance),distances:Rt(g.distances),extremes:Rt(g.extremes),aliens:Rt(g.aliens),foms:Rt(g.foms),sel:Rt(g.sel),scores:Rt(g.scores)}));ue(()=>{const E={};e.testres.simca.nMembers>0&&(E.sens=bi(e.testres.simca.nMembers,e.simca.alpha)),r(h).foms.ci=E}),ue(()=>{r(h).acceptance.subset&&e.resetSelection()}),ue(()=>{r(h).acceptance.ncomp=e.simca.ncomp,r(h).acceptance.title=`Acceptance (A = ${e.simca.ncomp})`,r(h).acceptance.limType=e.simca.limType,r(h).acceptance.alpha=e.simca.alpha,r(h).acceptance.gamma=e.simca.gamma}),ue(()=>{r(v)&&r(h).acceptance.subset&&(r(h).acceptance.colorByObj=r(h).acceptance.subset!=="all"?r(v)[r(h).acceptance.subset]:null)}),ue(()=>{r(h).acceptance.colorBy=r(h).acceptance.subset!=="all"?"roles":"classes"}),ue(()=>{r(h).scores.plotType!=="p"?(g.scores.comp1.hidden=!0,g.scores.showEllipse.hidden=!0,r(h).scores.showEllipse=!1):(g.scores.comp1.hidden=!1,g.scores.showEllipse.hidden=!1),r(h).scores.plotType==="l"||r(h).scores.plotType==="b"?(g.scores.colorBy.hidden=!0,r(h).scores.colorBy="none"):g.scores.colorBy.hidden=!1,r(h).scores.colorBy==="variable"?g.scores.colorByVar.hidden=!1:g.scores.colorByVar.hidden=!0,r(h).scores.colorBy==="groups"&&r(h).scores.plotType==="p"?g.scores.confEllipse.hidden=!1:(g.scores.confEllipse.hidden=!0,r(h).scores.confEllipse="none")});const p=w(()=>({res:a,classres:r(d),model:e.model,simca:e.simca,data:c,ncomp:e.simca.ncomp})),_={markOutlier:e.markOutlier,showContributions:e.showContributions};var b=he(),y=J(b);{var S=E=>{Na(E,{get plots(){return r(m)},get controls(){return g},get props(){return r(p)},get callbacks(){return _},get params(){return r(h)},set params(k){B(h,k,!0)}})};Y(y,E=>{e.simca&&e.testres&&E(S)})}T(l,b),_e()}var fh=X('<div class="data-loader svelte-1qdsey6"><!></div>'),dh=X('<div class="outliers-pane svelte-1qdsey6"><!></div>'),vh=X('<div class="buttons"><!> <!></div>'),mh=X('<div class="model-stats svelte-1qdsey6"><!></div> <div class="result-stats svelte-1qdsey6"><!></div>',1),hh=X('<p class="svelte-1qdsey6"><strong>Step 1</strong></p> <p class="svelte-1qdsey6">Load previously trained DD-SIMCA model from file.</p>',1),gh=X(`<p class="svelte-1qdsey6"><strong>Step 2</strong></p> <p class="svelte-1qdsey6">Load test set set from CSV file. The requirements to the file are the same as for the training set (column with
               class labels is mandatory), but test set may contain class labels both for target class (members) as well as for
               alternative classes (strangers).</p>`,1),ph=X(`<div class="help-text svelte-1qdsey6"><p class="svelte-1qdsey6">In this tab you can apply previously trained DD-SIMCA model to a dataset consisting of target class members (at least
            the app will assume this, you can of course provide any dataset). You can use it for testing performance
            of the model, or tune its parameters, if necessary.</p> <!></div>`),bh=X('<!> <div class="app-container svelte-1qdsey6"><div class="app-controls svelte-1qdsey6"><div class="model-loader svelte-1qdsey6"><!></div> <!> <!> <div class="simca-settings svelte-1qdsey6"><!> <!></div> <!></div> <div class="app-content svelte-1qdsey6"><!></div></div>',1);function _h(l,e){be(e,!0);const t=w(()=>e.session.test);let s=re(-1),a=re(!1);function o(W){if(W<0||W>r(t).testres.pca.nrows-1)return;const D=r(t).testres.pca.objindices[W];D>=0&&!r(t).outliers.includes(D)&&(r(t).outliers.push(D),r(t).testres.simca=null,r(t).testres.pca=null)}function c(W){W<0||(B(s,W,!0),B(a,!0))}function d(){B(a,!1),B(s,-1)}function u(){r(t).outliers=[],r(t).testres.simca=null,r(t).testres.pca=null}function f(){r(t).outliers.pop(),r(t).testres.simca=null,r(t).testres.pca=null}function v(){B(s,-1)}Il(()=>{r(t).testset===null&&(r(t).outliers=[],r(t).testres.simca=null,r(t).testres.pca=null),r(t).model===null&&(r(t).testres.simca=null,r(t).testres.pca=null,r(t).testset=null,r(t).outliers=[],r(t).simca=null)}),ue(()=>{r(t).model===null&&(r(t).outliers=[],r(t).testres.simca=null,r(t).testres.pca=null,r(t).testset=null)}),ue(()=>{r(t).testset===null&&(r(t).outliers=[],r(t).testres.simca=null,r(t).testres.pca=null,r(t).ind=null)}),ue(()=>{if(!r(t).testres.pca||!r(t).simca||r(t).testres.pca.classes.length<1)return;const W=r(t).testres.pca.classes,D=[],K=[];for(let Z=0;Z<W.length;Z++)W[Z]===r(t).simca.className?D.push(Z):K.push(Z);r(t).ind={members:D,strangers:K}}),ue(()=>{r(t).testres.pca&&r(t).simca&&r(t).ind&&(r(t).testres.simca=es(r(t).testres.pca,Yt(()=>r(t).simca.limType),r(t).simca.eCrit,r(t).simca.oCrit,r(t).ind))}),ue(()=>{const W=Yt(()=>JSON.stringify(e.session,ol));r(t).simca?e.backupSession(W,r(t).model,r(t).testset,r(t).simca.ncomp,r(t).testres.simca):e.backupSession(W,r(t).model,r(t).testset,r(t).simca,r(t).testres.simca)});var m=bh(),g=J(m);{var h=W=>{{let D=w(()=>({test:r(t).testres.pca}));xa(W,{get model_getter(){return nt},get res_getter(){return er},get model(){return r(t).model},get res(){return r(D)},closeModal:d,get ncomp(){return r(t).simca.ncomp},get selected(){return r(s)}})}};Y(g,W=>{r(a)&&r(t).simca&&r(t).model&&r(t).testres&&W(h)})}var p=z(g,2),_=j(p),b=j(_),y=j(b);dc(y,{get model(){return r(t).model},set model(W){r(t).model=W},get simca(){return r(t).simca},set simca(W){r(t).simca=W}});var S=z(b,2);{var E=W=>{var D=fh(),K=j(D);Ca(K,{get outliers(){return r(t).outliers},get WASM(){return e.WASM},get model(){return r(t).model},className:"Class",classMandatory:!0,get dataset(){return r(t).testset},set dataset(Z){r(t).testset=Z},get resobj(){return r(t).testres.pca},set resobj(Z){r(t).testres.pca=Z}}),T(W,D)};Y(S,W=>{r(t).model&&W(E)})}var k=z(S,2);{var C=W=>{var D=dh(),K=j(D);ua(K,{get outliers(){return r(t).outliers},get dataset(){return r(t).testset},resetOutliers:u,undoOutliers:f}),T(W,D)};Y(k,W=>{r(t).outliers&&r(t).outliers.length>0&&W(C)})}var A=z(k,2),P=j(A);{var M=W=>{{let D=w(()=>r(t).ind&&r(t).ind.members.length<1);Aa(W,{get model(){return r(t).model},get className(){return r(t).className},get isAlt(){return r(D)},get simca(){return r(t).simca},set simca(K){r(t).simca=K}})}};Y(P,W=>{r(t).model&&r(t).testres.pca&&W(M)})}var N=z(P,2);{var I=W=>{ie(W,{label:"Download",children:(D,K)=>{var Z=vh(),G=j(Z);lt(G,{onclick:()=>ts(r(t).model,r(t).simca,r(t).testres,r(t).testset,"test",r(t).outliers),text:"Res (test)"});var $=z(G,2);lt($,{onclick:()=>ca(r(t).model,r(t).simca),text:"Model"}),T(D,Z)},$$slots:{default:!0}})};Y(N,W=>{r(t).simca&&r(t).model&&r(t).testres.simca&&W(I)})}var L=z(A,2);{var F=W=>{var D=mh(),K=J(D),Z=j(K);Sa(Z,{get model(){return r(t).model},get simca(){return r(t).simca}});var G=z(K,2),$=j(G);sh($,{get res(){return r(t).testres.simca},get ncomp(){return r(t).simca.ncomp}}),T(W,D)};Y(L,W=>{r(t).model&&r(t).simca&&r(t).testres.simca&&W(F)})}var U=z(_,2),O=j(U);{var R=W=>{var D=ph(),K=z(j(D),2);{var Z=$=>{var ne=hh();T($,ne)},G=$=>{var ne=he(),ee=J(ne);{var se=pe=>{var Me=gh();T(pe,Me)};Y(ee,pe=>{r(t).testset||pe(se)})}T($,ne)};Y(K,$=>{r(t).model?$(G,!1):$(Z)})}T(W,D)},q=W=>{var D=he(),K=J(D);{var Z=G=>{var $=he(),ne=J($);bn(ne,()=>r(t).testres.pca,ee=>{uh(ee,Zt({markOutlier:o,showContributions:c,resetSelection:v},()=>r(t)))}),T(G,$)};Y(K,G=>{r(t).model&&r(t).simca&&r(t).testres.pca&&G(Z)})}T(W,D)};Y(O,W=>{r(t).testres.simca?W(q,!1):W(R)})}T(l,m),_e()}var wh=X('<table class="svelte-kg0b31"><thead><tr class="svelte-kg0b31"><th class="svelte-kg0b31"></th><th class="svelte-kg0b31">New</th></tr></thead><tbody><tr class="svelte-kg0b31"><td class="label svelte-kg0b31">Objects</td><td class="svelte-kg0b31"> </td></tr><tr class="svelte-kg0b31"><td class="label svelte-kg0b31">In</td><td class="svelte-kg0b31"> </td></tr><tr class="svelte-kg0b31"><td class="label svelte-kg0b31">Out</td><td class="svelte-kg0b31"> </td></tr></tbody></table>');function yh(l,e){be(e,!0);var t=he(),s=J(t);{var a=o=>{var c=wh(),d=z(j(c)),u=j(d),f=z(j(u)),v=j(f),m=z(u),g=z(j(m)),h=j(g),p=z(m),_=z(j(p)),b=j(_);ae(()=>{me(v,e.res.v[0].decs.length),me(h,e.res.v[e.ncomp-1].decsNum.in),me(b,e.res.v[e.ncomp-1].decsNum.out)}),T(o,c)};Y(s,o=>{e.res&&o(a)})}T(l,t),_e()}var xh=X("<!> <!>",1);function kh(l,e){be(e,!0);const t=(g,h=kt)=>{ie(g,{label:"Selected",children:(p,_)=>{lt(p,{onclick:()=>e.markOutlier(h()),text:"remove"})},$$slots:{default:!0}})},s=(g,h=kt)=>{ie(g,{label:"Selected",children:(p,_)=>{var b=xh(),y=J(b);lt(y,{onclick:()=>e.showContributions(h()),text:"plot"});var S=z(y,2);lt(S,{onclick:()=>e.markOutlier(h()),text:"remove"}),T(p,b)},$$slots:{default:!0}})},a={new:e.newres.pca},o={new:e.newset},c=w(()=>({new:e.newres.simca})),d=w(()=>({acceptance:{label:"Acceptance",scope:"objects",component:fl,buttons:s},distances:{label:"Distances",scope:"objects",component:dl,buttons:s},scores:{label:"Scores",scope:"objects",component:vl,buttons:t}})),u=De({acceptance:Ta(a),distances:Pa(a),scores:za(a)});let f=re(De({acceptance:Rt(u.acceptance),distances:Rt(u.distances),scores:Rt(u.scores)}));ue(()=>{r(f).acceptance.ncomp=e.simca.ncomp,r(f).acceptance.title=`Acceptance (A = ${e.simca.ncomp})`,r(f).acceptance.limType=e.simca.limType,r(f).acceptance.alpha=e.simca.alpha,r(f).acceptance.gamma=e.simca.gamma}),ue(()=>{r(f).acceptance.colorByObj={values:r(c).new.v[e.simca.ncomp-1].decs,classColmap:{in:At.new,out:At.new},labels:["in","out"],filled:r(c).new.v[e.simca.ncomp-1].decs.map(g=>g==="in"),showBar:!1}}),ue(()=>{r(f).scores.plotType!=="p"?(u.scores.comp1.hidden=!0,u.scores.showEllipse.hidden=!0,r(f).scores.showEllipse=!1):(u.scores.comp1.hidden=!1,u.scores.showEllipse.hidden=!1),r(f).scores.plotType==="l"||r(f).scores.plotType==="b"?(u.scores.colorBy.hidden=!0,r(f).scores.colorBy="none"):u.scores.colorBy.hidden=!1,r(f).scores.colorBy==="variable"?u.scores.colorByVar.hidden=!1:u.scores.colorByVar.hidden=!0,r(f).scores.colorBy==="groups"&&r(f).scores.plotType==="p"?u.scores.confEllipse.hidden=!1:(u.scores.confEllipse.hidden=!0,r(f).scores.confEllipse="none")});const v=w(()=>({res:a,classres:r(c),model:e.model,simca:e.simca,data:o,ncomp:e.simca.ncomp})),m={markOutlier:e.markOutlier,showContributions:e.showContributions};Na(l,{get plots(){return r(d)},get controls(){return u},get props(){return r(v)},get callbacks(){return m},get params(){return r(f)},set params(g){B(f,g,!0)}}),_e()}var Eh=X('<div class="data-loader svelte-1qdsey6"><!></div>'),Ch=X('<div class="outliers-pane svelte-1qdsey6"><!></div>'),Sh=X('<div class="buttons"><!> <!></div>'),Ah=X('<div class="model-stats svelte-1qdsey6"><!></div> <div class="result-stats svelte-1qdsey6"><!></div>',1),Nh=X('<p class="svelte-1qdsey6"><strong>Step 1</strong></p> <p class="svelte-1qdsey6">Load previously trained DD-SIMCA model from file.</p>',1),Mh=X(`<p class="svelte-1qdsey6"><strong>Step 2</strong></p> <p class="svelte-1qdsey6">Load data set from CSV file. The requirements to the file are the same as for the
               training set but no columns with reference classes is expected. If you have reference classes, use <em>Test</em> tab.</p>`,1),Th=X(`<div class="help-text svelte-1qdsey6"><p class="svelte-1qdsey6">In this tab you can apply previously trained DD-SIMCA model to a new dataset with objects whose class is unknown (hence the app
            does not expect column with target classes).</p> <!></div>`),Ph=X('<!> <div class="app-container svelte-1qdsey6"><div class="app-controls svelte-1qdsey6"><div class="model-loader svelte-1qdsey6"><!></div> <!> <!> <div class="simca-settings svelte-1qdsey6"><!> <!></div> <!></div> <div class="app-content svelte-1qdsey6"><!></div></div>',1);function zh(l,e){be(e,!0);const t=w(()=>e.session.new);let s=re(-1),a=re(!1);function o(q){if(q<0||q>r(t).newres.pca.nrows-1)return;const W=r(t).newres.pca.objindices[q];W>=0&&!r(t).outliers.includes(W)&&(r(t).outliers.push(W),r(t).newres.simca=null,r(t).newres.pca=null)}function c(){r(t).outliers=[],r(t).newres.simca=null,r(t).newres.pca=null}function d(){r(t).outliers.pop(),r(t).newres.simca=null,r(t).newres.pca=null}function u(q){q<0||(B(s,q,!0),B(a,!0))}function f(){B(a,!1),B(s,-1)}Il(()=>{r(t).newset===null&&(r(t).outliers=[],r(t).newres.simca=null,r(t).newres.pca=null),r(t).model===null&&(r(t).outliers=[],r(t).simca=null,r(t).newres.simca=null,r(t).newres.pca=null,r(t).newset=null)}),ue(()=>{r(t).model===null&&(r(t).outliers=[],r(t).newres.simca=null,r(t).newres.pca=null,r(t).newset=null)}),ue(()=>{r(t).newset===null&&(r(t).outliers=[],r(t).newres.simca=null,r(t).newres.pca=null)}),ue(()=>{r(t).newres.pca&&r(t).simca&&(r(t).newres.simca=es(r(t).newres.pca,Yt(()=>r(t).simca.limType),r(t).simca.eCrit,r(t).simca.oCrit))}),ue(()=>{const q=Yt(()=>JSON.stringify(e.session,ol));r(t).simca&&r(t).newres?e.backupSession(q,r(t).model,r(t).newset,r(t).newres.simca,r(t).simca.ncomp):e.backupSession(q,r(t).model,r(t).newset)});var v=Ph(),m=J(v);{var g=q=>{{let W=w(()=>({new:r(t).newres.pca}));xa(q,{get model_getter(){return nt},get res_getter(){return er},get model(){return r(t).model},get res(){return r(W)},closeModal:f,get ncomp(){return r(t).simca.ncomp},get selected(){return r(s)}})}};Y(m,q=>{r(a)&&r(t).model&&r(t).simca&&r(t).newres.pca&&q(g)})}var h=z(m,2),p=j(h),_=j(p),b=j(_);dc(b,{get model(){return r(t).model},set model(q){r(t).model=q},get simca(){return r(t).simca},set simca(q){r(t).simca=q}});var y=z(_,2);{var S=q=>{var W=Eh(),D=j(W);Ca(D,{get outliers(){return r(t).outliers},get WASM(){return e.WASM},get model(){return r(t).model},className:"Class",csvOnly:!1,get dataset(){return r(t).newset},set dataset(K){r(t).newset=K},get resobj(){return r(t).newres.pca},set resobj(K){r(t).newres.pca=K}}),T(q,W)};Y(y,q=>{r(t).model&&q(S)})}var E=z(y,2);{var k=q=>{var W=Ch(),D=j(W);ua(D,{get outliers(){return r(t).outliers},get dataset(){return r(t).newset},undoOutliers:d,resetOutliers:c}),T(q,W)};Y(E,q=>{r(t).outliers&&r(t).outliers.length>0&&q(k)})}var C=z(E,2),A=j(C);{var P=q=>{Aa(q,{get model(){return r(t).model},get className(){return r(t).className},isAlt:!0,get simca(){return r(t).simca},set simca(W){r(t).simca=W}})};Y(A,q=>{r(t).model&&r(t).newres.pca&&q(P)})}var M=z(A,2);{var N=q=>{ie(q,{label:"Download",children:(W,D)=>{var K=Sh(),Z=j(K);lt(Z,{onclick:()=>ts(r(t).model,r(t).simca,r(t).newres,r(t).newset,"new",r(t).outliers),text:"Res"});var G=z(Z,2);lt(G,{onclick:()=>ca(r(t).model,r(t).simca),text:"Model"}),T(W,K)},$$slots:{default:!0}})};Y(M,q=>{r(t).model&&r(t).simca&&r(t).newres.simca&&q(N)})}var I=z(C,2);{var L=q=>{var W=Ah(),D=J(W),K=j(D);Sa(K,{get model(){return r(t).model},get simca(){return r(t).simca},isAlt:!0});var Z=z(D,2),G=j(Z);yh(G,{get res(){return r(t).newres.simca},get ncomp(){return r(t).simca.ncomp}}),T(q,W)};Y(I,q=>{r(t).simca&&r(t).model&&r(t).newres.simca&&q(L)})}var F=z(p,2),U=j(F);{var O=q=>{var W=Th(),D=z(j(W),2);{var K=G=>{var $=Nh();T(G,$)},Z=G=>{var $=he(),ne=J($);{var ee=se=>{var pe=Mh();T(se,pe)};Y(ne,se=>{r(t).newset||se(ee)})}T(G,$)};Y(D,G=>{r(t).model?G(Z,!1):G(K)})}T(q,W)},R=q=>{var W=he(),D=J(W);{var K=Z=>{var G=he(),$=J(G);bn($,()=>r(t).newres.pca,ne=>{kh(ne,Zt({markOutlier:o,showContributions:u},()=>r(t)))}),T(Z,G)};Y(D,Z=>{r(t).model&&r(t).simca&&r(t).newres.pca&&Z(K)})}T(q,W)};Y(U,q=>{r(t).newres.simca?q(R,!1):q(O)})}T(l,v),_e()}function hc(l,e){B(e,!0)}function Lh(l,e,t){const s=oa(new Date),a=e.appID+"-session-"+s+".json";r(t).date=s;const o=JSON.stringify(r(t),ol),c=new Blob([o],{type:"text/json"}),d=window.URL.createObjectURL(c),u=document.createElement("a");u.setAttribute("href",d),u.setAttribute("download",a),u.click()}function Rh(l,e){confirm("Are you sure? All current results and models will be lost in all tabs.")&&e()}var Ih=X('<sup style="color:red">β</sup>'),jh=X('<li><button class="svelte-1cyr8za"> </button></li>'),qh=X("<div><!></div>"),Fh=X('<div class="info-container svelte-1cyr8za"><!></div>'),Oh=X('<div class="page svelte-1cyr8za"><header class="page-header svelte-1cyr8za"><div class="header-group svelte-1cyr8za"><img class="logo svelte-1cyr8za" src="logo.svg"/> <h1 class="svelte-1cyr8za"> <!></h1> <p class="svelte-1cyr8za"> </p></div> <ul class="nav svelte-1cyr8za"></ul></header> <main class="svelte-1cyr8za"><!></main> <footer class="svelte-1cyr8za"><div><span class="session-message svelte-1cyr8za"> </span> <label title="load session from file" class="upload-button svelte-1cyr8za"><input type="file" class="svelte-1cyr8za"/> <svg xmlns="http://www.w3.org/2000/svg" version="2.0" width="20px" height="20px" viewBox="0 0 100 100" class="svelte-1cyr8za"><line x1="50" y1="25" x2="50" y2="75"></line><line x1="30" y1="40" x2="50" y2="25"></line><line x1="70" y1="40" x2="50" y2="25"></line></svg></label> <button title="download session as a file" class="download-button svelte-1cyr8za"><svg xmlns="http://www.w3.org/2000/svg" version="2.0" width="20px" height="20px" viewBox="0 0 100 100" class="svelte-1cyr8za"><line x1="50" y1="25" x2="50" y2="75"></line><line x1="30" y1="60" x2="50" y2="75"></line><line x1="70" y1="60" x2="50" y2="75"></line></svg></button> <button title="reset all sessions" class="clear-button svelte-1cyr8za"><svg xmlns="http://www.w3.org/2000/svg" version="2.0" width="20px" height="20px" viewBox="0 0 100 100" class="svelte-1cyr8za"><line x1="25" y1="25" x2="75" y2="75"></line><line x1="25" y1="75" x2="75" y2="25"></line></svg></button></div> <div class="info svelte-1cyr8za"><button title="Show information about the app" class="button-info svelte-1cyr8za">info</button> <!></div></footer> <!></div>');function Bh(l,e){be(e,!0);let t=V(e,"tabs",19,()=>[]),s=V(e,"isBeta",3,!1);const a="mdatools-"+e.appID;let o=re(!1),c=re(void 0),d=re("Current session "),u=re(!1);function f(k){B(d,k,!0),B(u,!0),setTimeout(()=>{B(d,"Current session "),B(u,!1)},1e3)}function v(){B(o,!1)}function m(k){r(c).tab=k}function g(){const k=indexedDB.open(a,1);k.onsuccess=C=>{const P=C.target.result.transaction(e.appID,"readwrite");P.objectStore(e.appID).delete("session"),P.oncomplete=()=>{B(c,e.initSession(),!0),f("Session was reinitialzed.")},P.onerror=()=>console.error("Failed to session from DB.")}}function h(k,C){window.localStorage.removeItem(e.appID+"-blocked");const A=indexedDB.open(a,1);A.onsuccess=P=>{const I=P.target.result.transaction(e.appID,"readwrite").objectStore(e.appID);I.put(k,"session"),I.put(oa(new Date),"session-update")}}function p(){new Promise((k,C)=>{const A=indexedDB.open(a,1);A.onsuccess=P=>{const L=P.target.result.transaction(e.appID,"readonly").objectStore(e.appID).get("session");L.onsuccess=()=>k(L.result),L.onerror=()=>C(L.error)}}).then(k=>{_(k),B(d,"Last session is restored "),B(u,!0),setTimeout(()=>{B(d,"Current session "),B(u,!1)},1500)}).catch(k=>{console.error(k),B(c,e.initSession(),!0)})}function _(k){if(!k||k==="undefined"){B(c,e.initSession(),!0);return}const C=JSON.parse(k,aa);B(c,e.checkSession(C)?C:e.initSession(e.appID),!0)}function b(k){const C=new FileReader;C.onload=()=>{_(C.result),k.target.value=""},C.readAsText(k.target.files[0])}rf(()=>{const k=e.appID,C=indexedDB.open(a,1);C.onupgradeneeded=A=>{const P=A.target.result;P.objectStoreNames.contains(k)||P.createObjectStore(k)},C.onsuccess=A=>{p()}});var y=he(),S=J(y);{var E=k=>{var C=Oh(),A=j(C),P=j(A),M=j(P),N=z(M,2),I=j(N),L=z(I);{var F=fe=>{var ye=Ih();T(fe,ye)};Y(L,fe=>{s()&&fe(F)})}var U=z(N,2),O=j(U),R=z(P,2);Xe(R,21,t,Qe,(fe,ye,le)=>{var ve=jh();let oe;var xe=j(ve);xe.__click=()=>m(le),xe.__keydown=()=>m(le);var ke=j(xe);ae(ge=>{oe=pt(ve,1,"nav-item svelte-1cyr8za",null,oe,ge),me(ke,r(ye).name)},[()=>({selected:r(c).tab===le})]),T(fe,ve)});var q=z(A,2),W=j(q);bn(W,()=>r(c).date,fe=>{var ye=he(),le=J(ye);Xe(le,17,t,Qe,(ve,oe,xe)=>{var ke=qh();let ge;var je=j(ke);nl(je,()=>r(oe).component,(Pe,We)=>{We(Pe,{get WASM(){return e.WASM},get session(){return r(c)},backupSession:h})}),ae(Pe=>ge=pt(ke,1,"tab-content svelte-1cyr8za",null,ge,Pe),[()=>({hidden:r(c).tab!==xe})]),T(ve,ke)}),T(fe,ye)});var D=z(q,2),K=j(D);let Z;var G=j(K),$=j(G),ne=z(G,2),ee=j(ne);ee.__change=b;var se=z(ne,2);se.__click=[Lh,e,c];var pe=z(se,2);pe.__click=[Rh,g];var Me=z(K,2),Le=j(Me);Le.__click=[hc,o],Le.__keydown=[hc,o];var de=z(Le,2);Rr(de,()=>e.footer);var ce=z(D,2);{var Ce=fe=>{wa(fe,{closeModal:v,children:(ye,le)=>{var ve=Fh(),oe=j(ve);Rr(oe,()=>e.info),T(ye,ve)},$$slots:{default:!0}})};Y(ce,fe=>{r(o)&&fe(Ce)})}ae(fe=>{H(M,"alt",e.appShortTitle),me(I,e.appTitle),me(O,e.appSlogan),Z=pt(K,1,"session svelte-1cyr8za",null,Z,fe),me($,r(d))},[()=>({"no-buttons":r(u)})]),T(k,C)};Y(S,k=>{r(c)&&k(E)})}T(l,y),_e()}mt(["click","keydown","change"]);const Zh="modulepreload",$h=function(l){return"/"+l},eg={},Dh=function(e,t,s){let a=Promise.resolve();function o(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return a.then(c=>{for(const d of c||[])d.status==="rejected"&&o(d.reason);return e().catch(o)})};async function Vh(l={}){var pc;var e,t=l,s=typeof window=="object",a=typeof WorkerGlobalScope<"u",o=typeof process=="object"&&((pc=process.versions)==null?void 0:pc.node)&&process.type!="renderer";if(o){const{createRequire:Q}=await Dh(()=>Promise.resolve().then(()=>Hh),void 0);var c=Q($e&&$e.tagName.toUpperCase()==="SCRIPT"&&$e.src||new URL("ddsimca.js",document.baseURI).href)}var d=(Q,te)=>{throw te},u=$e&&$e.tagName.toUpperCase()==="SCRIPT"&&$e.src||new URL("ddsimca.js",document.baseURI).href,f="";function v(Q){return t.locateFile?t.locateFile(Q,f):f+Q}var m,g;if(o){var h=c("fs");u.startsWith("file:")&&(f=c("path").dirname(c("url").fileURLToPath(u))+"/"),g=Q=>{Q=E(Q)?new URL(Q):Q;var te=h.readFileSync(Q);return te},m=async(Q,te=!0)=>{Q=E(Q)?new URL(Q):Q;var we=h.readFileSync(Q,te?void 0:"utf8");return we},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),d=(Q,te)=>{throw process.exitCode=Q,te}}else if(s||a){try{f=new URL(".",u).href}catch{}a&&(g=Q=>{var te=new XMLHttpRequest;return te.open("GET",Q,!1),te.responseType="arraybuffer",te.send(null),new Uint8Array(te.response)}),m=async Q=>{if(E(Q))return new Promise((we,rt)=>{var Ze=new XMLHttpRequest;Ze.open("GET",Q,!0),Ze.responseType="arraybuffer",Ze.onload=()=>{if(Ze.status==200||Ze.status==0&&Ze.response){we(Ze.response);return}rt(Ze.status)},Ze.onerror=rt,Ze.send(null)});var te=await fetch(Q,{credentials:"same-origin"});if(te.ok)return te.arrayBuffer();throw new Error(te.status+" : "+te.url)}}var p=console.log.bind(console),_=console.error.bind(console),b,y=!1,S,E=Q=>Q.startsWith("file://"),k,C,A,P,M,N,I=!1;function L(){var Q=A.buffer;P=new Int8Array(Q),M=new Uint8Array(Q),t.HEAP32=new Int32Array(Q),N=new Uint32Array(Q),t.HEAPF64=new Float64Array(Q),new BigInt64Array(Q),new BigUint64Array(Q)}function F(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)ye(t.preRun.shift());de(fe)}function U(){I=!0,_l.i()}function O(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)Ce(t.postRun.shift());de(ce)}var R=0,q=null;function W(Q){var te;R++,(te=t.monitorRunDependencies)==null||te.call(t,R)}function D(Q){var we;if(R--,(we=t.monitorRunDependencies)==null||we.call(t,R),R==0&&q){var te=q;q=null,te()}}function K(Q){var we;(we=t.onAbort)==null||we.call(t,Q),Q="Aborted("+Q+")",_(Q),y=!0,Q+=". Build with -sASSERTIONS for more info.";var te=new WebAssembly.RuntimeError(Q);throw C==null||C(te),te}var Z;function G(){return t.locateFile?v("pca_wasm.wasm"):new URL("/ddsimca/ddsimca.wasm",$e&&$e.tagName.toUpperCase()==="SCRIPT"&&$e.src||new URL("ddsimca.js",document.baseURI).href).href}function $(Q){if(Q==Z&&b)return new Uint8Array(b);if(g)return g(Q);throw"both async and sync fetching of the wasm failed"}async function ne(Q){if(!b)try{var te=await m(Q);return new Uint8Array(te)}catch{}return $(Q)}async function ee(Q,te){try{var we=await ne(Q),rt=await WebAssembly.instantiate(we,te);return rt}catch(Ze){_(`failed to asynchronously prepare wasm: ${Ze}`),K(Ze)}}async function se(Q,te,we){if(!Q&&!E(te)&&!o)try{var rt=fetch(te,{credentials:"same-origin"}),Ze=await WebAssembly.instantiateStreaming(rt,we);return Ze}catch(ut){_(`wasm streaming compile failed: ${ut}`),_("falling back to ArrayBuffer instantiation")}return ee(te,we)}function pe(){return{a:Gh}}async function Me(){function Q(ut,ft){return _l=ut.exports,A=_l.h,L(),La(_l),D(),_l}W();function te(ut){return Q(ut.instance)}var we=pe();if(t.instantiateWasm)return new Promise((ut,ft)=>{t.instantiateWasm(we,(vt,wr)=>{ut(Q(vt))})});Z??(Z=G());var rt=await se(b,Z,we),Ze=te(rt);return Ze}class Le{constructor(te){yr(this,"name","ExitStatus");this.message=`Program terminated with exit(${te})`,this.status=te}}var de=Q=>{for(;Q.length>0;)Q.shift()(t)},ce=[],Ce=Q=>ce.push(Q),fe=[],ye=Q=>fe.push(Q),le=!0,ve=Q=>ds(Q),oe=()=>St(),xe=()=>K(""),ke=0,ge=()=>{le=!1,ke=0},je={},Pe=Q=>{if(Q instanceof Le||Q=="unwind")return S;d(1,Q)},We=()=>le||ke>0,Ae=Q=>{var te;S=Q,We()||((te=t.onExit)==null||te.call(t,Q),y=!0),d(Q,new Le(Q))},Te=(Q,te)=>{S=Q,Ae(Q)},Oe=Te,Ee=()=>{if(!We())try{Oe(S)}catch(Q){Pe(Q)}},Be=Q=>{if(!y)try{Q(),Ee()}catch(te){Pe(te)}},Fe=()=>performance.now(),rr=(Q,te)=>{if(je[Q]&&(clearTimeout(je[Q].id),delete je[Q]),!te)return 0;var we=setTimeout(()=>{delete je[Q],Be(()=>Pt(Q,Fe()))},te);return je[Q]={id:we,timeout_ms:te},0},qr=()=>Date.now(),Fr=()=>2147483648,Se=(Q,te)=>Math.ceil(Q/te)*te,qe=Q=>{var te=A.buffer.byteLength,we=(Q-te+65535)/65536|0;try{return A.grow(we),L(),1}catch{}},Re=Q=>{var te=M.length;Q>>>=0;var we=Fr();if(Q>we)return!1;for(var rt=1;rt<=4;rt*=2){var Ze=te*(1+.2/rt);Ze=Math.min(Ze,Q+100663296);var ut=Math.min(we,Se(Math.max(Q,Ze),65536)),ft=qe(ut);if(ft)return!0}return!1},Ve=[null,[],[]],wt=typeof TextDecoder<"u"?new TextDecoder:void 0,_r=(Q,te,we,rt)=>{for(var Ze=te+we;Q[te]&&!(te>=Ze);)++te;return te},Dt=(Q,te=0,we,rt)=>{var Ze=_r(Q,te,we);if(Ze-te>16&&Q.buffer&&wt)return wt.decode(Q.subarray(te,Ze));for(var ut="";te<Ze;){var ft=Q[te++];if(!(ft&128)){ut+=String.fromCharCode(ft);continue}var vt=Q[te++]&63;if((ft&224)==192){ut+=String.fromCharCode((ft&31)<<6|vt);continue}var wr=Q[te++]&63;if((ft&240)==224?ft=(ft&15)<<12|vt<<6|wr:ft=(ft&7)<<18|vt<<12|wr<<6|Q[te++]&63,ft<65536)ut+=String.fromCharCode(ft);else{var An=ft-65536;ut+=String.fromCharCode(55296|An>>10,56320|An&1023)}}return ut},Gt=(Q,te)=>{var we=Ve[Q];te===0||te===10?((Q===1?p:_)(Dt(we)),we.length=0):we.push(te)},it=(Q,te,we)=>Q?Dt(M,Q,te):"",et=(Q,te,we,rt)=>{for(var Ze=0,ut=0;ut<we;ut++){var ft=N[te>>2],vt=N[te+4>>2];te+=8;for(var wr=0;wr<vt;wr++)Gt(Q,M[ft+wr]);Ze+=vt}return N[rt>>2]=Ze,0},jt=Q=>{var te=t["_"+Q];return te},Ct=(Q,te)=>{P.set(Q,te)},yt=Q=>{for(var te=0,we=0;we<Q.length;++we){var rt=Q.charCodeAt(we);rt<=127?te++:rt<=2047?te+=2:rt>=55296&&rt<=57343?(te+=4,++we):te+=3}return te},dt=(Q,te,we,rt)=>{if(!(rt>0))return 0;for(var Ze=we,ut=we+rt-1,ft=0;ft<Q.length;++ft){var vt=Q.codePointAt(ft);if(vt<=127){if(we>=ut)break;te[we++]=vt}else if(vt<=2047){if(we+1>=ut)break;te[we++]=192|vt>>6,te[we++]=128|vt&63}else if(vt<=65535){if(we+2>=ut)break;te[we++]=224|vt>>12,te[we++]=128|vt>>6&63,te[we++]=128|vt&63}else{if(we+3>=ut)break;te[we++]=240|vt>>18,te[we++]=128|vt>>12&63,te[we++]=128|vt>>6&63,te[we++]=128|vt&63,ft++}}return te[we]=0,we-Ze},fr=(Q,te,we)=>dt(Q,M,te,we),nn=Q=>zr(Q),st=Q=>{var te=yt(Q)+1,we=nn(te);return fr(Q,we,te),we},Ie=(Q,te,we,rt,Ze)=>{var ut={string:nr=>{var wl=0;return nr!=null&&nr!==0&&(wl=st(nr)),wl},array:nr=>{var wl=nn(nr.length);return Ct(nr,wl),wl}};function ft(nr){return te==="string"?it(nr):te==="boolean"?!!nr:nr}var vt=jt(Q),wr=[],An=0;if(rt)for(var Nn=0;Nn<rt.length;Nn++){var bc=ut[we[Nn]];bc?(An===0&&(An=oe()),wr[Nn]=bc(rt[Nn])):wr[Nn]=rt[Nn]}var Ia=vt(...wr);function Kh(nr){return An!==0&&ve(An),ft(nr)}return Ia=Kh(Ia),Ia};t.noExitRuntime&&(le=t.noExitRuntime),t.print&&(p=t.print),t.printErr&&(_=t.printErr),t.wasmBinary&&(b=t.wasmBinary),t.arguments&&t.arguments,t.thisProgram&&t.thisProgram,t.ccall=Ie;var Pt,ds,zr,St;function La(Q){t._pcafit_wasm=Q.j,t._malloc=Q.k,t._free=Q.l,t._pcapredict_wasm=Q.m,t._pcvpca_wasm=Q.n,t._prepfit_wasm=Q.o,t._prepapply_wasm=Q.p,Pt=Q.q,ds=Q.r,zr=Q.s,St=Q.t}var Gh={c:xe,b:ge,d:rr,g:qr,e:Re,f:et,a:Ae},_l=await Me();function Ra(){if(R>0){q=Ra;return}if(F(),R>0){q=Ra;return}function Q(){var te;t.calledRun=!0,!y&&(U(),k==null||k(t),(te=t.onRuntimeInitialized)==null||te.call(t),O())}t.setStatus?(t.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>t.setStatus(""),1),Q()},1)):Q()}function Xh(){if(t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.shift()()}return Xh(),Ra(),I?e=t:e=new Promise((Q,te)=>{k=Q,C=te}),e}var Yh=X('<p>Current release: <span>2.2.6</span> &nbsp;Feedback: <a class="paper-link" href="mailto:help@mda.tools?subject=DDSIMCA app">help@mda.tools</a> &nbsp;Learn: <a class="paper-link" href="https://doi.org/10.1002/cem.3556" download="">tutorial</a> | <a class="paper-link" href="/ddsimca/Oregano.zip" download="">dataset</a> | <a href="https://www.youtube.com/playlist?list=PLep7KM9cEyFlcYmmBsyqI6whqUlauVCTz">video lessons</a></p>'),Wh=X(`<h2>Data Driven SIMCA</h2> <p>Authors: <em>Sergey Kucheryavskiy, Oxana Rodionova, Alexey Pomerantsev</em></p> <p>Interactive web-application for creating and using DD-SIMCA one class classifier
      directly in your browser. The app does not send any information to a server,
      all calculations are done locally on your device.</p> <p>Check our open access <a href="https://doi.org/10.1002/cem.3556">tutorial paper</a> and YouTube <a href="https://www.youtube.com/playlist?list=PLep7KM9cEyFlcYmmBsyqI6whqUlauVCTz">video-lessons</a></p> <p>Related theory: <a href="https://doi.org/10.1002/cem.2506">10.1002/cem.2506</a>, <a href="https://doi.org/10.1002/cem.2610">10.1002/cem.2610</a>, <a href="https://doi.org/10.1002/cem.3250">10.1002/cem.3250</a>, <a href="https://doi.org/10.1016/j.aca.2024.343352">10.1016/j.aca.2024.343352</a>.</p> <h3>v. 2.2.6</h3> <p class="release-info">released 4/09/2025</p> <ul><li>Fixed a small bug in <em>Predict</em> tab.</li> <li>Added link to updated video-tutorial.</li></ul> <h3>v. 2.2.5</h3> <p class="release-info">released 3/09/2025</p> <ul><li>Improvements to plots and the model widget.</li></ul> <h3>v. 2.2.3</h3> <p class="release-info">released 1/09/2025</p> <ul><li>Fixed rare bug with Acceptance plot.</li></ul>`,1);function Uh(l,e){be(e,!1);function t(o){const c=Object.keys(o);if(!["date","tab","train","test","new"].every(v=>c.includes(v)))return!1;/*!!!!change because in this case different tabs have different fields!!!*/const d=Object.keys(o.train);if(!["model","simca","calset","pvset","calres","pvres","outliers","prepType","prepmodel","prepmeta","prepobj"].every(v=>d.includes(v)))return!1;const u=Object.keys(o.test);if(!["model","simca","testset","testres","outliers"].every(v=>u.includes(v)))return!1;const f=Object.keys(o.new);return!!["model","simca","newset","newres","outliers"].every(v=>f.includes(v))}function s(){return{date:oa(new Date),tab:0,train:{model:0,simca:0,calset:0,calsetp:0,pvset:0,calres:{pca:0,simca:0},pvres:{pca:0,simca:0},outliers:[],prepType:null,prepmodel:0,prepmeta:0,prepobj:[]},test:{model:0,simca:0,testset:0,testres:{pca:0,simca:0},outliers:[],ind:null},new:{model:0,simca:0,newset:0,newres:{pca:0,simca:0},outliers:[]}}}const a=[{name:"Train",label:"train",component:K0},{name:"Test",label:"test",component:_h},{name:"Predict",label:"new",component:zh}];Zu(),Bh(l,{appID:"ddsimca",appTitle:"Data Driven SIMCA",appShortTitle:"DD-SIMCA",appSlogan:"One class classifier",get WASM(){return Vh},get tabs(){return a},initSession:s,checkSession:t,footer:d=>{var u=Yh();T(d,u)},info:d=>{var u=Wh();T(d,u)},$$slots:{footer:!0,info:!0}}),_e()}Ru(Uh,{target:document.body});const Hh=Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"}))})();
//# sourceMappingURL=ddsimca.js.map
