var m1=Object.defineProperty;var Ui=lt=>{throw TypeError(lt)};var h1=(lt,Qe,yt)=>Qe in lt?m1(lt,Qe,{enumerable:!0,configurable:!0,writable:!0,value:yt}):lt[Qe]=yt;var vr=(lt,Qe,yt)=>h1(lt,typeof Qe!="symbol"?Qe+"":Qe,yt),va=(lt,Qe,yt)=>Qe.has(lt)||Ui("Cannot "+yt);var Oe=(lt,Qe,yt)=>(va(lt,Qe,"read from private field"),yt?yt.call(lt):Qe.get(lt)),zt=(lt,Qe,yt)=>Qe.has(lt)?Ui("Cannot add the same private member more than once"):Qe instanceof WeakSet?Qe.add(lt):Qe.set(lt,yt),Wt=(lt,Qe,yt,Qr)=>(va(lt,Qe,"write to private field"),Qr?Qr.call(lt,yt):Qe.set(lt,yt),yt),Jr=(lt,Qe,yt)=>(va(lt,Qe,"access private method"),yt);(function(){"use strict";var Fn,jn,Hr,al,ol,wn,Vn,yn,Xr,On,il,cl,ur,Hi,Ul,ma,Gr,Bn,ul,Dl,Xi,Di;var lt=document.createElement("style");lt.textContent=`button.svelte-ymtj5z{display:inline-block;font-size:.9em;padding:0 .5em;line-height:1.5em;border-radius:.25em;box-shadow:none;margin:0;text-align:center;border:1px solid}.button.svelte-ymtj5z:focus-visible{outline:solid 2px;outline-offset:2px}button.svelte-bx9fh5{display:inline-block;font-size:1em;width:1.3em;height:1.3em;border:none;border-radius:50%;box-shadow:none;margin:0 .25em;text-align:center;padding:0;background-size:45% 45%;background-position:50%;background-repeat:no-repeat}button.svelte-bx9fh5:last-of-type{margin-right:0}.button.svelte-bx9fh5:focus-visible{outline:solid 2px;outline-offset:2px}.control-element.svelte-1986c5z{font-size:.85em;background:var(--container-bg-color, #fff);color:var(--text-color-dark, #606570);padding:.5em .5em .5em 1em;border-radius:0;display:flex;justify-items:flex-start;justify-content:flex-start;align-items:center;margin-bottom:.5px}.control-element.svelte-1986c5z:hover{background:var(--container-bg-color, #fafdff)}.control-element.svelte-1986c5z:first-child{margin-top:.25rem;border-top-left-radius:.25rem;border-top-right-radius:.25rem}.control-element.svelte-1986c5z:last-child{margin-bottom:.25rem;border-bottom-left-radius:.25rem;border-bottom-right-radius:.25rem}.hidden.svelte-1986c5z{display:none}.control-element.error.svelte-1986c5z{background:var(--warning-color, crimson);color:var(--warning-text-color, #fefefe)}.label.svelte-1986c5z{padding-right:.75em;flex-grow:0;flex-shrink:1;color:var(--text-color-dark, #606570)}.control-element.svelte-1986c5z>.wrapper{flex:1 1 auto;position:relative;box-sizing:border-box;display:inline-block;margin:0;padding:0;width:auto;align-items:flex-start;justify-content:center;justify-items:flex-start}.control-element.svelte-1986c5z>h2{text-align:left;flex-grow:1;padding:0 .25em 0 0;margin:0;font-size:1.1em}.control-element.svelte-1986c5z>p{text-align:left;flex-grow:1;padding:0 .25em 0 0;margin:0;font-size:max(12px,.9em)}.control-element.error p{color:var(--warning-text-color, #fefafa)}.control-element.error a{color:var(--warning-link-color, #ffeeaa)}.control-element.error a:hover{color:var(--warning-link-hover-color, #ffee80)}.control-element.svelte-1986c5z>.title{font-size:1.05em;font-weight:700;color:var(--text-color-dark, #606570);flex-grow:1;padding:.3em 0;margin:0}.control-element.svelte-1986c5z>.range-slider-container{outline-color:var(--outline-color, #ccc);background:var(--bg-color-light, #f0f0f0)}.control-element.svelte-1986c5z>.range-slider-container:focus-visible{outline-color:var(--outline-color, #ccc)}.control-element.svelte-1986c5z .range-slider{color:var(--text-color-light, #fafafa);background-color:var(--main-color1, #6eb8ff);border-right-color:var(--main-color2, #528abe)}.control-element.svelte-1986c5z .range-value{color:var(--text-color-light, #fafafa)}.control-element.svelte-1986c5z .range-value_left,.control-element.svelte-1986c5z .range-value_right{color:var(--text-color-dark, #606570)}.control-element.svelte-1986c5z .button{border-color:transparent;background-color:var(--bg-color-dark, #606570);color:var(--text-color-light, #fafafa);outline-color:var(--outline-color, #ccc)}.control-element.svelte-1986c5z .button:hover{border-color:var(--main-color1, #6eb8ff);background-color:var(--main-color1-light, #6eb8ff20);color:var(--main-color2, #5086b9)}.control-element.svelte-1986c5z .button-cancel{background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" version="2.0" viewBox="0 0 100 100" style="stroke:%23fafafa;stroke-width:1em;" ><line x1="0" y1="0" x2="100" y2="100"/><line x1="0" y1="100" x2="100" y2="0"/></svg>')}.control-element.svelte-1986c5z .button-cancel:hover{background-color:var(--warning-color, #dc143c)}.control-element.svelte-1986c5z .button-undo{background-image:url('data:image/svg+xml;utf8,<svg width="99px" height="99px" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><g stroke-linecap="round" stroke-linejoin="round" ><path d="M6 7L7 6L4.70711 3.70711L5.19868 3.21553C5.97697 2.43724 7.03256 2 8.13323 2C11.361 2 14 4.68015 14 7.93274C14 11.2589 11.3013 14 8 14C6.46292 14 4.92913 13.4144 3.75736 12.2426L2.34315 13.6569C3.90505 15.2188 5.95417 16 8 16C12.4307 16 16 12.3385 16 7.93274C16 3.60052 12.4903 0 8.13323 0C6.50213 0 4.93783 0.647954 3.78447 1.80132L3.29289 2.29289L1 0L0 1V7H6Z" fill="%23fafafa"></path> </g></svg>')}.control-element.svelte-1986c5z .button-undo:hover{background-color:var(--main-color1,#6eb8ff)}.control-element.svelte-1986c5z .button-up{background-image:url('data:image/svg+xml;utf8,<svg viewBox="0 0 110 110" style="stroke:%23fafafa;stroke-width:1.1em;" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><line x1="55" y1="110" x2="55" y2="10"/><line x1="20" y1="50" x2="55" y2="10"/><line x1="90" y1="50" x2="55" y2="10"/></svg>')}.control-element.svelte-1986c5z .button-up:hover{background-color:var(--main-color1,#6eb8ff)}.control-element.svelte-1986c5z .button-down{background-image:url('data:image/svg+xml;utf8,<svg viewBox="0 0 110 110" style="stroke:%23fafafa;stroke-width:1.1em;" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><line x1="55" y1="0" x2="55" y2="100"/><line x1="20" y1="60" x2="55" y2="100"/><line x1="90" y1="60" x2="55" y2="100"/></svg>')}.control-element.svelte-1986c5z .button-down:hover{background-color:var(--main-color1,#6eb8ff)}.control-element.svelte-1986c5z .button-download{background-image:url('data:image/svg+xml;utf8,<svg viewBox="0 0 110 110" style="stroke:%23fafafa;stroke-width:1.1em;" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><line x1="50" y1="0" x2="50" y2="100"/><line x1="10" y1="60" x2="50" y2="100"/><line x1="90" y1="60" x2="50" y2="100"/></svg>')}.control-element.svelte-1986c5z .button-download:hover{background-color:var(--main-color1,#6eb8ff)}.control-element.svelte-1986c5z .button-add{background-image:url('data:image/svg+xml;utf8,<svg viewBox="0 0 110 110" style="stroke:%23fafafa;stroke-width:1.1em;" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><line x1="55" y1="0" x2="55" y2="110"/><line x1="0" y1="55" x2="110" y2="55"/></svg>')}.control-element.svelte-1986c5z .button-add:hover{background-color:var(--main-color1,#6eb8ff)}.control-element.svelte-1986c5z .button-settings{background-size:75%;background-image:url('data:image/svg+xml;utf8,<svg width="16" height="16" viewBox="0 0 16 16"  style="stroke:none;stroke-width:1px;" fill="%23fafafa" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><path d="M12.2418 6.58543L6.27026 12.5584C5.94986 12.8788 5.54841 13.1061 5.10883 13.216L2.81783 13.7887C2.45164 13.8803 2.11994 13.5486 2.21149 13.1824L2.78424 10.8914C2.89413 10.4518 3.12143 10.0504 3.44183 9.72996L9.41337 3.75701L12.2418 6.58543ZM13.6567 2.3435C14.4378 3.12455 14.4378 4.39088 13.6567 5.17193L12.9489 5.87833L10.1205 3.0499L10.8283 2.3435C11.6093 1.56245 12.8757 1.56245 13.6567 2.3435Z"/></svg>')}.control-element.svelte-1986c5z .button-settings:hover{background-color:var(--main-color1,#6eb8ff)}.control-element.svelte-1986c5z .selector:focus-visible{outline:2px solid;outline-offset:2px;outline-color:var(--outline-color, #ccc)}.control-element.svelte-1986c5z .selector>.option{color:var(--text-color-dark, #606570);background-color:var(--bg-color-light, #f0f0f0)}.control-element.svelte-1986c5z .plot-selector>.option>svg{stroke:var(--main-color1, #606570)}.control-element.svelte-1986c5z .plot-selector>.option.selected>svg{stroke:var(--text-color-light, #fefefe)}.control-element.svelte-1986c5z .selector>.option.selected{background-color:var(--main-color1, #6eb8ff);color:var(--text-color-light, #fefefe)}.control-element.svelte-1986c5z .selector>.option:not(.selected):hover{border:1px solid var(--main-color1, #6eb8ff);background-color:var(--main-color1-light, #6eb8ff20);color:var(--main-color2, #4777a4)}.control-element.svelte-1986c5z .selector>.option:not(.selected):hover>svg{stroke:var(--main-color2, #4777a4)}.control-element.svelte-1986c5z .file-selector:before{color:var(--text-color-dark, #606570)}.control-element.svelte-1986c5z .file-selector.selected:before{color:var(--main-color1, #6eb8ff)}.control-element.svelte-1986c5z .file-selector:focus-visible{outline-color:var(--outline-color, #ccc)}.control-element.svelte-1986c5z .file-selector:focus-visible:before{outline-color:var(--outline-color, #ccc);color:var(--main-color1, #6eb8ff)}.control-element.svelte-1986c5z .file-selector:hover:before{color:var(--main-color1, #6eb8ff)}.control-element.svelte-1986c5z .textinput>input{background-color:var(--main-color1, #6eb8ff);color:var(--text-color-light, #fefefe)}.control-element.svelte-1986c5z .textinput>input:placeholder-shown{color:var(--text-color-dark, #a0a0a0);background-color:var(--bg-color-light, #f0f0f0);border-color:var(--bg-color-light, #f0f0f0)}.control-element.svelte-1986c5z .textinput>input::placeholder{color:#a0a0a0}.control-element.svelte-1986c5z .textinput>input:active::placeholder,.control-element.svelte-1986c5z .textinput>input:focus::placeholder{color:transparent}.control-element.svelte-1986c5z .textinput>input:focus,.control-element.svelte-1986c5z .textinput>input:active{border-color:var(--main-color1, #6eb8ff);background-color:var(--main-color1-light, #6eb8ff20);color:var(--main-color2, #4777a4)}.control-element.svelte-1986c5z .textinput.error>input,.control-element.svelte-1986c5z .textinput.error>input:focus,.control-element.svelte-1986c5z .textinput.error>input:active{color:var(--warning-color, crimson);background-color:var(--warning-color-light, #ffd5ce);border-color:var(--warning-color, crimson)}.control-element.svelte-1986c5z .textinput.error>.error-message{color:var(--warning-color, crimson);background-color:var(--warning-color-light, #ffd5ce)}.control-element.svelte-1986c5z .spinner:after{border-color:var(--main-color1, #6eb8ff) transparent var(--main-color1, #6eb8ff) transparent}.control-element.svelte-1986c5z .number-container{background-color:var(--bg-color-light, #f0f0f0)}.control-element.svelte-1986c5z .number-container>.value{color:var(--text-color-dark, #606570)}.control-element.svelte-1986c5z .number-container>.button-small>svg>polygon{fill:var(--main-color2, #4777a4)}.control-element.svelte-1986c5z .number-container>.button-small:hover>svg>polygon{fill:var(--main-color1, #6eb8ff)}.control-element.svelte-1986c5z .number-container:focus-visible{outline-color:var(--outline-color, #ccc)}.range-slider-container.svelte-vhx0r0{position:relative;box-sizing:border-box;flex:1 1 auto;height:1.5em;margin:0;padding:0;width:auto;border-radius:2px;cursor:default;display:flex;align-items:center;user-select:none;-webkit-user-select:none;-moz-user-select:none}.range-slider-container.svelte-vhx0r0:focus-visible{outline:solid 2px #ccc;outline-offset:2px}.range-slider.svelte-vhx0r0{position:relative;display:flex;justify-content:right;align-items:center;box-sizing:border-box;border-radius:2px;border-right:solid 5px;text-align:right;margin:0;padding:0;height:100%;cursor:default;user-select:none;-webkit-user-select:none;-moz-user-select:none}.range-slider_right.svelte-vhx0r0{justify-content:left}.range-value.svelte-vhx0r0{display:inline-block;margin:0;padding:0;cursor:default;font-size:.85em;position:relative;user-select:none;-webkit-user-select:none;-moz-user-select:none;right:.25em}.range-value_right.svelte-vhx0r0{left:calc(100% + 5px + .25em)}.range-slider-container.svelte-xdlm7u{position:relative;box-sizing:border-box;display:inline-block;flex:1 1 auto;height:1.5em;margin:0;padding:0;width:auto;border-radius:2px;cursor:default;display:flex;align-items:center;user-select:none;-webkit-user-select:none;-moz-user-select:none}.range-slider-container.svelte-xdlm7u:focus-visible{outline:solid 2px;outline-offset:2px}.range-slider.svelte-xdlm7u{position:relative;display:flex;justify-content:center;align-items:center;box-sizing:border-box;border-radius:2px;text-align:center;margin:0;padding:0;height:100%;cursor:default;user-select:none;-webkit-user-select:none;-moz-user-select:none}.range-slider_left.svelte-xdlm7u{justify-content:left}.range-slider_right.svelte-xdlm7u{justify-content:right}.range-value.svelte-xdlm7u{display:inline-block;margin:0;padding:0;cursor:default;font-size:.85em;user-select:none;-webkit-user-select:none;-moz-user-select:none}.range-value_left.svelte-xdlm7u{position:relative;left:calc(100% + .25em)}.range-value_right.svelte-xdlm7u{position:relative;right:calc(100% + .25em)}input.svelte-1i17tox{display:none}.selector.svelte-1i17tox{position:relative;box-sizing:border-box;flex:1 1 auto;font-size:1em;line-height:1.5em;margin:0;padding:0;width:auto;border-radius:2px;user-select:none;-webkit-user-select:none;-moz-user-select:none;display:flex}.selector.svelte-1i17tox:focus-visible{outline:solid 2px;outline-offset:2px}.option.svelte-1i17tox{cursor:default;padding:.25em .5em;margin:0 .3em 0 0;border:1px solid transparent;border-radius:.3em;font-size:.85em}.option.svelte-1i17tox:not(.selected):hover{border:1px solid}.file-selector.svelte-1k0x7uv>input:where(.svelte-1k0x7uv){display:none}.file-selector.svelte-1k0x7uv{display:flex;align-items:baseline;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;flex:1 1;min-width:0;border-radius:2px;cursor:default}.file-selector.svelte-1k0x7uv:focus-visible{outline:solid 2px;outline-offset:2px}.file-selector.svelte-1k0x7uv:before{display:inline-block;content:"⇪";font-size:1.1em;margin:0 .5em 0 0;padding:0}.file-selector.selected.svelte-1k0x7uv:before{content:"☷";font-size:1.3em;letter-spacing:-.2em;font-weight:700}.textinput.svelte-1qtiwcs{box-sizing:border-box;flex:1 1 auto;font-size:1em;line-height:1.5em;margin:0;padding:.15em 0;width:auto;border-radius:2px;user-select:none;-webkit-user-select:none;-moz-user-select:none;display:flex;position:relative}.textinput.svelte-1qtiwcs>input:where(.svelte-1qtiwcs){flex:1 1 auto;font-size:.9em;width:100%;cursor:default;padding:.25em .5em;border:1px solid;border-radius:.3em;outline:none}.textinput.svelte-1qtiwcs>input:where(.svelte-1qtiwcs):focus,.textinput.svelte-1qtiwcs>input:where(.svelte-1qtiwcs):active{border:1px solid}.error-message.svelte-1qtiwcs{position:absolute;left:0;bottom:calc(100% + 2px);border-radius:.3em;line-height:1em;font-size:.75em;padding:.5em}.spinner.svelte-n48urb{display:inline-block;height:1.5em;line-height:1.5em;width:1.5em;margin:0 .5em}.spinner.svelte-n48urb:after{content:" ";display:block;width:.8em;height:.8em;margin:.1em;border-radius:50%;border:.2em solid;animation:svelte-n48urb-spinner 1.2s linear infinite}@keyframes svelte-n48urb-spinner{0%{transform:rotate(0)}to{transform:rotate(360deg)}}input.svelte-yf64an{display:none}.selector.svelte-yf64an{position:relative;box-sizing:border-box;flex:1 1 auto;font-size:1em;margin:0;padding:0;width:auto;border-radius:2px;user-select:none;-webkit-user-select:none;-moz-user-select:none;display:flex}.option.svelte-yf64an{cursor:default;padding:0;padding-inline:0;padding-block:0;margin:0 .2em 0 0;border:1px solid transparent;border-radius:.3em;font-size:.85em;height:auto;display:flex;justify-content:center}.option.svelte-yf64an:not(.selected):hover{border:1px solid}.outliers.svelte-1ggez3e{line-height:1.5em;text-align:left;padding:.5em 0;flex:0 0 80%}.outliers.svelte-1ggez3e>.item:where(.svelte-1ggez3e){color:#dc143c;background:#dc143c20;display:inline-block;white-space:nowrap;vertical-align:middle;max-width:10ch;overflow:hidden;text-overflow:ellipsis;padding:.1em .5em;margin:.2em .1em;border-radius:.2em}.exclvars.svelte-181kelh{line-height:1.5em;text-align:left;padding:.5em 0;flex:0 0 80%}.show-download-links-none.svelte-1jtdxd0>.download-links:where(.svelte-1jtdxd0){display:none}.show-download-links-hover.svelte-1jtdxd0:hover>.download-links:where(.svelte-1jtdxd0){bottom:0}.show-download-links-fixed.svelte-1jtdxd0>.download-links:where(.svelte-1jtdxd0){bottom:0}.download-links.svelte-1jtdxd0{position:absolute;font-size:.8em;bottom:-50%;right:0;z-index:10;padding:.5em 1em;background:#fefefe;border-radius:.5em;transition:bottom .35s ease;box-shadow:0 0 .75em #00000060;margin:.6em;box-sizing:border-box;display:flex;align-items:center;justify-content:center}.download-links.svelte-1jtdxd0>button:where(.svelte-1jtdxd0){box-sizing:border-box;color:#606060;border:none;box-shadow:none;background:#fafafa;border-radius:.35em;padding:.25em .5em}.download-links.svelte-1jtdxd0>button:where(.svelte-1jtdxd0):hover{background:#433;color:#fafafa}.download-links.svelte-1jtdxd0>button.error{background:#e43}.download-links.svelte-1jtdxd0>button.copied{background:#48e}.plot-container.svelte-1jtdxd0{font-family:Arial,Helvetica,sans-serif;box-sizing:border-box;position:relative;min-width:100px;min-height:50px;width:100%;height:100%;padding:0;margin:0;overflow:hidden;background:#fff}.plot-error.svelte-1jtdxd0{display:flex;justify-content:center;align-items:center}.message-error.svelte-1jtdxd0{font-size:1.2em;color:#dc143c;padding:1em;box-sizing:border-box;text-align:center}.plot.svelte-1jtdxd0{display:block;box-sizing:border-box;position:absolute;padding:0;margin:0;left:0;top:0;bottom:0;right:0;width:100%;height:100%}.axes-content.svelte-1jtdxd0{padding:0;margin:0;height:100%;width:100%;max-height:100%;max-width:100%;min-height:100%;min-width:100%}.drop.svelte-q7wo60{position:fixed;z-index:9999;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background-color:#000000a0}.modal.svelte-q7wo60{border-radius:.5rem;background-color:#fff;display:grid;grid-template-areas:"header" "body";grid-template-rows:30px 1fr;width:auto;height:auto;border-radius:.25rem}.body.svelte-q7wo60{grid-area:body;box-sizing:border-box;padding:0 1em .5em;width:100%;height:100%}.header.svelte-q7wo60{grid-area:header}.close-button.svelte-q7wo60{cursor:pointer;border:none;box-shadow:none;background:transparent;font-size:inherit;font-weight:700;color:#f8ebc5;border-radius:50%;width:20px;height:20px;background-color:#9ea0a2;float:right;text-align:center;padding:0;line-height:20px;font-size:12px;margin:5px}.close-button.svelte-q7wo60:hover{background-color:#4e5052}.isdark.svelte-q7wo60,.isdark.svelte-q7wo60 .header:where(.svelte-q7wo60),.isdark.svelte-q7wo60 .body:where(.svelte-q7wo60){background-color:#606060}.isdark.svelte-q7wo60 .close-button:where(.svelte-q7wo60){color:#433201;background-color:#c2be9b}.isdark.svelte-q7wo60 .close-button:where(.svelte-q7wo60):hover{background-color:#f0f674}.wrapper.svelte-ha02r1{width:95vw;height:90vh;display:grid;grid-template-areas:"plot" "message" "controls";grid-template-rows:1fr 15px min-content}.plot-container.svelte-ha02r1{grid-area:plot}.plot-controls.svelte-ha02r1{grid-area:controls;display:flex;width:100%;justify-content:center;border-radius:.5rem}.plot-controls.svelte-ha02r1>.control-element{background:transparent}.msg-select.svelte-ha02r1{grid-area:message;height:15px;font-size:12px;color:#aaa;text-align:center}.info-details.svelte-1l1cvmx{position:relative;border-bottom:dashed 1px #606060;cursor:help}.info-details.svelte-1l1cvmx>span:where(.svelte-1l1cvmx){position:absolute;z-index:1;background:#505050;visibility:hidden;width:300px;top:100%;left:50%;margin-left:-100px;color:beige;box-shadow:0 0 5px #00000060;padding:.5em 1em;border-radius:.25em}.info-details.svelte-1l1cvmx>span:where(.svelte-1l1cvmx) ul{padding:0;margin:0;list-style:none}.info-details.svelte-1l1cvmx>span:where(.svelte-1l1cvmx) ul>li{padding:.25em 0}.info-details.svelte-1l1cvmx>span:where(.svelte-1l1cvmx) ul>li>span{margin-left:1em;padding:.15em .5em;background-color:#707070;border-radius:3px}.info-details.svelte-1l1cvmx:hover>span:where(.svelte-1l1cvmx){visibility:visible}.info{position:relative}.info-text.svelte-1dxrrpt{line-height:1.5em}.info-text.svelte-1dxrrpt>span{vertical-align:top;color:#a0a0a0}.info-text.svelte-1dxrrpt>.file-name:where(.svelte-1dxrrpt){display:inline-block;padding:0;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:25ch;color:#222}.prep-info{position:relative}span.svelte-2gffce{cursor:default;display:inline-block;border-radius:3px;border:solid 1px #a0a0a0;color:gray;background-color:#fafafa;padding:.2em .5em;margin:0 .5em}span.svelte-2gffce:hover{border:solid 1px #6eb8ff;color:#5086b9;background-color:#6eb8ff20}button.button-down{box-sizing:border-box;margin:0 .3em 0 0}botton.button-up{box-sizing:border-box;margin:0}.method-open.svelte-2gffce{position:absolute;height:100vh;top:0;left:inherit;width:340px;padding:200px 1em 1em;margin-left:-18px;background:#000000a0;z-index:999;box-sizing:border-box}.selected-methods-list.svelte-15cx0gr{background:#fefafaa0;border-radius:5px}.selected-methods-list.svelte-15cx0gr>.control-element:last-child .button-down,.selected-methods-list.svelte-15cx0gr>.control-element:nth-child(2) .button-up{cursor:text;background-color:transparent;color:transparent}.selected-methods-list.svelte-15cx0gr:not(.editable)>.control-element .button-settings{display:block}.methods-list.svelte-15cx0gr{margin-top:1em;font-size:.9em}.methods-list.svelte-15cx0gr>div{background:#ebf0f0}.final.svelte-15cx0gr .button-up,.final.svelte-15cx0gr .button-down,.final.svelte-15cx0gr .button-cancel{visibility:hidden}.plot-panel.svelte-x8qn01{width:100%;height:100%;box-sizing:border-box;padding:0;display:grid;grid-template-rows:1fr;grid-template-columns:1fr minmax(270px,30%)}.plot-area.svelte-x8qn01{padding:1em;margin-top:.25rem;border-radius:.25em;background:#fefefe}.plot-controls-area.svelte-x8qn01{padding:0 .25em 0 .5em}.plot.svelte-x8qn01{width:100%;height:calc(100% - 15px)}@media (min-width:1100px){.plot-panel.svelte-x8qn01{grid-template-columns:1fr minmax(285px,30%)}}@media (min-width:1300px){.plot-panel.svelte-x8qn01{grid-template-columns:1fr max(300px,30%)}}@media (min-width:1600px){.plot-panel.svelte-x8qn01{grid-template-columns:1fr 400px}}.widget-container.svelte-1soqt9v{font-family:Helvetica,Arial,sans-serif;font-size:1rem;color:#404040;box-sizing:border-box;margin:0 auto;padding:.35em .25em;width:100%;height:100%;display:grid;grid-template-areas:"controls content";grid-template-rows:100%;grid-template-columns:min(310px,30%) 1fr;background-color:#606060;width:98vw;height:95vh}.app-controls.svelte-1soqt9v{box-sizing:border-box;padding:.25em .5em}.app-content.svelte-1soqt9v{box-sizing:border-box;padding:.25em;height:100%}.app-controls.svelte-1soqt9v>div:where(.svelte-1soqt9v){border-radius:.25rem}@media (min-width:1300px){.widget-container.svelte-1soqt9v{grid-template-columns:min(340px,30%) 1fr}}@media (min-width:1100px){.widget-container.svelte-1soqt9v{grid-template-columns:min(320px,30%) 1fr}}.prep-container>button{margin-left:.25em}table.svelte-8wnifa{width:100%;border-collapse:collapse}tr.svelte-8wnifa{width:100%}th.svelte-8wnifa{border-bottom:1px solid #a0a0a0}th.svelte-8wnifa,td.svelte-8wnifa{text-align:right;padding:.2em .5em .2em .1em;color:#404040;margin:0}td.svelte-8wnifa:first-of-type{width:25%}p.svelte-16w7odi{line-height:1.5em}span.svelte-16w7odi{color:#a0a0a0}.dataset-info.svelte-gdjwex{line-height:1.5em}.dataset-info.svelte-gdjwex>span{vertical-align:middle;color:#a0a0a0}.dataset-info.svelte-gdjwex>.file-name:where(.svelte-gdjwex),.dataset-info.svelte-gdjwex>.file-size:where(.svelte-gdjwex){display:inline-block;padding:0;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:25ch;color:#222}.selected-buttons.svelte-8mh2yv>.control-element{background:#fff0c8}.selected-buttons.svelte-8mh2yv>.control-element button:last-of-type{color:#fff;border-color:#dc143c;background:#dc143c;margin-left:5px}.selected-buttons.svelte-8mh2yv>.control-element button:last-of-type:hover{background:#dc143c20;border-color:#dc143c80;color:#dc143c}.plot-panel.svelte-8mh2yv{width:100%;height:100%;box-sizing:border-box;padding:0;display:grid;grid-template-rows:1fr;grid-template-columns:1fr minmax(270px,30%)}.plot-area.svelte-8mh2yv{padding:1em;margin-top:.25rem;border-radius:.25em;background:#fefefe}.plot-controls-area.svelte-8mh2yv{padding:0 .25em 0 .5em}.plot-selector.svelte-8mh2yv{cursor:pointer;color:#606060;background:#fffef480;box-sizing:border-box;padding:.5em 1em;margin:.25em 0;border-radius:.25rem;box-shadow:none;border:none;width:100%;text-align:left;font-size:1rem}.plot-selector.svelte-8mh2yv:hover{background:#e0e0e0;color:#403020}div.plot-container.off-screen{position:absolute;top:0;left:50%;width:650px;height:600px;background:#fff;z-index:999}.plot.svelte-8mh2yv{width:100%;height:calc(100% - 15px)}.plot-select-msg.svelte-8mh2yv{height:15px;font-size:12px;color:#aaa;text-align:center}@media (min-width:1100px){.plot-panel.svelte-8mh2yv{grid-template-columns:1fr minmax(285px,30%)}}@media (min-width:1300px){.plot-panel.svelte-8mh2yv{grid-template-columns:1fr max(300px,30%)}}@media (min-width:1600px){.plot-panel.svelte-8mh2yv{grid-template-columns:1fr 400px}}div.svelte-17oamay{width:100%;height:100%}div.svelte-17oamay .plot .axes{cursor:crosshair}div.svelte-17oamay .plot .axes-content rect{pointer-events:none}.plot-controls-area>.plot-selector-fom,.plot-controls-area>.plot-selector-loadings{margin-top:1em}.info-text.svelte-3v2vv7{line-height:1.5em}.info-text.svelte-3v2vv7>span{vertical-align:top;color:#a0a0a0}.info-text.svelte-3v2vv7>.file-name:where(.svelte-3v2vv7){display:inline-block;padding:0;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:25ch;color:#222}.app-container.svelte-b7gdku{font-family:Helvetica,Arial,sans-serif;font-size:1rem;color:#404040;box-sizing:border-box;margin:0 auto;padding:.35em .25em;width:100%;height:100%;display:grid;grid-template-areas:"controls content";grid-template-rows:100%;grid-template-columns:min(310px,30%) 1fr}.app-controls.svelte-b7gdku{box-sizing:border-box;padding:.25em .5em}.app-content.svelte-b7gdku{box-sizing:border-box;padding:.25em;height:100%}.app-controls.svelte-b7gdku>div:where(.svelte-b7gdku){border-radius:.25rem}.app-controls.svelte-b7gdku>.result-stats:where(.svelte-b7gdku){background:#e8e8e8}.help-text.svelte-b7gdku{margin-top:.25rem}.help-text.svelte-b7gdku>p:where(.svelte-b7gdku),.help-text.svelte-b7gdku>div:where(.svelte-b7gdku){background:#fafafa;padding:0 1.5em .5em;color:#606060;line-height:1.5em;margin:0 1em 0 0}.help-text.svelte-b7gdku table:where(.svelte-b7gdku){border-collapse:collapse}.help-text.svelte-b7gdku table:where(.svelte-b7gdku) td:where(.svelte-b7gdku){padding:.25em .5em;background:#e0f0fa;text-align:right;border:1px solid white}.help-text.svelte-b7gdku table:where(.svelte-b7gdku) thead:where(.svelte-b7gdku) tr:where(.svelte-b7gdku) td:where(.svelte-b7gdku){font-weight:700;background:#f8f4e0}.help-text.svelte-b7gdku table:where(.svelte-b7gdku) td:where(.svelte-b7gdku):first-child{font-weight:700;background:#f8f4e0;padding-right:1em}.help-text.svelte-b7gdku table:where(.svelte-b7gdku) tbody:where(.svelte-b7gdku) td:where(.svelte-b7gdku):nth-child(2){background:#e0e8f0;padding-right:1em}.help-text.svelte-b7gdku>p:where(.svelte-b7gdku):first-child{border-top-left-radius:.25rem;border-top-right-radius:.25rem;padding-top:1.5em}.help-text.svelte-b7gdku>p:where(.svelte-b7gdku):last-child{border-bottom-left-radius:.25rem;border-bottom-right-radius:.25rem;padding-bottom:1.5em}.result-stats.svelte-b7gdku{padding:.5rem 1rem;margin-top:.25rem;font-size:.85em}@media (min-width:1300px){.app-container.svelte-b7gdku{grid-template-columns:min(340px,30%) 1fr}}@media (min-width:1100px){.app-container.svelte-b7gdku{grid-template-columns:min(330px,30%) 1fr}}.app-container.svelte-1ssp7bh{font-family:Helvetica,Arial,sans-serif;font-size:1rem;color:#404040;box-sizing:border-box;margin:0 auto;padding:.35em .25em;width:100%;height:100%;display:grid;grid-template-areas:"controls content";grid-template-rows:100%;grid-template-columns:min(310px,30%) 1fr}.app-controls.svelte-1ssp7bh{box-sizing:border-box;padding:.25em .5em}.app-content.svelte-1ssp7bh{box-sizing:border-box;padding:.25em;height:100%}.app-controls.svelte-1ssp7bh>div:where(.svelte-1ssp7bh){border-radius:.25rem}.help-text.svelte-1ssp7bh{margin-top:.25rem}.help-text.svelte-1ssp7bh>p:where(.svelte-1ssp7bh),.help-text.svelte-1ssp7bh>div:where(.svelte-1ssp7bh){background:#fafafa;padding:0 1.5em .5em;color:#606060;line-height:1.5em;margin:0 1em 0 0}.help-text.svelte-1ssp7bh table:where(.svelte-1ssp7bh){border-collapse:collapse}.help-text.svelte-1ssp7bh table:where(.svelte-1ssp7bh) td:where(.svelte-1ssp7bh){padding:.25em .5em;background:#e0f0fa;text-align:right;border:1px solid white}.help-text.svelte-1ssp7bh table:where(.svelte-1ssp7bh) thead:where(.svelte-1ssp7bh) tr:where(.svelte-1ssp7bh) td:where(.svelte-1ssp7bh){font-weight:700;background:#f8f4e0}.help-text.svelte-1ssp7bh table:where(.svelte-1ssp7bh) td:where(.svelte-1ssp7bh):first-child{font-weight:700;background:#f8f4e0;padding-right:1em}.help-text.svelte-1ssp7bh>p:where(.svelte-1ssp7bh):first-child{border-top-left-radius:.25rem;border-top-right-radius:.25rem;padding-top:1.5em}.help-text.svelte-1ssp7bh>p:where(.svelte-1ssp7bh):last-child{border-bottom-left-radius:.25rem;border-bottom-right-radius:.25rem;padding-bottom:1.5em}@media (min-width:1300px){.app-container.svelte-1ssp7bh{grid-template-columns:min(340px,30%) 1fr}}@media (min-width:1100px){.app-container.svelte-1ssp7bh{grid-template-columns:min(330px,30%) 1fr}}.page.svelte-1cyr8za{width:100%;height:100%;margin:0 auto;padding:0;min-width:1020px;min-height:590px;max-width:1900px;display:flex;flex-direction:column}header.svelte-1cyr8za{display:flex;justify-content:flex-start;flex-direction:row;background:#f8f6f4}.header-group.svelte-1cyr8za{width:min-content;min-width:400px;margin:0 0 0 .25rem;display:grid;align-items:center;grid-template-columns:min-content 1fr;grid-template-rows:min-content min-content min-content min-content;grid-template-areas:"logo ." "logo title" "logo subtitle" "logo ."}.logo.svelte-1cyr8za{width:3.5rem;margin:.25rem;padding:.5rem;grid-area:logo}.header-group.svelte-1cyr8za>h1:where(.svelte-1cyr8za){margin:0;padding:0;text-align:left;font-size:1.6rem;color:#4e5052;white-space:nowrap;grid-area:title}.header-group.svelte-1cyr8za>p:where(.svelte-1cyr8za){margin:0;padding:0;text-align:left;font-size:1.1rem;color:#7e8082;grid-area:subtitle}main.svelte-1cyr8za{flex-basis:auto;flex-grow:1;flex-shrink:1;box-sizing:border-box;padding:.2rem 0}main.svelte-1cyr8za>div:where(.svelte-1cyr8za){height:100%}footer.svelte-1cyr8za{display:grid;grid-template-columns:20% 60% 20%;grid-template-areas:"session info .";align-items:center;justify-content:center;font-size:.9rem;flex-basis:min-content;flex-grow:0;flex-shrink:0;background:#4e5052;color:silver;padding:.5em}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za){grid-area:session;padding-left:.5em;display:flex;align-items:center}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) input:where(.svelte-1cyr8za){display:none}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .session-message:where(.svelte-1cyr8za){color:silver;padding-right:.5em}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .session-message:where(.svelte-1cyr8za){color:#fafafa}footer.svelte-1cyr8za .session.no-buttons:where(.svelte-1cyr8za) .clear-button:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session.no-buttons:where(.svelte-1cyr8za) .upload-button:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session.no-buttons:where(.svelte-1cyr8za) .download-button:where(.svelte-1cyr8za){display:none}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .clear-button:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .upload-button:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .download-button:where(.svelte-1cyr8za){font-size:.9rem;background:#5e6062;color:silver;box-shadow:none;padding:0;margin:0 0 0 .2em;border-radius:3px;border:none;height:20px;box-sizing:border-box;display:inline-block}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .clear-button:where(.svelte-1cyr8za) svg:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .upload-button:where(.svelte-1cyr8za) svg:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .download-button:where(.svelte-1cyr8za) svg:where(.svelte-1cyr8za){stroke-width:.75em;stroke-linecap:round;stroke-linejoin:round;stroke:silver}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .clear-button:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .upload-button:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .download-button:where(.svelte-1cyr8za){background:#35332d}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .clear-button:where(.svelte-1cyr8za) svg:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .upload-button:where(.svelte-1cyr8za) svg:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .download-button:where(.svelte-1cyr8za) svg:where(.svelte-1cyr8za){stroke:#fafafa}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .clear-button:where(.svelte-1cyr8za){margin-left:.5em}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .upload-button:where(.svelte-1cyr8za):hover,footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .download-button:where(.svelte-1cyr8za):hover{background-color:#6eb8ff}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .clear-button:where(.svelte-1cyr8za):hover{background-color:#dc143c}footer.svelte-1cyr8za .info:where(.svelte-1cyr8za){grid-area:info;display:flex;justify-content:center;align-items:center}footer.svelte-1cyr8za .info:where(.svelte-1cyr8za) .button-info:where(.svelte-1cyr8za){cursor:default;border:none;box-shadow:none;background:transparent;font-weight:700;color:#4e5052;border-radius:.2em;padding:.25em .5em;text-align:center;line-height:1em;margin-left:.25em;margin-right:.5em;background-color:#f8ebc5}footer.svelte-1cyr8za .info:where(.svelte-1cyr8za) .button-info:where(.svelte-1cyr8za):hover{background-color:#f7db89}footer.svelte-1cyr8za p{margin:0 .5em;text-align:center;padding:.15em}footer.svelte-1cyr8za span,footer.svelte-1cyr8za a{color:#f8ebc5}.hidden.svelte-1cyr8za{display:none}.nav.svelte-1cyr8za,.nav.svelte-1cyr8za :where(.svelte-1cyr8za){-webkit-user-select:none;user-select:none;-moz-user-select:none}.nav.svelte-1cyr8za{display:flex;flex-direction:row;justify-content:flex-end;list-style:none;margin:0 100px 0 auto;padding:0;align-self:flex-end}.nav-item.svelte-1cyr8za{list-style:none;margin:0;border-bottom:5px solid transparent}.nav-item.svelte-1cyr8za>button:where(.svelte-1cyr8za){cursor:pointer;padding:.5em 1em;border:none;box-shadow:none;background:transparent;font-size:inherit}.nav-item.svelte-1cyr8za>button:where(.svelte-1cyr8za)>span{color:#888}.nav-item.svelte-1cyr8za:hover{border-bottom:5px solid #80888f50}.nav-item.svelte-1cyr8za:hover>button:where(.svelte-1cyr8za){border-top-left-radius:5px;border-top-right-radius:5px;background:#00000010}.nav-item.selected.svelte-1cyr8za{border-bottom:5px solid #80888f}.nav-item.selected.svelte-1cyr8za>button:where(.svelte-1cyr8za){font-weight:700;cursor:default}.nav-item.selected.svelte-1cyr8za:hover{border-bottom:5px solid #80888f}@media (min-width: 1600px){.page.svelte-1cyr8za>header:where(.svelte-1cyr8za){border-bottom-right-radius:.25rem;border-bottom-left-radius:.25rem}.page.svelte-1cyr8za>footer:where(.svelte-1cyr8za){border-top-right-radius:.25rem;border-top-left-radius:.25rem}}.info-container.svelte-1cyr8za{width:900px}.info-container.svelte-1cyr8za>p{font-size:1.15em;line-height:1.35em;padding:0 1em .5em;margin:0}.info-container.svelte-1cyr8za>.release-info{font-size:1em;color:gray;line-height:1.25em;padding:0 1.2em .5em;margin:0}.info-container.svelte-1cyr8za>h2{font-size:1.5em;line-height:1.25em;padding:0em 1rem .5em;margin:0}.info-container.svelte-1cyr8za>h3{font-size:1.15em;line-height:1.25em;padding:1rem 1em .25em;margin:0}.info-container.svelte-1cyr8za>ul{margin:0}.info-container.svelte-1cyr8za>ul>li{font-size:1.15em;line-height:1.25em;padding:0 .5em .5em 0;margin:0}.info-container.svelte-1cyr8za>ul>li>span{font-size:.9em;color:gray;line-height:1.25em;padding:0 .25em;margin:0}.info-container.svelte-1cyr8za a{color:#ae8032}.info-container.svelte-1cyr8za a:hover{color:#eb9707}.info-container.svelte-1cyr8za:last-child{padding-bottom:1rem}
/*$vite$:1*/`,document.head.appendChild(lt);var Qe=typeof document<"u"?document.currentScript:null;const yt=!1;var Qr=Array.isArray,Gi=Array.prototype.indexOf,Hl=Array.from,Xl=Object.defineProperty,Nr=Object.getOwnPropertyDescriptor,ha=Object.getOwnPropertyDescriptors,ga=Object.prototype,Ki=Array.prototype,vl=Object.getPrototypeOf,pa=Object.isExtensible;function En(n){return typeof n=="function"}const Tt=()=>{};function Ji(n){return typeof(n==null?void 0:n.then)=="function"}function Qi(n){return n()}function ml(n){for(var e=0;e<n.length;e++)n[e]()}function Zi(){var n,e,r=new Promise((l,s)=>{n=l,e=s});return{promise:r,resolve:n,reject:e}}function Gl(n,e){if(Array.isArray(n))return n;if(e===void 0||!(Symbol.iterator in n))return Array.from(n);const r=[];for(const l of n)if(r.push(l),r.length===e)break;return r}const Ut=2,Kl=4,hl=8,Sn=16,Er=32,Zr=64,ba=128,$t=256,gl=512,It=1024,er=2048,zr=4096,ar=8192,$r=16384,pl=32768,Cn=65536,_a=1<<17,$i=1<<18,Jl=1<<19,Ql=1<<20,Zl=1<<21,$l=1<<22,en=1<<23,Rr=Symbol("$state"),wa=Symbol("legacy props"),ec=Symbol(""),es=new class extends Error{constructor(){super(...arguments);vr(this,"name","StaleReactionError");vr(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function tc(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function ya(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function rc(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function nc(n){throw new Error("https://svelte.dev/e/effect_in_teardown")}function lc(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function sc(n){throw new Error("https://svelte.dev/e/effect_orphan")}function ac(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function oc(n){throw new Error("https://svelte.dev/e/props_invalid_value")}function ic(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function cc(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function uc(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const bl=1,_l=2,xa=4,dc=8,fc=16,vc=1,mc=2,hc=4,gc=8,pc=16,bc=1,_c=2,wc=4,ka=1,yc=2,xt=Symbol(),xc="http://www.w3.org/1999/xhtml";let kc=!1;function Ea(n){return n===this.v}function Sa(n,e){return n!=n?e==e:n!==e||n!==null&&typeof n=="object"||typeof n=="function"}function Ec(n,e){return n!==e}function Ca(n){return!Sa(n,this.v)}let An=!1,Sc=!1;function Cc(){An=!0}const Ac=[];function Tc(n,e=!1){return wl(n,new Map,"",Ac)}function wl(n,e,r,l,s=null){if(typeof n=="object"&&n!==null){var a=e.get(n);if(a!==void 0)return a;if(n instanceof Map)return new Map(n);if(n instanceof Set)return new Set(n);if(Qr(n)){var o=Array(n.length);e.set(n,o),s!==null&&e.set(s,o);for(var c=0;c<n.length;c+=1){var d=n[c];c in n&&(o[c]=wl(d,e,r,l))}return o}if(vl(n)===ga){o={},e.set(n,o),s!==null&&e.set(s,o);for(var u in n)o[u]=wl(n[u],e,r,l);return o}if(n instanceof Date)return structuredClone(n);if(typeof n.toJSON=="function")return wl(n.toJSON(),e,r,l,n)}if(n instanceof EventTarget)return n;try{return structuredClone(n)}catch{return n}}let st=null;function Tn(n){st=n}function jt(n){return Aa().get(n)}function Pc(n,e){return Aa().set(n,e),e}function fe(n,e=!1,r){st={p:st,c:null,e:null,s:n,x:null,l:An&&!e?{s:null,u:null,$:[]}:null}}function ve(n){var e=st,r=e.e;if(r!==null){e.e=null;for(var l of r)Da(l)}return st=e.p,{}}function Mr(){return!An||st!==null&&st.l===null}function Aa(n){return st===null&&ya(),st.c??(st.c=new Map(Lc(st)||void 0))}function Lc(n){let e=n.p;for(;e!==null;){const r=e.c;if(r!==null)return r;e=e.p}return null}const Nc=new WeakMap;function zc(n){var e=We;if(e===null)return Ue.f|=en,n;if((e.f&pl)===0){if((e.f&ba)===0)throw!e.parent&&n instanceof Error&&Ta(n),n;e.b.error(n)}else ts(n,e)}function ts(n,e){for(;e!==null;){if((e.f&ba)!==0)try{e.b.error(n);return}catch(r){n=r}e=e.parent}throw n instanceof Error&&Ta(n),n}function Ta(n){const e=Nc.get(n);e&&(Xl(n,"message",{value:e.message}),Xl(n,"stack",{value:e.stack}))}let qn=[],rs=[];function Pa(){var n=qn;qn=[],ml(n)}function Rc(){var n=rs;rs=[],ml(n)}function Dn(n){qn.length===0&&queueMicrotask(Pa),qn.push(n)}function Mc(){qn.length>0&&Pa(),rs.length>0&&Rc()}function Ic(){for(var n=We.b;n!==null&&!n.has_pending_snippet();)n=n.parent;return n===null&&tc(),n}function Yn(n){var e=Ut|er,r=Ue!==null&&(Ue.f&Ut)!==0?Ue:null;return We===null||r!==null&&(r.f&$t)!==0?e|=$t:We.f|=Jl,{ctx:st,deps:null,effects:null,equals:Ea,f:e,fn:n,reactions:null,rv:0,v:xt,wv:0,parent:r??We,ac:null}}function Fc(n,e){let r=We;r===null&&rc();var l=r.b,s=void 0,a=ln(xt),o=null,c=!Ue;return Gc(()=>{try{var d=n()}catch(h){d=Promise.reject(h)}var u=()=>d;s=(o==null?void 0:o.then(u,u))??Promise.resolve(d),o=s;var f=et,v=l.pending;c&&(l.update_pending_count(1),v||f.increment());const m=(h,p=void 0)=>{o=null,v||f.activate(),p?p!==es&&(a.f|=en,Fr(a,p)):((a.f&en)!==0&&(a.f^=en),Fr(a,h)),c&&(l.update_pending_count(-1),v||f.decrement()),za()};if(s.then(m,h=>m(null,h||"unknown")),f)return()=>{queueMicrotask(()=>f.neuter())}}),new Promise(d=>{function u(f){function v(){f===s?d(a):u(s)}f.then(v,v)}u(s)})}function g(n){const e=Yn(n);return Za(e),e}function ns(n){const e=Yn(n);return e.equals=Ca,e}function La(n){var e=n.effects;if(e!==null){n.effects=null;for(var r=0;r<e.length;r+=1)gr(e[r])}}function jc(n){for(var e=n.parent;e!==null;){if((e.f&Ut)===0)return e;e=e.parent}return null}function ls(n){var e,r=We;br(jc(n));try{La(n),e=no(n)}finally{br(r)}return e}function Na(n){var e=ls(n);if(n.equals(e)||(n.v=e,n.wv=to()),!sn)if(Ir!==null)Ir.set(n,n.v);else{var r=(Or||(n.f&$t)!==0)&&n.deps!==null?zr:It;qt(n,r)}}function Vc(n,e,r){const l=Mr()?Yn:ns;if(e.length===0){r(n.map(l));return}var s=et,a=We,o=Oc(),c=Ic();Promise.all(e.map(d=>Fc(d))).then(d=>{s==null||s.activate(),o();try{r([...n.map(l),...d])}catch(u){(a.f&$r)===0&&ts(u,a)}s==null||s.deactivate(),za()}).catch(d=>{c.error(d)})}function Oc(){var n=We,e=Ue,r=st;return function(){br(n),tr(e),Tn(r)}}function za(){br(null),tr(null),Tn(null)}const Wn=new Set;let et=null,yl=null,Ir=null,Ra=new Set,xl=[];function Ma(){const n=xl.shift();xl.length>0&&queueMicrotask(Ma),n()}let tn=[],kl=null,ss=!1,El=!1;const ql=class ql{constructor(){zt(this,ur);vr(this,"current",new Map);zt(this,Fn,new Map);zt(this,jn,new Set);zt(this,Hr,0);zt(this,al,null);zt(this,ol,!1);zt(this,wn,[]);zt(this,Vn,[]);zt(this,yn,[]);zt(this,Xr,[]);zt(this,On,[]);zt(this,il,[]);zt(this,cl,[]);vr(this,"skipped_effects",new Set)}process(e){var a;tn=[],yl=null;var r=null;if(Wn.size>1){r=new Map,Ir=new Map;for(const[o,c]of this.current)r.set(o,{v:o.v,wv:o.wv}),o.v=c;for(const o of Wn)if(o!==this)for(const[c,d]of Oe(o,Fn))r.has(c)||(r.set(c,{v:c.v,wv:c.wv}),c.v=d)}for(const o of e)Jr(this,ur,Hi).call(this,o);if(Oe(this,wn).length===0&&Oe(this,Hr)===0){Jr(this,ur,ma).call(this);var l=Oe(this,yn),s=Oe(this,Xr);Wt(this,yn,[]),Wt(this,Xr,[]),Wt(this,On,[]),yl=et,et=null,Fa(l),Fa(s),et===null?et=this:Wn.delete(this),(a=Oe(this,al))==null||a.resolve()}else Jr(this,ur,Ul).call(this,Oe(this,yn)),Jr(this,ur,Ul).call(this,Oe(this,Xr)),Jr(this,ur,Ul).call(this,Oe(this,On));if(r){for(const[o,{v:c,wv:d}]of r)o.wv<=d&&(o.v=c);Ir=null}for(const o of Oe(this,wn))Gn(o);for(const o of Oe(this,Vn))Gn(o);Wt(this,wn,[]),Wt(this,Vn,[])}capture(e,r){Oe(this,Fn).has(e)||Oe(this,Fn).set(e,r),this.current.set(e,e.v)}activate(){et=this}deactivate(){et=null,yl=null;for(const e of Ra)if(Ra.delete(e),e(),et!==null)break}neuter(){Wt(this,ol,!0)}flush(){tn.length>0?Ia():Jr(this,ur,ma).call(this),et===this&&(Oe(this,Hr)===0&&Wn.delete(this),this.deactivate())}increment(){Wt(this,Hr,Oe(this,Hr)+1)}decrement(){if(Wt(this,Hr,Oe(this,Hr)-1),Oe(this,Hr)===0){for(const e of Oe(this,il))qt(e,er),rn(e);for(const e of Oe(this,cl))qt(e,zr),rn(e);Wt(this,yn,[]),Wt(this,Xr,[]),this.flush()}else this.deactivate()}add_callback(e){Oe(this,jn).add(e)}settled(){return(Oe(this,al)??Wt(this,al,Zi())).promise}static ensure(){if(et===null){const e=et=new ql;Wn.add(et),El||ql.enqueue(()=>{et===e&&e.flush()})}return et}static enqueue(e){xl.length===0&&queueMicrotask(Ma),xl.unshift(e)}};Fn=new WeakMap,jn=new WeakMap,Hr=new WeakMap,al=new WeakMap,ol=new WeakMap,wn=new WeakMap,Vn=new WeakMap,yn=new WeakMap,Xr=new WeakMap,On=new WeakMap,il=new WeakMap,cl=new WeakMap,ur=new WeakSet,Hi=function(e){var f;e.f^=It;for(var r=e.first;r!==null;){var l=r.f,s=(l&(Er|Zr))!==0,a=s&&(l&It)!==0,o=a||(l&ar)!==0||this.skipped_effects.has(r);if(!o&&r.fn!==null){if(s)r.f^=It;else if((l&It)===0)if((l&Kl)!==0)Oe(this,Xr).push(r);else if((l&$l)!==0){var c=(f=r.b)!=null&&f.pending?Oe(this,Vn):Oe(this,wn);c.push(r)}else Al(r)&&((r.f&Sn)!==0&&Oe(this,On).push(r),Gn(r));var d=r.first;if(d!==null){r=d;continue}}var u=r.parent;for(r=r.next;r===null&&u!==null;)r=u.next,u=u.parent}},Ul=function(e){for(const r of e)((r.f&er)!==0?Oe(this,il):Oe(this,cl)).push(r),qt(r,It);e.length=0},ma=function(){if(!Oe(this,ol))for(const e of Oe(this,jn))e();Oe(this,jn).clear()};let Un=ql;function Bc(n){var e=El;El=!0;try{for(var r;;){if(Mc(),tn.length===0&&(et==null||et.flush(),tn.length===0))return kl=null,r;Ia()}}finally{El=e}}function Ia(){var n=Ln;ss=!0;try{var e=0;for(Ja(!0);tn.length>0;){var r=Un.ensure();if(e++>1e3){var l,s;qc()}r.process(tn),nn.clear()}}finally{ss=!1,Ja(n),kl=null}}function qc(){try{ac()}catch(n){ts(n,kl)}}function Fa(n){var e=n.length;if(e!==0){for(var r=0;r<e;){var l=n[r++];if((l.f&($r|ar))===0&&Al(l)){var s=et?et.current.size:0;if(Gn(l),l.deps===null&&l.first===null&&l.nodes_start===null&&(l.teardown===null&&l.ac===null?Xa(l):l.fn=null),et!==null&&et.current.size>s&&(l.f&Ql)!==0)break}}for(;r<e;)rn(n[r++])}}function rn(n){for(var e=kl=n;e.parent!==null;){e=e.parent;var r=e.f;if(ss&&e===We&&(r&Sn)!==0)return;if((r&(Zr|Er))!==0){if((r&It)===0)return;e.f^=It}}tn.push(e)}const nn=new Map;function ln(n,e){var r={f:0,v:n,reactions:null,equals:Ea,rv:0,wv:0};return r}function te(n,e){const r=ln(n);return Za(r),r}function as(n,e=!1,r=!0){var s;const l=ln(n);return e||(l.equals=Ca),An&&r&&st!==null&&st.l!==null&&((s=st.l).s??(s.s=[])).push(l),l}function F(n,e,r=!1){Ue!==null&&(!pr||(Ue.f&_a)!==0)&&Mr()&&(Ue.f&(Ut|Sn|$l|_a))!==0&&!(Vt!=null&&Vt.includes(n))&&uc();let l=r?Ne(e):e;return Fr(n,l)}function Fr(n,e){if(!n.equals(e)){var r=n.v;sn?nn.set(n,e):nn.set(n,r),n.v=e;var l=Un.ensure();l.capture(n,r),(n.f&Ut)!==0&&((n.f&er)!==0&&ls(n),qt(n,(n.f&$t)===0?It:zr)),n.wv=to(),ja(n,er),Mr()&&We!==null&&(We.f&It)!==0&&(We.f&(Er|Zr))===0&&(rr===null?Jc([n]):rr.push(n))}return e}function os(n){F(n,n.v+1)}function ja(n,e){var r=n.reactions;if(r!==null)for(var l=Mr(),s=r.length,a=0;a<s;a++){var o=r[a],c=o.f;if(!(!l&&o===We)){var d=(c&er)===0;d&&qt(o,e),(c&Ut)!==0?ja(o,zr):d&&rn(o)}}}function Ne(n){if(typeof n!="object"||n===null||Rr in n)return n;const e=vl(n);if(e!==ga&&e!==Ki)return n;var r=new Map,l=Qr(n),s=te(0),a=an,o=c=>{if(an===a)return c();var d=Ue,u=an;tr(null),eo(a);var f=c();return tr(d),eo(u),f};return l&&r.set("length",te(n.length)),new Proxy(n,{defineProperty(c,d,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&ic();var f=r.get(d);return f===void 0?f=o(()=>{var v=te(u.value);return r.set(d,v),v}):F(f,u.value,!0),!0},deleteProperty(c,d){var u=r.get(d);if(u===void 0){if(d in c){const f=o(()=>te(xt));r.set(d,f),os(s)}}else F(u,xt),os(s);return!0},get(c,d,u){var h;if(d===Rr)return n;var f=r.get(d),v=d in c;if(f===void 0&&(!v||(h=Nr(c,d))!=null&&h.writable)&&(f=o(()=>{var p=Ne(v?c[d]:xt),w=te(p);return w}),r.set(d,f)),f!==void 0){var m=t(f);return m===xt?void 0:m}return Reflect.get(c,d,u)},getOwnPropertyDescriptor(c,d){var u=Reflect.getOwnPropertyDescriptor(c,d);if(u&&"value"in u){var f=r.get(d);f&&(u.value=t(f))}else if(u===void 0){var v=r.get(d),m=v==null?void 0:v.v;if(v!==void 0&&m!==xt)return{enumerable:!0,configurable:!0,value:m,writable:!0}}return u},has(c,d){var m;if(d===Rr)return!0;var u=r.get(d),f=u!==void 0&&u.v!==xt||Reflect.has(c,d);if(u!==void 0||We!==null&&(!f||(m=Nr(c,d))!=null&&m.writable)){u===void 0&&(u=o(()=>{var h=f?Ne(c[d]):xt,p=te(h);return p}),r.set(d,u));var v=t(u);if(v===xt)return!1}return f},set(c,d,u,f){var y;var v=r.get(d),m=d in c;if(l&&d==="length")for(var h=u;h<v.v;h+=1){var p=r.get(h+"");p!==void 0?F(p,xt):h in c&&(p=o(()=>te(xt)),r.set(h+"",p))}if(v===void 0)(!m||(y=Nr(c,d))!=null&&y.writable)&&(v=o(()=>te(void 0)),F(v,Ne(u)),r.set(d,v));else{m=v.v!==xt;var w=o(()=>Ne(u));F(v,w)}var b=Reflect.getOwnPropertyDescriptor(c,d);if(b!=null&&b.set&&b.set.call(f,u),!m){if(l&&typeof d=="string"){var _=r.get("length"),S=Number(d);Number.isInteger(S)&&S>=_.v&&F(_,S+1)}os(s)}return!0},ownKeys(c){t(s);var d=Reflect.ownKeys(c).filter(v=>{var m=r.get(v);return m===void 0||m.v!==xt});for(var[u,f]of r)f.v!==xt&&!(u in c)&&d.push(u);return d},setPrototypeOf(){cc()}})}var is,Va,Oa,Ba;function Dc(){if(is===void 0){is=window,Va=/Firefox/.test(navigator.userAgent);var n=Element.prototype,e=Node.prototype,r=Text.prototype;Oa=Nr(e,"firstChild").get,Ba=Nr(e,"nextSibling").get,pa(n)&&(n.__click=void 0,n.__className=void 0,n.__attributes=null,n.__style=void 0,n.__e=void 0),pa(r)&&(r.__t=void 0)}}function jr(n=""){return document.createTextNode(n)}function Ht(n){return Oa.call(n)}function Sl(n){return Ba.call(n)}function Y(n,e){return Ht(n)}function X(n,e){{var r=Ht(n);return r instanceof Comment&&r.data===""?Sl(r):r}}function N(n,e=1,r=!1){let l=n;for(;e--;)l=Sl(l);return l}function Yc(n){n.textContent=""}function Cl(){return!1}function qa(n){We===null&&Ue===null&&sc(),Ue!==null&&(Ue.f&$t)!==0&&We===null&&lc(),sn&&nc()}function Wc(n,e){var r=e.last;r===null?e.last=e.first=n:(r.next=n,n.prev=r,e.last=n)}function mr(n,e,r,l=!0){var s=We;s!==null&&(s.f&ar)!==0&&(n|=ar);var a={ctx:st,deps:null,nodes_start:null,nodes_end:null,f:n|er,first:null,fn:e,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(r)try{Gn(a),a.f|=pl}catch(d){throw gr(a),d}else e!==null&&rn(a);var o=r&&a.deps===null&&a.first===null&&a.nodes_start===null&&a.teardown===null&&(a.f&Jl)===0;if(!o&&l&&(s!==null&&Wc(a,s),Ue!==null&&(Ue.f&Ut)!==0&&(n&Zr)===0)){var c=Ue;(c.effects??(c.effects=[])).push(a)}return a}function Uc(n){const e=mr(hl,null,!1);return qt(e,It),e.teardown=n,e}function ge(n){qa();var e=We.f,r=!Ue&&(e&Er)!==0&&(e&pl)===0;if(r){var l=st;(l.e??(l.e=[])).push(n)}else return Da(n)}function Da(n){return mr(Kl|Ql,n,!1)}function Hc(n){return qa(),mr(hl|Ql,n,!0)}function Xc(n){Un.ensure();const e=mr(Zr,n,!0);return(r={})=>new Promise(l=>{r.outro?Vr(e,()=>{gr(e),l(void 0)}):(gr(e),l(void 0))})}function cs(n){return mr(Kl,n,!1)}function Gc(n){return mr($l|Jl,n,!0)}function Ya(n,e=0){return mr(hl|e,n,!0)}function ne(n,e=[],r=[]){Vc(e,r,l=>{mr(hl,()=>n(...l.map(t)),!0)})}function Pn(n,e=0){var r=mr(Sn|e,n,!0);return r}function hr(n,e=!0){return mr(Er,n,!0,e)}function Wa(n){var e=n.teardown;if(e!==null){const r=sn,l=Ue;Qa(!0),tr(null);try{e.call(null)}finally{Qa(r),tr(l)}}}function Ua(n,e=!1){var s;var r=n.first;for(n.first=n.last=null;r!==null;){(s=r.ac)==null||s.abort(es);var l=r.next;(r.f&Zr)!==0?r.parent=null:gr(r,e),r=l}}function Kc(n){for(var e=n.first;e!==null;){var r=e.next;(e.f&Er)===0&&gr(e),e=r}}function gr(n,e=!0){var r=!1;(e||(n.f&$i)!==0)&&n.nodes_start!==null&&n.nodes_end!==null&&(Ha(n.nodes_start,n.nodes_end),r=!0),Ua(n,e&&!r),Tl(n,0),qt(n,$r);var l=n.transitions;if(l!==null)for(const a of l)a.stop();Wa(n);var s=n.parent;s!==null&&s.first!==null&&Xa(n),n.next=n.prev=n.teardown=n.ctx=n.deps=n.fn=n.nodes_start=n.nodes_end=n.ac=null}function Ha(n,e){for(;n!==null;){var r=n===e?null:Sl(n);n.remove(),n=r}}function Xa(n){var e=n.parent,r=n.prev,l=n.next;r!==null&&(r.next=l),l!==null&&(l.prev=r),e!==null&&(e.first===n&&(e.first=l),e.last===n&&(e.last=r))}function Vr(n,e){var r=[];us(n,r,!0),Ga(r,()=>{gr(n),e&&e()})}function Ga(n,e){var r=n.length;if(r>0){var l=()=>--r||e();for(var s of n)s.out(l)}else e()}function us(n,e,r){if((n.f&ar)===0){if(n.f^=ar,n.transitions!==null)for(const o of n.transitions)(o.is_global||r)&&e.push(o);for(var l=n.first;l!==null;){var s=l.next,a=(l.f&Cn)!==0||(l.f&Er)!==0;us(l,e,a?r:!1),l=s}}}function Hn(n){Ka(n,!0)}function Ka(n,e){if((n.f&ar)!==0){n.f^=ar,(n.f&It)===0&&(qt(n,er),rn(n));for(var r=n.first;r!==null;){var l=r.next,s=(r.f&Cn)!==0||(r.f&Er)!==0;Ka(r,s?e:!1),r=l}if(n.transitions!==null)for(const a of n.transitions)(a.is_global||e)&&a.in()}}let Ln=!1;function Ja(n){Ln=n}let sn=!1;function Qa(n){sn=n}let Ue=null,pr=!1;function tr(n){Ue=n}let We=null;function br(n){We=n}let Vt=null;function Za(n){Ue!==null&&(Vt===null?Vt=[n]:Vt.push(n))}let Ot=null,Xt=0,rr=null;function Jc(n){rr=n}let $a=1,Xn=0,an=Xn;function eo(n){an=n}let Or=!1;function to(){return++$a}function Al(n){var v;var e=n.f;if((e&er)!==0)return!0;if((e&zr)!==0){var r=n.deps,l=(e&$t)!==0;if(r!==null){var s,a,o=(e&gl)!==0,c=l&&We!==null&&!Or,d=r.length;if((o||c)&&(We===null||(We.f&$r)===0)){var u=n,f=u.parent;for(s=0;s<d;s++)a=r[s],(o||!((v=a==null?void 0:a.reactions)!=null&&v.includes(u)))&&(a.reactions??(a.reactions=[])).push(u);o&&(u.f^=gl),c&&f!==null&&(f.f&$t)===0&&(u.f^=$t)}for(s=0;s<d;s++)if(a=r[s],Al(a)&&Na(a),a.wv>n.wv)return!0}(!l||We!==null&&!Or)&&qt(n,It)}return!1}function ro(n,e,r=!0){var l=n.reactions;if(l!==null&&!(Vt!=null&&Vt.includes(n)))for(var s=0;s<l.length;s++){var a=l[s];(a.f&Ut)!==0?ro(a,e,!1):e===a&&(r?qt(a,er):(a.f&It)!==0&&qt(a,zr),rn(a))}}function no(n){var p;var e=Ot,r=Xt,l=rr,s=Ue,a=Or,o=Vt,c=st,d=pr,u=an,f=n.f;Ot=null,Xt=0,rr=null,Or=(f&$t)!==0&&(pr||!Ln||Ue===null),Ue=(f&(Er|Zr))===0?n:null,Vt=null,Tn(n.ctx),pr=!1,an=++Xn,n.ac!==null&&(n.ac.abort(es),n.ac=null);try{n.f|=Zl;var v=(0,n.fn)(),m=n.deps;if(Ot!==null){var h;if(Tl(n,Xt),m!==null&&Xt>0)for(m.length=Xt+Ot.length,h=0;h<Ot.length;h++)m[Xt+h]=Ot[h];else n.deps=m=Ot;if(!Or||(f&Ut)!==0&&n.reactions!==null)for(h=Xt;h<m.length;h++)((p=m[h]).reactions??(p.reactions=[])).push(n)}else m!==null&&Xt<m.length&&(Tl(n,Xt),m.length=Xt);if(Mr()&&rr!==null&&!pr&&m!==null&&(n.f&(Ut|zr|er))===0)for(h=0;h<rr.length;h++)ro(rr[h],n);return s!==null&&s!==n&&(Xn++,rr!==null&&(l===null?l=rr:l.push(...rr))),(n.f&en)!==0&&(n.f^=en),v}catch(w){return zc(w)}finally{n.f^=Zl,Ot=e,Xt=r,rr=l,Ue=s,Or=a,Vt=o,Tn(c),pr=d,an=u}}function Qc(n,e){let r=e.reactions;if(r!==null){var l=Gi.call(r,n);if(l!==-1){var s=r.length-1;s===0?r=e.reactions=null:(r[l]=r[s],r.pop())}}r===null&&(e.f&Ut)!==0&&(Ot===null||!Ot.includes(e))&&(qt(e,zr),(e.f&($t|gl))===0&&(e.f^=gl),La(e),Tl(e,0))}function Tl(n,e){var r=n.deps;if(r!==null)for(var l=e;l<r.length;l++)Qc(n,r[l])}function Gn(n){var e=n.f;if((e&$r)===0){qt(n,It);var r=We,l=Ln;We=n,Ln=!0;try{(e&Sn)!==0?Kc(n):Ua(n),Wa(n);var s=no(n);n.teardown=typeof s=="function"?s:null,n.wv=$a;var a;yt&&Sc&&(n.f&er)!==0&&n.deps}finally{Ln=l,We=r}}}function t(n){var e=n.f,r=(e&Ut)!==0;if(Ue!==null&&!pr){var l=We!==null&&(We.f&$r)!==0;if(!l&&!(Vt!=null&&Vt.includes(n))){var s=Ue.deps;if((Ue.f&Zl)!==0)n.rv<Xn&&(n.rv=Xn,Ot===null&&s!==null&&s[Xt]===n?Xt++:Ot===null?Ot=[n]:(!Or||!Ot.includes(n))&&Ot.push(n));else{(Ue.deps??(Ue.deps=[])).push(n);var a=n.reactions;a===null?n.reactions=[Ue]:a.includes(Ue)||a.push(Ue)}}}else if(r&&n.deps===null&&n.effects===null){var o=n,c=o.parent;c!==null&&(c.f&$t)===0&&(o.f^=$t)}if(sn){if(nn.has(n))return nn.get(n);if(r){o=n;var d=o.v;return((o.f&It)===0&&o.reactions!==null||lo(o))&&(d=ls(o)),nn.set(o,d),d}}else if(r){if(o=n,Ir!=null&&Ir.has(o))return Ir.get(o);Al(o)&&Na(o)}if((n.f&en)!==0)throw n.v;return n.v}function lo(n){if(n.v===xt)return!0;if(n.deps===null)return!1;for(const e of n.deps)if(nn.has(e)||(e.f&Ut)!==0&&lo(e))return!0;return!1}function _r(n){var e=pr;try{return pr=!0,n()}finally{pr=e}}const Zc=-7169;function qt(n,e){n.f=n.f&Zc|e}function $c(n){if(!(typeof n!="object"||!n||n instanceof EventTarget)){if(Rr in n)ds(n);else if(!Array.isArray(n))for(let e in n){const r=n[e];typeof r=="object"&&r&&Rr in r&&ds(r)}}}function ds(n,e=new Set){if(typeof n=="object"&&n!==null&&!(n instanceof EventTarget)&&!e.has(n)){e.add(n),n instanceof Date&&n.getTime();for(let l in n)try{ds(n[l],e)}catch{}const r=vl(n);if(r!==Object.prototype&&r!==Array.prototype&&r!==Map.prototype&&r!==Set.prototype&&r!==Date.prototype){const l=ha(r);for(let s in l){const a=l[s].get;if(a)try{a.call(n)}catch{}}}}}const eu=["touchstart","touchmove"];function tu(n){return eu.includes(n)}let so=!1;function ru(){so||(so=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{var e;if(!n.defaultPrevented)for(const r of n.target.elements)(e=r.__on_r)==null||e.call(r)})},{capture:!0}))}function Pl(n){var e=Ue,r=We;tr(null),br(null);try{return n()}finally{tr(e),br(r)}}function nu(n,e,r,l=r){n.addEventListener(e,()=>Pl(r));const s=n.__on_r;s?n.__on_r=()=>{s(),l(!0)}:n.__on_r=()=>l(!0),ru()}const ao=new Set,fs=new Set;function lu(n,e,r,l={}){function s(a){if(l.capture||Kn.call(e,a),!a.cancelBubble)return Pl(()=>r==null?void 0:r.call(this,a))}return n.startsWith("pointer")||n.startsWith("touch")||n==="wheel"?Dn(()=>{e.addEventListener(n,s,l)}):e.addEventListener(n,s,l),s}function on(n,e,r,l,s){var a={capture:l,passive:s},o=lu(n,e,r,a);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Uc(()=>{e.removeEventListener(n,o,a)})}function vt(n){for(var e=0;e<n.length;e++)ao.add(n[e]);for(var r of fs)r(n)}function Kn(n){var S;var e=this,r=e.ownerDocument,l=n.type,s=((S=n.composedPath)==null?void 0:S.call(n))||[],a=s[0]||n.target,o=0,c=n.__root;if(c){var d=s.indexOf(c);if(d!==-1&&(e===document||e===window)){n.__root=e;return}var u=s.indexOf(e);if(u===-1)return;d<=u&&(o=d)}if(a=s[o]||n.target,a!==e){Xl(n,"currentTarget",{configurable:!0,get(){return a||r}});var f=Ue,v=We;tr(null),br(null);try{for(var m,h=[];a!==null;){var p=a.assignedSlot||a.parentNode||a.host||null;try{var w=a["__"+l];if(w!=null&&(!a.disabled||n.target===a))if(Qr(w)){var[b,..._]=w;b.apply(a,[n,..._])}else w.call(a,n)}catch(y){m?h.push(y):m=y}if(n.cancelBubble||p===e||p===null)break;a=p}if(m){for(let y of h)queueMicrotask(()=>{throw y});throw m}}finally{n.__root=e,delete n.currentTarget,tr(f),br(v)}}}function vs(n){var e=document.createElement("template");return e.innerHTML=n.replaceAll("<!>","<!---->"),e.content}function cn(n,e){var r=We;r.nodes_start===null&&(r.nodes_start=n,r.nodes_end=e)}function H(n,e){var r=(e&ka)!==0,l=(e&yc)!==0,s,a=!n.startsWith("<!>");return()=>{s===void 0&&(s=vs(a?n:"<!>"+n),r||(s=Ht(s)));var o=l||Va?document.importNode(s,!0):s.cloneNode(!0);if(r){var c=Ht(o),d=o.lastChild;cn(c,d)}else cn(o,o);return o}}function su(n,e,r="svg"){var l=!n.startsWith("<!>"),s=(e&ka)!==0,a=`<${r}>${l?n:"<!>"+n}</${r}>`,o;return()=>{if(!o){var c=vs(a),d=Ht(c);if(s)for(o=document.createDocumentFragment();Ht(d);)o.appendChild(Ht(d));else o=Ht(d)}var u=o.cloneNode(!0);if(s){var f=Ht(u),v=u.lastChild;cn(f,v)}else cn(u,u);return u}}function xe(n,e){return su(n,e,"svg")}function au(n=""){{var e=jr(n+"");return cn(e,e),e}}function ce(){var n=document.createDocumentFragment(),e=document.createComment(""),r=jr();return n.append(e,r),cn(e,r),n}function E(n,e){n!==null&&n.before(e)}let ms=!0;function ke(n,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(n.__t??(n.__t=n.nodeValue))&&(n.__t=r,n.nodeValue=r+"")}function ou(n,e){return iu(n,e)}const Nn=new Map;function iu(n,{target:e,anchor:r,props:l={},events:s,context:a,intro:o=!0}){Dc();var c=new Set,d=v=>{for(var m=0;m<v.length;m++){var h=v[m];if(!c.has(h)){c.add(h);var p=tu(h);e.addEventListener(h,Kn,{passive:p});var w=Nn.get(h);w===void 0?(document.addEventListener(h,Kn,{passive:p}),Nn.set(h,1)):Nn.set(h,w+1)}}};d(Hl(ao)),fs.add(d);var u=void 0,f=Xc(()=>{var v=r??e.appendChild(jr());return hr(()=>{if(a){fe({});var m=st;m.c=a}s&&(l.$$events=s),ms=o,u=n(v,l)||{},ms=!0,a&&ve()}),()=>{var p;for(var m of c){e.removeEventListener(m,Kn);var h=Nn.get(m);--h===0?(document.removeEventListener(m,Kn),Nn.delete(m)):Nn.set(m,h)}fs.delete(d),v!==r&&((p=v.parentNode)==null||p.removeChild(v))}});return cu.set(u,f),u}let cu=new WeakMap;const hs=0,Ll=1,gs=2;function ps(n,e,r,l,s){var a=n,o=Mr(),c=st,d=xt,u,f,v,m=o?ln(void 0):as(void 0,!1,!1),h=o?ln(void 0):as(void 0,!1,!1),p=!1;function w(_,S){p=!0,S&&(br(b),tr(b),Tn(c));try{_===hs&&r&&(u?Hn(u):u=hr(()=>r(a))),_===gs&&s&&(v?Hn(v):v=hr(()=>s(a,h))),_!==hs&&u&&Vr(u,()=>u=null),_!==Ll&&f&&Vr(f,()=>f=null),_!==gs&&v&&Vr(v,()=>v=null)}finally{S&&(Tn(null),tr(null),br(null),Bc())}}var b=Pn(()=>{if(d!==(d=e())){if(Ji(d)){var _=d;p=!1,_.then(S=>{_===d&&(Fr(m,S),w(Ll,!0))},S=>{if(_===d&&(Fr(h,S),w(gs,!0),!s))throw h.v}),Dn(()=>{p||w(hs,!0)})}else Fr(m,d),w(Ll,!1);return()=>d=xt}})}function B(n,e,r=!1){var l=n,s=null,a=null,o=xt,c=r?Cn:0,d=!1;const u=(h,p=!0)=>{d=!0,m(p,h)};var f=null;function v(){f!==null&&(f.lastChild.remove(),l.before(f),f=null);var h=o?s:a,p=o?a:s;h&&Hn(h),p&&Vr(p,()=>{o?a=null:s=null})}const m=(h,p)=>{if(o!==(o=h)){var w=Cl(),b=l;if(w&&(f=document.createDocumentFragment(),f.append(b=jr())),o?s??(s=p&&hr(()=>p(b))):a??(a=p&&hr(()=>p(b))),w){var _=et,S=o?s:a,y=o?a:s;S&&_.skipped_effects.delete(S),y&&_.skipped_effects.add(y),_.add_callback(v)}else v()}};Pn(()=>{d=!1,e(u),d||m(null,null)},c)}function zn(n,e,r){var l=n,s=xt,a,o,c=null,d=Mr()?Ec:Sa;function u(){a&&Vr(a),c!==null&&(c.lastChild.remove(),l.before(c),c=null),a=o}Pn(()=>{if(d(s,s=e())){var f=l,v=Cl();v&&(c=document.createDocumentFragment(),c.append(f=jr())),o=hr(()=>r(f)),v?et.add_callback(u):u()}})}function qe(n,e){return e}function uu(n,e,r){for(var l=n.items,s=[],a=e.length,o=0;o<a;o++)us(e[o].e,s,!0);var c=a>0&&s.length===0&&r!==null;if(c){var d=r.parentNode;Yc(d),d.append(r),l.clear(),wr(n,e[0].prev,e[a-1].next)}Ga(s,()=>{for(var u=0;u<a;u++){var f=e[u];c||(l.delete(f.k),wr(n,f.prev,f.next)),gr(f.e,!c)}})}function Me(n,e,r,l,s,a=null){var o=n,c={flags:e,items:new Map,first:null},d=(e&xa)!==0;if(d){var u=n;o=u.appendChild(jr())}var f=null,v=!1,m=new Map,h=ns(()=>{var _=r();return Qr(_)?_:_==null?[]:Hl(_)}),p,w;function b(){du(w,p,c,m,o,s,e,l,r),a!==null&&(p.length===0?f?Hn(f):f=hr(()=>a(o)):f!==null&&Vr(f,()=>{f=null}))}Pn(()=>{w??(w=We),p=t(h);var _=p.length;if(!(v&&_===0)){v=_===0;var S,y,C,L;if(Cl()){var k=new Set,P=et;for(y=0;y<_;y+=1){C=p[y],L=l(C,y);var z=c.items.get(L)??m.get(L);z?(e&(bl|_l))!==0&&oo(z,C,y,e):(S=io(null,c,null,null,C,L,y,s,e,r,!0),m.set(L,S)),k.add(L)}for(const[j,R]of c.items)k.has(j)||P.skipped_effects.add(R.e);P.add_callback(b)}else b();t(h)}})}function du(n,e,r,l,s,a,o,c,d){var U,K,J,se;var u=(o&dc)!==0,f=(o&(bl|_l))!==0,v=e.length,m=r.items,h=r.first,p=h,w,b=null,_,S=[],y=[],C,L,k,P;if(u)for(P=0;P<v;P+=1)C=e[P],L=c(C,P),k=m.get(L),k!==void 0&&((U=k.a)==null||U.measure(),(_??(_=new Set)).add(k));for(P=0;P<v;P+=1){if(C=e[P],L=c(C,P),k=m.get(L),k===void 0){var z=l.get(L);if(z!==void 0){l.delete(L),m.set(L,z);var j=b?b.next:p;wr(r,b,z),wr(r,z,j),bs(z,j,s),b=z}else{var R=p?p.e.nodes_start:s;b=io(R,r,b,b===null?r.first:b.next,C,L,P,a,o,d)}m.set(L,b),S=[],y=[],p=b.next;continue}if(f&&oo(k,C,P,o),(k.e.f&ar)!==0&&(Hn(k.e),u&&((K=k.a)==null||K.unfix(),(_??(_=new Set)).delete(k))),k!==p){if(w!==void 0&&w.has(k)){if(S.length<y.length){var A=y[0],I;b=A.prev;var D=S[0],W=S[S.length-1];for(I=0;I<S.length;I+=1)bs(S[I],A,s);for(I=0;I<y.length;I+=1)w.delete(y[I]);wr(r,D.prev,W.next),wr(r,b,D),wr(r,W,A),p=A,b=W,P-=1,S=[],y=[]}else w.delete(k),bs(k,p,s),wr(r,k.prev,k.next),wr(r,k,b===null?r.first:b.next),wr(r,b,k),b=k;continue}for(S=[],y=[];p!==null&&p.k!==L;)(p.e.f&ar)===0&&(w??(w=new Set)).add(p),y.push(p),p=p.next;if(p===null)continue;k=p}S.push(k),b=k,p=k.next}if(p!==null||w!==void 0){for(var T=w===void 0?[]:Hl(w);p!==null;)(p.e.f&ar)===0&&T.push(p),p=p.next;var q=T.length;if(q>0){var Z=(o&xa)!==0&&v===0?s:null;if(u){for(P=0;P<q;P+=1)(J=T[P].a)==null||J.measure();for(P=0;P<q;P+=1)(se=T[P].a)==null||se.fix()}uu(r,T,Z)}}u&&Dn(()=>{var $;if(_!==void 0)for(k of _)($=k.a)==null||$.apply()}),n.first=r.first&&r.first.e,n.last=b&&b.e;for(var M of l.values())gr(M.e);l.clear()}function oo(n,e,r,l){(l&bl)!==0&&Fr(n.v,e),(l&_l)!==0?Fr(n.i,r):n.i=r}function io(n,e,r,l,s,a,o,c,d,u,f){var v=(d&bl)!==0,m=(d&fc)===0,h=v?m?as(s,!1,!1):ln(s):s,p=(d&_l)===0?o:ln(o),w={i:p,v:h,k:a,a:null,e:null,prev:r,next:l};try{if(n===null){var b=document.createDocumentFragment();b.append(n=jr())}return w.e=hr(()=>c(n,h,p,u),kc),w.e.prev=r&&r.e,w.e.next=l&&l.e,r===null?f||(e.first=w):(r.next=w,r.e.next=w.e),l!==null&&(l.prev=w,l.e.prev=w.e),w}finally{}}function bs(n,e,r){for(var l=n.next?n.next.e.nodes_start:r,s=e?e.e.nodes_start:r,a=n.e.nodes_start;a!==null&&a!==l;){var o=Sl(a);s.before(a),a=o}}function wr(n,e,r){e===null?n.first=r:(e.next=r,e.e.next=r&&r.e),r!==null&&(r.prev=e,r.e.prev=e&&e.e)}function Pt(n,e,r=!1,l=!1,s=!1){var a=n,o="";ne(()=>{var c=We;if(o!==(o=e()??"")&&(c.nodes_start!==null&&(Ha(c.nodes_start,c.nodes_end),c.nodes_start=c.nodes_end=null),o!=="")){var d=o+"";r?d=`<svg>${d}</svg>`:l&&(d=`<math>${d}</math>`);var u=vs(d);if((r||l)&&(u=Ht(u)),cn(Ht(u),u.lastChild),r||l)for(;Ht(u);)a.before(Ht(u));else a.before(u)}})}function Sr(n,e,...r){var l=n,s=Tt,a;Pn(()=>{s!==(s=e())&&(a&&(gr(a),a=null),a=hr(()=>s(l,...r)))},Cn)}function Jn(n,e,r){var l=n,s,a,o=null,c=null;function d(){a&&(Vr(a),a=null),o&&(o.lastChild.remove(),l.before(o),o=null),a=c,c=null}Pn(()=>{if(s!==(s=e())){var u=Cl();if(s){var f=l;u&&(o=document.createDocumentFragment(),o.append(f=jr())),c=hr(()=>r(f,s))}u?et.add_callback(d):d()}},Cn)}function co(n){var e,r,l="";if(typeof n=="string"||typeof n=="number")l+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(e=0;e<s;e++)n[e]&&(r=co(n[e]))&&(l&&(l+=" "),l+=r)}else for(r in n)n[r]&&(l&&(l+=" "),l+=r);return l}function fu(){for(var n,e,r=0,l="",s=arguments.length;r<s;r++)(n=arguments[r])&&(e=co(n))&&(l&&(l+=" "),l+=e);return l}function vu(n){return typeof n=="object"?fu(n):n??""}const uo=[...`
\r\f \v\uFEFF`];function mu(n,e,r){var l=n==null?"":""+n;if(e&&(l=l?l+" "+e:e),r){for(var s in r)if(r[s])l=l?l+" "+s:s;else if(l.length)for(var a=s.length,o=0;(o=l.indexOf(s,o))>=0;){var c=o+a;(o===0||uo.includes(l[o-1]))&&(c===l.length||uo.includes(l[c]))?l=(o===0?"":l.substring(0,o))+l.substring(c+1):o=c}}return l===""?null:l}function hu(n,e){return n==null?null:String(n)}function pt(n,e,r,l,s,a){var o=n.__className;if(o!==r||o===void 0){var c=mu(r,l,a);c==null?n.removeAttribute("class"):e?n.className=c:n.setAttribute("class",c),n.__className=r}else if(a&&s!==a)for(var d in a){var u=!!a[d];(s==null||u!==!!s[d])&&n.classList.toggle(d,u)}return a}function ht(n,e,r,l){var s=n.__style;if(s!==e){var a=hu(e);a==null?n.removeAttribute("style"):n.style.cssText=a,n.__style=e}return l}const gu=Symbol("is custom element"),pu=Symbol("is html");function O(n,e,r,l){var s=bu(n);s[e]!==(s[e]=r)&&(e==="loading"&&(n[ec]=r),r==null?n.removeAttribute(e):typeof r!="string"&&_u(n).includes(e)?n[e]=r:n.setAttribute(e,r))}function bu(n){return n.__attributes??(n.__attributes={[gu]:n.nodeName.includes("-"),[pu]:n.namespaceURI===xc})}var fo=new Map;function _u(n){var e=fo.get(n.nodeName);if(e)return e;fo.set(n.nodeName,e=[]);for(var r,l=n,s=Element.prototype;s!==l;){r=ha(l);for(var a in r)r[a].set&&e.push(a);l=vl(l)}return e}const wu=()=>performance.now(),Cr={tick:n=>requestAnimationFrame(n),now:()=>wu(),tasks:new Set};function vo(){const n=Cr.now();Cr.tasks.forEach(e=>{e.c(n)||(Cr.tasks.delete(e),e.f())}),Cr.tasks.size!==0&&Cr.tick(vo)}function yu(n){let e;return Cr.tasks.size===0&&Cr.tick(vo),{promise:new Promise(r=>{Cr.tasks.add(e={c:n,f:r})}),abort(){Cr.tasks.delete(e)}}}function Nl(n,e){Pl(()=>{n.dispatchEvent(new CustomEvent(e))})}function xu(n){if(n==="float")return"cssFloat";if(n==="offset")return"cssOffset";if(n.startsWith("--"))return n;const e=n.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(r=>r[0].toUpperCase()+r.slice(1)).join("")}function mo(n){const e={},r=n.split(";");for(const l of r){const[s,a]=l.split(":");if(!s||a===void 0)break;const o=xu(s.trim());e[o]=a.trim()}return e}const ku=n=>n;function ho(n,e,r,l){var s=(n&bc)!==0,a=(n&_c)!==0,o=s&&a,c=(n&wc)!==0,d=o?"both":s?"in":"out",u,f=e.inert,v=e.style.overflow,m,h;function p(){return Pl(()=>u??(u=r()(e,(l==null?void 0:l())??{},{direction:d})))}var w={is_global:c,in(){var y;if(e.inert=f,!s){h==null||h.abort(),(y=h==null?void 0:h.reset)==null||y.call(h);return}a||m==null||m.abort(),Nl(e,"introstart"),m=_s(e,p(),h,1,()=>{Nl(e,"introend"),m==null||m.abort(),m=u=void 0,e.style.overflow=v})},out(y){if(!a){y==null||y(),u=void 0;return}e.inert=!0,Nl(e,"outrostart"),h=_s(e,p(),m,0,()=>{Nl(e,"outroend"),y==null||y()})},stop:()=>{m==null||m.abort(),h==null||h.abort()}},b=We;if((b.transitions??(b.transitions=[])).push(w),s&&ms){var _=c;if(!_){for(var S=b.parent;S&&(S.f&Cn)!==0;)for(;(S=S.parent)&&(S.f&Sn)===0;);_=!S||(S.f&pl)!==0}_&&cs(()=>{_r(()=>w.in())})}}function _s(n,e,r,l,s){var a=l===1;if(En(e)){var o,c=!1;return Dn(()=>{if(!c){var b=e({direction:a?"in":"out"});o=_s(n,b,r,l,s)}}),{abort:()=>{c=!0,o==null||o.abort()},deactivate:()=>o.deactivate(),reset:()=>o.reset(),t:()=>o.t()}}if(r==null||r.deactivate(),!(e!=null&&e.duration))return s(),{abort:Tt,deactivate:Tt,reset:Tt,t:()=>l};const{delay:d=0,css:u,tick:f,easing:v=ku}=e;var m=[];if(a&&r===void 0&&(f&&f(0,1),u)){var h=mo(u(0,1));m.push(h,h)}var p=()=>1-l,w=n.animate(m,{duration:d,fill:"forwards"});return w.onfinish=()=>{w.cancel();var b=(r==null?void 0:r.t())??1-l;r==null||r.abort();var _=l-b,S=e.duration*Math.abs(_),y=[];if(S>0){var C=!1;if(u)for(var L=Math.ceil(S/16.666666666666668),k=0;k<=L;k+=1){var P=b+_*v(k/L),z=mo(u(P,1-P));y.push(z),C||(C=z.overflow==="hidden")}C&&(n.style.overflow="hidden"),p=()=>{var j=w.currentTime;return b+_*v(j/S)},f&&yu(()=>{if(w.playState!=="running")return!1;var j=p();return f(j,1-j),!0})}w=n.animate(y,{duration:S,fill:"forwards"}),w.onfinish=()=>{p=()=>l,f==null||f(l,1-l),s()}},{abort:()=>{w&&(w.cancel(),w.effect=null,w.onfinish=Tt)},deactivate:()=>{s=Tt},reset:()=>{l===0&&(f==null||f(1,0))},t:()=>p()}}function ws(n,e,r=e){var l=Mr(),s=new WeakSet;nu(n,"input",a=>{var o=a?n.defaultValue:n.value;if(o=ys(n)?xs(o):o,r(o),et!==null&&s.add(et),l&&o!==(o=e())){var c=n.selectionStart,d=n.selectionEnd;n.value=o??"",d!==null&&(n.selectionStart=c,n.selectionEnd=Math.min(d,n.value.length))}}),_r(e)==null&&n.value&&(r(ys(n)?xs(n.value):n.value),et!==null&&s.add(et)),Ya(()=>{var a=e();if(n===document.activeElement){var o=yl??et;if(s.has(o))return}ys(n)&&a===xs(n.value)||n.type==="date"&&!a&&!n.value||a!==n.value&&(n.value=a??"")})}function ys(n){var e=n.type;return e==="number"||e==="range"}function xs(n){return n===""?null:+n}const Yl=class Yl{constructor(e){zt(this,Dl);zt(this,Gr,new WeakMap);zt(this,Bn);zt(this,ul);Wt(this,ul,e)}observe(e,r){var l=Oe(this,Gr).get(e)||new Set;return l.add(r),Oe(this,Gr).set(e,l),Jr(this,Dl,Xi).call(this).observe(e,Oe(this,ul)),()=>{var s=Oe(this,Gr).get(e);s.delete(r),s.size===0&&(Oe(this,Gr).delete(e),Oe(this,Bn).unobserve(e))}}};Gr=new WeakMap,Bn=new WeakMap,ul=new WeakMap,Dl=new WeakSet,Xi=function(){return Oe(this,Bn)??Wt(this,Bn,new ResizeObserver(e=>{for(var r of e){Yl.entries.set(r.target,r);for(var l of Oe(this,Gr).get(r.target)||[])l(r)}}))},vr(Yl,"entries",new WeakMap);let ks=Yl;var Eu=new ks({box:"border-box"});function go(n,e,r){var l=Eu.observe(n,()=>r(n[e]));cs(()=>(_r(()=>r(n[e])),l))}function po(n,e){return n===e||(n==null?void 0:n[Rr])===e}function un(n={},e,r,l){return cs(()=>{var s,a;return Ya(()=>{s=a,a=[],_r(()=>{n!==r(...a)&&(e(n,...a),s&&po(r(...s),n)&&e(null,...s))})}),()=>{Dn(()=>{a&&po(r(...a),n)&&e(null,...a)})}}),n}function Su(n=!1){const e=st,r=e.l.u;if(!r)return;let l=()=>$c(e.s);if(n){let s=0,a={};const o=Yn(()=>{let c=!1;const d=e.s;for(const u in d)d[u]!==a[u]&&(a[u]=d[u],c=!0);return c&&s++,s});l=()=>t(o)}r.b.length&&Hc(()=>{bo(e,l),ml(r.b)}),ge(()=>{const s=_r(()=>r.m.map(Qi));return()=>{for(const a of s)typeof a=="function"&&a()}}),r.a.length&&ge(()=>{bo(e,l),ml(r.a)})}function bo(n,e){if(n.l.s)for(const r of n.l.s)t(r);e()}let zl=!1;function Cu(n){var e=zl;try{return zl=!1,[n(),zl]}finally{zl=e}}const Au={get(n,e){if(!n.exclude.includes(e))return n.props[e]},set(n,e){return!1},getOwnPropertyDescriptor(n,e){if(!n.exclude.includes(e)&&e in n.props)return{enumerable:!0,configurable:!0,value:n.props[e]}},has(n,e){return n.exclude.includes(e)?!1:e in n.props},ownKeys(n){return Reflect.ownKeys(n.props).filter(e=>!n.exclude.includes(e))}};function dn(n,e,r){return new Proxy({props:n,exclude:e},Au)}const Tu={get(n,e){let r=n.props.length;for(;r--;){let l=n.props[r];if(En(l)&&(l=l()),typeof l=="object"&&l!==null&&e in l)return l[e]}},set(n,e,r){let l=n.props.length;for(;l--;){let s=n.props[l];En(s)&&(s=s());const a=Nr(s,e);if(a&&a.set)return a.set(r),!0}return!1},getOwnPropertyDescriptor(n,e){let r=n.props.length;for(;r--;){let l=n.props[r];if(En(l)&&(l=l()),typeof l=="object"&&l!==null&&e in l){const s=Nr(l,e);return s&&!s.configurable&&(s.configurable=!0),s}}},has(n,e){if(e===Rr||e===wa)return!1;for(let r of n.props)if(En(r)&&(r=r()),r!=null&&e in r)return!0;return!1},ownKeys(n){const e=[];for(let r of n.props)if(En(r)&&(r=r()),!!r){for(const l in r)e.includes(l)||e.push(l);for(const l of Object.getOwnPropertySymbols(r))e.includes(l)||e.push(l)}return e}};function Br(...n){return new Proxy({props:n},Tu)}function V(n,e,r,l){var y;var s=!An||(r&mc)!==0,a=(r&gc)!==0,o=(r&pc)!==0,c=l,d=!0,u=()=>(d&&(d=!1,c=o?_r(l):l),c),f;if(a){var v=Rr in n||wa in n;f=((y=Nr(n,e))==null?void 0:y.set)??(v&&e in n?C=>n[e]=C:void 0)}var m,h=!1;a?[m,h]=Cu(()=>n[e]):m=n[e],m===void 0&&l!==void 0&&(m=u(),f&&(s&&oc(),f(m)));var p;if(s?p=()=>{var C=n[e];return C===void 0?u():(d=!0,C)}:p=()=>{var C=n[e];return C!==void 0&&(c=void 0),C===void 0?c:C},s&&(r&hc)===0)return p;if(f){var w=n.$$legacy;return function(C,L){return arguments.length>0?((!s||!L||w||h)&&f(L?p():C),C):p()}}var b=!1,_=((r&vc)!==0?Yn:ns)(()=>(b=!1,p()));a&&t(_);var S=We;return function(C,L){if(arguments.length>0){const k=L?t(_):s&&a?Ne(C):C;return F(_,k),b=!0,c!==void 0&&(c=k),C}return sn&&b||(S.f&$r)!==0?_.v:t(_)}}function Pu(n){st===null&&ya(),An&&st.l!==null?Lu(st).m.push(n):ge(()=>{const e=_r(n);if(typeof e=="function")return e})}function Lu(n){var e=n.l;return e.u??(e.u={a:[],b:[],m:[]})}const Nu="5";typeof window<"u"&&((Di=window.__svelte??(window.__svelte={})).v??(Di.v=new Set)).add(Nu),Cc();function _o(n,e){if(De(n))return _o(n.v,De(e)?e.v:e);const r=e.length;e[r-1]=e[r-1]*1.0001;let l=new Ie.valuesConstructor(r-1);for(let s=0;s<n.length;s++)for(let a=0;a<r-1;a++)n[s]>=e[a]&&n[s]<e[a+1]&&(l[a]+=1);return new Ie(l)}function wo(n){if(De(n))return wo(n.v);const e=new Ie.valuesConstructor(n.length-1);for(let r=0;r<e.length;r++)e[r]=.5*(n[r]+n[r+1]);return new Ie(e)}function Rl(n,e){De(n)&&Rl(n.v,e);const r=Tr(n);if(r[0]===r[1])throw new Error('split: values in a vector "x" should vary.');const l=(r[1]-r[0])/e;return Ie.seq(r[0],r[1],l)}function yo(n){if(De(n))return yo(n.v);const e=new Ie.valuesConstructor(n.length-1);for(let r=0;r<n.length-1;r++)e[r]=n[r+1]-n[r];return new Ie(e)}function zu(n){const e=n<10?.375:.5,r=new Ie.valuesConstructor(n);for(let l=0;l<n;l++)r[l]=(l+1-e)/(n+(1-e)-e);return new Ie(r)}function xo(n,e,r=!1,l=void 0,s=void 0){if(De(n))return xo(n.v,e.v,r,l,s);const a=n.length;if(e.length!==a)throw Error("Vectors 'x' and 'y' must have the same length.");if(a<2)throw Error("Vectors 'x' and 'y' must have at least two values.");l===void 0&&(l=fn(n)),s===void 0&&(s=fn(e));let o=0;for(let c=0;c<a;c++)o=o+(n[c]-l)*(e[c]-s);return o/(r?a:a-1)}function Ar(n,e){if(De(n))return Ar(n.v,e);e===void 0&&(e=.1);const r=Tr(n),l=(r[1]-r[0])*e;return[r[0]-l,r[1]+l]}function Tr(n){if(De(n))return Tr(n.v);let e=n[0],r=n[0];for(let l=1;l<n.length;l++)n[l]<e&&(e=n[l]),n[l]>r&&(r=n[l]);return[e,r]}function ko(n,e){return De(n)?ko(n.v,e):Math.sqrt(Es(n,e))}function Es(n,e){if(e===void 0&&(e=!1),De(n))return Es(n.v);const r=fn(n);let l=0;for(let s=0;s<n.length;s++){const a=n[s]-r;l=l+a*a}return l/(e?n.length:n.length-1)}function fn(n){return De(n)?fn(n.v):Eo(n)/n.length}function Eo(n){if(De(n))return Eo(n.v);let e=0;for(let r=0;r<n.length;r++)e=e+n[r];return e}function Ss(n){if(De(n))return Ss(n.v);let e=1;for(let r=0;r<n.length;r++)e=e*n[r];return e}function Gt(n){return De(n)||or(n)?n.v[Cs(n.v)-1]:n[Cs(n)-1]}function Cs(n){if(De(n)||or(n))return Cs(n.v);let e=1,r=n[0];for(let l=2;l<=n.length;l++)n[l-1]<r&&(e=l,r=n[l-1]);return e}function nr(n){return De(n)||or(n)?n.v[As(n.v)-1]:n[As(n)-1]}function As(n){if(De(n)||or(n))return As(n.v);let e=1,r=n[0];for(let l=2;l<=n.length;l++)n[l-1]>r&&(e=l,r=n[l-1]);return e}const Ts=30,Ru=1e-7,Mu=1e-7,Iu=100;function Fu(n,e,r,l,s){s===void 0&&(s=Iu);let a=r,o=l,c=(o-a)/s;for(let d=0;d<s;d++){let u,f;for(let h=0;h<s;h++){u=a+h*c,f=a+(h+1)*c;const p=e(u),w=e(f);if(p<=n&&w>=n)break}const v=(u+f)/2,m=e(v);if(Math.abs(m-n)<Ru||(a=u,o=f,c=(o-a)/s,c/o<Mu))return v}return(a+o)/2}function So(n,e=0,r=1){let l=Ie.zeros(n);for(let s=0;s<n;s++)l.v[s]=e+Math.random()*(r-e);return l}function Co(n,e=0,r=1){let l=Ie.zeros(n);for(let s=0;s<n;s++){const a=Math.sqrt(-2*Math.log(Math.random())),o=2*Math.PI*Math.random();l.v[s]=a*Math.sin(o)*r+e}return l}function Ao(n,e=0,r=1){if(De(n))return n.apply(s=>Ao(s,e,r));const l=1/(Math.sqrt(2)*r);return .5*(1+Vu((n-e)*l))}function Ml(n,e=0,r=1){if(De(n))return n.apply(D=>Ml(D,e,r));if(e!==0||r!==1)return Ml(n)*r+e;if(n<0||n>1)throw Error('Parameter "p" must be between 0 and 1.');if(n<1e-10)return-1/0;if(n>.9999999999)return 1/0;const l=.425,s=5,a=.180625,o=1.6,c=3.3871327179,d=5.0434271938*10,u=1.5929113202*100,f=5.910937472*10,v=1.7895169469*10,m=7.8757757664*10,h=6.71875636*10,p=1.4234372777,w=2.75681539,b=1.3067284816,_=1.7023821103*.1,S=7.370016425*.1,y=1.2021132975*.1,C=6.657905115,L=3.081226386,k=4.2868294337*.1,P=1.7337203997*.01,z=2.4197894225*.1,j=1.2258202635*.01,R=n-.5;let A;if(Math.abs(R)<=l)return A=a-R*R,R*(((f*A+u)*A+d)*A+c)/(((h*A+m)*A+v)*A+1);A=R<0?n:1-n,A=Math.sqrt(-Math.log(A));let I;return A<=s?(A=A-o,I=(((_*A+b)*A+w)*A+p)/((y*A+S)*A+1)):(A=A-s,I=((P*A+k)*A+L+C)/((j*A+z)*A+1)),R<0?-I:I}function To(n,e){if(Array.isArray(n))return To(Ge(n),e);const r=5/6-1/(9*e)-7/(648*e*e)+25/(2187*e*e*e),l=1/(18*e)+1/(162*e*e)-37/(1164*e*e*e),s=Math.sqrt(l);function a(d){if(d===0)return 0;if(e===0||e>100&&d>e*2||e>50&&d>e*3||e>10&&d>e*5||e>5&&d>e*8||d>e*30)return 1;const u=d/e,f=Math.pow(u,1/6)-.5*Math.pow(u,1/3)+1/3*Math.pow(u,1/2);return Ao(f,r,s)}function o(d){return d===0?0:e===0||e>100&&d>e*2||e>50&&d>e*3||e>10&&d>e*5||e>5&&d>e*8||d>e*30?1:ju(d/2,e/2)/Qn(e/2)}const c=e>Ts?a:o;return De(n)?n.apply(c):c(n)}function Po(n,e){if(Array.isArray(n))return Po(Ge(n),e);const r=5/6-1/(9*e)-7/(648*e*e)+25/(2187*e*e*e),l=1/(18*e)+1/(162*e*e)-37/(1164*e*e*e),s=Math.sqrt(l);function a(d){if(d===0)return 0;if(d===1)return Inf;if(e===0)return 0;const u=Ml(d,r,s),f=Math.pow(Math.sqrt(36*u*u-30*u+13)/4+(3*u-3/2)/2+1/8,1/3);return Math.pow(f-3/(4*f)+.5,6)*e}function o(d){return d===0?0:d===1?Inf:e===0?0:Fu(d,f=>To(f,e),0,Ts*10)}const c=e>Ts?a:o;return De(n)?n.apply(c):c(n)}function Qn(n){if(De(n))return n.apply(Qn);if(n<=0)throw new Error("gamma: the function only works with arguments > 0.");const e=[676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23];if(n<.5)return Math.PI/(Math.sin(Math.PI*n)+Qn(1-n));n=n-1;let r=.9999999999998099;for(let s=0;s<e.length;s++)r=r+e[s]/(n+s+1);const l=n+e.length-.5;return Math.sqrt(2*Math.PI)*Math.pow(l,n+.5)*Math.exp(-l)*r}function ju(n,e){let s=0;for(let a=0;a<1e4;a++){const o=Math.pow(n,a)/Qn(e+a+1);if(isNaN(o)||o<1e-18)break;s+=o}return Math.pow(n,e)*Qn(e)*Math.exp(-n)*s}function Vu(n){const e=n>=0?1:-1;n=Math.abs(n);const r=.254829592,l=-.284496736,s=1.421413741,a=-1.453152027,o=1.061405429,d=1/(1+.3275911*n),u=1-((((o*d+a)*d+s)*d+l)*d+r)*d*Math.exp(-n*n);return e*u}function Lo(n){const e=n.nrows,r=n.ncols;if(e<r){const o=Lo(n.subset([],bt.seq(1,e)));return{Q:o.Q,R:Bu(o.Q,n)}}let l=it.eye(e),s=n.t();for(let o=1;o<=r;o++)for(let c=e;c>=o+1;c--){const d=s.v.subarray((c-2)*r,c*r),u=l.v.subarray((c-2)*e,c*e),f=d.slice(),v=u.slice(),[m,h,p]=Ou(f[o-1],f[o-1+r]);for(let w=0;w<r;w++)d[w]=f[w]*m+f[w+r]*h,d[w+r]=f[w]*-h+f[w+r]*m,u[w]=v[w]*m+v[w+e]*h,u[w+e]=v[w]*-h+v[w+e]*m;for(let w=r;w<e;w++)u[w]=v[w]*m+v[w+e]*h,u[w+e]=v[w]*-h+v[w+e]*m}const a=bt.seq(1,r);return{Q:e===r?l:l.subset([],a),R:e===r?s.t():s.subset([],a).t()}}function Ou(n,e){if(n==0)return[0,1,e];if(Math.abs(n)>Math.abs(e)){const a=e/n,o=Math.sqrt(1+a*a),c=1/o;return[c,a*c,n*o]}const r=n/e,l=Math.sqrt(1+r*r),s=1/l;return[r*s,s,e*l]}function No(n){return typeof n=="number"}function zo(n,e){e===void 0&&(e=n);const r=n.nrows,l=n.ncols,s=e.nrows;e.ncols;const a=r,o=s,c=l,d=new Float64Array(a*o);for(let u=0;u<c;u++){const f=n.v.subarray(u*r,(u+1)*r),v=e.v.subarray(u*s,(u+1)*s);for(let m=0;m<o;m++){const h=d.subarray(m*a,(m+1)*a);for(let p=0;p<a;p++)h[p]+=f[p]*v[m]}}return new it(d,a,o)}function Bu(n,e){if(e===void 0&&(e=n),!lr(n)||!lr(e))throw Error("crossprod: both X and Y must be instance of Matrix class.");const r=n.nrows,l=n.ncols,s=e.nrows,a=e.ncols,o=l,c=a,d=r,u=new Float64Array(o*c);for(let f=0;f<c;f++){const v=e.v.subarray(f*s,(f+1)*s),m=u.subarray(f*o,(f+1)*o);for(let h=0;h<o;h++){const p=n.v.subarray(h*r,(h+1)*r);let w=0;for(let b=0;b<d;b++)w+=p[b]*v[b];m[h]=w}}return new it(u,o,c)}function Ro(n,e,r){if(r===void 0){if(e!==n.v.length)throw Error("reshape: provided dimension does not match number of values in the object.");return new Ie(n.v)}if(n.v.length!==e*r)throw Error("reshape: provided dimension does not match number of values in the object.");return new it(n.v,e,r)}function lr(n){return n&&n.constructor===it}function qu(n,e,r){return new it(new Float64Array(n),e,r)}const Fe=class Fe{constructor(e,r,l){if(!ArrayBuffer.isView(e)||e.constructor!==Fe.valuesConstructor)throw Error('Matrix: parameter "values" must be Float64Array.');if(r===0||l===0)throw Error("Matrix: can not create matrix with zero rows or columns.");if(e.length!==r*l)throw Error('Matrix: number elements in "values" is not equal to "nrows" x "ncols".');this.v=e,this.nrows=r,this.ncols=l}inv(){if(this.nrows!==this.ncols)throw Error("inv: only squared matrices can be inverted.");const e=this.ncols;if(this.isuppertriangular()){if(this.islowertriangular())return Fe.diagm(this.diag().apply(d=>Math.abs(d)>Number.EPSILON?1/d:x));const l=Fe.eye(e),s=Fe.eye(e),a=this.t(),o=a.v[(e-1)*e+(e-1)],c=e-1;for(let d=0;d<e;d++)s.v[c*e+d]=l.v[c*e+d]/o;for(let d=e-2;d>=0;d--){let u=l.getcolumn(d+1);const f=a.getcolref(d+1);for(let v=d+1;v<e;v++){const m=s.getcolumn(v+1);u=u.subtract(m.mult(f[v]))}s.v.set(u.divide(f[d]).v,d*e)}return s.t()}if(this.islowertriangular()){const l=this.diag();if(Ss(l)<Number.EPSILON)throw Error("inv: the matrix is not invertible.");const s=Fe.eye(e),a=Fe.eye(e),o=this.t(),c=0,d=o.v[0];for(let u=0;u<e;u++)a.v[c*e+u]=s.v[c*e+u]/d;for(let u=1;u<e;u++){let f=s.getcolumn(u+1);const v=o.getcolref(u+1);for(let m=0;m<u;m++){const h=a.getcolumn(m+1);f=f.subtract(h.mult(v[m]))}a.v.set(f.divide(v[u]).v,u*e)}return a.t()}const r=Lo(this);if(!r.R.isuppertriangular())throw Error("inv: QR decomposition of the matrix returned incorrect result.");return r.R.inv().dot(r.Q.t())}islowertriangular(){if(this.nrows!==this.ncols)return!1;for(let e=1;e<this.ncols;e++)for(let r=0;r<e;r++)if(Math.abs(this.v[e*this.nrows+r])>Fe.TOLERANCE)return!1;return!0}isuppertriangular(){if(this.nrows!==this.ncols)return!1;for(let e=0;e<this.ncols;e++)for(let r=e+1;r<this.nrows;r++)if(Math.abs(this.v[e*this.nrows+r])>Fe.TOLERANCE)return!1;return!0}diag(){const e=Math.min(this.nrows,this.ncols),r=new Float64Array(e);for(let l=0;l<e;l++)r[l]=this.getcolref(l+1)[l];return new Ie(r)}t(){const e=this.nrows,r=this.ncols,l=new Fe.valuesConstructor(this.v.length);if(this.ncols<this.nrows){for(let s=0;s<this.ncols;s++){const a=this.v.subarray(s*this.nrows,(s+1)*this.nrows);for(let o=0;o<this.nrows;o++)l[o*r+s]=a[o]}return new Fe(l,r,e)}for(let s=0;s<this.nrows;s++){const a=l.subarray(s*r,(s+1)*r);for(let o=0;o<this.ncols;o++)a[o]=this.v[o*this.nrows+s]}return new Fe(l,r,e)}dot(e){if(De(e))return new Fe(Ns(this.v,e.v,this.nrows,this.ncols,e.length,1),this.nrows,1);if(lr(e))return new Fe(Ns(this.v,e.v,this.nrows,this.ncols,e.nrows,e.ncols),this.nrows,e.ncols);throw Error("dot: argument 'X' must be a matrix or a vector.")}op(e,r,l){if(lr(e))return new Fe(Ps(this.v,e.v,r),this.nrows,this.ncols);if(No(e))return new Fe(Ls(this.v,e,r),this.nrows,this.ncols);if(!De(e))throw new Error('op: argument "x" must be a matrix, a vector or a number.');if(l===void 0&&(l=e.length===this.ncols?2:1),l===2&&e.length===this.ncols){const s=new Fe.valuesConstructor(this.v.length);for(let a=0;a<this.ncols;a++)s.set(Ls(this.getcolref(a+1),e.v[a],r),a*this.nrows);return new Fe(s,this.nrows,this.ncols)}if(l===1&&e.length===this.nrows){const s=new Fe.valuesConstructor(this.v.length);for(let a=0;a<this.ncols;a++)s.set(Ps(this.getcolref(a+1),e.v,r),a*this.nrows);return new Fe(s,this.nrows,this.ncols)}throw new Error('op: length of vector "X" does not match number of rows nor number of columns of the maytrix.')}add(e){return this.op(e,(r,l)=>r+l)}subtract(e){return this.op(e,(r,l)=>r-l)}mult(e){return this.op(e,(r,l)=>r*l)}divide(e){return this.op(e,(r,l)=>r/l)}apply(e,r){if(r===void 0&&(r=2),r==2){const l=this.ncols,s=new Fe.valuesConstructor(l);for(let a=0;a<l;a++)s[a]=e(this.getcolref(a+1));return new Ie(s)}if(r==1)return this.t().apply(e,2);if(r==0){const l=this.v.length,s=new Fe.valuesConstructor(l);for(let a=0;a<l;a++)s[a]=e(this.v[a]);return new Fe(s,this.nrows,this.ncols)}}replace(e,r,l){typeof r=="number"&&(r=[r]),r.length===0&&(r=bt.seq(1,this.nrows)),or(r)||(r=ir(r)),typeof l=="number"&&(l=[l]),l.length===0&&(l=bt.seq(1,this.ncols)),or(l)||(l=ir(l));const s=r.length,a=l.length;if(Gt(r)<1||nr(r)>this.nrows)throw Error("Matrix.replace: row indices do not match the dimension of matrix.");if(Gt(l)<1||nr(l)>this.ncols)throw Error("Matrix.replace: column indices do not match the dimension of matrix.");if(e.nrows!==s||e.ncols!==a)throw Error('Matrix.replace: dimension of "X" does not match the indices.');for(let o=0;o<l.length;o++){const c=e.getcolref(o+1),d=(l.v[o]-1)*this.nrows;for(let u=0;u<r.length;u++){const f=r.v[u];this.v[d+f-1]=c[u]}}return this}copy(){return new Fe(this.v.slice(),this.nrows,this.ncols)}getrow(e){if(e<1||e>this.nrows)throw Error("getrow: wrong row index.");const r=new Ie.valuesConstructor(this.ncols);for(let l=0;l<this.ncols;l++)r[l]=this.getcolref(l+1)[e-1];return new Ie(r)}getcolumn(e){if(e<1||e>this.ncols)throw Error("getcolumn: wrong column index.");return new Ie(this.v.slice((e-1)*this.nrows,e*this.nrows))}getcolref(e){return this.v.subarray((e-1)*this.nrows,e*this.nrows)}subset(e,r){if(typeof e=="number"&&(e=ir([e])),typeof r=="number"&&(r=ir([r])),Array.isArray(e)&&(e=e.length===0?null:ir(e)),Array.isArray(r)&&(r=r.length===0?null:ir(r)),e!==null&&!or(e))throw Error('subset: parameter "rind" can be a number, null or instance of Index.');if(r!==null&&!or(r))throw Error('subset: parameter "cind" can be a number, null or instance of Index.');if(e!==null&&(Gt(e)<1||nr(e)>this.nrows))throw Error('subset: parameter "rind" does not match size of the matrix.');if(r!==null&&(Gt(r)<1||nr(r)>this.ncols))throw Error('subset: parameter "cind" does not match size of the matrix.');if(e===null){const c=r.length,d=this.nrows,u=new Fe.valuesConstructor(d*c);for(let f=0;f<r.length;f++)u.set(this.v.slice((r.v[f]-1)*this.nrows,r.v[f]*this.nrows),f*this.nrows);return new Fe(u,d,c)}if(r==null)return this.t().subset(r,e).t();const l=e.length,s=r.length,a=new Fe.valuesConstructor(l*s);let o=new Fe.valuesConstructor(l);for(let c=0;c<s;c++){const d=this.v.subarray((r.v[c]-1)*this.nrows,r.v[c]*this.nrows);for(let u=0;u<l;u++)o[u]=d[e.v[u]-1];a.set(o,c*l)}return new Fe(a,l,s)}toString(e){function r(o,c){return" ".repeat(c-o.length)+o}e===void 0&&(e=2),this.ncols;const l=Math.round(Math.abs(Math.log10(nr(this.v))))+e+3;let s="";const a=this.t();for(let o=1;o<=a.ncols;o++)s+=Array.from(a.getcolref(o)).map(c=>r(c.toFixed(e),l)).join(" ")+`
`;return s}toCSV(e,r,l,s){e===void 0&&(e=","),r===void 0&&(r=e===";"?",":".");const a=s!=null&&s.length>0,o=l!=null&&l.length>0;if(a&&s.length!==this.nrows)throw Error("Matrix.toCSV: number of elements in labels array must match number of rows in the matrix.");if(o&&l.length!==this.ncols+(a?1:0))throw Error("Matrix.toCSV: number of elements in header must match number of columns in the matrix.");const c=this.t();let d=o?l.join(e)+`
`:"";for(let u=1;u<=c.ncols;u++)d=d+(a?s[u-1]+e:"")+c.getcolref(u).join(e)+`
`;return d=d.replace(/\./g,r),d}static randn(e,r,l,s){return Ro(Co(e*r,l,s),e,r)}static rand(e,r,l,s){return Ro(So(e*r,l,s),e,r)}static eye(e,r){r===void 0&&(r=e);const l=new Float64Array(e*r);for(let s=0;s<Math.min(e,r);s++)l[s*e+s]=1;return new Fe(l,e,r)}static diagm(e){if(!De(e))throw Error('diagm: the argument "x" must be a Vector.');const r=e.length,l=new Float64Array(r*r);for(let s=0;s<r;s++)l[s*r+s]=e.v[s];return new Fe(l,r,r)}static zeros(e,r){return r===void 0&&(r=e),new Fe(new Float64Array(e*r),e,r)}static ones(e,r){return Fe.fill(1,e,r)}static fill(e,r,l){l===void 0&&(l=r);const s=new Float64Array(r*l);for(let a=0;a<s.length;a++)s[a]=e;return new Fe(s,r,l)}static outer(e,r,l){if(Array.isArray(e)&&(e=Ge(e)),Array.isArray(r)&&(r=Ge(r)),!De(e))throw Error('Matrix.outer: parameter "x" must be a vector or an array with numbers.');if(!De(r))throw Error('Matrix.outer: parameter "y" must be a vector or an array with numbers.');const s=Fe.zeros(e.length,r.length);for(let a=0;a<r.length;a++){const o=r.v[a],c=s.getcolref(a+1);for(let d=0;d<e.length;d++)c[d]=l(e.v[d],o)}return s}static parseCSV(e,r,l,s){function a(b){return b.some(_=>Number.isNaN(Number.parseFloat(_.trim())))}r===void 0&&(r=",");const o=r===";"?",":".";e=e.replace(/^\uFEFF/gm,"").replace(/^\u00EF?\u00BB\u00BF/gm,""),e=e.replace(/\r/gm,"");let c=e.split(/\n/),d=[],u=0;const f=c[0].split(r);(l||l===void 0&&a(f))&&(d=f,u=1),c=c.filter(b=>b.trim().length>1);let v=[],m=0;s&&(m=1);const h=c.length-u,p=f.length-m;if(h<1)throw Error("Data file should contain at least 1 row with values.");if(p<1)throw Error("Data file should contain at least 1 column with values.");const w=Fe.zeros(p,h);for(let b=u;b<h+u;b++){const _=c[b].split(r);let S;if(s?(v[b-u]=_[0],S=_.slice(1).map(y=>Number.parseFloat(y.trim().replace(o,".")))):S=_.map(y=>Number.parseFloat(y.trim().replace(o,"."))),S.some(y=>Number.isNaN(y)))throw Error("Some of the values can not be converted to numbers, check your CSV file and try again.");if(S.length!=p)throw Error("Wrong number of values in row #"+b);w.v.set(new Float64Array(S),(b-u)*p)}return{values:w.t(),header:d,labels:v,sep:r,dec:o}}};vr(Fe,"valuesConstructor",Float64Array),vr(Fe,"TOLERANCE",Math.pow(10,-9));let it=Fe;function De(n){return n&&n.constructor===Ie}function Ge(n){return new Ie(new Float64Array(n))}const gt=class gt{constructor(e){if(!ArrayBuffer.isView(e)||e.constructor!==Float64Array)throw Error('Vector: parameter "values" must be Float64Array.');this.v=e,this.length=e.length}which(e){const r=new bt.valuesConstructor(this.length);let l=0;for(let s=0;s<this.length;s++)e(this.v[s],s)&&(r[l]=s+1,l=l+1);return new bt(r.subarray(0,l))}filter(e){const r=new gt.valuesConstructor(this.length);let l=0;for(let s=0;s<this.length;s++)e(this.v[s],s)&&(r[l]=this.v[s],l=l+1);return new gt(r.subarray(0,l))}shuffle(){return new gt(jo(this.v))}sort(e){return new gt(Vo(this.v,e))}sortind(e){return new bt(Oo(this.v,e))}rep(e){return Io(this,e)}repeach(e){return Fo(this,e)}replace(e,r){typeof r=="number"&&(r=[r]),r.length===0&&(r=bt.seq(1,this.length)),or(r)||(r=ir(r));const l=r.length;if(Gt(r)<1||nr(r)>this.length)throw Error("Vector.replace: indices do not match the lenght of the vector.");if(e.length!==l)throw Error('Vector.replace: length of "x" does not match the indices.');for(let s=0;s<r.length;s++){const a=r.v[s];this.v[a-1]=e.v[s]}return this}subset(e){if(typeof e=="number"&&(e=ir([e])),Array.isArray(e)&&(e=typeof e[0]=="boolean"?bt.bool2ind(e):ir(e)),!or(e))throw Error('subset: parameter "ind" must be number, array of instance of class Index.');const r=e.length,l=gt.zeros(r);for(let s=0;s<r;s++){if(e.v[s]<1)throw Error("subset: indices must start with 1 (not 0).");if(e.v[s]>this.length)throw Error("subset: index exceeds the length of the vector.");l.v[s]=this.v[e.v[s]-1]}return l}slice(e,r){if(e===null&&(e=1),r==null&&(r=this.length),e<1)throw Error("slice: indices must start with 1 (not 0).");if(r>this.length)throw Error("slice: index exceeds the length of the vector.");if(r<e)throw Error('slice: "end" must not be smaller than "start".');return new gt(this.v.slice(e-1,r))}copy(){return new gt(this.v.slice())}dot(e){return e===void 0&&(e=this),Ns(this.v,e.v,1,this.length,e.length,1)[0]}op(e,r){if(De(e))return new gt(Ps(this.v,e.v,r));if(No(e))return new gt(Ls(this.v,e,r));throw new Error('op: argument "x" must be a vector or a number.')}add(e){return this.op(e,(r,l)=>r+l)}subtract(e){return this.op(e,(r,l)=>r-l)}mult(e){return this.op(e,(r,l)=>r*l)}divide(e){return this.op(e,(r,l)=>r/l)}apply(e){const r=this.v.length,l=gt.zeros(r);for(let s=0;s<r;s++)l.v[s]=e(this.v[s]);return l}static c(...e){if(e.length===1)return e[0];const r=e.reduce((a,o)=>a+(typeof o=="number"?1:o.length),0),l=new gt.valuesConstructor(r);let s=0;for(const a of e)typeof a=="number"?(l[s]=a,s+=1):(l.set(De(a)?a.v:new gt.valuesConstructor(a),s),s+=typeof a=="number"?1:a.length);return new gt(l)}static seq(e,r,l){return Mo(e,r,l,gt)}static randn(e,r,l){return Co(e,r,l)}static rand(e,r,l){return So(e,r,l)}static zeros(e){return new gt(new gt.valuesConstructor(e))}static ones(e){return gt.fill(1,e)}static fill(e,r){const l=new gt.valuesConstructor(r);for(let s=0;s<l.length;s++)l[s]=e;return new gt(l)}};vr(gt,"valuesConstructor",Float64Array);let Ie=gt;function or(n){return n.constructor===bt}function ir(n){return new bt(new Int32Array(n))}const At=class At{constructor(e){if(!ArrayBuffer.isView(e)||e.constructor!==Int32Array)throw Error('Index: parameter "values" must be Int32Array.');this.v=e,this.length=e.length}which(e){const r=new At.valuesConstructor(this.length);let l=0;for(let s=0;s<this.length;s++)e(this.v[s],s)&&(r[l]=s+1,l=l+1);return new At(r.subarray(0,l))}filter(e){const r=new At.valuesConstructor(this.length);let l=0;for(let s=0;s<this.length;s++)e(this.v[s],s)&&(r[l]=this.v[s],l=l+1);return new At(r.subarray(0,l))}shuffle(){return new At(jo(this.v))}sort(e){return new At(Vo(this.v,e))}sortind(e){return new At(Oo(this.v,e))}rep(e){return Io(this,e)}repeach(e){return Fo(this,e)}subset(e){if(typeof e=="number"&&(e=ir([e])),Array.isArray(e)&&(e=ir(e)),!or(e))throw Error('subset: parameter "ind" must be number, array of instance of class Index.');const r=e.length,l=new At.valuesConstructor(r);for(let s=0;s<r;s++){if(e.v[s]<1)throw Error("subset: indices must start with 1 (not 0).");if(e.v[s]>this.length)throw Error("subset: index exceeds the length of the vector.");l[s]=this.v[e.v[s]-1]}return new At(l)}slice(e,r){if(e===null&&(e=1),r==null&&(r=this.length),e<1)throw Error("slice: indices must start with 1 (not 0).");if(r>this.length)throw Error("slice: index exceeds the length of the vector.");if(r<e)throw Error('slice: "end" must not be smaller than "start".');return new At(this.v.slice(e-1,r))}static seq(e,r,l){return Mo(e,r,l,At)}static ones(e){return At.fill(1,e)}static fill(e,r){const l=new At.valuesConstructor(r);for(let s=0;s<l.length;s++)l[s]=e;return new At(l)}static bool2ind(e){let r=0;const l=new At.valuesConstructor(e.length);for(let s=0;s<e.length;s++)e[s]&&(l[r]=s+1,r=r+1);return new At(l.subarray(0,r))}};vr(At,"valuesConstructor",Int32Array);let bt=At;function Mo(n,e,r,l){r===void 0&&(r=n<=e?1:-1);const s=Math.floor((e-n)/r)+1;if(s<1)throw Error("seq: wrong combination of parameters.");const a=new l.valuesConstructor(s);for(let o=0;o<s;o++)a[o]=n+o*r;return new l(a)}function Io(n,e){const r=n.length*e,l=new n.constructor.valuesConstructor(r);for(let s=1;s<=e;s++)for(let a=0;a<n.length;a++)l[(s-1)*n.length+a]=n.v[a];return new n.constructor(l)}function Fo(n,e){if(e<1||Math.round(e)!==e)throw Error('rep: parameter "n" must be an integer number > 1.');const r=n.length*e,l=new n.constructor.valuesConstructor(r);for(let s=0;s<n.length;s++)for(let a=0;a<e;a++)l[s*e+a]=n.v[s];return new n.constructor(l)}function Ps(n,e,r){if(n.length!==e.length)throw new Error("_opvv: arrays sizes do not match.");if(n.constructor!==e.constructor)throw new Error("_opvv: array types do not match.");const l=new n.constructor(n.length);for(let s=0;s<n.length;s++)l[s]=r(n[s],e[s]);return l}function Ls(n,e,r){const l=new n.constructor(n.length);for(let s=0;s<n.length;s++)l[s]=r(n[s],e);return l}function Ns(n,e,r,l,s,a){if(l!==s)throw Error("_dot: matrix dimensions do not much.");const o=r,c=a,d=l,u=new n.constructor(o*c);for(let f=0;f<c;f++){const v=e.subarray(f*s,(f+1)*s),m=u.subarray(f*o,(f+1)*o);for(let h=0;h<d;h++){const p=v[h],w=n.subarray(h*r,(h+1)*r);for(let b=0;b<o;b++)m[b]+=w[b]*p}}return u}function jo(n){let e=n.slice(),r=e.length,l,s;for(;r;)s=Math.floor(Math.random()*r--),l=e[r],e[r]=e[s],e[s]=l;return e}function Vo(n,e=!1){return e?n.slice().sort((r,l)=>l-r):n.slice().sort((r,l)=>r-l)}function Oo(n,e=!1){const r=bt.seq(1,n.length).v;return e?r.sort((l,s)=>n[s-1]-n[l-1]):r.sort((l,s)=>n[l-1]-n[s-1])}function Du(n,e,r){if(!n||!n.class||!n.class.includes("pcamodel"))throw new Error('pcamodel_get: parameter "m" must be JSON with PCA model.');const l=n.ncols,s=n.ncomp;let a,o;switch(e){case"mX":a=2,o=l;break;case"sX":a=2+l,o=l;break;case"loadings":case"xloadings":a=2+2*l+(r-1)*l,o=l;break;case"P":a=2+2*l,o=s*l;break;case"eigenvals":case"xeigenvals":a=2+2*l+l*s,o=s;break;case"cq0":a=2+2*l+l*s+s,o=s;break;case"cNq":a=2+2*l+l*s+2*s,o=s;break;case"rq0":a=2+2*l+l*s+3*s,o=s;break;case"rNq":a=2+2*l+l*s+4*s,o=s;break;case"ch0":a=2+2*l+l*s+5*s,o=s;break;case"cNh":a=2+2*l+l*s+6*s,o=s;break;case"rh0":a=2+2*l+l*s+7*s,o=s;break;case"rNh":a=2+2*l+l*s+8*s,o=s;break;case"cr0":a=2+2*l+l*s+9*s,o=s;break;case"cNr":a=2+2*l+l*s+10*s,o=s;break;case"rr0":a=2+2*l+l*s+11*s,o=s;break;case"rNr":a=2+2*l+l*s+12*s,o=s;break;case"cg0":a=2+2*l+l*s+13*s,o=s;break;case"cNg":a=2+2*l+l*s+14*s,o=s;break;case"rg0":a=2+2*l+l*s+15*s,o=s;break;case"rNg":a=2+2*l+l*s+16*s,o=s;break;default:throw Error("pcamodel_get: wrong outcome name.")}return n.v.subarray(a,a+o)}function Bo(n,e,r){if(!n||!n.class||!n.class.includes("pcares"))throw new Error('pcares_get: parameter "r" must be JSON with PCA results.');const l=n.ncols,s=n.nrows,a=n.ncomp;let o,c;switch(e){case"scores":case"xscores":o=(r-1)*s,c=s;break;case"T":o=0,c=s*a;break;case"hdist":o=s*a+(r-1)*s,c=s;break;case"qdist":o=2*s*a+(r-1)*s,c=s;break;case"xcumexpvar":case"cumexpvar":o=3*s*a,c=a;break;case"fdistc":o=3*s*a+a+(r-1)*s,c=s;break;case"fdistr":o=4*s*a+a+(r-1)*s,c=s;break;case"gdist":o=5*s*a+a+(r-1)*l,c=l;break;case"rdist":o=5*s*a+a+l*a+(r-1)*l,c=l;break;case"idistc":o=5*s*a+a+2*l*a+(r-1)*l,c=l;break;case"idistr":o=5*s*a+a+3*l*a+(r-1)*l,c=l;break;case"E":o=5*s*a+a+3*l*a+a*l,c=s*l;break;default:throw new Error("pcares_get: wrong outcome name.")}return n.v.subarray(o,o+c)}function Yu(n,e,r,l){return n*r+n*r+n*r+r+n*e*r+n*r+n*r+r+e*r+e*r+e*r+e*r+n*l}function qo(n,e,r){return 3+2*(n+e)+n*r+1*r+4*r+4*r+4*r+n*r+e*r+1*r}function Il(n,e,r){if(!Array.isArray(n))return!1;if(n.length===0)return!0;for(let l=0;l<n.length;l++){const s=n[l];if(s<e||s>r)return!1}return!0}function Ft(n,e,r){if(!n||!n.class||!n.class.includes("plsmodel"))throw new Error('plsmodel_get: parameter "m" must be JSON with PLS model.');const l=n.npred,s=n.nresp,a=n.ncomp;let o,c=qo(l,s,a)-l*a-s*a-2*s;switch(e){case"mY":c=3,o=s;break;case"mX":c=3+s,o=l;break;case"sY":c=3+s+l,o=s;break;case"sX":c=3+s+l+s,o=l;break;case"P":c=3+2*(s+l),o=a*l;break;case"loadings":case"xloadings":c=3+2*(s+l)+(r-1)*l,o=l;break;case"eigenvals":case"xeigenvals":c=3+2*(s+l)+a*l,o=a;break;case"cq0":c=3+2*(s+l)+a*l+a,o=a;break;case"cNq":c=3+2*(s+l)+a*l+2*a,o=a;break;case"rq0":c=3+2*(s+l)+a*l+3*a,o=a;break;case"rNq":c=3+2*(s+l)+a*l+4*a,o=a;break;case"ch0":c=3+2*(s+l)+a*l+5*a,o=a;break;case"cNh":c=3+2*(s+l)+a*l+6*a,o=a;break;case"rh0":c=3+2*(s+l)+a*l+7*a,o=a;break;case"rNh":c=3+2*(s+l)+a*l+8*a,o=a;break;case"cz0":c=3+2*(s+l)+a*l+9*a,o=a;break;case"cNz":c=3+2*(s+l)+a*l+10*a,o=a;break;case"rz0":c=3+2*(s+l)+a*l+11*a,o=a;break;case"rNz":c=3+2*(s+l)+a*l+12*a,o=a;break;case"weights":c=3+2*(s+l)+a*l+13*a+(r-1)*l,o=l;break;case"yloadings":c=3+2*(s+l)+a*l+13*a+a*l+(r-1)*s,o=s;break;case"yeigenvals":c=3+2*(s+l)+a*l+13*a+a*l+a*s,o=a;break;default:throw Error("plsmodel_get: wrong outcome name.")}return n.v.subarray(c,c+o)}function Lt(n,e,r,l){if(!n||!n.class||!n.class.includes("plsres"))throw new Error('plsres_get: parameter "r" must be JSON with PLS results.');l||(l=1);const s=n.nrows,a=n.ncomp,o=n.nresp,c=n.npred,d=n.nresp_model;let u,f=3*s*a+a;switch(e){case"Yp":f=f+(r-1)*d*s+(l-1)*s,u=s;break;case"yscores":f=f+a*d*s+(r-1)*s,u=s;break;case"zdist":f=f+a*d*s+a*s+(r-1)*s,u=s;break;case"ycumexpvar":f=f+a*d*s+a*s+a*s,u=a;break;case"rmse":f=f+a*d*s+a*s+a*s+a,u=d*a;break;case"r2":f=f+a*d*s+a*s+a*s+a+o*a,u=d*a;break;case"bias":f=f+a*d*s+a*s+a*s+a+2*o*a,u=d*a;break;case"slope":f=f+a*d*s+a*s+a*s+a+3*o*a,u=d*a;break;case"E":f=f+a*d*s+a*s+a*s+a+4*o*a,u=s*c;break;case"T":f=0,u=s*a;break;default:return Bo(n,e,r)}return n.v.subarray(f,f+u)}function Wu(n,e,r,l,s,a,o,c){if(!lr(e))throw new Error("pls_fit: D must be a matrix.");if(r<1||e.ncols<2+r)throw new Error("pls_fit: training set should have at least 2 predictors and 1 response.");o||(o=[]);const d=o&&Array.isArray(o)?o.length:0;if(!Il(o,0,e.nrows-1))throw new Error('pls_fit: some indices in "outliers" array are outside the expected range.');c||(c=[]);const u=c&&Array.isArray(c)?c.length:0;if(!Il(c,0,e.ncols-r-1))throw new Error('pls_fit: some indices in "exclvars" array are outside the expected range.');const f=e.nrows-d,v=e.ncols-r-u;if(f<3||v<2)throw new Error("pls_fit: X must have at least 3 rows and 2 predictors.");if(s===void 0&&(s=!0),a===void 0&&(a=!1),l===void 0&&(l=Math.min(f-1,v)),l<1||l>Math.min(f-1,v))throw new Error('pls_fit: the value of "ncomp" does not match the dimension of D.');const m=n._malloc(e.v.length*e.v.BYTES_PER_ELEMENT);n.HEAPF64.set(e.v,m/e.v.BYTES_PER_ELEMENT);let h=null;if(d>0){const I=new Int32Array(o);h=n._malloc(I.length*I.BYTES_PER_ELEMENT),n.HEAP32.set(I,h/I.BYTES_PER_ELEMENT)}let p=null;if(u>0){const I=new Int32Array(c);p=n._malloc(I.length*I.BYTES_PER_ELEMENT),n.HEAP32.set(I,p/I.BYTES_PER_ELEMENT)}const w=qo(v,r,l),b=Float64Array,_=n._malloc(w*b.BYTES_PER_ELEMENT),S=v*r*l,y=Float64Array,C=n._malloc(S*b.BYTES_PER_ELEMENT),L=n._malloc(S*b.BYTES_PER_ELEMENT),k=n._malloc(S*b.BYTES_PER_ELEMENT);if(n.ccall("plsfit_wasm",["number"],["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"],[m,e.nrows,e.ncols-r,r,l,s,a,_,h,d,p,u,L,C,k])!==1)throw new Error("pls_fit: unexpected error.");const z=n.HEAPF64.slice(_/b.BYTES_PER_ELEMENT,_/b.BYTES_PER_ELEMENT+w),j=n.HEAPF64.slice(L/y.BYTES_PER_ELEMENT,L/y.BYTES_PER_ELEMENT+S),R=n.HEAPF64.slice(C/y.BYTES_PER_ELEMENT,C/y.BYTES_PER_ELEMENT+S),A=n.HEAPF64.slice(k/y.BYTES_PER_ELEMENT,k/y.BYTES_PER_ELEMENT+S);return n._free(m),n._free(_),n._free(L),n._free(C),n._free(k),h&&n._free(h),p&&n._free(p),{class:["plsmodel","pcamodel"],v:z,ncomp:l,nrows:f,npred:v,nresp:r,exclvars:c,center:s,scale:a,coeffs:j,vip:R,sr:A}}function Uu(n,e,r,l,s){if(!e||!e.class||!e.class.includes("plsmodel"))throw new Error('pls_predict: parameter "m" must be JSON with PLS results.');if(!lr(r))throw new Error("pls_predict: D must be a matrix.");s||(s=[]);const a=s&&Array.isArray(s)?s.length:0;if(!Il(s,0,r.nrows-1))throw new Error('pls_predict: some indices in "outliers" array are outside the expected range.');let o=e.exclvars.length;e.exclvars;const c=r.nrows-a;r.ncols-l===e.npred&&(o=0);const d=r.ncols-o-l;if(c<1)throw new Error("pls_predict: D must have at least 1 row.");if(d!==e.npred)throw new Error("pls_predict: D must have the same number of predictors (without excluded ones) as the training set.");const u=n._malloc(r.v.length*r.v.BYTES_PER_ELEMENT);n.HEAPF64.set(r.v,u/r.v.BYTES_PER_ELEMENT);let f=null;if(a>0){const W=new Int32Array(s);f=n._malloc(W.length*W.BYTES_PER_ELEMENT),n.HEAP32.set(W,f/W.BYTES_PER_ELEMENT)}let v=null;if(o>0){const W=new Int32Array(e.exclvars);v=n._malloc(W.length*W.BYTES_PER_ELEMENT),n.HEAP32.set(W,v/W.BYTES_PER_ELEMENT)}const m=n._malloc(e.v.length*e.v.BYTES_PER_ELEMENT);n.HEAPF64.set(e.v,m/e.v.BYTES_PER_ELEMENT);const h=Yu(c,e.nresp,e.ncomp,e.npred),p=Float64Array,w=n._malloc(h*p.BYTES_PER_ELEMENT);if(n.ccall("plspredict_wasm",["number"],["number","number","number","number","number","number","number","number","number","number","number"],[u,r.nrows,r.ncols-l,l,m,w,f,a,v,o])!==1)throw new Error("pls_predict: unexpected error.");const _=n.HEAPF64.slice(w/p.BYTES_PER_ELEMENT,w/p.BYTES_PER_ELEMENT+h);n._free(u),n._free(m),n._free(w),f&&n._free(f),v&&n._free(v);const S={class:["plsres","pcares"],v:_,ncomp:e.ncomp,nrows:c,npred:d,nresp:l,nresp_model:e.nresp,outliers:s,exclvars:e.exclvars,center:e.center,scale:e.scale},y=new Array(e.ncomp),C=new Array(e.ncomp),L=new Array(e.ncomp),k=new Array(e.ncomp),P=new Array(e.ncomp),z=new Array(e.ncomp),j=new Array(e.ncomp),R=new Array(e.ncomp),A=new Array(e.ncomp),I=Lt(S,"xcumexpvar"),D=Lt(S,"ycumexpvar");if(l>0){y[0]=1,P[0]=I[0],k[0]=1-I[0],C[0]=I[0],L[0]=1-I[0],A[0]=D[0],R[0]=1-D[0],z[0]=D[0],j[0]=1-D[0];for(let M=1;M<e.ncomp;M++)y[M]=M+1,P[M]=I[M],k[M]=1-I[M],C[M]=I[M]-I[M-1],L[M]=1-C[M],A[M]=D[M],R[M]=1-D[M],z[M]=D[M]-D[M-1],j[M]=1-z[M];const W=new it(Lt(S,"rmse"),e.nresp,e.ncomp),T=new it(Lt(S,"r2"),e.nresp,e.ncomp),q=new it(Lt(S,"slope"),e.nresp,e.ncomp),Z=new it(Lt(S,"bias"),e.nresp,e.ncomp);S.stat={components:y,xresvar:L,xexpvar:C,xcumexpvar:P,xcumresvar:k,yresvar:j,yexpvar:z,ycumexpvar:A,ycumresvar:R,rmse:W.t(),r2:T.t(),slope:q.t(),bias:Z.t()}}else S.stat=null;return S}function Hu(n,e,r,l,s,a,o,c,d){if(!e||!e.class||!e.class.includes("plsmodel"))throw new Error('pcvpls: parameter "m" must be JSON with PLS model.');if(!lr(r))throw new Error("pcvpls: D must be a matrix.");if(l<1)throw new Error("pcvpls: D must have at least one response.");d||(d=[]);const u=d&&Array.isArray(d)?d.length:0;if(!Il(d,0,r.nrows-1))throw new Error('pca_predict: some indices in "outliers" array are outside the expected range.');const f=e.exclvars.length,v=r.nrows-u,m=r.ncols-l-f;if(v<3)throw new Error("plspcv: D must have at least 3 rows.");if(m<2)throw new Error("plspcv: D must have at least 2 predictors.");if(!Number.isInteger(o)||![0,1,2].includes(o))throw new Error('plspcv: parameter "cv_type" must be one of 0 ("loo"), 1 ("ven"), 2 ("rand).');if(!Number.isInteger(c)||![0,1].includes(c))throw new Error('plspcv: parameter "cv_scope" must be 0 ("global") or 1 ("local").');if(o>0&&(!Number.isInteger(a)||a<2))throw new Error('plspcv: parameter "cv_nseg" must be a number ≥ 2.');if(o>0&&a>v)throw new Error('plspcv: the value of "cv_nseg" is too large for the given X.');if(o===0&&(a=v),!Number.isInteger(s)||s<1)throw new Error('plspcv: the value of "ncomp" must be a number >= 1.');const h=Math.min(o===0?v-2:v-Math.ceil(v/a)-1,m,e.ncomp);if(s>h)throw new Error('pcapcv: the value of "ncomp" is too large.');const p=n._malloc(r.v.length*r.v.BYTES_PER_ELEMENT);n.HEAPF64.set(r.v,p/r.v.BYTES_PER_ELEMENT);let w=null;if(u>0){const A=new Int32Array(d);w=n._malloc(A.length*A.BYTES_PER_ELEMENT),n.HEAP32.set(A,w/A.BYTES_PER_ELEMENT)}let b=null;if(f>0){const A=new Int32Array(e.exclvars);b=n._malloc(A.length*A.BYTES_PER_ELEMENT),n.HEAP32.set(A,b/A.BYTES_PER_ELEMENT)}const _=n._malloc(e.v.length*e.v.BYTES_PER_ELEMENT);n.HEAPF64.set(e.v,_/e.v.BYTES_PER_ELEMENT);const S=r.v.constructor,y=v*(l+m),C=n._malloc(y*S.BYTES_PER_ELEMENT),L=a*s,k=r.v.constructor,P=n._malloc(L*k.BYTES_PER_ELEMENT);if(n.ccall("pcvpls_wasm",["number"],["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"],[p,r.nrows,r.ncols-l,l,s,e.center,e.scale,o,a,c,_,C,P,w,u,b,f])!==1)throw new Error("plspcv: unexpected error.");const j=n.HEAPF64.slice(C/S.BYTES_PER_ELEMENT,C/S.BYTES_PER_ELEMENT+y),R=n.HEAPF64.slice(P/k.BYTES_PER_ELEMENT,P/k.BYTES_PER_ELEMENT+L);return n._free(p),n._free(_),n._free(C),n._free(P),w&&n._free(w),b&&n._free(b),[new it(j,v,l+m),new it(R,a,s)]}function Xu(n,e){if(e[0]===0){const r=e[1]+2;return 2+n*r+2*n+r}return 3+n}const qr=[{id:"norm",title:"Normalization",mpl:2,get_mpl_new:(n,e)=>2,mp:[0,0]},{id:"savgol",title:"Savitzky-Golay",mpl:3,get_mpl_new:(n,e)=>e[0]*e[0],mp:[3,1,0]},{id:"scale",title:"Scaling",mpl:2,get_mpl_new:(n,e)=>2*n,mp:[1,0]},{id:"baseline",title:"Baseline",mpl:3,get_mpl_new:Xu,mp:[0,0,0]},{id:"trim",title:"Trim tails",mpl:2,get_mpl_new:(n,e)=>2,mp:[0,0]},{id:"spikes",title:"Spike removal",mpl:2,get_mpl_new:(n,e)=>2+3*n+e[0],mp:[5,5]}];function Gu(n){let e="<ul>";for(let r=0;r<n.ml.length;r++){const l=qr[n.ml[r]].title;e=e+"<li>"+l+" <span>"+n.info[r]+"</span></li>"}return e=e+"</ul>",e}function Do(n,e,r){const l=qr.findIndex(v=>v.id==="trim");let s=0,a=n.ncols-e,o=0;for(let v=0;v<r.ml.length;v++){if(r.ml[v]!==l){o+=r.mpl_new[v];continue}s=Math.max(s,r.mp_new[o]),a=Math.min(a,r.mp_new[o+1]),o+=r.mpl_new[v]}const c=n.nrows,u=a-s+e,f=it.zeros(c,u);return o=0,e>0&&(f.v.set(n.v.slice(0,e*c),o),o+=e*c),f.v.set(n.v.slice((e+s)*c,(e+a)*c),o),[s,a,f]}function Ku(n,e){if(!n||!e||typeof e!="object"||Object.keys(e).length===0)return n;const r=qr.findIndex(c=>c.id==="trim");if(e.ml.findIndex(c=>c===r)<0)return n;const[s,a,o]=Do(n.values,n.nresp,e);return n.values=o,n.varlabels=n.nresp>0?n.varlabels.slice(0,n.nresp).concat(n.varlabels.slice(n.nresp+s,n.nresp+a)):n.varlabels.slice(s,a),n.varindices=n.nresp>0?Dr(0,n.nresp-1).concat(Dr(0,a-s-1)):Dr(0,a-s-1),n.varvalues=n.nresp>0?n.varvalues.slice(0,n.nresp).concat(n.varvalues.slice(n.nresp+s,n.nresp+a)):n.varvalues.slice(s,a),n}function Yo(n,e,r,l,s=!0,a=[]){if(!lr(e))throw new Error("prep: D must be a matrix.");if(!Array.isArray(l)||l.length<1)throw new Error("prep_fit: list with methods is not correct.");let o,c;s?(o=e.ncols,c=e.nrows-r):(o=e.nrows,c=e.ncols-r);const d=l.length;if(d<1)throw new Error("prep_fit: no preprocessing methods are provided.");const u=new Int32Array(d),f=new Int32Array(d),v=new Int32Array(d);let m=0,h=0;for(let I=0;I<l.length;I++){const D=l[I].id,W=l[I].params,T=qr.findIndex(Z=>Z.id==D);if(T<0)throw new Error("prep_fit: wrong method name: "+D+".");const q=qr[T];if(W.length!==q.mpl)throw new Error("prep_fit: wrong number of parameters for method: "+D+".");u[I]=T,f[I]=q.mpl,v[I]=q.get_mpl_new(c,W),m=m+f[I],h=h+v[I]}const p=new Float64Array(m);let w=0;for(let I=0;I<l.length;I++){const D=l[I].id,W=l[I].params;qr.findIndex(T=>T.id==D),p.set(W,w),w=w+f[I]}const b=n._malloc(e.v.length*e.v.BYTES_PER_ELEMENT);n.HEAPF64.set(e.v,b/e.v.BYTES_PER_ELEMENT);const _=n._malloc(u.length*u.BYTES_PER_ELEMENT);n.HEAP32.set(u,_/u.BYTES_PER_ELEMENT);const S=n._malloc(f.length*f.BYTES_PER_ELEMENT);n.HEAP32.set(f,S/f.BYTES_PER_ELEMENT);const y=n._malloc(v.length*v.BYTES_PER_ELEMENT);n.HEAP32.set(v,y/v.BYTES_PER_ELEMENT);const C=n._malloc(p.length*p.BYTES_PER_ELEMENT);n.HEAPF64.set(p,C/p.BYTES_PER_ELEMENT);const L=n._malloc(h*p.BYTES_PER_ELEMENT),k=new Int32Array(a),P=k.length,z=n._malloc(P*k.BYTES_PER_ELEMENT);if(n.HEAP32.set(k,z/k.BYTES_PER_ELEMENT),n.ccall("prepfit_wasm",["number"],["number","number","number","number","number","number","number","number","number","number","number","number","numbers"],[b,o,c,r,d,_,S,C,y,L,s,z,P])!==1)throw new Error("prep_fit: unexpected error.");const R=n.HEAPF64.slice(L/p.BYTES_PER_ELEMENT,L/p.BYTES_PER_ELEMENT+h);return n._free(b),n._free(_),n._free(C),n._free(S),n._free(z),n._free(L),n._free(y),{ml:u,mpl:f,mp:p,mpl_new:v,mp_new:R,npred:c,class:["prepmodel"]}}function zs(n,e,r,l,s=!0,a=!1){if(!lr(e))throw new Error("prep_apply: D must be a matrix.");let o,c;if(s?(o=e.ncols,c=e.nrows-r):(o=e.nrows,c=e.ncols-r),c!==l.npred)throw new Error("prep_apply: D has wrong number of predictors (expected "+l.npred+" got "+c+").");const d=l.ml,u=l.mpl_new,f=l.mp_new,v=u.reduce((L,k)=>L+k,0);if(!d||d.length<1||!u||u.length!==d.length||f.length!==v)throw console.log(f.length,v),new Error("prep_apply: wrong structure of the model object.");const m=d.length,h=n._malloc(e.v.length*e.v.BYTES_PER_ELEMENT);n.HEAPF64.set(e.v,h/e.v.BYTES_PER_ELEMENT);const p=n._malloc(d.length*d.BYTES_PER_ELEMENT);n.HEAP32.set(d,p/d.BYTES_PER_ELEMENT);const w=n._malloc(u.length*u.BYTES_PER_ELEMENT);n.HEAP32.set(u,w/u.BYTES_PER_ELEMENT);const b=n._malloc(f.length*f.BYTES_PER_ELEMENT);n.HEAPF64.set(f,b/f.BYTES_PER_ELEMENT);const _=n._malloc(e.v.length*e.v.BYTES_PER_ELEMENT);if(n.ccall("prepapply_wasm",["number"],["number","number","number","number","number","number","number","number","number","number"],[h,o,c,r,m,p,w,b,_,s])!==1)throw new Error("prep_apply: unexpected error.");const y=n.HEAPF64.slice(_/e.v.BYTES_PER_ELEMENT,_/e.v.BYTES_PER_ELEMENT+e.v.length);n._free(h),n._free(p),n._free(w),n._free(b),n._free(_);const C=new it(y,e.nrows,e.ncols);if(a){const[L,k,P]=Do(C,r,l);return P}return C}function Dr(n,e,r=1){const l=Math.round((e-n+1)/r),s=Array(l);for(let a=0;a<l;a++)s[a]=n+a*r;return s}function Ju(n,e){let r,l,s;if(e.length>0){const a=n.values.nrows,o=n.objindices,c=a-e.length;r=Array(c),l=Array(c),s=Array(c);let d=0;for(let u=0;u<a;u++)e.includes(u)||(r[d]=o[u],l[d]=n.classes[u],s[d]=n.objlabels[u],d=d+1)}else r=n.objindices,s=n.objlabels,l=n.classes;return[r,s,l]}function Wo(){const n=new Date;return`${n.getFullYear()}${(n.getMonth()+1).toString().padStart(2,"0")}${n.getDate().toString().padStart(2,"0")}${n.getHours().toString().padStart(2,"0")}${n.getMinutes().toString().padStart(2,"0")}${n.getSeconds().toString().padStart(2,"0")}${n.getMilliseconds().toString().padStart(3,"0")}`}function Rs(n,e,r,l,s=!1){const[a,o,c]=Ju(r,l),d=s&&e.prep&&e.prep.ml&&e.prep.ml.length>0?zs(n,r.values,r.nresp,e.prep,!1,!0):r.values,u=Uu(n,e,d,r.nresp,l);return u.hash=Wo(),u.objindices=a,u.objlabels=o,u.varlabels=e.varlabels,r.nresp>0?u.Yref=l&&l.length>0?r.values.subset(a.map(f=>f+1),bt.seq(1,r.nresp)):r.values.subset(null,bt.seq(1,r.nresp)):u.Yref=null,u}function Qu(n,e="."){return Array.isArray(n)&&n.length>0?e==="."?n.map(r=>Number.parseFloat(r.trim())):n.map(r=>Number.parseFloat(r.trim().replace(e,"."))):e==="."?Number.parseFloat(n.trim()):Number.parseFloat(n.trim().replace(e,"."))}function Zn(n){return n.some(e=>Number.isNaN(e))}function vn(n){return n.replace("	","").trim().replace(/^(['"])(.*)\1$/,"$2")}function Uo(n){let e=n.replace(/^\uFEFF/gm,"").replace(/^\u00EF?\u00BB\u00BF/gm,"");return e=e.replace(/\r/gm,""),e.split(/\n/).filter(r=>r.trim().length>1)}function Zu(n,e,r,l,s,a,o,c=0){if(e===void 0&&(e=","),!(e===","||e===";"))throw new Error("Values separator can be either comma or semicolon.");const d=e===";"?",":".";let u=Uo(n);if(u.length<1)throw new Error("Could not find non-empty rows with values, check your CSV file and try again.");u=u.filter(T=>T.replaceAll(e,"").trim().length>0);const f=u[0].split(e);if(f.length<2)throw new Error("Found only one column, looks like your delimiter is not correct.");let v=0,m;const h=r!=="no";(h||h===void 0&&Zn(firstRow))&&(m=f,v=1);const p=u.length-v;if(p<1)throw new Error("Data file should contain at least 1 row with values.");let w,b,_,S=Array(p);l?(w=h?vn(m[0]):"",_=Array(p),b=1):(w="",_=[],b=0);let y,C=[],L;s?(y=h?vn(m[b]):"",L=Array(p),b=b+1):(y="",L=[]);const k=f.length-b;if(k<1)throw new Error("Data file should contain at least 1 column with values.");const P=it.zeros(k,p);for(let T=v;T<p+v;T++){const q=T-v;S[q]=q;let Z=u[T].split(e);if(l&&(_[q]=Z[0],Z.shift()),s){const U=Z[0];L[q]=U,Z.shift(),(C.length===0||C.indexOf(U)<0)&&C.push(U)}const M=d==="."?Z.map((U,K)=>Number.parseFloat(U.trim())):Z.map((U,K)=>Number.parseFloat(U.trim().replace(d,".")));if(M.some(U=>Number.isNaN(U)))throw new Error("Some of the values can not be converted to numbers, check your CSV file and try again.");if(M.length!=k)throw new Error("Wrong number of values in row #"+T);P.v.set(new Float64Array(M),(T-v)*k)}if(!l||_.length!==p){_=Array(p);for(let T=0;T<p;T++)_[T]="O"+(T+1)}_=_.map(T=>vn(T)),L=L.map(T=>vn(T)),C=C.map(T=>vn(T));let z,j=Array(k),R=Array(k);if(m&&m.length===k+b){z=m.map(T=>vn(T)).slice(b);for(let T=0;T<k;T++)j[T]=T>=c?T-c:T,R[T]=T>=c?T-c+1:T+1}else{z=Array(k);for(let T=0;T<k;T++)j[T]=T>=c?T-c:T,z[T]=T>=c?"V"+(T-c+1):"Y"+(T+1),R[T]=T>=c?T-c+1:T+1}let A;if(r==="values"){if(A=d==="."?z.map((T,q)=>q<c?q:Number.parseFloat(T.trim())):z.map((T,q)=>q<c?q:Number.parseFloat(T.trim().replace(d,"."))),A.some(T=>Number.isNaN(T)))throw new Error("Some of the header values can not be converted to numbers, check your CSV file and try again.")}else A=R;Array.isArray(A)||(A=[]),a||(a=""),o||(o=""),a=A.length>0&&a.length>0?a:"Variables",o=A.length>0&&o.length>0?o:"";const I=a+(o.length>0?", "+o:""),D=A[1]<A[0];return{values:P.t(),nresp:c,header:r,hasLabels:l,hasClassNames:s,labelsVarname:w,classLabelsVarname:y,objlabels:_,objindices:S,varlabels:z,varvalues:A,varindices:j,varrev:D,classes:L,classNames:C,sep:e,dec:d,varvaluesName:a,varvaluesUnits:o,varAxisTitle:I}}function $u(n){if(Zn(n[0].slice(2)))return!0;const e=n[0].length,r=[];for(let l=2;l<e;l++){let s=[];for(let u=1;u<n.length;u++)s.push(n[u][l]);const a=n[0][l],o=fn(s),c=ko(s),d=Math.abs((a-o)/c);r.push(d)}return r.every(l=>l>5)}function ed(n){const r=n[0].split(","),l=n[1].split(","),s=r.length,a=l.length,o=";",c=n[0].split(o),d=n[1].split(o),u=c.length,f=d.length;let v,m;if(s>1&&a>1&&s===a&&s>u)m=",",v=s;else if(u>1&&f>1&&u===f)m=o,v=u;else throw new Error("Values in the CSV file should be separated by coma or by semicolon.");return[m,m===","?".":",",v]}function td(n,e=0){const r=Uo(n),l=r.length;if(l<3)throw new Error("It looks like the dataset has less then three rows, minimum three is needed, check your CSV file and try again.");const[s,a,o]=ed(r),c=Math.min(o,5),d=Math.min(l,5);let u=r[0].split(s).length,f=r.slice(0,d).map(j=>j.split(s).slice(0,c));f=f.map(j=>j.map(R=>vn(R)));const v=f.map(j=>Qu(j.slice(),a));for(let j=1;j<d;j++)if(Zn(v[j].slice(2)))throw new Error("Some of the data values expected to be numeric are not, check your CSV file.");const m=$u(v);let h=0;const p=m?1:0,w=p+1,b=f[p][0],_=f[w][0],S=v[p][0],y=v[w][0],C=v[p][1],L=v[w][1];let k=!1,P=!1;if(Number.isNaN(S)&&Number.isNaN(y)&&b!==_?(k=!0,h=h+1):Number.isNaN(C)&&Number.isNaN(L)&&b!==_&&(k=!0,P=!0,h=h+2),!P){const j=k?1:0,R=v[p][j],A=v[w][j];P=Zn([R,A]),h=h+P}let z="no";if(m){h>0?f[0].slice(h+e):f[e];const j=h>0?v[0].slice(h+e):v[e];z=Zn(j)?"labels":"values"}return[s,k,P,z,u]}function rd(n){const e=n.values.t(),r=n.sep,l=n.dec;let s=null;n.header!=="no"&&(s=n.header==="values"?n.nresp&&n.nresp>0?n.varlabels.slice(0,n.nresp).concat(n.varvalues.slice(n.nresp)):n.varvalues.slice():n.varlabels.slice()),s&&n.hasClassNames&&(s=[n.classLabelsVarname,...s]),s&&n.hasLabels&&(s=[n.labelsVarname,...s]);const a=n.classes&&n.classes.length===e.ncols,o=n.objlabels&&n.objlabels.length===e.ncols;let c=s?s.join(r):"";for(let d=0;d<e.ncols;d++){let u=e.getcolref(d+1).join(r);l!=="."&&(u=u.replace(".",l)),a&&(u=n.classes[d]+n.sep+u),o&&(u=n.objlabels[d]+n.sep+u),c=c+`
`+u}return c=c+`
`,l!=="."&&(c=c.replace(/\./g,l)),c}function nd(n,e){const r=rd(n),l=new Blob([r],{type:"text/csv"}),s=window.URL.createObjectURL(l),a=document.createElement("a");a.setAttribute("href",s),a.setAttribute("download",`${e}.csv`),a.click()}function $n(n,e){return lr(e)?{__type:"matrix",nrows:e.nrows,ncols:e.ncols,v:Array.from(e.v)}:De(e)?{__type:"vector",length:e.length,v:Array.from(e.v)}:ArrayBuffer.isView(e)?{__type:e.constructor.name,data:Array.from(e)}:e}function Ms(n,e){if(e&&typeof e=="object"&&e.__type){if(e.__type==="matrix")return qu(e.v,e.nrows,e.ncols);if(e.__type==="vector")return Ge(e.v);const r=globalThis[e.__type];if(typeof r=="function")return new r(e.data)}return e}function Is(n){const e=n.getFullYear(),r=String(n.getMonth()+1).padStart(2,"0"),l=String(n.getDate()).padStart(2,"0"),s=String(n.getHours()).padStart(2,"0"),a=String(n.getMinutes()).padStart(2,"0"),o=String(n.getSeconds()).padStart(2,"0");return`${e}${r}${l}${s}${a}${o}`}function Ho(n){return Array.from({length:8},(e,r)=>n>>7-r&1).reverse()}function Fl(n,e,r){let l="";for(let s=0;s<e;s++){const a=n.getUint8(r++);if(a===0)break;l+=String.fromCharCode(a)}return l}function ld(n){const e=["A.U.","cm^–1","µm","nm","s","min","Hz","KHz","MHz","M/z","ppm","days","years","cm^–1","eV","","","","","F","C","K","","msec","µsec","nsec","GHz","cm","m","mm","h",""],r=["Arbitrary","Wavenumber","Micrometers","Nanometers","Seconds","Minutes","Hertz","Kilohertz","Megahertz","Mass","Parts per million","Days","Years","Raman shift","Electron Volts","X,Y,Z text labels in fcatxt (old 4Dh version only)","Diode Number","Channel","Degrees","Temperature","Temperature","Temperature","Data Points","Milliseconds","Microseconds","Nanoseconds","Gigahertz","Centimeters","Meters","Millimeters","Hours","Double interferogram (no display labels)"],l=["Arbitrary Intensity","Interferogram","Absorbance","Kubelka-Munk","Counts","Volts","Degrees","Milliamps","Millimeters","Millivolts","Log (1/R)","Percent","Intensity","Relative Intensity","Energy",null,"Decibel",null,null,"Temperature (F)","Temperature (C)","Temperature (K)","Index of Refraction [N]","Extinction Coeff. [K]","Real","Imaginary","Complex"],s=["Transmission","Reflectance","Arbitrary or Single Beam with Valley Peaks","Emission"];let a=0;const o=n.getUint8(a);a+=1;const c=n.getUint8(a);if(a+=1,c===77)throw new Error("SPC file has old format which is not supported.");const d=c===75,u=n.getUint8(a);a+=1;const f=n.getInt8(a);a+=1;const v=n.getUint32(a,d);a+=4;const m=n.getFloat64(a,d);a+=8;const h=n.getFloat64(a,d);a+=8;const p=n.getUint32(a,d);a+=4;const w=n.getUint8(a);a+=1;const b=n.getUint8(a);a+=1;const _=n.getUint8(a);a+=1;const S=n.getUint8(a);a+=1;const y=n.getUint32(a,d);a+=4;const C=Fl(n,9,a);a+=9;const L=Fl(n,9,a);a+=9;const k=n.getUint16(a,d);a+=2;const P=Array.from({length:8},()=>{const se=n.getFloat32(a,d);return a+=4,se}),z=Fl(n,130,a);a+=130;const j=Fl(n,30,a);a+=30;const R=n.getUint32(a,d);a+=4;const[A,I,D,W,T,q,Z,M]=Ho(o),U=w===255?r[31]:r[w],K=w===255?e[31]:e[w],J=b<=26?l[b]:b>=128&&b<=131?s[b]:"Unknown";return{ftflgsv:o,ftflgs:{TSPREC:A,TCGRAM:I,TMULTI:D,TRANDM:W,TORDRD:T,TALABS:q,TXYXYS:Z,TXVALS:M},fexper:u,fexp:f,fnpts:v,ffirst:m,flast:h,fnsub:p,fxtype:w,fytype:b,fztype:_,fpost:S,fdate:y,fres:C,fsource:L,fpeakpt:k,fspare:P,fcmnt:z,fcatxt:j,flogoff:R,xaxisName:U,xaxisUnit:K,yaxisName:J}}function sd(n,e){const r=Ho(n.getUint8(e));e+=1;const l=n.getInt8(e);e+=1;const s=n.getUint16(e,!0);e+=2;const a=n.getFloat32(e,!0);e+=4;const o=n.getFloat32(e,!0);e+=4;const c=n.getFloat32(e,!0);e+=4;const d=n.getInt32(e,!0);e+=4;const u=n.getInt32(e,!0);e+=4;const f=n.getFloat32(e,!0);return e+=4,{flags:r,exp:l,index:s,time:a,next:o,noise:c,nPoints:d,nScans:u,wAxis:f}}async function Xo(n){if(n.name.slice(-3).toLowerCase()!=="spc")throw new Error(`One of the selected files is not SPC (${n.name}).`);const r=n.name.slice(0,-4),l=await n.arrayBuffer(),s=new DataView(l);let a=0;const o=ld(s);a+=512;const c=o.fnpts;if(c<2)throw new Error(`Error reading SPC file (${n.name}).`);let d=new Array(c);if(o.ftflgs.TXVALS)for(let v=0;v<c;v++){const m=s.getFloat32(a,!0);a=a+4,d[v]=m}else{(o.flast-o.ffirst)/(c-1);for(let v=0;v<c;v++)d[v]=o.ffirst+v*o.flast}const u=new Float64Array(c*o.fnsub);for(let v=0;v<o.fnsub;v++){sd(s,a),a=a+32;for(let m=0;m<c;m++){const h=s.getFloat32(a,!0);a=a+4,u[v*c+m]=h}}const f=[];return o.fnsub>1?Dr(1,o.fnsub).forEach(m=>{f.push(r+"_"+m)}):f.push(r),{hdr:o,xvalues:d,yvalues:u,objlabels:f}}async function ad(n){if(!(n instanceof FileList||Array.isArray(n)))throw new Error("readSPCFiles: expected FileList or array of files.");const e=n.length,r=[];let l=[],s=[];const a=await Xo(n[0]),o=a.xvalues.length;if(r.push(a.yvalues),l=l.concat(a.objlabels),s.push(a.hdr.fnsub),e>1)for(let p=1;p<e;p++){const w=await Xo(n[p]);if(w.xvalues.length!==o)throw new Error("Number of spectral values in SPC files is different.");r.push(w.yvalues),l=l.concat(w.objlabels),s.push(w.hdr.fnsub)}const c=s.reduce((p,w)=>p+w,0),d=new Float64Array(c*o);let u=0;for(let p=0;p<r.length;p++)d.set(r[p].slice(),u),u+=s[p]*o;const f=new it(d,o,c),v=Dr(0,o-1),m=Dr(0,c-1),h=a.xvalues.map(p=>p.toFixed(1));return{values:f.t(),nresp:0,header:"values",hasLabels:!0,hasClassNames:!1,labelsVarname:"",classLabelsVarname:"",classes:[],classNames:[],objlabels:l,objindices:m,varlabels:h,varvalues:a.xvalues,varindices:v,varev:a.xvalues[1]<a.xvalues[0],sep:",",dec:".",varvaluesName:a.hdr.xaxisName,varvaluesUnits:a.hdr.xaxisUnit,varAxisTitle:"",fileName:`${e} SPC files`}}var od=H('<button tabindex="0" class="button svelte-ymtj5z"> </button>');function at(n,e){let r=V(e,"text",3,"button");var l=od();l.__click=function(...a){var o;(o=e.onclick)==null||o.apply(this,a)};var s=Y(l);ne(()=>ke(s,r())),E(n,l)}vt(["click"]);var id=H('<button tabindex="0"></button>');function mn(n,e){V(e,"disable",3,!1);var r=id();r.__click=function(...l){var s;(s=e.onclick)==null||s.apply(this,l)},ne(()=>{O(r,"title",e.title),O(r,"aria-label",e.title),O(r,"alt",e.title),pt(r,1,`button ${e.className??""}`,"svelte-bx9fh5")}),E(n,r)}vt(["click"]);function cr(n,e){let r=V(e,"title",3,"Reset");mn(n,{get title(){return r()},get onclick(){return e.onclick},className:"button-cancel"})}function cd(n,e){let r=V(e,"title",3,"Undo");mn(n,{get title(){return r()},get onclick(){return e.onclick},className:"button-undo"})}function ud(n,e){let r=V(e,"title",3,"Download");mn(n,{get title(){return r()},get onclick(){return e.onclick},className:"button-download"})}function dd(n,e){let r=V(e,"title",3,"Add");mn(n,{get title(){return r()},get onclick(){return e.onclick},className:"button-add"})}function Go(n,e){let r=V(e,"title",3,"Settings");mn(n,{get title(){return r()},get onclick(){return e.onclick},className:"button-settings"})}function fd(n,e){let r=V(e,"title",3,"Move up");mn(n,{get title(){return r()},get onclick(){return e.onclick},className:"button-up"})}function vd(n,e){let r=V(e,"title",3,"Move down");mn(n,{get title(){return r()},get onclick(){return e.onclick},className:"button-down"})}function St(n){const e={};for(const r of Object.keys(n))e[r]=n[r].default;return e}var md=H('<span class="label svelte-1986c5z"> </span>'),hd=H("<div><!> <!></div>");function oe(n,e){let r=V(e,"label",3,null),l=V(e,"name",3,""),s=V(e,"status",3,""),a=V(e,"colors",3,""),o=V(e,"labelWidth",3,12);var c=hd(),d=Y(c);{var u=v=>{var m=md(),h=Y(m);ne(()=>{ht(m,`flex-basis:${o()??""}ch;`),ke(h,r())}),E(v,m)};B(d,v=>{r()&&v(u)})}var f=N(d,2);Sr(f,()=>e.children??Tt),ne(()=>{pt(c,1,`control-element ${l()??""} ${s()??""}`,"svelte-1986c5z"),ht(c,a())}),E(n,c)}const Ko=(n,e,r,l)=>{const s=e(n);s<0||s>1||F(r,s*100>t(l)-5&&s*100<t(l)+5,!0)},Jo=(n,e,r,l,s,a)=>{F(e,!1);const o=r(n);o<0||o>1||(l(s(o)),a()&&a()(l()))},Qo=(n,e,r,l,s,a)=>{if(!t(e))return;const o=r(n);o<0||o>1||(l(s(o)),a()&&a()(l()))},gd=(n,e,r,l,s,a)=>{if(n.key==="ArrowLeft"){e(e()-r()<l()?l():e()-r()),s()&&s()(e());return}if(n.key==="ArrowRight"){e(e()+r()>a()?a():e()+r()),s()&&s()(e());return}};var pd=H('<div role="slider" class="range-slider-container svelte-vhx0r0" tabindex="0"><div><span> </span></div></div>');function hn(n,e){fe(e,!0);let r=V(e,"min",7,0),l=V(e,"max",3,100),s=V(e,"value",31,()=>Ne(r())),a=V(e,"decNum",3,1),o=V(e,"step",19,()=>+((l()-r())/100).toFixed(4)),c=V(e,"onchange",3,null);ge(()=>{s()<r()&&(s(r()),c()&&c()(s())),s()>l()&&(s(l()),c()&&c()(s())),r()>l()&&r(l())});let d=te(void 0),u=te(void 0),f=te(!1);const v=k=>{const P=r()+k*(l()-r());return+(Math.round(P/o())*o()).toFixed(4)},m=k=>{const P=t(d).getBoundingClientRect(),z=t(u).getBoundingClientRect(),j=P.x,R=z.x+z.width;return(k.clientX-j)/(R-j)},h=k=>{F(f,!1)},p=k=>{let P=s()+o()*k.deltaY*.5;P<r()&&(P=r()),P>l()&&(P=l()),s(+(Math.round(P/o())*o()).toFixed(4)),k.preventDefault(),c()&&c()(s())},w=g(()=>r()===l()?100:(s()-r())/(l()-r())*100);var b=pd();b.__keydown=[gd,s,o,r,c,l],b.__mousemove=[Qo,f,m,s,v,c],b.__mousedown=[Ko,m,f,w],b.__mouseup=[Jo,f,m,s,v,c],b.__touchmove=[Qo,f,m,s,v,c],b.__touchstart=[Ko,m,f,w],b.__touchend=[Jo,f,m,s,v,c];var _=Y(b);let S;var y=Y(_);let C;var L=Y(y);un(_,k=>F(d,k),()=>t(d)),un(b,k=>F(u,k),()=>t(u)),ne((k,P,z)=>{O(b,"aria-valuenow",s()),O(b,"aria-valuemin",r()),O(b,"aria-valuemax",l()),S=pt(_,1,"range-slider svelte-vhx0r0",null,S,k),ht(_,`width:${t(w)??""}%`),C=pt(y,1,"range-value svelte-vhx0r0",null,C,P),ke(L,z)},[()=>({"range-slider_right":t(w)<50}),()=>({"range-value_right":t(w)<50}),()=>s().toFixed(a())]),on("mousewheel",b,p),on("mouseleave",b,h),on("touchcancel",b,h),E(n,b),ve()}vt(["keydown","mousemove","mousedown","mouseup","touchmove","touchstart","touchend"]);const Zo=(n,e,r,l,s)=>{const a=e(n);a<0||a>1||F(r,a>t(l)&&a<t(s)+t(l),!0)},$o=(n,e,r,l,s)=>{F(e,!1);const a=r(n);if(a<0||a>1)return;const o=l(a);s()!==o&&s(o)},ei=(n,e,r,l,s)=>{if(!t(e))return;const a=r(n);if(a<0||a>1)return;const o=l(a);o!=s()&&s(o)},bd=(n,e,r,l,s)=>{if(n.key==="ArrowLeft"){e(e()-r()<l()?l():e()-r());return}if(n.key==="ArrowRight"){e(e()+r()>s()?s():e()+r());return}};var _d=H('<div role="slider" class="range-slider-container range-slider-container_discrete svelte-xdlm7u" tabindex="0"><div><span> </span></div></div>');function Dt(n,e){fe(e,!0);let r=V(e,"min",3,0),l=V(e,"max",3,10),s=V(e,"value",31,()=>Ne(r())),a=V(e,"step",3,1);s()<r()&&(console.log('RangeDiscrete: the "value" is outside of the provided range.'),s(r())),s()>l()&&(console.log('RangeDiscrete: the "value" is outside of the provided range.'),s(l())),r()>l()&&console.error("The min and max values must be distinct.");let o=te(void 0),c=te(void 0),d=te(!1);const u=g(()=>r()===l()?0:(s()-r())/(l()-r()+a())),f=g(()=>a()/(l()-r()+a())),v=g(()=>l()<100?`background: repeating-linear-gradient(to right, var(--bg-color-light, #f4f4f4), var(--bg-color-light, #f4f4f4), var(--bg-color-light, #f4f4f4) ${t(f)*100}%, var(--bg-color-light2, #e8e8e8) ${t(f)*100}%, var(--bg-color-light2, #e8e8e8) ${200*t(f)}%)`:"background: #f0f0f0"),m=k=>{if(k<0||k>1)return s();let P=s();return Math.round(t(f)/k),k<t(u)&&t(u)>0&&(P=s()-a()*Math.ceil((t(u)-k)/t(f))),k>t(u)+t(f)&&t(u)+t(f)<1&&(P=s()+a()*Math.ceil((k-(t(u)+t(f)))/t(f))),P<r()&&(P=r()),P>l()&&(P=l()),P},h=k=>{const P=t(c).getBoundingClientRect(),z=P.x,j=P.x+P.width;return(k.clientX-z)/(j-z)},p=k=>{F(d,!1)},w=k=>{let P=s()+Math.round(k.deltaY*.5)*a();P<r()&&(P=r()),P>l()&&(P=l()),s(P),k.preventDefault()};var b=_d();b.__keydown=[bd,s,a,r,l],b.__mousemove=[ei,d,h,m,s],b.__mousedown=[Zo,h,d,u,f],b.__mouseup=[$o,d,h,m,s],b.__touchmove=[ei,d,h,m,s],b.__touchstart=[Zo,h,d,u,f],b.__touchend=[$o,d,h,m,s];var _=Y(b);let S;var y=Y(_);let C;var L=Y(y);un(_,k=>F(o,k),()=>t(o)),un(b,k=>F(c,k),()=>t(c)),ne((k,P,z)=>{O(b,"aria-valuenow",s()),O(b,"aria-valuemin",r()),O(b,"aria-valuemax",l()),ht(b,t(v)),S=pt(_,1,"range-slider svelte-xdlm7u",null,S,k),ht(_,`width: max(2px, ${t(f)*100}%);left:${t(u)*100}%;`),C=pt(y,1,"range-value svelte-xdlm7u",null,C,P),ke(L,z)},[()=>({"range-slider_left":t(f)<.1&&t(u)<.5,"range-slider_right":t(f)<.1&&t(u)>=.5}),()=>({"range-value_right":t(f)<.1&&t(u)>.5,"range-value_left":t(f)<.1&&t(u)<=.5}),()=>s().toFixed(0)]),on("mousewheel",b,w),on("mouseleave",b,p),on("touchcancel",b,p),E(n,b),ve()}vt(["keydown","mousemove","mousedown","mouseup","touchmove","touchstart","touchend"]);const wd=(n,e,r)=>{if(n.key==="ArrowLeft"){const l=e.options.findIndex(s=>s===r());l>0&&r(e.options[l-1]);return}if(n.key==="ArrowRight"){const l=e.options.findIndex(s=>s===r());l<e.options.length-1&&r(e.options[l+1]);return}};var yd=(n,e,r)=>e(r),xd=H('<button tabindex="-1"><!></button>'),kd=H('<div role="radiogroup" tabindex="0"></div> <input class="svelte-1i17tox"/>',1);function He(n,e){fe(e,!0);let r=V(e,"value",31,()=>Ne(e.options[0])),l=V(e,"className",3,"");var s=kd(),a=X(s);a.__keydown=[wd,e,r],Me(a,20,()=>e.options,c=>c,(c,d)=>{var u=xd();u.__click=[yd,r,d];let f;var v=Y(u);Pt(v,()=>d),ne((m,h)=>f=pt(u,1,`option option_${m??""}`,"svelte-1i17tox",f,h),[()=>d.toString().replace(".","_"),()=>({selected:d==r()})]),E(c,u)});var o=N(a,2);ne(()=>pt(a,1,`selector ${l()??""}`,"svelte-1i17tox")),ws(o,r),E(n,s),ve()}vt(["keydown","click"]);function Kt(n,e){fe(e,!0);let r=V(e,"options",19,()=>["no","yes"]),l=V(e,"value",15,!1),s=te(!0);const a=g(()=>r().length!=2?(console.error('Switch: parameter "option" must gave two values.'),null):r());ge(()=>F(s,l()?r()[1]:r()[0],!0)),ge(()=>l(t(s)===r()[1]));var o=ce(),c=X(o);{var d=u=>{He(u,{get options(){return t(a)},get value(){return t(s)},set value(f){F(s,f,!0)}})};B(c,u=>{t(a)&&u(d)})}E(n,o),ve()}function ti(n,e,r){t(e)&&t(e).files.length>0?r(t(e).files.length===1?t(e).files[0]:t(e).files):r(null)}function ri(n,e){(n.type==="click"||n.type==="keydown"&&(n.code==="Space"||n.code==="Enter"))&&t(e).click()}var Ed=H('<input type="file" multiple class="svelte-1k0x7uv"/>'),Sd=H('<input type="file" class="svelte-1k0x7uv"/>'),Cd=H('<div tabindex="0" role="radiogroup"> <!></div> <!>',1);function jl(n,e){fe(e,!0);let r=V(e,"file",15),l=V(e,"message",3,"Select CSV file with dataset"),s=V(e,"acceptType",3,".csv"),a=V(e,"multiple",3,!1),o=te(void 0);function c(_){t(o).value=null,r(null)}var d=Cd(),u=X(d);u.__keydown=[ri,o],u.__click=[ri,o];let f;var v=Y(u),m=N(v);{var h=_=>{var S=Ed();S.__change=[ti,o,r],un(S,y=>F(o,y),()=>t(o)),ne(()=>O(S,"accept",s())),E(_,S)},p=_=>{var S=Sd();S.__change=[ti,o,r],un(S,y=>F(o,y),()=>t(o)),ne(()=>O(S,"accept",s())),E(_,S)};B(m,_=>{a()?_(h):_(p,!1)})}var w=N(u,2);{var b=_=>{cr(_,{onclick:c})};B(w,_=>{r()&&_(b)})}ne(_=>{f=pt(u,1,"file-selector svelte-1k0x7uv",null,f,_),ke(v,`${(r()?r().name:l())??""} `)},[()=>({selected:r()})]),E(n,d),ve()}vt(["keydown","click","change"]);function Ad(n,e,r,l){e()&&F(r,e()(l()),!0)}var Td=H('<div class="error-message svelte-1qtiwcs"> </div>'),Pd=H('<div><input type="text" class="svelte-1qtiwcs"/> <!></div>');function ni(n,e){fe(e,!0);let r=V(e,"value",15,""),l=V(e,"className",3,""),s=V(e,"placeholder",3,""),a=V(e,"maxLength",3,25),o=V(e,"validator",3,null),c=te("");var d=Pd();let u;var f=Y(d);f.__input=[Ad,o,c,r];var v=N(f,2);{var m=h=>{var p=Td(),w=Y(p);ne(()=>ke(w,t(c))),E(h,p)};B(v,h=>{t(c)&&t(c).length>0&&h(m)})}ne(h=>{u=pt(d,1,`textinput ${l()??""}`,"svelte-1qtiwcs",u,h),O(f,"placeholder",s()),O(f,"maxlength",a())},[()=>({error:t(c)&&t(c).length>0})]),ws(f,r),E(n,d),ve()}vt(["input"]);var Ld=H('<div class="spinner svelte-n48urb"></div>');function Fs(n){var e=Ld();E(n,e)}const Nd=(n,e,r)=>{if(n.key==="ArrowLeft"){const l=e().findIndex(s=>s===r());l>0&&r(e()[l-1]);return}if(n.key==="ArrowRight"){const l=e().findIndex(s=>s===r());l<e().length-1&&r(e()[l+1]);return}};var zd=(n,e,r)=>e(r),Rd=H('<button tabindex="-1"><!></button>'),Md=H('<div role="radiogroup" tabindex="0" class="selector plot-selector svelte-yf64an"></div> <input class="svelte-yf64an"/>',1);function js(n,e){fe(e,!0);let r=V(e,"options",19,()=>["p","l","b","h","qq"]),l=V(e,"value",31,()=>Ne(r()[0]));const s='<svg width="3em" height="1.5em" viewBox="0 0 32 20" fill="transparent" xmlns="http://www.w3.org/2000/svg">',a={bp:'<rect x="8" y="5" width="16" height="10" stroke-width="2"/><line x1="15" y1="14" x2="15" y2="4" stroke-width="2"/><line x1="30" y1="10" x2="25" y2="10" stroke-width="2"/><line x1="8" y1="10" x2="2" y2="10" stroke-width="2"/>',hm:'<rect x="5" y="4" width="23" height="12"stroke-width="2"/><line x1="13" y1="16" x2="13" y2="3" stroke-width="2"/><line x1="21" y1="16" x2="21" y2="3" stroke-width="2"/><line x1="28" y1="10" x2="5" y2="10" stroke-width="2"/>',l:'<path d="M4.23178 14.3598L15.5 5" stroke-width="2"/><line x1="14.4846" y1="5.17692" x2="26.4846" y2="10.1769" stroke-width="2"/>',p:'<circle cx="6.5" cy="12.5" r="1" stroke-width="4"/><circle cx="15.2" cy="5.8" r="1" stroke-width="4"/><circle cx="25" cy="10" r="1" stroke-width="4"/>',h:'<line x1="9" y1="15" x2="9" y2="9" stroke-width="6"/><line x1="17" y1="15" x2="17" y2="3" stroke-width="6"/><line x1="25" y1="15" x2="25" y2="7" stroke-width="6"/>',qq:'<circle cx="6.5" cy="15.0" r="1" stroke-width="4"/><circle cx="15.2" cy="10" r="1" stroke-width="4"/><circle cx="25" cy="5.8" r="1" stroke-width="4"/>'};a.b=a.l+a.p;const o={bp:"boxplot",hm:"heatmap",l:"line",p:"scatter",b:"line + scatter",h:"bar",qq:"qq-plot"};var c=Md(),d=X(c);d.__keydown=[Nd,r,l],Me(d,20,r,f=>f,(f,v)=>{var m=Rd();m.__click=[zd,l,v];let h;var p=Y(m);Pt(p,()=>s+a[v]+"</svg"),ne(w=>{h=pt(m,1,"option svelte-yf64an",null,h,w),O(m,"title",o[v])},[()=>({selected:v==l()})]),E(f,m)});var u=N(d,2);ws(u,l),E(n,c),ve()}vt(["keydown","click"]),vt(["keydown","click"]);var Id=H("<h2> </h2>"),Fd=H("<!> <!>",1),jd=H('<div class="widget"><!></div>');function Vd(n,e){fe(e,!0);let r=V(e,"title",3,""),l=V(e,"value",15),s=V(e,"labelWidth",3,13);function a(u){const f={};for(const v of Object.keys(u))f[v]=u[v].default;return f}ge(()=>{!l()&&e.options&&l(a(e.options))});var o=jd(),c=Y(o);{var d=u=>{var f=Fd(),v=X(f);{var m=p=>{oe(p,{children:(w,b)=>{var _=Id(),S=Y(_);ne(()=>ke(S,r())),E(w,_)},$$slots:{default:!0}})};B(v,p=>{r()&&p(m)})}var h=N(v,2);Me(h,17,()=>Object.keys(e.options),qe,(p,w)=>{var b=ce();const _=g(()=>e.options[t(w)]);var S=X(b);{var y=C=>{oe(C,{get name(){return t(_).name},get label(){return t(_).label},get labelWidth(){return s()},children:(L,k)=>{var P=ce(),z=X(P);Jn(z,()=>t(_).el,(j,R)=>{R(j,Br(()=>t(_).props,{get value(){return l()[t(w)]},set value(A){l(l()[t(w)]=A,!0)}}))}),E(L,P)},$$slots:{default:!0}})};B(S,C=>{t(_).hidden||C(y)})}E(p,b)}),E(u,f)};B(c,u=>{l()&&u(d)})}E(n,o),ve()}function Vl(n,e,r,l){let s=n.outliers,a=n.exclvars;(!s||!Array.isArray(s))&&(s=[]);const o=e.sep,c=e.values.nrows,d=s.length,u=c-d,f=n.nresp,v=n.nresp_model,m=n.ncomp,h=Array(m).fill(""),p=Array(m).fill(0).map((k,P)=>"LV"+(P+1));function w(k,P){const z=e.objlabels;_+=`
`,_+=[k+": ",...h].join(o)+o+`
`,_+=["object",...p].join(o)+o+`
`;const j=n.v.subarray(P,P+m*u);let R=0;for(let A=0;A<c;A++){if(d>0&&s.includes(A)){_+=[z[A],...Array(m).fill("-")].join(o)+o+`
`;continue}const I=Array(m);for(let D=0;D<m;D++)I[D]=j[D*u+R];_+=[z[A],...I].join(o)+o+`
`,R=R+1}_+=`
`}function b(k){const P=e.objlabels,z=3*m*u+m,j=m*u*v,R=n.v.subarray(z,z+j);let A=0;for(let I=0;I<c;I++){if(d>0&&s.includes(I)){_+=[P[I],...Array(m).fill("-")].join(o)+o+`
`;continue}const D=Array(m);for(let W=0;W<m;W++)D[W]=R[W*(u*v)+(k-1)*u+A];_+=[P[I],...D].join(o)+o+`
`,A=A+1}_+=`
`}let _="";if(_+=["Number of LVs:",m,...h].join(o)+`
`,_+=["Optinal number of LVs:",l,...h].join(o)+`
`,_+=["Center:",n.center,...h].join(o)+`
`,_+=["Scale:",n.scale,...h].join(o)+`
`,s.length>0&&(_+=["Removed outliers:",s.length,...h].join(o)+`
`),a.length>0&&(_+=["Excluded variables:",a.length,...h].join(o)+`
`),_+=`
`,f>0){_+=["Variances:","",...h].join(o)+`
`,_+=["",...p].join(o)+o+`
`,_+=["xexpvar:",...n.stat.xexpvar].join(o)+o+`
`,_+=["xcumexpvar",...n.stat.xcumexpvar].join(o)+o+`
`,_+=["yexpvar:",...n.stat.yexpvar].join(o)+o+`
`,_+=["ycumexpvar:",...n.stat.ycumexpvar].join(o)+o+`
`,_+=`
`,_+=`
`;for(let k=1;k<=f;k++)_+=["Response variable:"+o+n.varlabels[k-1],...h].join(o)+`

`,_+=["FoMs:",...p].join(o)+o+`
`,n.stat&&(_+=["RMSE",...n.stat.rmse.getcolref(k)].join(o)+o+`
`,_+=["R2",...n.stat.r2.getcolref(k)].join(o)+o+`
`,_+=["Slope",...n.stat.slope.getcolref(k)].join(o)+o+`
`,_+=["Bias",...n.stat.bias.getcolref(k)].join(o)+o+`
`,_+=`
`),_+=["Predictions:",...p].join(o)+o+`
`,b(k)}else for(let k=1;k<=v;k++)_+=["Response variable:"+o+n.varlabels[k-1],...h].join(o)+`

`,_+=["Predictions:",...p].join(o)+o+`
`,b(k);w("X-scores",0),w("Score distances, h",m*u),w("Orthogonal distances, q",m*u*2),n.stat&&(w("Y-scores",3*m*u+m+u*m*f),w("Orthogonal distances, z",4*m*u+m+u*m*f)),e.dec!=="."&&(_=_.replace(/\./g,e.dec)),_=["Data filename:",e.fileName,...h].join(e.sep)+`
`+_;let S=["PLS results ("+r+")","https://mda.tools/pls/",...h].join(e.sep)+`

`;const y=new Blob([S+_],{type:"text/csv"}),C=window.URL.createObjectURL(y),L=document.createElement("a");L.setAttribute("href",C),L.setAttribute("download",`pls-results-${r}.csv`),L.click()}function li(n,e,r){n.ncomp_selected=e,n.prep=r;const l=new Blob([JSON.stringify(n,$n)],{type:"application/json"}),s=window.URL.createObjectURL(l),a=document.createElement("a");a.setAttribute("href",s),a.setAttribute("download","pls-model.json"),a.click()}var Od=H('<span class="item svelte-1ggez3e"> </span>'),Bd=H('<p class="outliers svelte-1ggez3e"><span style="color:#a0a0a0;">Removed:</span> <!></p> <!> <!>',1);function Vs(n,e){fe(e,!0);var r=ce(),l=X(r);{var s=a=>{oe(a,{children:(o,c)=>{var d=Bd(),u=X(d),f=N(Y(u),2);Me(f,17,()=>e.outliers,qe,(p,w)=>{var b=Od(),_=Y(b);ne(()=>ke(_,e.dataset.objlabels[t(w)])),E(p,b)});var v=N(u,2);{var m=p=>{cd(p,{get onclick(){return e.undoOutliers}})};B(v,p=>{e.outliers.length>1&&p(m)})}var h=N(v,2);cr(h,{get onclick(){return e.resetOutliers}}),E(o,d)},$$slots:{default:!0}})};B(l,a=>{e.dataset&&e.outliers&&e.outliers.length>0&&a(s)})}E(n,r),ve()}var qd=H('<p class="exclvars svelte-181kelh"><span style="color:#a0a0a0;">Excluded</span> <span style="color:#504040;"> </span> <span style="color:#a0a0a0;">variables</span></p> <!>',1);function Dd(n,e){fe(e,!0);var r=ce(),l=X(r);{var s=a=>{oe(a,{children:(o,c)=>{var d=qd(),u=X(d),f=N(Y(u),2),v=Y(f),m=N(u,2);cr(m,{get onclick(){return e.resetExclvars}}),ne(()=>ke(v,e.exclvars.length)),E(o,d)},$$slots:{default:!0}})};B(l,a=>{e.exclvars&&e.exclvars.length>0&&a(s)})}E(n,r),ve()}const Yd={small:30,medium:40,large:50,xlarge:60},Wd={small:5,medium:8,large:12,xlarge:15},Ud={small:6,medium:10,large:14,xlarge:18},Os={small:4,medium:6,large:8,xlarge:10},Hd={small:12,medium:15,large:19,xlarge:21},Bs={small:11,medium:15,large:17,xlarge:19},el={small:["0","3,3","1,1","3,1,1,1"],medium:["0","5,5","2,2","5,2,2,2"],large:["0","7,7","3,3","7,3,2,3"],xlarge:["0","9,9","4,4","9,3,3,3"]},Rn=["●","◼","▲","▼","⬥","＋","✳","✕"],Xd=.8,si=.5,Gd={small:5,medium:8,large:12,xlarge:15},Kd=12,Ct={MIDDLEGRAY:"#dadada",DARKGRAY:"#606060",LEGEND:"#303030",PRIMARY:"#2679B2",PRIMARY_TEXT:"#333",CLEGEND_LABELS:"#808080"};function ai(n){let e=Array(n);for(let r=0;r<n;r++)e[r]=r+1;return e}function oi(n,e){return Array.isArray(n)&&n.length===e&&!n.some(r=>r===void 0)&&!n.some(r=>isNaN(r))}function ii(n,e){if(n!=null&&(Array.isArray(n)&&(n=Ge(n)),!(!De(n)||n.length<1)))return n.apply(r=>Ws((r-e[1])*e[0]+e[2])).v}function mt(n,e){return ii(n,e.coords)}function tl(n,e){return ii(n,e.objects)}function ci(n,e){if(n!=null&&(Array.isArray(n)&&(n=Ge(n)),!(!De(n)||n.length<1)))return n.apply(r=>(r-e[2])/e[0]+e[1]).v}function ui(n,e){return ci(n,e.coords)}function di(n,e){return ci(n,e.objects)}function qs(n){return n===0?"":`<tspan>&times;10</tspan><tspan font-size="0.75em" dy="-0.5em">${n.toString()}</tspan>`}function gn(n){if(n===Math.round(n))return n;if(Math.abs(n)>10**6)return Math.round(n);if(Math.abs(n)<10**-6)return n;let e=n.toPrecision(10);return e=e.replace(/\.?0+$/,""),parseFloat(e)}function Ds(n){if(n===void 0)return[0,void 0];if(n.length<1)return[0,void 0];if(n.length===1)return[0,[n[0].toString()]];let e=gn(Math.abs(Gt(yo(n)))),r=0;if(e>=1)return e<100?[0,Array.from(n).map(a=>a.toFixed(0))]:(r=Math.ceil(gn(Math.log10(e)))-2,[r,Array.from(n).map(a=>(a/Math.pow(10,r)).toFixed(0))]);let l=Math.ceil(-gn(Math.log10(e)));return l<=2?[0,Array.from(n).map(s=>s.toFixed(l))]:(r=l-2,l=2,gn(Math.abs(nr(n)))<=10?[-r,Array.from(n).map(s=>(s*Math.pow(10,r)).toFixed(l))]:[-r,Array.from(n).map(s=>(s/Math.pow(10,r)).toString())])}function Rt(n,e,r){return Array.isArray(n)&&(n=Ge(n)),De(n)?n.length<1?(console.error(e+": vector with coordinates is empty."),null):r&&n.length!==r?(console.error(e+": vector does not have the expected length of "+r+"."),null):n:(console.error(e+": coordinates must be provided as array or instance of Vector class."),null)}function Ys(n,e,r,l){if(!n||!e||n.length!==e.length)return console.error("val2p: provided coordinate values are not correct."),null;const s=r.coords,a=l.coords;let o="";for(let c=0;c<n.length;c++){const d=Ws((n.v[c]-s[1])*s[0]+s[2]),u=Ws((e.v[c]-a[1])*a[0]+a[2]);o+=d+","+u+" "}return o}function fi(n,e){return n?Array.isArray(n)?!e||e.length<1?[null,"tick labels must be accompanied with tick values."]:e.v.length!==n.length?[null,"number of tick labels and values should be the same."]:[n.map(r=>Yr(r)),""]:[null,"tick labels must be provided as array."]:[null,""]}function vi(n,e){if(Array.isArray(n)&&(n=Ge(n)),!De(n))return[null,"tick values must be provided as an array or as a vector."];if(n.v.some(o=>isNaN(o)))return[null,"tick values must be numeric"];const r=new Set(n.v);if(n.length!==r.size)return[null,"ticks values must be unique."];const l=e[0]<e[1]?e[0]:e[1],s=e[0]<e[1]?e[1]:e[0],a=n.filter(o=>o>=l&o<=s);return a.length!==n.length?[null,"some of ticks values are outside axis limits."]:[a,""]}function mi(n,e,r,l,s,a){s==null&&(s=!1),a===void 0&&(a=1e-4);const o=e[0]<e[1]?e:[e[1],e[0]];if(n)return n;if(typeof o!="object"||o[0]===void 0||o[1]===void 0){console.error("getAxisTicks: provided axis limits are not valid.");return}const c=Math.abs(o[1]-o[0])*a,d=o[1]-o[0]-2*c,u=Math.floor(Math.log10(d)),f=1/Math.pow(10,u-1),v=Math.round(d*f)/f;let m=Jd(v/r);s&&(Math.abs(o[1]-o[0])<=1?console.error('getAxisTicks: parameter "whole" will be ignored as axis limits are too narrow to fit whole ticks.'):(m<1&&(m=1),m=Math.round(m)));let h=Math.ceil((o[0]+c)/m)*m,p=Math.floor((o[1]-c)/m)*m;Math.abs(o[0]-h)<m/10&&(h=h+m),Math.abs(o[1]-p)<m/10&&(p=p-m),r=Math.ceil(gn((p-h)/m))+1,n=Ie.zeros(r);for(let w=0;w<r;w++)n.v[w]=h+m*w;if(Math.abs(m)<1){const w=Math.pow(10,1+Math.round(-Math.log10(m)));n=n.apply(b=>Math.round((b+Number.EPSILON)*w)/w)}return n.filter(w=>w>=o[0]&w<=o[1])}function Jd(n,e){const r=Math.floor(Math.log10(n)),l=n/Math.pow(10,r);let s;return l<=1?s=1:l<=2?s=2:l<=5?s=5:s=10,s*Math.pow(10,r)}function Ws(n){return Math.round(n*10)/10}function Qd(n,e){return e<300.2||n<400.2?"small":e<400.2||n<700.2?"medium":e<650.2||n<850.2?"large":"xlarge"}function hi(n,e){return n<400.2?"small":n<700.2?"medium":n<900.2?"large":"xlarge"}function Zd(){const n=new Int32Array(256);for(let e=0;e<256;e++){let r=e;for(let l=0;l<8;l++)r=r&1?3988292384^r>>>1:r>>>1;n[e]=r}return n}function $d(n){let e=-1,r=Zd();for(let l=0;l<n.length;l++)e=r[(e^n[l])&255]^e>>>8;return e^-1}function ef(n,e){const r=new Uint8Array(13);e*=39.3701,r[0]=112,r[1]=72,r[2]=89,r[3]=115,r[4]=e>>>24,r[5]=e>>>16,r[6]=e>>>8,r[7]=e&255,r[8]=r[4],r[9]=r[5],r[10]=r[6],r[11]=r[7],r[12]=1;const l=$d(r),s=new Uint8Array(4);s[0]=l>>>24,s[1]=l>>>16,s[2]=l>>>8,s[3]=l&255;const a=new Uint8Array(4);a[0]=0,a[1]=0,a[2]=0,a[3]=9;const o=new Uint8Array(54);return o.set(n,0),o.set(a,33),o.set(r,37),o.set(s,50),o}function tf(n,e){const r=n.split(","),l=r[0],s=r[1],a=33/3*4,o=s.substring(0,a),c=s.substring(a),d=atob(o),u=new Uint8Array(d.length);for(let m=0;m<u.length;m++)u[m]=d.charCodeAt(m);const f=ef(u,e),v=btoa(String.fromCharCode(...f));return[l,",",v,c].join("")}function rf(n,e,r,l,s){if(r||(r=10),l||(l=10),s||(s=300),r<1||r>30)return console.error('Parameter "width" must be between 1 and 30 (cm).'),null;if(l<1||l>30)return console.error('Parameter "height" must be between 1 and 30 (cm).'),null;if(s<50||s>1200)return console.error('Parameter "res" must be between 50 and 1200 (ppi).'),null;if(!n||!(n instanceof SVGElement))return console.error('Parameter "svg" is not an instance of SVGElement.'),null;(!e||e.trim()==="")&&(e="plot");const a=r/2.54*s,o=l/2.54*s;setTimeout(()=>{const c=n.clientHeight,d=n.clientWidth;let u=Math.max(a/d,o/c),f=1;u<1&&(f=u,u=1);const v=document.createElement("canvas"),m=v.getContext("2d");v.width=d*(f<1?f:u),v.height=c*(f<1?f:u),n.setAttribute("width",d*u),n.setAttribute("height",c*u),m.fillStyle="white",m.fillRect(0,0,v.width,v.height),m.scale(u,u);const h=new XMLSerializer().serializeToString(n),p=new Blob([h],{type:"image/svg+xml;charset=utf-8"}),w=URL.createObjectURL(p),b=new Image;b.onload=function(){f<0&&(b.width=b.width*f,b.height=b.height*f),m.drawImage(b,0,0,v.width,v.height);const _=v.toDataURL("image/png"),S=tf(_,s),y=document.createElement("a");y.href=S,y.download=`${e}.png`,y.click()},b.src=w},20)}function nf(n,e){if(!n||!(n instanceof SVGElement))return console.error('Variable "svg" is not an instance of SVGElement.'),null;(!e||e.trim()==="")&&(e="plot");const r=n.clientHeight,l=n.clientWidth;n.setAttribute("width",l+"px"),n.setAttribute("height",r+"px"),n.setAttribute("viewBox",`0 0 ${l} ${r}`);const s=new Blob([n.outerHTML],{type:"image/svg+xml"}),a=window.URL.createObjectURL(s),o=document.createElement("a");o.setAttribute("href",a),o.setAttribute("download",`${e}.svg`),o.click()}function lf(n,e,r,l){const s=n.textContent;navigator.clipboard.write([new ClipboardItem({"image/png":sf(e,r,l)})]).then(()=>{n.classList.add("copied"),n.textContent="✓ done",setTimeout(()=>{n.classList.remove("copied"),n.textContent=s},500)},a=>{console.error(a),n.classList.add("error"),n.textContent="x copy",setTimeout(()=>{n.classList.remove("error"),n.textContent=s},500)}).catch(a=>console.error(a))}async function sf(n,e,r){const l=n.clientHeight,s=n.clientWidth,a=Math.max(e/s,r/l),o=document.createElement("canvas"),c=o.getContext("2d");return o.width=s*a,o.height=l*a,c.scale(a,a),n.setAttribute("width",o.width),n.setAttribute("height",o.height),await new Promise((u,f)=>{const v=new XMLSerializer().serializeToString(n),m=new Blob([v],{type:"image/svg+xml;charset=utf-8"}),h=window.URL||window.webkitURL||window,p=h.createObjectURL(m),w=new Image;w.onload=function(){c.drawImage(w,0,0,o.width,o.height),h.revokeObjectURL(p),o.toBlob(function(b){b?u(b):f(new Error("Failed to create blob"))},"image/png")},w.onerror=function(b){f(b)},w.src=p})}function Us(n,e){return n>16&&(n=16),[["#2679B2"],["#2679B2","#D22C2F"],["#2679B2","#92B42A","#D22C2F"],["#2679B2","#2E9658","#F2B825","#D22C2F"],["#2679B2","#22988A","#92B42A","#F79426","#D22C2F"],["#2679B2","#1C9AA8","#379531","#EED524","#FB7F28","#D22C2F"],["#2679B2","#1D94A9","#2E9658","#92B42A","#F2B825","#F47129","#D22C2F"],["#2679B2","#1E90AA","#279775","#519E2F","#D3CB25","#F5A326","#EF672A","#D22C2F"],["#2679B2","#1F8DAB","#22988A","#33953F","#92B42A","#EFCA24","#F79426","#EB5F2A","#D22C2F"],["#2679B2","#208BAC","#1E999A","#2E9658","#5FA32E","#C5C626","#F2B825","#F98827","#E85A2B","#D22C2F"],["#2679B2","#2089AD","#1C9AA8","#29976C","#379531","#92B42A","#EED524","#F4AA26","#FB7F28","#E6552B","#D22C2F"],["#2679B2","#2188AD","#1C97A8","#25987C","#329546","#68A62D","#BCC327","#F0C524","#F69E26","#F77728","#E4512B","#D22C2F"],["#2679B2","#2186AD","#1D94A9","#22988A","#2E9658","#469A2F","#92B42A","#DECF25","#F2B825","#F79426","#F47129","#E34E2C","#D22C2F"],["#2679B2","#2285AE","#1E92AA","#209995","#2A9767","#34953A","#6FA82D","#B5C128","#EFCE24","#F3AD25","#F98C27","#F16B29","#E14B2C","#D22C2F"],["#2679B2","#2284AE","#1E90AA","#1D999F","#279775","#31964A","#519E2F","#92B42A","#D3CB25","#F0C224","#F5A326","#FA8527","#EF672A","#E0492C","#D22C2F"],["#2679B2","#2283AE","#1F8FAB","#1C9AA8","#249880","#2E9658","#379531","#73AA2C","#B0BF28","#EDD424","#F2B825","#F69B26","#FB7F28","#ED632A","#DF472C","#D22C2F"]][n-1]}function af(n,e,r,l,s){let a=s.ticks,o=s.tickLabels,c=0;const d=mi(a,n,Wd[r.x],!0,s.whole),u=d.length,f=di([Os[r.plot]],l)[0],v=Ie.fill(e[0],u),m=v.add(f),h=Ie.fill(e[1],u);if(o||(a?(c=0,o=a.v.map(z=>gn(z).toString())):[c,o]=Ds(d.v)),!o||o.length!==d.length)return console.error('XAxis: "tickLabels" must be a array of the same size as ticks.'),null;const p=[[d,v],[d,h]],w=[[Ge([n[0]]),Ge([e[0]])],[Ge([n[1]]),Ge([e[0]])]],b=[[d,m],[d,v]],_=(n[1]-n[0])*.01,S=[[null,null],[[n[1]-(c>9?1:0)*_],[v.v[u-1]]]],y=qs(c),C=o.length,L=Math.abs(n[1]>n[0]?n[1]-d.v[C-1]:n[1]-d.v[0]),k=Math.abs(n[1]-n[0]),P=Math.abs(d.v[1]-d.v[0]);if(y.length>0&&L<k*.1&&L<P*.5){const z=n[1]>n[0]?C-1:0;o[z]=" "}return{grid:p,axisLine:w,tickCoords:b,tfCoords:S,ticks:a,tickLabels:o,tickFactor:c,tfLabel:y}}function of(n,e,r,l,s){let a=s.ticks,o=s.tickLabels,c=0;const d=mi(s.ticks,e,Ud[r.y],!0,s.whole),u=d.length,f=di([Os[r.plot]],l)[0],v=Ie.fill(n[0],u),m=v.add(f),h=Ie.fill(n[1],u);if(o||(a?(c=0,o=a.v.map(P=>gn(P).toString())):[c,o]=Ds(d.v)),o.length!==d.length)return console.error('YAxis: "tickLabels" must be a array of the same size as ticks.'),null;const p=[[v,d],[h,d]],w=[[Ge([n[0]]),Ge([e[0]])],[Ge([n[0]]),Ge([e[1]])]],b=[[v,d],[m,d]],_=[[[],[]],[[m.v[u-1]+(Math.abs(c)>9?3:2)*f],[e[1]]]],S=qs(c),y=o.length,C=Math.abs(e[1]>e[0]?e[1]-d.v[y-1]:e[1]-d.v[0]),L=Math.abs(e[1]-e[0]),k=Math.abs(d.v[1]-d.v[0]);if(S.length>0&&C<L*.1&&C<k*.5){const P=e[1]>e[0]?y-1:0;o[P]=" "}return{grid:p,axisLine:w,tickCoords:b,tfCoords:_,ticks:a,tickLabels:o,tickFactor:c,tfLabel:S}}function cf(n){if(!n.breaks)return console.error("ColormapLegend: breaks values must be provided."),null;const e=De(n.breaks)?n.breaks.v:n.breaks;if(e.length<2)return console.error("ColormapLegend: incorrect breaks values."),null;if(!n.colmap)return console.error('ColormapLegend: values for "colmap" parameter must be provided.'),null;if(!Array.isArray(n.colmap))return console.error('ColormapLegend: parameter "colmap" must be array with colors.'),null;if(n.colmap.length!==e.length-1)return console.error('ColormapLegend: number of color values in "colmap" does not match number of intervals defined by breaks.'),null;const r=n.colmap;let l,s;if(n.labels?(l=n.labels,s=0):[s,l]=Ds(e),!(l.length===e.length-1||l.length===e.length))return console.error('ColormapLegend: number of values in "labels" should be equal to or by one less than number of values in "breaks".'),null;const a=l.length===r.length;return{colmap:r,breaks:e,labels:l,isCentered:a,labelsFactor:s,fontSize:n.fontSize,labelColor:n.labelColor}}function uf(n,e,r,l){const s=n.colmap.length,a=e*Xd,o=a/s,c=r[1]+(e-a)*.5,d=Gd[l.y],u=r[2]+d*si,f=u+d*(1+si),v=n.isCentered?o/2:0;return{start:c,top:u,height:d,width:o,dxl:v,ltop:f}}function pn(n,e,r){if(!n||!e||!r||typeof r!="function")return;const l=n.target;if(l.tagName===e){const s=Array.prototype.indexOf.call(l.parentNode.children,l);if(s<0)return;r(s),n.stopPropagation()}}function df(n,e){const l=document.createElement("canvas").getContext("2d");return l.font=e,l.measureText(n.replace(/<(.|\n)*?>/g,"")).width}function ff(n,e){const r="Arial",l=e/8,s=e*1.5,a=Array(n.length),o=Array(n.length);let c=0,d=0,u=0;for(let v=0;v<n.length;v++){const m=df("  "+n[v].label+"  ",e+"px "+r);u=m>u?m:u;const h=e*n[v].labelHeight+2*l;a[v]=h,o[v]=c,c=c+h,d=d+h}const f=s+2*l+u;return[o,a,s,l,d,f]}function vf(n,e,r,l,s){const[a,o,c,d,u,f]=ff(n.items,l*n.fontSize),v=n.position.includes("left")?e[0]+s:n.position.includes("right")?e[1]-f-s:(e[1]+e[0]-f)*.5,m=n.position.includes("top")?r[1]+s:n.position.includes("bottom")?r[0]-u-s:(r[1]+r[0]-u)*.5;return{lgl:v,lgt:m,lgw:f,lgh:u,ely:a,elh:o,elw:c,elp:d}}function Yr(n){if(!n||n.length<1)return n;function e(a){return'<tspan font-size="0.75em" dy="-0.5em">'+a+'</tspan><tspan dy="0.4em"> </tspan>'}function r(a){return'<tspan font-size="0.75em" dy="0.5em">'+a+'</tspan><tspan dy="-0.4em"> </tspan>'}let l=0,s="";for(;l<n.length;){const a=n[l];if((a==="^"||a==="_")&&l<n.length-1){const o=a==="^";if(l++,n[l]==="("){let c=l+1;for(;c<n.length&&n[c]!==")";)c++;const d=n.slice(l+1,c);s+=o?e(d):r(d),l=c+1}else if(n[l]==="-"||n[l]==="–"){const c=n.slice(l,l+2);s+=o?e(c):r(c),l=l+2}else s+=o?e(n[l]):r(n[l]),l++}else s+=a,l++}return s}var mf=xe('<line vector-effect="non-scaling-stroke"></line>'),hf=xe("<g></g>");function Hs(n,e){fe(e,!0);let r=V(e,"lineCoords",19,()=>[]),l=V(e,"lineColor",19,()=>Ct.DARKGRAY),s=V(e,"lineType",3,1),a=V(e,"lineWidth",3,1),o=V(e,"className",3,"");const c=jt("axes");let d=g(()=>mt(r()[0][0],c.tX())),u=g(()=>mt(r()[1][0],c.tX())),f=g(()=>mt(r()[0][1],c.tY())),v=g(()=>mt(r()[1][1],c.tY())),m=g(()=>`stroke:${l()};stroke-width: ${a()}px;stroke-dasharray:${el[c.scales().plot][s()-1]}`);var h=ce(),p=X(h);{var w=b=>{var _=hf();Me(_,21,()=>t(d),qe,(S,y,C)=>{var L=mf();ne(()=>{O(L,"x1",t(d)[C]),O(L,"x2",t(u)[C]),O(L,"y1",t(f)[C]),O(L,"y2",t(v)[C]),ht(L,t(m))}),E(S,L)}),ne(()=>pt(_,0,vu(o()))),E(b,_)};B(p,b=>{t(d)&&t(f)&&t(u)&&b(w)})}E(n,h),ve()}var gf=xe('<text text-anchor="middle"><!></text>'),pf=xe("<text><!></text>"),bf=xe("<text><!></text>"),_f=xe('<g class="tick-labels"><!></g>');function gi(n,e){fe(e,!0);let r=V(e,"pos",3,1),l=V(e,"las",3,1),s=g(()=>["middle","middle","start","middle","end"][r()]),a=g(()=>`fill:${e.textColor};`);const o=jt("axes");let c=g(()=>mt(e.tickCoords[1][0],o.tX())),d=g(()=>mt(e.tickCoords[1][1],o.tY())),u=g(()=>Bs[o.scales().plot]),f=g(()=>[0,0,t(u),0,-t(u)][r()]),v=g(()=>[0,t(u),0,-t(u),0][r()]);var m=_f(),h=Y(m);{var p=b=>{var _=ce(),S=X(_);Me(S,17,()=>t(c),qe,(y,C,L)=>{var k=gf();O(k,"data-id",L),O(k,"dx",0);var P=Y(k);Pt(P,()=>e.tickLabels[L],!0),ne(()=>{O(k,"x",t(c)[L]),O(k,"y",t(d)[L]),O(k,"dy",t(f)*1.25),O(k,"transform",`rotate(-90, ${t(c)[L]}, ${t(d)[L]})`)}),E(y,k)}),E(b,_)},w=b=>{var _=ce(),S=X(_);{var y=L=>{var k=ce(),P=X(k);Me(P,17,()=>t(c),qe,(z,j,R)=>{var A=pf();O(A,"data-id",R),O(A,"dy",0),O(A,"text-anchor","end");var I=Y(A);Pt(I,()=>e.tickLabels[R],!0),ne(()=>{O(A,"x",t(c)[R]),O(A,"y",t(d)[R]),O(A,"dx",-t(v)/2),O(A,"transform",`rotate(-90, ${t(c)[R]}, ${t(d)[R]})`)}),E(z,A)}),E(L,k)},C=L=>{var k=ce(),P=X(k);Me(P,17,()=>t(c),qe,(z,j,R)=>{var A=bf();O(A,"data-id",R);var I=Y(A);Pt(I,()=>e.tickLabels[R],!0),ne(()=>{O(A,"x",t(c)[R]),O(A,"y",t(d)[R]),O(A,"dx",t(f)),O(A,"dy",t(v)),O(A,"text-anchor",t(s))}),E(z,A)}),E(L,k)};B(S,L=>{l()===2&&r()===1?L(y):L(C,!1)},!0)}E(b,_)};B(h,b=>{l()===2&&r()===4?b(p):b(w,!1)})}ne(()=>ht(m,t(a))),E(n,m),ve()}const wf=(n,e=Tt,r=Tt)=>{var l=Af();const s=g(()=>e().colmap.length);var a=X(l);Me(a,17,()=>e().colmap,qe,(f,v,m)=>{var h=Ef();const p=g(()=>r().start+m*r().width);var w=X(h),b=N(w);O(b,"dy",0);var _=Y(b);Pt(_,()=>e().labels[m],!0),ne(()=>{O(w,"x",t(p)),O(w,"y",r().top),O(w,"width",r().width),O(w,"height",r().height),O(w,"fill",t(v)),O(b,"x",t(p)),O(b,"y",r().ltop),O(b,"dx",r().dxl),O(b,"fill",e().labelColor),O(b,"font-size",e().fontSize+"em")}),E(f,h)});var o=N(a);{var c=f=>{var v=Sf();const m=g(()=>r().start+t(s)*r().width);O(v,"dx",0),O(v,"dy",0);var h=Y(v);Pt(h,()=>e().labels[t(s)],!0),ne(()=>{O(v,"x",t(m)),O(v,"y",r().ltop),O(v,"fill",e().labelColor),O(v,"font-size",`${e().fontSize??""}em`)}),E(f,v)};B(o,f=>{e().isCentered||f(c)})}var d=N(o);{var u=f=>{var v=Cf();const m=g(()=>r().start+t(s)*r().width);var h=Y(v);Pt(h,()=>qs(e().labelsFactor),!0),ne(()=>{O(v,"x",t(m)),O(v,"y",r().ltop),O(v,"fill",e().labelColor),O(v,"font-size",`${e().fontSize??""}em`)}),E(f,v)};B(d,f=>{e().labelsFactor!==0&&f(u)})}E(n,l)};function pi(n,e,r){n.preventDefault(),e(n,r())}function bi(n,e,r){n.preventDefault(),e(n,r())}function _i(n,e,r){n.preventDefault(),e(n,r())}function Ol(n,e,r){n.preventDefault(),e(n,r())}async function wi(n,e,r,l){lf(n.target,t(e),r(),l())}function yi(n,e,r){nf(t(e),r())}function xi(n,e,r,l,s,a){rf(t(e),r(),l(),s(),a())}var yf=xe('<text fill="crimson" text-anchor="middle"> </text>'),xf=xe('<text dy="10px" fill="crimson" text-anchor="middle" dominant-baseline="hanging"> </text>'),kf=xe("<!><!><!><!><!>",1),Ef=xe('<rect></rect><text dominant-baseline="hanging" text-anchor="middle"><!></text>',1),Sf=xe('<text dominant-baseline="hanging" text-anchor="middle"><!></text>'),Cf=xe('<text dx="1.2em" dy="-0.25em" dominant-baseline="hanging" text-anchor="right"><!></text>'),Af=xe("<!><!><!>",1),Tf=xe("<line></line>"),Pf=xe('<text dominant-baseline="middle" text-anchor="middle"> </text>'),Lf=xe('<svg><!><!><text class="legend-text" xml:space="preserve" dominant-baseline="middle" text-anchor="start"><!></text></svg>'),Nf=xe('<svg><rect height="100%" width="100%"></rect><!></svg>'),zf=xe('<text dominant-baseline="middle" style="font-size:1.1em;"><!></text>'),Rf=xe('<text dominant-baseline="middle" style="font-size:1.1em;"><!></text>'),Mf=xe('<text dominant-baseline="middle" style="font-size:1.2em;"><!></text>'),If=xe('<g class="plot-labels"><!><!><!></g>'),Ff=xe('<g class="axis x-axis"><!></g>'),jf=xe('<g class="axis y-axis"><!></g>'),Vf=xe('<rect fill="transparent" id="axes-box"></rect>'),Of=xe('<rect stroke="transparent" fill="transparent" id="axes-box"></rect>'),Bf=xe('<g class="colormap-legend" style="stroke:0;stroke-width:0px;"><!></g>'),qf=xe('<g class="group-legend" style="stroke:0;stroke-width:0px;"><!></g>'),Df=xe('<!><!><g class="axes-box"><!></g><g class="axes-content svelte-1jtdxd0"><!></g><!><!>',1),Yf=H('<p class="message-error svelte-1jtdxd0">Axes component was not properly initialized. <br/> Check that you defined axes limits and margins correctly.</p>'),Wf=H('<div class="download-links svelte-1jtdxd0"><button class="svelte-1jtdxd0">⇩ svg</button> <button class="svelte-1jtdxd0">⇩ png</button> <button class="svelte-1jtdxd0">⧉ copy</button></div>'),Uf=H(`<div><svg class="plot svelte-1jtdxd0" xmlns="http://www.w3.org/2000/svg"><style>.plot {
            font-family: Arial, Helvetica, sans-serif;
         }

         .plot-labels text {
            font-weight:bold;
            text-anchor:middle;
            user-select: none;
         }

         .series-points text {
            /* dominant-baseline: central;
            alignment-baseline: central */
         }

         .tick-labels text,
         .tick-labels tspan,
         .series-textlabels text,
         .series-textlabels tspan,
         .series-text text,
         .series-text tspan {
            dominant-baseline: middle;
            cursor: default;
            user-select: none;
            -webkit-user-select: none;
         }


         .colormap-legend text,
         .colormap-legend tspan,
         .series-points text,
         .series-points tspan {
            cursor: default;
            user-select: none;
            -webkit-user-select: none;
         }

         .series-points1 text,
         .series-points1 tspan {
            dominant-baseline: middle;
            alignment-baseline: middle;
         }

         .series-points2 text,
         .series-points2 tspan {
            dominant-baseline: central;
            alignment-baseline: central;
         }

         .series-text text,
         .series-text tspan {
            dominant-baseline: middle;
            alignment-baseline: middle;
            text-anchor: middle;
            user-select: none;
            -webkit-user-select: none;
         }

         .tick-labels text,
         .tick-labels tspan {
            user-select: none;
            -webkit-user-select: none;
         }</style><!><svg preserveAspectRatio="none" class="axes"><defs><clipPath><rect></rect></clipPath></defs><!></svg></svg> <!></div>`);function Xs(n,e){fe(e,!0);const r=(Se,Le=Tt,Ae=Tt)=>{var ze=ce(),_t=X(ze);{var dr=Yt=>{var ot=ce(),$e=X(ot);{var Mt=wt=>{var dt=yf(),sr=Y(dt);ne(()=>{O(dt,"x",t(Q)[0]-10),O(dt,"y",t(se)),O(dt,"transform",`rotate(-90, ${t(Q)[0]-10}, ${t(se)})`),ke(sr,Ae().error)}),E(wt,dt)},kt=wt=>{var dt=xf(),sr=Y(dt);ne(()=>{O(dt,"x",t($)),O(dt,"y",t(ae)[0]),ke(sr,Ae().error)}),E(wt,dt)};B($e,wt=>{Ae().pos===4?wt(Mt):wt(kt,!1)})}E(Yt,ot)},Bt=Yt=>{var ot=kf(),$e=X(ot);{var Mt=Te=>{Hs(Te,{get lineCoords(){return Le().grid},get lineColor(){return Ct.MIDDLEGRAY},lineType:3})};B($e,Te=>{Ae().showGrid&&Te(Mt)})}var kt=N($e);Hs(kt,{get lineCoords(){return Le().axisLine},get lineColor(){return Ct.DARKGRAY},lineType:1});var wt=N(kt);Hs(wt,{get lineCoords(){return Le().tickCoords},get lineColor(){return Ct.DARKGRAY},lineType:1});var dt=N(wt);{var sr=Te=>{gi(Te,{get las(){return Ae().las},get pos(){return Ae().pos},get tickCoords(){return Le().tickCoords},get tickLabels(){return Le().tickLabels},get tickColor(){return Ct.DARKGRAY},get hideLast(){return Ae().hideLast}})};B(dt,Te=>{Le().tickCoords.length===2&&Le().tickLabels.length===Le().tickCoords[1][0].length&&Te(sr)})}var Kr=N(dt);{var nt=Te=>{{let Nt=g(()=>[Le().tfLabel]);gi(Te,{get pos(){return Ae().pos},get tickCoords(){return Le().tfCoords},get tickLabels(){return t(Nt)},get textColor(){return Ct.DARKGRAY}})}};B(Kr,Te=>{Le().tickFactor!==0&&Te(nt)})}E(Yt,ot)};B(_t,Yt=>{Ae().error?Yt(dr):Yt(Bt,!1)})}E(Se,ze)},l=(Se,Le=Tt,Ae=Tt)=>{var ze=Nf();const _t=g(()=>Ae().elw+2*Ae().elp),dr=g(()=>Ae().elp),Bt=g(()=>Ae().elh),Yt=g(()=>Ae().ely);var ot=Y(ze),$e=N(ot);Me($e,17,()=>Le().items,qe,(Mt,kt,wt)=>{var dt=Lf();O(dt,"x",0);var sr=Y(dt);{var Kr=kr=>{var Et=Tf();ne(()=>{O(Et,"x1",t(dr)),O(Et,"x2",t(_t)-t(dr)),O(Et,"y1",t(Bt)[wt]/2),O(Et,"y2",t(Bt)[wt]/2),O(Et,"stroke",t(kt).line.lineColor),O(Et,"stroke-width",t(kt).line.lineWidth),O(Et,"stroke-dasharray",t(A)[t(kt).line.lineType-1])}),E(kr,Et)};B(sr,kr=>{t(kt).line&&kr(Kr)})}var nt=N(sr);{var Te=kr=>{var Et=Pf(),ua=Y(Et);ne(()=>{O(Et,"x",t(_t)/2),O(Et,"y",t(Bt)[wt]/2),O(Et,"fill",t(kt).point.faceColor),O(Et,"stroke-width",t(kt).point.lineWidth),O(Et,"stroke",t(kt).point.lineColor),O(Et,"font-size",`${t(kt).point.markerSize??""}em`),ke(ua,Rn[t(kt).point.marker-1])}),E(kr,Et)};B(nt,kr=>{t(kt).point&&kr(Te)})}var Nt=N(nt),Wl=Y(Nt);Pt(Wl,()=>t(kt).label,!0),ne(()=>{O(dt,"y",t(Yt)[wt]),O(dt,"width",Ae().lgw),O(dt,"height",t(Bt)[wt]),O(Nt,"x",t(_t)+t(dr)),O(Nt,"y",t(Bt)[wt]/2),O(Nt,"fill",Ct.LEGEND),O(Nt,"font-size",`${Le().fontSize??""}em`)}),E(Mt,dt)}),ne(()=>{O(ze,"x",Ae().lgl),O(ze,"y",Ae().lgt),O(ze,"height",Ae().lgh),O(ze,"width",Ae().lgw),O(ot,"fill",Le().faceColor),O(ot,"stroke",Le().lineColor),O(ot,"stroke-width",Le().lineWidth)}),E(Se,ze)};let s=V(e,"limX",19,()=>[0,1]),a=V(e,"limY",19,()=>[0,1]),o=V(e,"margins",19,()=>[1,1.1,.55,.6]),c=V(e,"downloadLinks",3,"none"),d=V(e,"fileName",3,"plot"),u=V(e,"pngWidth",3,8),f=V(e,"pngHeight",3,8),v=V(e,"pngRes",3,300),m=V(e,"clipboardWidth",3,1200),h=V(e,"clipboardHeight",3,800),p=V(e,"onclick",3,null),w=V(e,"onmousemove",3,null),b=V(e,"onmousedown",3,null),_=V(e,"onmouseup",3,null);function S(Se,Le){if(Le&&Se.target.id=="axes-box"){const Ae=ui([Se.offsetX-t(D)],t(K))[0],ze=ui([Se.offsetY-t(W)],t(J))[0];Le(Ae,ze)}}const y="plottingArea"+Math.round(Math.random()*1e4);let C=te(0),L=te(0),k=te(0);const P=g(()=>({plot:Qd(t(L),t(k)),x:hi(t(L)),y:hi(t(k))})),z=g(()=>o().map(Se=>Se*Yd[t(P).plot])),j=g(()=>Hd[t(P).plot]),R=g(()=>Os[t(P).plot]),A=g(()=>el[t(P).plot]),I=g(()=>t(Ce).show&&t(Ce).label!==""?t(j)*1.5:0),D=g(()=>t(me).show&&t(me).label!==""?t(j)*1.5:0),W=g(()=>e.title&&e.title!==""?t(j)*1.5:0),T=g(()=>t(L)>t(D)?t(L)-t(D):0),q=g(()=>t(k)>t(I)+t(W)?t(k)-t(I)-t(W):0),Z=g(()=>t(q)-t(z)[0]-t(z)[2]),M=g(()=>t(T)-t(z)[1]-t(z)[3]),U=g(()=>oi(s(),2)&&oi(a(),2)&&t(T)>t(z)[1]+t(z)[3]&&t(q)>t(z)[0]+t(z)[2]),K=g(()=>t(U)?{coords:[t(M)/(s()[1]-s()[0]),s()[0],t(z)[1]],objects:[t(M)/(s()[1]-s()[0]),0,0]}:{coords:[1,0,0],objects:[1,0,0]}),J=g(()=>t(U)?{coords:[-t(Z)/(a()[1]-a()[0]),a()[1],t(z)[2]],objects:[t(Z)/(a()[1]-a()[0]),0,0]}:{coords:[0,1,0],objects:[0,1,0]}),se=g(()=>t(Z)*.5+t(W)+t(z)[2]),$=g(()=>t(M)*.5+t(D)+t(z)[1]),Q=g(()=>t(U)?mt(s(),t(K)):[0,1]),ae=g(()=>t(U)?mt(a(),t(J)):[1,0]),_e=g(()=>Yr(e.title)),ie=g(()=>t(_e)?t(_e).length===e.title.left?1:1.4:0);let ye=te(Ne({show:!1})),Ce=te(Ne({show:!1,error:""})),me=te(Ne({show:!1,error:""})),he=te(Ne({show:!1,colmap:null,breaks:null})),pe=te(Ne({show:!1,items:null,position:null}));const Pe=g(()=>t(U)&&t(he)&&t(he).show?cf(t(he)):null),re=g(()=>t(U)&&t(Ce).show?af(s(),a(),t(P),t(J),t(Ce)):null),de=g(()=>t(U)&&t(me).show?of(s(),a(),t(P),t(K),t(me)):null),le=g(()=>t(U)&&t(Pe)?uf(t(Pe),t(M),t(z),t(P)):null),we=g(()=>t(U)&&t(pe)&&t(pe).show&&t(Q)?vf(t(pe),t(Q),t(ae),t(j),t(R)):null);Pc("axes",{setBox:Se=>F(ye,Se,!0),setXAxis:Se=>F(Ce,Se,!0),setYAxis:Se=>F(me,Se,!0),setColmapLegend:Se=>F(he,Se,!0),setGroupLegend:Se=>F(pe,Se,!0),scales:()=>t(P),tX:()=>t(K),tY:()=>t(J),limX:()=>s(),limY:()=>a()});var ue=Uf();let Ee;var Re=Y(ue),je=N(Y(Re));{var Ve=Se=>{var Le=If(),Ae=Y(Le);{var ze=ot=>{var $e=zf();O($e,"dx",0),O($e,"dy",0);var Mt=Y($e);Pt(Mt,()=>t(Ce).label,!0),ne(()=>{O($e,"x",t($)),O($e,"y",t(q)+t(W))}),E(ot,$e)};B(Ae,ot=>{t(Ce).show&&t(Ce).label&&t(Ce).label!==""&&ot(ze)})}var _t=N(Ae);{var dr=ot=>{var $e=Rf();O($e,"dx",0),O($e,"dy",0);var Mt=Y($e);Pt(Mt,()=>t(me).label,!0),ne(()=>{O($e,"x",t(j)/1.1*t(me).labelHeight),O($e,"y",t(se)),O($e,"transform",`rotate(-90, ${t(j)*t(me).labelHeight/1.1}, ${t(se)})`)}),E(ot,$e)};B(_t,ot=>{t(me).show&&t(me).label&&t(me).label!==""&&ot(dr)})}var Bt=N(_t);{var Yt=ot=>{var $e=Mf();O($e,"dx",0),O($e,"dy",0);var Mt=Y($e);Pt(Mt,()=>t(_e),!0),ne(()=>{O($e,"x",t($)),O($e,"y",t(j)*t(ie))}),E(ot,$e)};B(Bt,ot=>{t(_e)&&t(_e)!==""&&ot(Yt)})}E(Se,Le)};B(je,Se=>{t(U)&&Se(Ve)})}var tt=N(je),Ye=Y(tt),Be=Y(Ye),Ze=Y(Be),Xe=N(Ye);{var Ke=Se=>{var Le=Df(),Ae=X(Le);{var ze=nt=>{var Te=Ff(),Nt=Y(Te);r(Nt,()=>t(re),()=>t(Ce)),E(nt,Te)};B(Ae,nt=>{t(Ce).show&&t(re)&&nt(ze)})}var _t=N(Ae);{var dr=nt=>{var Te=jf(),Nt=Y(Te);r(Nt,()=>t(de),()=>t(me)),E(nt,Te)};B(_t,nt=>{t(me).show&&t(de)&&nt(dr)})}var Bt=N(_t),Yt=Y(Bt);{var ot=nt=>{var Te=Vf();Te.__keydown=[Ol,S,p],Te.__click=[Ol,S,p],Te.__mousemove=[_i,S,w],Te.__mousedown=[pi,S,b],Te.__mouseup=[bi,S,_],ne(()=>{O(Te,"stroke",t(ye).lineColor),O(Te,"stroke-width",`${t(ye).lineWidth??""}px`),O(Te,"x",t(Q)[0]),O(Te,"y",t(ae)[1]),O(Te,"width",t(Q)[1]-t(Q)[0]),O(Te,"height",t(ae)[0]-t(ae)[1])}),E(nt,Te)},$e=nt=>{var Te=Of();Te.__keydown=[Ol,S,p],Te.__click=[Ol,S,p],Te.__mousemove=[_i,S,w],Te.__mousedown=[pi,S,b],Te.__mouseup=[bi,S,_],ne(()=>{O(Te,"x",t(Q)[0]),O(Te,"y",t(ae)[1]),O(Te,"width",t(Q)[1]-t(Q)[0]),O(Te,"height",t(ae)[0]-t(ae)[1])}),E(nt,Te)};B(Yt,nt=>{t(ye).show?nt(ot):nt($e,!1)})}var Mt=N(Bt),kt=Y(Mt);Sr(kt,()=>e.children??Tt);var wt=N(Mt);{var dt=nt=>{var Te=Bf(),Nt=Y(Te);wf(Nt,()=>t(Pe),()=>t(le)),E(nt,Te)};B(wt,nt=>{t(le)&&nt(dt)})}var sr=N(wt);{var Kr=nt=>{var Te=qf(),Nt=Y(Te);l(Nt,()=>t(pe),()=>t(we)),E(nt,Te)};B(sr,nt=>{t(we)&&nt(Kr)})}ne(()=>O(Mt,"clip-path",`url(#${y})`)),E(Se,Le)};B(Xe,Se=>{t(U)&&Se(Ke)})}un(Re,Se=>F(C,Se),()=>t(C));var Qt=N(Re,2);{var Pr=Se=>{var Le=Yf();E(Se,Le)},Lr=Se=>{var Le=Wf(),Ae=Y(Le);Ae.__click=[yi,C,d],Ae.__keydown=[yi,C,d];var ze=N(Ae,2);ze.__click=[xi,C,d,u,f,v],ze.__keydown=[xi,C,d,u,f,v];var _t=N(ze,2);_t.__click=[wi,C,m,h],_t.__keydown=[wi,C,m,h],E(Se,Le)};B(Qt,Se=>{t(U)?Se(Lr,!1):Se(Pr)})}ne(Se=>{Ee=pt(ue,1,`plot-container show-download-links-${c()??""}`,"svelte-1jtdxd0",Ee,Se),ht(Re,`font-size:${t(j)??""}px`),O(tt,"x",t(D)),O(tt,"y",t(W)),O(tt,"width",t(T)),O(tt,"height",t(q)),O(Be,"id",y),O(Ze,"x",t(Q)[0]),O(Ze,"y",t(ae)[1]),O(Ze,"width",t(Q)[1]-t(Q)[0]),O(Ze,"height",t(ae)[0]-t(ae)[1])},[()=>({"plot-error":!t(U)})]),go(Re,"clientWidth",Se=>F(L,Se)),go(Re,"clientHeight",Se=>F(k,Se)),E(n,ue),ve()}vt(["keydown","click","mousemove","mousedown","mouseup"]);function Gs(n,e){fe(e,!0);let r=V(e,"tickLabels",7),l=V(e,"las",3,1),s=V(e,"whole",3,!1),a=V(e,"show",3,!0),o=V(e,"showGrid",3,!1);const c=jt("axes");ge(()=>{const d=Yr(e.label),u=d?d.length===e.label.length?1:1.4:0;let f,v="";e.ticks&&([f,v]=vi(e.ticks,c.limX())),!v&&r()&&(m=>{var h=Gl(m,2);r(h[0]),v=h[1]})(fi(r(),f)),c.setXAxis({show:a(),error:v,label:d,ticks:f,labelHeight:u,showGrid:o(),las:l(),whole:s(),tickLabels:r()})}),ve()}function Ks(n,e){fe(e,!0);let r=V(e,"tickLabels",7),l=V(e,"las",3,1),s=V(e,"whole",3,!1),a=V(e,"show",3,!0),o=V(e,"showGrid",3,!1);const c=jt("axes");ge(()=>{const d=Yr(e.label),u=d?d.length===e.label.length?1:1.4:0;let f,v="";e.ticks&&([f,v]=vi(e.ticks,c.limY())),!v&&r()&&(m=>{var h=Gl(m,2);r(h[0]),v=h[1]})(fi(r(),f)),c.setYAxis({show:a(),error:v,label:d,ticks:f,labelHeight:u,showGrid:o(),las:l(),whole:s(),tickLabels:r(),pos:4})}),ve()}function Js(n,e){fe(e,!0);let r=V(e,"lineWidth",3,1),l=V(e,"lineColor",3,"#606060");const s=jt("axes");ge(()=>{s.setBox({show:!0,lineWidth:r(),lineColor:l()})}),ve()}var Hf=(n,e)=>pn(n,"rect",e.onclick),Xf=xe("<rect></rect>"),Gf=xe("<g></g>");function Mn(n,e){fe(e,!0);let r=V(e,"faceColor",19,()=>Ct.PRIMARY),l=V(e,"lineColor",19,r),s=V(e,"lineWidth",3,1),a=V(e,"className",3,"series-rect");const o=g(()=>Rt(e.left,"Rectangles (left)")),c=g(()=>t(o)?Rt(e.top,"Rectangles (top)",t(o).length):null),d=g(()=>t(c)?typeof e.width!="object"?Ie.fill(e.width,t(o).length):e.width:null),u=g(()=>t(c)?typeof e.height!="object"?Ie.fill(e.height,t(o).length):e.height:null),f=jt("axes"),v=g(()=>t(o)?mt(t(o),f.tX()):null),m=g(()=>t(c)?mt(t(c),f.tY()):null),h=g(()=>t(d)?tl(t(d),f.tX()):null),p=g(()=>t(u)?tl(t(u),f.tY()):null),w=g(()=>`fill:${r()};stroke:${l()};stroke-width:${s()}px;`),b=g(()=>t(v)&&t(m)&&t(h)&&t(p)&&t(h).length===t(v).length&&t(p).length===t(v).length);var _=ce(),S=X(_);{var y=C=>{var L=Gf();L.__click=[Hf,e],Me(L,21,()=>e.left,qe,(k,P,z)=>{var j=Xf();ne(()=>{O(j,"x",t(v)[z]),O(j,"y",t(m)[z]),O(j,"width",t(h)[z]),O(j,"height",t(p)[z])}),E(k,j)}),ne(()=>{pt(L,0,`series ${a()??""}`),ht(L,t(w))}),E(C,L)};B(S,C=>{t(b)&&C(y)})}E(n,_),ve()}vt(["click"]);var Kf=(n,e)=>pn(n,"line",e.onclick),Jf=xe("<line></line>"),Qf=xe('<g class="series series-segment"></g>');function bn(n,e){fe(e,!0);let r=V(e,"lineColor",19,()=>Ct.PRIMARY),l=V(e,"lineType",3,1),s=V(e,"lineWidth",3,1);const a=g(()=>Rt(e.xStart,"Segments")),o=g(()=>t(a)?Rt(e.yStart,"Segments",t(a).length):null),c=g(()=>t(o)?Rt(e.xEnd,"Segments",t(a).length):null),d=g(()=>t(c)?Rt(e.yEnd,"Segments",t(a).length):null),u=jt("axes"),f=g(()=>t(a)?mt(t(a),u.tX()):null),v=g(()=>t(c)?mt(t(c),u.tX()):null),m=g(()=>t(o)?mt(t(o),u.tY()):null),h=g(()=>t(d)?mt(t(d),u.tY()):null),p=g(()=>`stroke:${r()};stroke-width: ${s()}px;stroke-dasharray:${el[u.scales().plot][l()-1]}`),w=g(()=>t(f)&&t(v)&&t(m)&&t(h));var b=ce(),_=X(b);{var S=y=>{var C=Qf();C.__click=[Kf,e],Me(C,21,()=>t(f),qe,(L,k,P)=>{var z=Jf();ne(()=>{O(z,"x1",t(f)[P]),O(z,"x2",t(v)[P]),O(z,"y1",t(m)[P]),O(z,"y2",t(h)[P])}),E(L,z)}),ne(()=>ht(C,t(p))),E(y,C)};B(_,y=>{t(w)&&y(S)})}E(n,b),ve()}vt(["click"]);var Zf=(n,e)=>pn(n,"text",e.onclick),$f=xe("<text><!></text>"),ev=xe("<text><!></text>"),tv=xe("<text><!></text>"),rv=xe('<g class="series series-textlabels"><!></g>');function _n(n,e){fe(e,!0);let r=V(e,"pos",3,0),l=V(e,"faceColor",19,()=>Ct.PRIMARY_TEXT),s=V(e,"lineColor",3,"transparent"),a=V(e,"lineWidth",3,0),o=V(e,"textSize",3,1),c=V(e,"rotateAngle",3,0);const d=["middle","middle","start","middle","end"],u=g(()=>Rt(e.xValues,"TextLabels")),f=g(()=>t(u)?Rt(e.yValues,"TextLabels",t(u).length):null),v=g(()=>t(f)?Array.isArray(e.labels)&&e.labels.length!==t(f).length?(console.error('TextLabels: number of elements in "labels" does not match number of coordinates'),null):e.labels:null),m=g(()=>t(v)?typeof e.labels=="string"&&typeof r()!="number"?(console.error('TextLabels: parameter "labels" is provided as single string, so "pos" must be a single number.'),null):r():null),h=jt("axes"),p=g(()=>t(u)&&t(m)!==null?mt(t(u),h.tX()):null),w=g(()=>t(f)&&t(p)?mt(t(f),h.tY()):null),b=g(()=>Bs[h.scales().plot]),_=g(()=>[0,0,-t(b),0,t(b),t(b)]),S=g(()=>[0,t(b),0,-t(b),0,t(b)]),y=g(()=>`fill:${l()};stroke-width:${a()}px;stroke:${s()};font-size:${o()}em;`),C=g(()=>t(p)&&t(w)&&t(m)!==null&&t(v)&&t(p).length===t(w).length);var L=ce(),k=X(L);{var P=z=>{var j=rv();j.__click=[Zf,e];var R=Y(j);{var A=D=>{var W=ce(),T=X(W);Me(T,17,()=>t(p),qe,(q,Z,M)=>{var U=$f();O(U,"data-id",M);var K=Y(U);Pt(K,()=>e.labels,!0),ne(()=>{O(U,"x",t(p)[M]),O(U,"y",t(w)[M]),O(U,"dx",t(_)[r()]),O(U,"dy",t(S)[r()]),O(U,"transform",c()!==void 0?`rotate(${c()}, ${t(p)[M]+t(_)[r()]}, ${t(w)[M]+t(S)[r()]})`:""),O(U,"text-anchor",d[r()[M]])}),E(q,U)}),E(D,W)},I=D=>{var W=ce(),T=X(W);{var q=M=>{var U=ce(),K=X(U);Me(K,17,()=>t(p),qe,(J,se,$)=>{var Q=ev();O(Q,"data-id",$);var ae=Y(Q);Pt(ae,()=>e.labels[$],!0),ne(()=>{O(Q,"x",t(p)[$]),O(Q,"y",t(w)[$]),O(Q,"dx",t(_)[r()[$]]),O(Q,"dy",t(S)[r()[$]]),O(Q,"transform",c()!==void 0?`rotate(${c()}, ${t(p)[$]+t(_)[r()]}, ${t(w)[$]+t(S)[r()]})`:""),O(Q,"text-anchor",d[r()[$]])}),E(J,Q)}),E(M,U)},Z=M=>{var U=ce(),K=X(U);Me(K,17,()=>t(p),qe,(J,se,$)=>{var Q=tv();O(Q,"data-id",$);var ae=Y(Q);Pt(ae,()=>e.labels[$],!0),ne(()=>{O(Q,"x",t(p)[$]),O(Q,"y",t(w)[$]),O(Q,"dx",t(_)[r()]),O(Q,"dy",t(S)[r()]),O(Q,"transform",c()!==void 0?`rotate(${c()}, ${t(p)[$]+t(_)[r()]}, ${t(w)[$]+t(S)[r()]})`:""),O(Q,"text-anchor",d[r()])}),E(J,Q)}),E(M,U)};B(T,M=>{Array.isArray(r())||ArrayBuffer.isView(r())?M(q):M(Z,!1)},!0)}E(D,W)};B(R,D=>{typeof e.labels=="string"?D(A):D(I,!1)})}ne(()=>ht(j,t(y))),E(z,j)};B(k,z=>{t(C)&&z(P)})}E(n,L),ve()}vt(["click"]),vt(["click"]);function nv(n,e){fe(e,!0);let r=V(e,"barWidth",3,.8),l=V(e,"faceColor",19,()=>Ct.PRIMARY),s=V(e,"lineColor",19,()=>Ct.PRIMARY),a=V(e,"lineWidth",3,1);const o=g(()=>r()<=0||r()>1?(console.error('Bars: parameter "barWidth" should be between 0 and 1.'),null):r()),c=g(()=>{if(!t(o))return null;const h=Rt(e.xValues,"BarSeries");if(!h)return null;const p=h.length;if(p<1)return null;let w;if(e.barWidthExact)w=e.barWidthExact;else{if(p==1)return console.error('Bars: if only one bar must be shown, value for property "barWidthExact" should be provided.'),null;{w=0;let y=0;for(let C=1;C<p;C++)y=Math.abs(h.v[C-1]-h.v[C]),y>w&&(w=y)}}w=w*r();const b=w/2,_=Ie.zeros(p),S=Ie.zeros(p);for(let y=0;y<p;y++)_.v[y]=h.v[y]-b,S.v[y]=w;return{left:_,width:S}}),d=g(()=>{if(!t(c))return null;const h=Rt(e.yValues,"BarSeries");if(!h)return null;const p=h.length;if(p!==t(c).left.length)return console.error('BarSeries: parameters "yValues" must be vector of the same length as "xValues".'),null;const w=Ie.zeros(p),b=Ie.zeros(p);for(let _=0;_<p;_++){const S=h.v[_];w.v[_]=S>0?S:0,b.v[_]=Math.abs(S)}return{top:w,height:b}}),u=g(()=>t(c)&&t(d));var f=ce(),v=X(f);{var m=h=>{Mn(h,{className:"series series-bar",get left(){return t(c).left},get width(){return t(c).width},get top(){return t(d).top},get height(){return t(d).height},get lineWidth(){return a()},get lineColor(){return s()},get faceColor(){return l()},get onclick(){return e.onclick}})};B(v,h=>{t(u)&&h(m)})}E(n,f),ve()}var lv=(n,e)=>pn(n,"text",e.onclick),sv=xe("<text> </text>"),av=xe('<g text-anchor="middle"></g>');function ov(n,e){fe(e,!0);let r=V(e,"marker",3,1),l=V(e,"faceColor",3,"transparent"),s=V(e,"lineColor",19,()=>Ct.PRIMARY),a=V(e,"lineWidth",3,1),o=V(e,"markerSize",3,1);const c=g(()=>typeof r()!="number"||r()<1||r()>Rn.length?(console.error('Points: parameter "marker" must be a number from 1 to '+Rn.length+"."),null):Rn[r()-1]),d=g(()=>Rt(e.xValues,"Points")),u=g(()=>t(d)?Rt(e.yValues,"Points",t(d).length):null),f=jt("axes"),v=g(()=>t(d)?mt(t(d),f.tX()):null),m=g(()=>t(v)&&t(u)?mt(t(u),f.tY()):null),h=g(()=>["＋","✳","✕"].includes(t(c))?`fill:${s()&&s()!=="transparent"?s():l()};stroke-width:0px;font-size:${o()}em;`:`fill:${l()};stroke-width:${a()}px;stroke:${s()}; font-size:${o()}em;`),p=g(()=>["◼","⬥","＋","✳","✕"].includes(t(c))?"series-points2":"series-points1"),w=g(()=>t(v)&&t(m)&&t(v).length===t(m).length);var b=ce(),_=X(b);{var S=y=>{var C=av();C.__click=[lv,e],Me(C,21,()=>t(v),qe,(L,k,P)=>{var z=sv(),j=Y(z);ne(()=>{O(z,"x",t(v)[P]),O(z,"y",t(m)[P]),ke(j,t(c))}),E(L,z)}),ne(()=>{pt(C,0,`series series-points ${t(p)??""}`),ht(C,t(h))}),E(y,C)};B(_,y=>{t(w)&&y(S)})}E(n,b),ve()}vt(["click"]);var iv=(n,e)=>pn(n,"polyline",e.onclick),cv=xe('<g class="series series-line"><polyline class="line"></polyline></g>');function yr(n,e){fe(e,!0);let r=V(e,"lineColor",19,()=>Ct.PRIMARY),l=V(e,"lineType",3,1),s=V(e,"lineWidth",3,1);const a=g(()=>Rt(e.xValues,"Lines")),o=g(()=>t(a)?Rt(e.yValues,"Lines",t(a).length):null),c=jt("axes"),d=g(()=>t(a)&&t(o)?Ys(t(a),t(o),c.tX(),c.tY()):null),u=g(()=>`fill:transparent;stroke:${r()};stroke-width: ${s()}px; stroke-dasharray:${el[c.scales().plot][l()-1]}`);var f=ce(),v=X(f);{var m=h=>{var p=cv();p.__click=[iv,e];var w=Y(p);ne(()=>{ht(p,t(u)),O(w,"points",t(d))}),E(h,p)};B(v,h=>{t(d)&&h(m)})}E(n,f),ve()}vt(["click"]);var uv=(n,e)=>pn(n,"polyline",e.onclick),dv=xe('<polyline class="line"></polyline>'),fv=xe('<g class="series series-multiline"></g>');function ki(n,e){fe(e,!0);let r=V(e,"lineColor",19,()=>Ct.PRIMARY),l=V(e,"lineType",3,1),s=V(e,"lineWidth",3,1);const a=g(()=>Rt(e.xValues,"Multilines")),o=g(()=>t(a)?lr(e.yValues)?(t(a).length!==e.yValues.nrows&&console.error('Multilines: parameter "xValues" must have the same number of values as number of rows in "yValues".'),e.yValues):(console.error('Multilines: parameter "yValues" must be a matrix.'),null):null),c=jt("axes"),d=g(()=>{if(!t(a)||!t(o))return null;const h=new Array(t(o).ncols);for(let p=0;p<h.length;p++)h[p]=Ys(t(a),t(o).getcolumn(p+1),c.tX(),c.tY());return h}),u=g(()=>`fill:transparent;stroke:${r()};stroke-width: ${s()}px; stroke-dasharray:${el[c.scales().plot][l()-1]}`);var f=ce(),v=X(f);{var m=h=>{var p=fv();p.__click=[uv,e],Me(p,21,()=>t(d),qe,(w,b)=>{var _=dv();ne(()=>O(_,"points",t(b))),E(w,_)}),ne(()=>ht(p,t(u))),E(h,p)};B(v,h=>{t(d)&&t(d).length>0&&h(m)})}E(n,f),ve()}vt(["click"]);function vv(...n){const e=n.length,r=n.map(o=>o.length);let l=Ss(r),s=Array(e),a=1;for(let o=0;o<e;o++){const c=De(n[o])?n[o]:Ge(n[o]),d=c.length;l=l/d,s[o]=c.subset(bt.seq(1,d).repeach(a).rep(l)),a=a*d}return s}var mv=xe("<rect></rect>"),hv=xe('<g title="heatmap-group"><!></g>'),gv=xe('<g class="heatmap" style="stroke:0;stroke-width:0px;"></g>');function pv(n,e){fe(e,!0);let r=V(e,"colmap",3,null),l=g(()=>lr(e.values)&&e.values.nrows>0&&e.values.ncols>0?e.values:null),s=g(()=>t(l)?e.breaks&&Array.isArray(e.breaks)?e.breaks:e.breaks&&De(e.breaks)?e.breaks.v:Rl(t(l).v,Kd).v:null),a=g(()=>r()?Array.isArray(r())?r().length!==e.breaks.length-1?(console.error("Heatmap: number of color values in colormap does not match number of intervals defined by breaks."),null):r():(console.error('Heatmap: parameter "colmap" must be array with colors.'),null):Us(t(s).length-1)),o=g(()=>t(l)?ai(t(l).ncols):null),c=g(()=>t(l)?ai(t(l).nrows):null),d=g(()=>t(o)&&t(c)?vv(t(c),t(o)):null),u=g(()=>{if(!t(d)||!t(s)||!t(a))return null;const[y,C]=t(d),L=C.length,k=t(s).length,P=Array(k).fill().map(()=>[]),z=Array(k).fill().map(()=>[]),j=t(s).slice(),R=j[1]-j[0];j[0]=j[0]-.1*R,j[k-1]=j[k-1]+.1*R;for(let A=0;A<L;A++){const I=t(l).v[A];for(let D=0;D<k-1;D++)if(I>j[D]&&I<=j[D+1]){P[D].push(C.v[A]-.5),z[D].push(t(l).nrows-y.v[A]+1.5);break}}return{rl:P,rt:z}});const f=jt("axes");let v=g(()=>t(u)?t(u).rl.map(y=>y.length>0?mt(y,f.tX()):[]):null),m=g(()=>t(u)?t(u).rt.map(y=>y.length>0?mt(y,f.tY()):[]):null),h=g(()=>tl([1],f.tX())),p=g(()=>tl([1],f.tY())),w=g(()=>t(v)&&t(m)&&t(v).length===t(m).length);var b=ce(),_=X(b);{var S=y=>{var C=gv();Me(C,21,()=>t(a),qe,(L,k,P)=>{var z=hv(),j=Y(z);{var R=A=>{var I=ce(),D=X(I);Me(D,17,()=>t(v)[P],qe,(W,T,q,Z)=>{var M=mv();ne(()=>{O(M,"x",t(v)[P][q]),O(M,"y",t(m)[P][q]),O(M,"width",t(h)),O(M,"height",t(p))}),E(W,M)}),E(A,I)};B(j,A=>{t(v)[P].length>0&&A(R)})}ne(()=>ht(z,`fill:${t(k)??""};`)),E(L,z)}),E(y,C)};B(_,y=>{t(w)&&y(S)})}E(n,b),ve()}function rl(n,e){fe(e,!0);let r=V(e,"show",3,!0),l=V(e,"position",3,"topleft"),s=V(e,"lineColor",19,()=>Ct.LEGEND),a=V(e,"lineWidth",3,1),o=V(e,"faceColor",3,"#fff"),c=V(e,"fontSize",3,.85);function d(v){return typeof v!="string"?(console.error('Legend: value of "position" must be a string.'),null):["top","left","right","topleft","topright","bottom","bottomleft","bottomright"].includes(v)?v:(console.error('Legend: wrong value of "position" property'),null)}function u(v){if(!v||!Array.isArray(v)||v.length<1)return console.error('Legend: property "items" must be provided as array of JSONs.'),null;for(let m=0;m<v.length;m++){const h=v[m];if(!h.label)return console.error('Legend: all elements of "items" must include at least one field: "label".'),null;const p=Yr(h.label),w=p.length===h.label?1:1.4;h.label=p,h.labelHeight=w,h.line&&(h.line.lineType||(h.line.lineType=1),h.line.lineType>0&&h.line.lineType<=4||console.error('Legend: parameter "lineType" for legend item '+(m+1)+" is incorrect."),h.line.lineColor=h.line.lineColor?h.line.lineColor:Ct.PRIMARY,h.line.lineWidth=h.line.lineWidth?h.line.lineWidth:1),h.point&&(h.point.marker||(h.point.marker=1),h.point.marker>0&&h.point.marker<=Rn.length||console.error('Legend: parameter "marker" for legend item '+(m+1)+" is incorrect."),h.point.faceColor=h.point.faceColor?h.point.faceColor:"transparent",h.point.lineWidth=h.point.lineWidth?h.point.lineWidth:1,h.point.markerSize=h.point.markerSize?h.point.markerSize:1,h.point.lineColor=h.point.lineColor?h.point.lineColor:Ct.PRIMARY)}return v}const f=jt("axes");ge(()=>{const v=u(e.items),m=d(l());f.setGroupLegend(v&&m?{show:r(),position:l(),items:e.items,lineColor:s(),faceColor:o(),lineWidth:a(),fontSize:c()}:{show:!1,position:null,items:null})}),ve()}function Ei(n,e){fe(e,!0);let r=V(e,"show",3,!0),l=V(e,"labels",3,null),s=V(e,"labelColor",19,()=>Ct.CLEGEND_LABELS),a=V(e,"fontSize",3,.85);const o=jt("axes");ge(()=>{o.setColmapLegend({show:r(),breaks:e.breaks,colmap:e.colmap,labels:l(),labelColor:s(),fontSize:a()})}),ve()}const bv=n=>n;function Si(n,{delay:e=0,duration:r=400,easing:l=bv}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:r,easing:l,css:a=>`opacity: ${a*s}`}}var _v=H('<div><div class="modal svelte-q7wo60"><div class="header svelte-q7wo60"><button class="close-button svelte-q7wo60">✕</button></div> <div class="body svelte-q7wo60"><!></div></div></div>');function Qs(n,e){fe(e,!0);let r=V(e,"isDark",3,!1);function l(v){v.key==="Escape"&&e.closeModal()}var s=_v();on("keydown",is,l);let a;var o=Y(s),c=Y(o),d=Y(c);d.__click=function(...v){var m;(m=e.closeModal)==null||m.apply(this,v)};var u=N(c,2),f=Y(u);Sr(f,()=>e.children),ne(v=>a=pt(s,1,"drop svelte-q7wo60",null,a,v),[()=>({isdark:r()})]),ho(7,s,()=>Si),E(n,s),ve()}vt(["click"]);const wv=[1,1.1,.45,.4],Wr={cal:1,pv:2,test:2,new:2},Ur={cal:"#2679B2",pv:"#D22C2F",test:"#a05e5e",new:"#5e85a0"},Ci={cal:"#f0f8ff",pv:"#f4e5e5",test:"#fff0f8",new:"#f0f8ff"},nl={cal:"#2679B230",pv:"#D22C2F30",test:"#f05e5e30",new:"#5e85a030"},Zs="#808090",Bl="#a0a0a0",Ai="#909090",ll="#909090",Ti=8,yv=8,xv=8,kv=600;function Ev(n,e,r){const l=e.length,s=new Array(n.length),a=e[1]-e[0];for(let o=0;o<n.length;o++)for(let c=0;c<l-1;c++){const d=n[o]>=e[c],u=c===l-2?n[o]<e[c+1]+a:n[o]<e[c+1];if(d&&u){s[o]=r[c];break}}return s}function Pi(n,e,r,l){if(!n||!e)return null;const s=n.length;let a=Ie.zeros(s),o=Number.NEGATIVE_INFINITY,c=Number.POSITIVE_INFINITY;if(l==="log")for(let d=0;d<s;d++){const u=Math.log(1+n[d]/r);a.v[d]=u,o=Math.max(o,u),c=Math.min(c,u)}else for(let d=0;d<s;d++){const u=n[d]/r;a.v[d]=u,o=Math.max(o,u),c=Math.min(c,u)}return{values:a,min:c,max:o}}function Li(n,e){return{z:"Full y-distance",f:"Full x-distance",q:"Orthogonal distance",h:"Score distance"}[n]+", "+(e==="log"?"log(1 + "+n+"/"+n+"0)":n+"/"+n+"0")}function Ni(n,e,r,l){const a=e+r,c=Po(n,a)/r,d=-e/r,u=-c/d,f=Ie.seq(0,u*1,u/100),v=f.apply(m=>m*d+c);return{x:l==="log"?f.apply(m=>Math.log(1+m)):f,y:l==="log"?v.apply(m=>Math.log(1+m)):v}}function Sv(n,e,r,l=4){const s=Math.abs(r-e);let a;return s<1?a=Math.min(Math.round(Math.abs(Math.log10(s))+1),l):s<10?a=2:s<100?a=1:a=0,Array.from(n).map(o=>o.toFixed(a).toString())}function sl(n,e=nl){return n?n.map(r=>({id:r,label:r,point:{marker:Wr[r],faceColor:e[r],lineColor:Ur[r],markerSize:Wr[r]===1?.85:.65,lineWidth:1.5}})):null}var Cv=H("<!> <!> <!> <!>",1);function xr(n,e){let r=V(e,"whole",3,!1),l=dn(e,["$$slots","$$events","$$legacy","title","limX","limY","xLabel","yLabel","whole","fileName","children"]);Xs(n,Br({get title(){return e.title},get limX(){return e.limX},get limY(){return e.limY},get fileName(){return e.fileName},downloadLinks:"hover",get margins(){return wv},get pngWidth(){return yv},get pngHeight(){return xv},get pngRes(){return kv}},()=>l,{children:(s,a)=>{var o=Cv(),c=X(o);Sr(c,()=>e.children);var d=N(c,2);Gs(d,{showGrid:!0,get label(){return e.xLabel},get whole(){return r()}});var u=N(d,2);Ks(u,{showGrid:!0,get label(){return e.yLabel}});var f=N(u,2);Js(f,{}),E(s,o)},$$slots:{default:!0}}))}function Av(n,e){if(n.target.tagName!=="rect"){F(e,-1);return}const r=Array.from(n.target.parentNode.children).indexOf(n.target);if(r<0){F(e,-1);return}t(e)!==r&&F(e,r,!0)}var Tv=H("<!> <!> <!>",1),Pv=H("<!> <!> <!> <!> <!>",1),Lv=H("<div><!></div>"),Nv=H('<div class="wrapper svelte-ha02r1"><div class="plot-container svelte-ha02r1" role="tooltip"><!></div> <div class="msg-select svelte-ha02r1">click inside the plot to see a variable label</div> <div class="plot-controls svelte-ha02r1"><div><!></div> <!></div></div>');function $s(n,e){fe(e,!0);let r=V(e,"outliers",19,()=>[]),l=V(e,"model_getter",3,Du),s=V(e,"res_getter",3,Bo),a=te("residual"),o=te(-1);const c=g(()=>e.res?Object.keys(e.res):null);let d=te(Ne(t(c)?t(c)[0]:null));const u=g(()=>{if(!e.model)return null;const K=e.model.nresp?e.model.nresp:0,J=Ge(e.model.varvalues.filter((ye,Ce)=>Ce>=K)),se=J.length,$=(J.v[1]-J.v[0])/2,Q=(J.v[se-1]-J.v[se-2])/2,ae=[J.v[0],J.v[se-1]],_e=[ae[0]-$,ae[1]+Q],ie=(ae[1]-ae[0])/se;return{values:J,lim:_e,width:ie,hwidth:ie*.5}}),f=g(()=>t(u)?t(u).values.apply(K=>K-t(u).hwidth):null),v=g(()=>t(d)?e.res[t(d)]:null),m=g(()=>t(v)?new it(s()(t(v),"T"),t(v).nrows,t(v).ncomp):null),h=g(()=>t(v)?new it(s()(t(v),"E"),t(v).nrows,t(v).npred).t():null),p=g(()=>e.model?new it(l()(e.model,"P"),e.model.npred?e.model.npred:e.model.ncols,e.model.ncomp):null),w=g(()=>e.ncomp?bt.seq(1,e.ncomp):null),b=g(()=>e.ncomp<e.model.ncomp?bt.seq(e.ncomp+1,e.model.ncomp):null),_=g(()=>t(m)&&t(w)?t(m).subset(null,t(w)):null),S=g(()=>t(m)&&t(w)?t(p).subset(null,t(w)):null),y=g(()=>t(m)&&t(b)?t(m).subset(null,t(b)):null),C=g(()=>t(m)&&t(b)?t(p).subset(null,t(b)):null),L=g(()=>t(_)&&t(S)?zo(t(S),t(_)):null),k=g(()=>t(y)&&t(C)?zo(t(C),t(y)).add(t(h)):t(h)),P=g(()=>t(L)&&t(k)?t(L).add(t(k)):null);let z=g(()=>t(L)?t(L).getcolumn(e.selected+1):null),j=g(()=>t(k)?t(k).getcolumn(e.selected+1):null),R=g(()=>t(P)?t(P).getcolumn(e.selected+1):null),A=g(()=>{if(!t(z)||!t(j)||!t(R))return null;const K=t(a)==="explained"?{all:t(L),sel:t(z),label:"Explained part, TP^T"}:t(a)==="residual"?{all:t(k),sel:t(j),label:"Residuals, E"}:{all:t(P),sel:t(R),label:"Preprocessed data, X"},J=Tr(K.all.v),se=J[1]-J[0],$=[J[0]-se/50,J[1]+se/12],Q=Ie.fill(J[1],K.sel.length);return K.lim=$,K.top=Q,K.height=se,K});const I=g(()=>t(u)&&t(o)>=0?t(u).values.v[t(o)]:null),D=g(()=>t(A)&&t(o)>=0?t(A).sel.v[t(o)]:null),W=g(()=>e.model&&t(o)>=0?e.model.varlabels[t(o)]:null),T=g(()=>t(v)&&e.selected>=0?`Object ${t(v).objlabels[e.selected].replace("_","-")}`:null),q=g(()=>e.model?e.model.varvaluesName+(e.model.varvaluesUnits?", "+e.model.varvaluesUnits:""):null);var Z=ce(),M=X(Z);{var U=K=>{Qs(K,{get closeModal(){return e.closeModal},children:(J,se)=>{var $=Nv(),Q=Y($);Q.__click=[Av,o];var ae=Y(Q);xr(ae,{get title(){return t(T)},get yLabel(){return t(A).label},get xLabel(){return t(q)},get limY(){return t(A).lim},get limX(){return t(u).lim},fileName:"plot-contributions",children:(he,pe)=>{var Pe=Pv(),re=X(Pe);ki(re,{get xValues(){return t(u).values},get yValues(){return t(A).all},lineColor:"#e0e0e0"});var de=N(re,2);{var le=je=>{var Ve=ce(),tt=X(Ve);Me(tt,17,r,qe,(Ye,Be)=>{{let Ze=g(()=>t(A).all.getcolumn(t(Be)+1));yr(Ye,{get xValues(){return t(u).values},get yValues(){return t(Ze)},lineColor:"#ffdd88"})}}),E(je,Ve)};B(de,je=>{r().length>0&&je(le)})}var we=N(de,2);yr(we,{get xValues(){return t(u).values},get yValues(){return t(A).sel},lineColor:"crimson"});var ue=N(we,2);Mn(ue,{get left(){return t(f)},get top(){return t(A).top},get height(){return t(A).height},get width(){return t(u).width},faceColor:"transparent",borderColor:"transparent"});var Ee=N(ue,2);{var Re=je=>{var Ve=Tv(),tt=X(Ve);{let Ze=g(()=>[t(I)]),Xe=g(()=>[t(A).top.v[0]]),Ke=g(()=>[t(W)]);_n(tt,{get xValues(){return t(Ze)},get yValues(){return t(Xe)},get labels(){return t(Ke)},pos:3,textSize:.85})}var Ye=N(tt,2);{let Ze=g(()=>[t(I)]),Xe=g(()=>[t(D)]);ov(Ye,{get xValues(){return t(Ze)},get yValues(){return t(Xe)},faceColor:"crimson",lineColor:"crimson"})}var Be=N(Ye,2);{let Ze=g(()=>[t(f).v[t(o)]]),Xe=g(()=>[t(A).top.v[t(o)]]);Mn(Be,{get left(){return t(Ze)},get top(){return t(Xe)},get height(){return t(A).height},get width(){return t(u).width},faceColor:"#ff000015"})}E(je,Ve)};B(Ee,je=>{t(o)>=0&&je(Re)})}E(he,Pe)},$$slots:{default:!0}});var _e=N(Q,4),ie=Y(_e),ye=Y(ie);oe(ye,{label:"Show",children:(he,pe)=>{He(he,{id:"type",options:["full","explained","residual"],get value(){return t(a)},set value(Pe){F(a,Pe,!0)}})},$$slots:{default:!0}});var Ce=N(ie,2);{var me=he=>{var pe=Lv(),Pe=Y(pe);oe(Pe,{label:"For",children:(re,de)=>{He(re,{id:"type",get options(){return t(c)},get value(){return t(d)},set value(le){F(d,le,!0)}})},$$slots:{default:!0}}),E(he,pe)};B(Ce,he=>{t(c).length>1&&he(me)})}E(J,$)},$$slots:{default:!0}})};B(M,K=>{t(u)&&t(A)&&K(U)})}E(n,Z),ve()}vt(["click"]);function zv(n,e){let r=0,l=0;n.nresp>0&&(r=new Ie(n.values.v.slice(0,n.values.nrows)),l=1);const s=new it(n.values.v.slice(l*n.values.nrows),n.values.nrows,n.values.ncols-l).t(),a=s.ncols<e?1:Math.round(s.ncols/e),o=bt.seq(1,s.ncols,a),c=s.subset(null,o),d=r?r.subset(o):null,u=n.classes?n.classes.filter((f,v)=>o.v.includes(v)):null;return{classNames:n.classNames,classes:u,resp:d,values:c,varvalues:n.varvalues.filter((f,v)=>v>=l),varindices:n.varindices.filter((f,v)=>v>=l),varaxisLabel:n.varvaluesUnits?n.varvaluesName+" "+n.varvaluesUnits:n.varvaluesName,varaxisUnits:n.varvaluesUnits}}function ea(n,e){return{values:e||n.values.copy(),varvalues:n.varvalues,varindices:n.varindices,varaxisLabel:n.varaxisLabel}}function Rv(n,e){if(!e||e.nrows!==n.values.nrows||e.ncols!==n.values.ncols)throw new Error("Object with values seems to be wrong for cloning.");const r=structuredClone(n);return r.values=e,r}var Mv=H('<span class="info-details svelte-1l1cvmx"> <span class="svelte-1l1cvmx"><!></span></span>');function ta(n,e){fe(e,!0);var r=ce(),l=X(r);{var s=o=>{var c=Mv(),d=Y(c),u=N(d),f=Y(u);Pt(f,()=>Gu(e.prepmodel)),ne(()=>ke(d,`${e.prepmodel.ml.length+" method"+(e.prepmodel.ml.length>1?"s":"")} `)),E(o,c)},a=o=>{var c=au("skipped");E(o,c)};B(l,o=>{e.prepmodel.ml?o(s):o(a,!1)})}E(n,r),ve()}var Iv=H('<span>file:</span> <span class="file-name svelte-1dxrrpt"> </span><br/>',1),Fv=H('<p class="info-text svelte-1dxrrpt"><span style="display:inline-block;font-weight:bold;padding-bottom: 0.25em;">Preprocessing model</span><br/> <!> <span style="color:#a0a0a0;">variables</span>, <!></p> <!>',1);function jv(n,e){fe(e,!0);var r=ce(),l=X(r);{var s=a=>{oe(a,{name:"info",children:(o,c)=>{var d=Fv(),u=X(d),f=N(Y(u),3);{var v=b=>{var _=Iv(),S=N(X(_),2),y=Y(S);ne(()=>{O(S,"title",e.model.fileName),ke(y,e.model.fileName)}),E(b,_)};B(f,b=>{e.model.fileName&&b(v)})}var m=N(f),h=N(m,3);ta(h,{get prepmodel(){return e.model}});var p=N(u,2);{var w=b=>{cr(b,{get onclick(){return e.reset}})};B(p,b=>{e.reset&&b(w)})}ne(()=>ke(m,` ${e.model.npred??""} `)),E(o,d)},$$slots:{default:!0}})};B(l,a=>{e.model&&a(s)})}E(n,r),ve()}var Vv=H("<!> <!>",1),Ov=H("<p><!></p>"),Bv=H("<!> <!>",1);function qv(n,e){fe(e,!0);let r=V(e,"model",15),l=te(""),s=te("neutral"),a=te("");function o(b){try{const _=JSON.parse(b,Ms);if(Array.isArray(_.v)&&(_.v=Float64Array.from(_.v)),!Object.keys(_).includes("class")||_.class[0]!=="prepmodel")throw Error("The JSON file you selected does not contain preprocessing model.");_.fileName=t(u),r(_),F(s,"success"),F(a,"")}catch(_){console.log(_),r(null),F(s,"error"),F(a,_,!0)}}function c(b){const _=new FileReader;_.onload=()=>{o(_.result)},_.readAsText(t(l))}function d(){F(l,""),r(null),F(s,"neutral"),F(a,"")}ge(()=>{t(l)===null?(r(null),F(s,"neutral"),F(a,"")):(F(s,"neutral"),F(a,""))}),ge(()=>{(r()===null||r()===0)&&F(l,"")});let u=g(()=>t(l)?t(l).name.replace(/\.[^/.]+$/,""):"");var f=Bv(),v=X(f);{var m=b=>{var _=Vv(),S=X(_);zn(S,()=>t(l),L=>{oe(L,{name:"file-selector",children:(k,P)=>{jl(k,{id:"modelFile",acceptType:".json",message:"Select file with model",get file(){return t(l)},set file(z){F(l,z,!0)}})},$$slots:{default:!0}})});var y=N(S,2);{var C=L=>{oe(L,{name:"load-button",label:" ",children:(k,P)=>{at(k,{onclick:c,text:"Load"})},$$slots:{default:!0}})};B(y,L=>{t(l)&&L(C)})}E(b,_)},h=b=>{jv(b,{get model(){return r()},reset:d})};B(v,b=>{r()?b(h,!1):b(m)})}var p=N(v,2);{var w=b=>{oe(b,{name:"error",status:"error",children:(_,S)=>{var y=Ov(),C=Y(y);Pt(C,()=>t(a)),E(_,y)},$$slots:{default:!0}})};B(p,b=>{(t(s)==="error"||t(a))&&b(w)})}E(n,f),ve()}var Dv=H('<p class="title"> </p>'),Yv=H("<!>&nbsp;",1),Wv=H("<!> <!>",1),Uv=H('<div class="method-open svelte-2gffce"><!> <!> <!></div>'),Hv=(n,e)=>e.open(e.pos),Xv=H('<p> <span title="Edit" class="svelte-2gffce"> </span></p> <!> <!> <!>',1);function In(n,e){fe(e,!0);let r=V(e,"cancel",3,null);var l=ce(),s=X(l);{var a=c=>{var d=Uv(),u=Y(d);oe(u,{children:(m,h)=>{var p=Dv(),w=Y(p);ne(()=>ke(w,e.title)),E(m,p)},$$slots:{default:!0}});var f=N(u,2);Sr(f,()=>e.children);var v=N(f,2);oe(v,{label:" ",children:(m,h)=>{var p=Wv(),w=X(p);{var b=S=>{var y=Yv(),C=X(y);at(C,{text:"Cancel",get onclick(){return r()}}),E(S,y)};B(w,S=>{r()&&S(b)})}var _=N(w,2);at(_,{text:"Save",get onclick(){return e.apply}}),E(m,p)},$$slots:{default:!0}}),ho(3,d,()=>Si,()=>({duration:10})),E(c,d)},o=c=>{oe(c,{children:(d,u)=>{var f=Xv(),v=X(f),m=Y(v),h=N(m);h.__click=[Hv,e];var p=Y(h),w=N(v,2);fd(w,{onclick:()=>e.moveUp(e.pos)});var b=N(w,2);vd(b,{onclick:()=>e.moveDown(e.pos)});var _=N(b,2);cr(_,{onclick:()=>e.remove(e.pos)}),ne(()=>{ke(m,`${e.title??""} `),ke(p,e.settings)}),E(d,f)},$$slots:{default:!0}})};B(s,c=>{e.isOpen?c(a):c(o,!1)})}E(n,l),ve()}vt(["click"]);var Gv=H("<!> <!>",1);function Kv(n,e){fe(e,!0);let r=V(e,"params",31,()=>Ne([0,0])),l=V(e,"varind",15),s=V(e,"settings",15),a=V(e,"nvars",3,0),o=dn(e,["$$slots","$$events","$$legacy","params","varind","settings","isOpen","nvars"]);const c={snv:0,area:1,length:2,var:3},d=Object.keys(c);let u=te(Ne(d[r()[0]])),f=te(r()[1]+1);const v="Normalization";ge(()=>{s(t(u)+(t(u)==="var"?" #"+t(f):""))}),ge(()=>{t(u)==="var"?l(l()[0]=r()[1]>0?r()[1]:1,!0):l(l()[0]=-1,!0)}),ge(()=>{t(u)==="var"&&e.isOpen?l(l()[0]=r()[1],!0):l(l()[0]=-1,!0)}),ge(()=>{t(u)&&r(r()[0]=c[t(u)],!0)}),ge(()=>{t(f)&&r(r()[1]=t(f)-1,!0)}),In(n,Br({id:"norm",title:v,get settings(){return s()},get isOpen(){return e.isOpen}},()=>o,{children:(m,h)=>{var p=Gv(),w=X(p);oe(w,{label:"Type",children:(S,y)=>{He(S,{get options(){return d},get value(){return t(u)},set value(C){F(u,C,!0)}})},$$slots:{default:!0}});var b=N(w,2);{var _=S=>{oe(S,{label:"Variable index",children:(y,C)=>{Dt(y,{min:1,get max(){return a()},step:1,get value(){return t(f)},set value(L){F(f,L,!0)}})},$$slots:{default:!0}})};B(b,S=>{t(u)==="var"&&S(_)})}E(m,p)},$$slots:{default:!0}})),ve()}var Jv=H("<!> <!> <!>",1);function Qv(n,e){fe(e,!0);let r=V(e,"params",31,()=>Ne([3,1,0])),l=V(e,"settings",15),s=dn(e,["$$slots","$$events","$$legacy","params","settings","nvars"]);const a=g(()=>{if(!e.nvars)return 3;const u=Math.round(e.nvars*.25);return u>39?39:u%2<1?u+1:u}),o=g(()=>r()[1]<2?[0,1]:[0,1,2]),c=g(()=>r()[0]<5?[1,2]:[1,2,3]);ge(()=>{r()[0]<5&&r()[1]>2&&r(r()[1]=2,!0)}),ge(()=>{r()[2]>r()[1]&&r(r()[2]=r()[1],!0)}),ge(()=>{l(r()[0]+", "+r()[1]+", "+r()[2])}),In(n,Br({id:"savgol",title:"Savitzkiy-Golay",get settings(){return l()}},()=>s,{children:(u,f)=>{var v=Jv(),m=X(v);oe(m,{label:"Width",children:(w,b)=>{Dt(w,{min:3,get max(){return t(a)},step:2,get value(){return r()[0]},set value(_){r(r()[0]=_,!0)}})},$$slots:{default:!0}});var h=N(m,2);oe(h,{label:"Polynomial",children:(w,b)=>{He(w,{get options(){return t(c)},get value(){return r()[1]},set value(_){r(r()[1]=_,!0)}})},$$slots:{default:!0}});var p=N(h,2);oe(p,{label:"Derivative",children:(w,b)=>{He(w,{get options(){return t(o)},get value(){return r()[2]},set value(_){r(r()[2]=_,!0)}})},$$slots:{default:!0}}),E(u,v)},$$slots:{default:!0}})),ve()}var Zv=H("<!> <!>",1);function $v(n,e){fe(e,!0);let r=V(e,"params",31,()=>Ne([1,0]));V(e,"varind",27,()=>-1);let l=V(e,"settings",15);V(e,"nvars",3,0);let s=dn(e,["$$slots","$$events","$$legacy","params","varind","settings","nvars"]);const a={no:0,mean:1,median:2},o={no:0,sd:1,iqr:2,range:3,pareto:4},c=Object.keys(a),d=Object.keys(o);let u=te(Ne(c[r()[0]])),f=te(Ne(d[r()[1]]));const v="Scaling";ge(()=>{l(t(u)+"/"+t(f))}),ge(()=>{t(u)&&r(r()[0]=a[t(u)],!0)}),ge(()=>{t(f)&&r(r()[1]=o[t(f)],!0)}),In(n,Br({id:"scale",title:v,get settings(){return l()}},()=>s,{children:(m,h)=>{var p=Zv(),w=X(p);oe(w,{label:"Center",children:(_,S)=>{He(_,{get options(){return c},get value(){return t(u)},set value(y){F(u,y,!0)}})},$$slots:{default:!0}});var b=N(w,2);oe(b,{label:"Scale",children:(_,S)=>{He(_,{get options(){return d},get value(){return t(f)},set value(y){F(f,y,!0)}})},$$slots:{default:!0}}),E(m,p)},$$slots:{default:!0}})),ve()}var em=H("<!> <!> <!>",1),tm=H("<!> <!> <!>",1);function rm(n,e){fe(e,!0);let r=V(e,"params",31,()=>Ne([0,1,.1]));V(e,"varind",27,()=>-1);let l=V(e,"settings",15,"");V(e,"nvars",3,0);let s=dn(e,["$$slots","$$events","$$legacy","params","varind","settings","nvars"]);const a="Baseline correction",o={emsc:0,als:1},c=Object.keys(o);function d(p){const w=Math.ceil(Math.log10(p));return Math.pow(10,w)}let u=te(Ne(c[r()[0]])),f=te(Ne(r()[2]>0?d(r()[2]).toString():"0.1")),v=g(()=>parseFloat(t(f))),m=g(()=>t(v)/10),h=g(()=>Math.ceil(-Math.log10(t(v)))+1);ge(()=>{if(t(u)!=="als")return;const p=parseFloat(t(f));(r()[2]<t(m)||r()[2]>p-t(m))&&r(r()[2]=t(m),!0)}),ge(()=>{l(t(u)+" ("+(t(u)=="emsc"?r()[1].toFixed(0):r()[1].toFixed(1)+","+r()[2].toFixed(3))+")")}),ge(()=>{t(u)&&r(r()[0]=o[t(u)],!0)}),In(n,Br({id:"scale",title:a,get settings(){return l()}},()=>s,{children:(p,w)=>{var b=tm(),_=X(b);oe(_,{label:"Type",children:(k,P)=>{He(k,{get options(){return c},get value(){return t(u)},set value(z){F(u,z,!0)}})},$$slots:{default:!0}});var S=N(_,2);{var y=k=>{var P=em(),z=X(P);oe(z,{label:"Lambda",children:(A,I)=>{hn(A,{min:1,max:7,step:.1,get value(){return r()[1]},set value(D){r(r()[1]=D,!0)}})},$$slots:{default:!0}});var j=N(z,2);oe(j,{label:"Penalty range",children:(A,I)=>{He(A,{options:["1","0.1","0.01"],get value(){return t(f)},set value(D){F(f,D,!0)}})},$$slots:{default:!0}});var R=N(j,2);oe(R,{label:"Penalty",children:(A,I)=>{{let D=g(()=>t(v)-t(m));hn(A,{get min(){return t(m)},get max(){return t(D)},get step(){return t(m)},get decNum(){return t(h)},get value(){return r()[2]},set value(W){r(r()[2]=W,!0)}})}},$$slots:{default:!0}}),E(k,P)};B(S,k=>{t(u)==="als"&&k(y)})}var C=N(S,2);{var L=k=>{oe(k,{label:"Polynomial",children:(P,z)=>{Dt(P,{min:0,max:5,step:1,decNum:0,get value(){return r()[1]},set value(j){r(r()[1]=j,!0)}})},$$slots:{default:!0}})};B(C,k=>{t(u)==="emsc"&&k(L)})}E(p,b)},$$slots:{default:!0}})),ve()}var nm=H("<!> <!>",1);function lm(n,e){fe(e,!0);let r=V(e,"params",15),l=V(e,"varind",15),s=V(e,"settings",15),a=dn(e,["$$slots","$$events","$$legacy","params","varind","settings","isOpen","left","right","nvars"]);const o="Trim tails";let c=te(!1);const d=g(()=>e.nvars?Math.round(e.nvars*.1):1);ge(()=>{e.isOpen?((r()[0]===void 0||r()[0]===null||r()[0]<e.left||r()[0]>e.right-t(d))&&r(r()[0]=e.left,!0),(r()[1]===void 0||r()[1]===null||r()[1]>e.right||r()[1]<e.left+t(d))&&r(r()[1]=e.right,!0),l(l()[1]=r()[0],!0),l(l()[2]=r()[1],!0),F(c,!0)):(l(l()[1]=-1,!0),l(l()[2]=-1,!0),F(c,!1))}),ge(()=>{s("left: "+r()[0]+" right: "+r()[1])}),In(n,Br({id:"norm",title:o,get settings(){return s()},get isOpen(){return e.isOpen}},()=>a,{children:(u,f)=>{var v=ce(),m=X(v);{var h=p=>{var w=nm(),b=X(w);oe(b,{label:"Left",children:(S,y)=>{{let C=g(()=>e.right-t(d));hn(S,{get min(){return e.left},get max(){return t(C)},step:1,decNum:0,get value(){return r()[0]},set value(L){r(r()[0]=L,!0)}})}},$$slots:{default:!0}});var _=N(b,2);oe(_,{label:"Right",children:(S,y)=>{{let C=g(()=>e.left+t(d));hn(S,{get min(){return t(C)},get max(){return e.right},step:1,decNum:0,get value(){return r()[1]},set value(L){r(r()[1]=L,!0)}})}},$$slots:{default:!0}}),E(p,w)};B(m,p=>{t(c)&&p(h)})}E(u,v)},$$slots:{default:!0}})),ve()}var sm=H("<!> <!>",1);function am(n,e){fe(e,!0);let r=V(e,"params",31,()=>Ne([3,5]));V(e,"varind",27,()=>-1);let l=V(e,"settings",15);V(e,"nvars",3,0);let s=dn(e,["$$slots","$$events","$$legacy","params","varind","settings","nvars"]);const a="Spike removal";ge(()=>{l(r()[0]+"/"+r()[1])}),In(n,Br({id:"scale",title:a,get settings(){return l()}},()=>s,{children:(o,c)=>{var d=sm(),u=X(d);oe(u,{label:"Window",children:(v,m)=>{Dt(v,{min:3,max:15,step:2,get value(){return r()[0]},set value(h){r(r()[0]=h,!0)}})},$$slots:{default:!0}});var f=N(u,2);oe(f,{label:"Threshold",children:(v,m)=>{Dt(v,{min:3,max:50,get value(){return r()[1]},set value(h){r(r()[1]=h,!0)}})},$$slots:{default:!0}}),E(o,d)},$$slots:{default:!0}})),ve()}var om=H("<h2>Selected methods</h2> <!>",1),im=H("<p>No methods selected</p>"),cm=H("<p> </p>"),um=H("<h2>Available methods</h2>"),dm=H("<p>Maximum number of methods is selected.</p>"),fm=H("<p> </p> <!>",1),vm=H('<div><!> <!> <!></div> <div class="downloads-block"><!></div> <div class="methods-list svelte-15cx0gr"><!> <!></div>',1);function mm(n,e){fe(e,!0);let r=V(e,"prepobj",31,()=>Ne([])),l=V(e,"meta",15),s=V(e,"varind",31,()=>-1),a=V(e,"rawdataShort",15),o=V(e,"prepdataShort",15),c=V(e,"prepmodel",3,null),d=V(e,"reset",3,null),u=V(e,"finalize",3,null);const f=30,v=8,m={savgol:Qv,norm:Kv,scale:$v,baseline:rm,trim:lm,spikes:am};let h=te("neutral"),p=te(""),w=te(void 0),b=te(""),_=te(Ne([])),S=te(!1),y=te(Ne([])),C=te(Ne([]));l(new Array(v).fill(""));const L=g(()=>e.rawdata.values.ncols-e.rawdata.nresp);let k=Ne(e.rawdata.values.nrows<3?Object.keys(m).filter(re=>re!=="scale"):Object.keys(m));z(),r().length!==0&&P();async function P(){r().length!==0&&F(w,e.WASM().then(re=>{F(h,"applying");const de=Yo(re,a().values,0,r(),!0,[]),le=zs(re,a().values,0,de,!0);o(ea(a(),le)),F(h,"success")}).catch(re=>{o(ea(a())),console.error(re),F(h,"error"),F(p,re,!0)}),!0)}function z(){const re=e.rawdata.values.ncols-e.rawdata.nresp;if(!e.rawdata)return;if(!r()||r().length<1){e.setLeft(0),e.setRight(re),F(y,[],!0),F(C,[],!0);return}let de=[],le=[],we=0,ue=re;for(let Ee of r())Ee.id==="trim"?(de.push(we),le.push(ue),Ee.params[0]<we&&(Ee.params[0]=we),Ee.params[1]>ue&&(Ee.params[1]=ue),we=Ee.params[0]>we?Ee.params[0]:we,ue=Ee.params[1]>0&&Ee.params[1]<ue?Ee.params[1]:ue):(de.push(we),le.push(ue));F(y,de,!0),F(C,le,!0),e.setLeft(we),e.setRight(ue)}function j(re){const de=qr.find(le=>le.id===re);de&&(t(y).push(e.left),t(C).push(e.right),r().push({id:de.id,params:de.mp}),F(S,!0),F(b,r().length-1))}function R(){r().length<1||(t(y).pop(),t(C).pop(),r().pop(),F(S,!1),F(b,-1))}function A(re){if(re<=0)return;const de=r()[re],le=r()[re-1];r(r()[re-1]=de,!0),r(r()[re]=le,!0),q()}function I(re){if(re<0||re===r().length-1)return;const de=r()[re],le=r()[re+1];r(r()[re+1]=de,!0),r(r()[re]=le,!0),q()}function D(re){re<0||re>=r().length||(r(r().filter((de,le)=>le!==re)),q())}function W(re){F(b,re,!0)}function T(){F(b,null)}function q(){F(h,"neutral"),F(p,""),F(S,!1),F(b,null),c()&&d()(),z(),P(),s(s()[1]=-1,!0),s(s()[2]=-1,!0)}ge(()=>{e.rawdata&&!a()&&a(zv(e.rawdata,f))}),ge(()=>{a()&&!o()&&o(ea(a()))}),ge(()=>{(!r()||r().length===0)&&(F(_,[],!0),o(null),F(y,[],!0),F(C,[],!0),F(b,""),l(new Array(v).fill("")))});var Z=vm(),M=X(Z);let U;var K=Y(M);oe(K,{label:"",children:(re,de)=>{var le=om(),we=N(X(le),2);{var ue=Ee=>{Go(Ee,{text:"edit",get onclick(){return d()}})};B(we,Ee=>{c()&&d()&&Ee(ue)})}E(re,le)},$$slots:{default:!0}});var J=N(K,2);{var se=re=>{oe(re,{label:"",children:(de,le)=>{var we=im();E(de,we)},$$slots:{default:!0}})},$=re=>{var de=ce(),le=X(de);Me(le,17,r,qe,(we,ue,Ee)=>{var Re=ce();const je=g(()=>m[t(ue).id]);var Ve=X(Re);{var tt=Be=>{var Ze=ce(),Xe=X(Ze);{let Ke=g(()=>Ee===t(b)),Qt=g(()=>t(S)?R:null);Jn(Xe,()=>t(je),(Pr,Lr)=>{Lr(Pr,{get isOpen(){return t(Ke)},get left(){return t(y)[Ee]},get right(){return t(C)[Ee]},pos:Ee,get nvars(){return t(L)},moveUp:A,moveDown:I,apply:q,open:W,close:T,remove:D,get cancel(){return t(Qt)},get params(){return t(ue).params},set params(Se){t(ue).params=Se},get varind(){return s()},set varind(Se){s(Se)},get settings(){return l()[Ee]},set settings(Se){l(l()[Ee]=Se,!0)}})})}E(Be,Ze)},Ye=Be=>{var Ze=ce(),Xe=X(Ze);{let Ke=g(()=>Ee===t(b)),Qt=g(()=>t(S)?R:null);Jn(Xe,()=>t(je),(Pr,Lr)=>{Lr(Pr,{pos:Ee,get isOpen(){return t(Ke)},get left(){return t(y)[Ee]},get right(){return t(C)[Ee]},get nvars(){return t(L)},moveUp:A,moveDown:I,apply:q,open:W,close:T,remove:D,get cancel(){return t(Qt)},get params(){return t(ue).params},set params(Se){t(ue).params=Se},get settings(){return l()[Ee]},set settings(Se){l(l()[Ee]=Se,!0)}})})}E(Be,Ze)};B(Ve,Be=>{t(ue).id==="norm"||t(ue).id==="trim"?Be(tt):Be(Ye,!1)})}E(we,Re)}),E(re,de)};B(J,re=>{r().length===0?re(se):re($,!1)})}var Q=N(J,2);{var ae=re=>{oe(re,{status:"error",children:(de,le)=>{var we=cm(),ue=Y(we);ne(()=>ke(ue,t(p))),E(de,we)},$$slots:{default:!0}})};B(Q,re=>{(t(h)==="error"||t(p))&&re(ae)})}var _e=N(M,2),ie=Y(_e);{var ye=re=>{oe(re,{label:" ",children:(de,le)=>{at(de,{get onclick(){return u()},text:"Finalize"})},$$slots:{default:!0}})};B(ie,re=>{!c()&&!t(b)&&r().length>0&&re(ye)})}var Ce=N(_e,2),me=Y(Ce);oe(me,{label:"",children:(re,de)=>{var le=um();E(re,le)},$$slots:{default:!0}});var he=N(me,2);{var pe=re=>{oe(re,{label:"",children:(de,le)=>{var we=dm();E(de,we)},$$slots:{default:!0}})},Pe=re=>{var de=ce(),le=X(de);Me(le,17,()=>k,qe,(we,ue)=>{const Ee=g(()=>qr.find(Re=>Re.id===t(ue)));oe(we,{children:(Re,je)=>{var Ve=fm(),tt=X(Ve),Ye=Y(tt),Be=N(tt,2);dd(Be,{onclick:()=>j(t(Ee).id)}),ne(()=>ke(Ye,t(Ee).title)),E(Re,Ve)},$$slots:{default:!0}})}),E(re,de)};B(he,re=>{r().length>=v?re(pe):re(Pe,!1)})}ne(re=>U=pt(M,1,"selected-methods-list svelte-15cx0gr",null,U,re),[()=>({final:c()!==null&&c()!==void 0})]),E(n,Z),ve()}var hm=H("<!> <!>",1),gm=H("<!> <!>",1),pm=H("<!> <!>",1),bm=H("<!> <!> <!> <!> <!> <!> <!> <!>",1),_m=H("<h2>Plot settings</h2>"),wm=H('<div class="plot-area svelte-x8qn01"><div class="plot svelte-x8qn01"><!></div></div> <div class="plot-controls-area svelte-x8qn01"><!> <!> <!> <!></div>',1),ym=H('<div class="plot-panel svelte-x8qn01"><!></div>');function xm(n,e){fe(e,!0);let r=te(!0),l=te("none"),s=te(!1);const a=g(()=>(t(r)?"Preprocessed":"Raw")+" data (selected rows)"),o=g(()=>t(r)&&e.prepdata?e.prepdata:e.rawdata),c=g(()=>t(o)?t(o).varaxisLabel:"Variables"),d=g(()=>e.rawdata.varaxisUnits),u=g(()=>e.left>=0||e.right>0&&e.right<t(o).values.nrows),f=g(()=>e.left>=0?e.left+1:1),v=g(()=>e.right>0&&e.right<t(o).values.nrows?e.right:t(o).values.nrows),m=g(()=>t(r)&&t(o)&&t(u)?bt.seq(t(f),t(v)):null),h=g(()=>t(m)?t(o).varvalues.filter((z,j)=>j>=t(f)-1&&j<t(v)):t(o).varvalues),p=g(()=>t(m)?t(o).values.subset(t(m),null):t(o).values),w=g(()=>t(p)?Ar(t(p).v):null),b=g(()=>t(w)?(t(w)[1]-t(w)[0])*.05:null),_=g(()=>t(w)?[t(w)[0],t(w)[1]+(t(l)!=="none")*t(b)]:[0,1]),S=g(()=>t(o)?Ar(t(o).varvalues,t(s)?.005:.1):[0,1]),y=g(()=>t(s)&&t(u)?[t(o).varvalues[t(f)-1],t(o).varvalues[t(v)-1]]:t(S)),C=g(()=>{if(!e.rawdata)return null;const z={none:{colors:"#ff0000"}};if(e.rawdata.classes&&e.rawdata.classNames&&e.rawdata.classNames.length>1){const j=Us(e.rawdata.classNames.length);z.groups={colors:e.rawdata.classes.map(R=>j[e.rawdata.classNames.findIndex(A=>A===R)]),breaks:Dr(0,e.rawdata.classNames.length),labels:e.rawdata.classNames,map:j}}if(e.rawdata.resp&&e.rawdata.resp.length===e.rawdata.values.ncols){const j=Rl(e.rawdata.resp,8),R=Us(j.length-1);z.response={colors:Ev(e.rawdata.resp.v,j.v,R),labels:null,breaks:j,map:R}}return z});ge(()=>{(e.left<1||e.right<1||e.right>=e.left)&&F(s,!1)});var L=ym(),k=Y(L);{var P=z=>{var j=wm(),R=X(j),A=Y(R),I=Y(A);Xs(I,{get title(){return t(a)},get limY(){return t(_)},get limX(){return t(y)},fileName:"plot-preprocessed",children:(K,J)=>{var se=bm(),$=X(se);{var Q=le=>{ki(le,{get xValues(){return t(h)},get yValues(){return t(p)}})},ae=le=>{var we=ce(),ue=X(we);Me(ue,17,()=>t(C)[t(l)].colors,qe,(Ee,Re,je)=>{{let Ve=g(()=>t(p).getcolumn(je+1));yr(Ee,{get xValues(){return t(h)},get yValues(){return t(Ve)},get lineColor(){return t(Re)}})}}),E(le,we)};B($,le=>{t(l)==="none"?le(Q):le(ae,!1)})}var _e=N($,2);{var ie=le=>{var we=hm();const ue=g(()=>t(o).varvalues[e.varind[0]]);var Ee=X(we);{let je=g(()=>[t(ue),t(ue)]);yr(Ee,{get xValues(){return t(je)},get yValues(){return t(_)},lineColor:"#00000060"})}var Re=N(Ee,2);{let je=g(()=>[t(ue)]),Ve=g(()=>[t(_)[1]-t(b)*(t(l)==="none"?1:2)]),tt=g(()=>Yr(t(ue).toFixed(2)+" "+t(d)));_n(Re,{get xValues(){return t(je)},get yValues(){return t(Ve)},get labels(){return t(tt)},textColor:"#a0a0a0",textSize:.8,pos:2})}E(le,we)};B(_e,le=>{e.varind&&e.varind[0]>0&&le(ie)})}var ye=N(_e,2);{var Ce=le=>{var we=gm();const ue=g(()=>t(o).varvalues[e.varind[1]]);var Ee=X(we);{let je=g(()=>[t(y)[0]]),Ve=g(()=>[t(o).varvalues[e.varind[1]]-t(y)[0]]),tt=g(()=>[t(_)[1]]),Ye=g(()=>[t(_)[1]-t(_)[0]]);Mn(Ee,{get left(){return t(je)},get width(){return t(Ve)},get top(){return t(tt)},get height(){return t(Ye)},lineColor:"transparent",faceColor:"#00000040"})}var Re=N(Ee,2);{let je=g(()=>[t(ue)]),Ve=g(()=>[t(_)[1]-t(b)*(t(l)==="none"?1:2)]),tt=g(()=>Yr(t(ue).toFixed(2)+" "+t(d)));_n(Re,{get xValues(){return t(je)},get yValues(){return t(Ve)},get labels(){return t(tt)},textColor:"#a0a0a0",textSize:.8,pos:2})}E(le,we)};B(ye,le=>{e.varind&&e.varind[1]>0&&le(Ce)})}var me=N(ye,2);{var he=le=>{var we=pm();const ue=g(()=>t(o).varvalues[e.varind[2]-1]);var Ee=X(we);{let je=g(()=>[t(o).varvalues[e.varind[2]-1]]),Ve=g(()=>[t(y)[1]-t(o).varvalues[e.varind[2]-1]]),tt=g(()=>[t(_)[1]]),Ye=g(()=>[t(_)[1]-t(_)[0]]);Mn(Ee,{get left(){return t(je)},get width(){return t(Ve)},get top(){return t(tt)},get height(){return t(Ye)},lineColor:"transparent",faceColor:"#00000040"})}var Re=N(Ee,2);{let je=g(()=>[t(ue)]),Ve=g(()=>[t(_)[1]-t(b)*(t(l)==="none"?1:2)]),tt=g(()=>Yr(t(ue).toFixed(2)+" "+t(d)));_n(Re,{get xValues(){return t(je)},get yValues(){return t(Ve)},get labels(){return t(tt)},textColor:"#a0a0a0",textSize:.8,pos:2})}E(le,we)};B(me,le=>{e.varind&&e.varind[2]<t(o).varvalues.length&&e.varind[2]>0&&le(he)})}var pe=N(me,2);{let le=g(()=>t(l)!=="none");Ei(pe,{get show(){return t(le)},get labels(){return t(C)[t(l)].labels},get breaks(){return t(C)[t(l)].breaks},get colmap(){return t(C)[t(l)].map}})}var Pe=N(pe,2);Gs(Pe,{get label(){return t(c)},showGrid:!0});var re=N(Pe,2);Ks(re,{showGrid:!0});var de=N(re,2);Js(de,{}),E(K,se)},$$slots:{default:!0}});var D=N(R,2),W=Y(D);oe(W,{label:"",children:(K,J)=>{var se=_m();E(K,se)},$$slots:{default:!0}});var T=N(W,2);oe(T,{label:"Show",children:(K,J)=>{Kt(K,{options:["raw","preprocessed"],get value(){return t(r)},set value(se){F(r,se,!0)}})},$$slots:{default:!0}});var q=N(T,2);{var Z=K=>{oe(K,{label:"Color by",children:(J,se)=>{{let $=g(()=>Object.keys(t(C)));He(J,{get options(){return t($)},get value(){return t(l)},set value(Q){F(l,Q,!0)}})}},$$slots:{default:!0}})};B(q,K=>{Object.keys(t(C)).length>1&&K(Z)})}var M=N(q,2);{var U=K=>{oe(K,{label:"Zoom (x-axis)",children:(J,se)=>{Kt(J,{options:["off","on"],get value(){return t(s)},set value($){F(s,$,!0)}})},$$slots:{default:!0}})};B(M,K=>{e.left>0&&e.right>e.left&&K(U)})}E(z,j)};B(k,z=>{t(h)&&t(p)&&z(P)})}E(n,L),ve()}var km=H('<div class="widget-container svelte-1soqt9v"><div class="app-controls svelte-1soqt9v"><div class="prep-creator svelte-1soqt9v"><!></div></div> <div class="app-content svelte-1soqt9v"><!></div></div>');function Em(n,e){fe(e,!0);let r=V(e,"left",15),l=V(e,"right",15),s=V(e,"prepobj",15),a=V(e,"meta",15),o=V(e,"finalize",3,null),c=te(Ne([-1,0,0])),d=te(null),u=te(null);function f(y){const C=e.rawdata.values.ncols-e.rawdata.nresp;e.rawdata&&y>=0&&y<C&&y<l()&&r(y)}function v(y){const C=e.rawdata.values.ncols-e.rawdata.nresp;e.rawdata&&y<=C&&y>r()&&l(y)}var m=km(),h=Y(m),p=Y(h),w=Y(p);mm(w,{get WASM(){return e.WASM},get rawdata(){return e.rawdata},get outliers(){return e.outliers},get left(){return r()},get right(){return l()},setLeft:f,",":!0,setRight:v,get finalize(){return o()},get varind(){return t(c)},set varind(y){F(c,y,!0)},get prepobj(){return s()},set prepobj(y){s(y)},get rawdataShort(){return t(d)},set rawdataShort(y){F(d,y,!0)},get prepdataShort(){return t(u)},set prepdataShort(y){F(u,y,!0)},get meta(){return a()},set meta(y){a(y)}});var b=N(h,2),_=Y(b);{var S=y=>{xm(y,{get rawdata(){return t(d)},get prepdata(){return t(u)},get left(){return r()},get right(){return l()},get varind(){return t(c)}})};B(_,y=>{t(d)&&y(S)})}E(n,m),ve()}var Sm=H('<p class="info-text"><span style="color:#a0a0a0;">Preprocessing:</span> <!></p>'),Cm=H("<!> <!> <!>",1),Am=H('<p class="info-text"><span style="color:#a0a0a0;">Preprocessing:</span> skipped</p> <div><!></div>',1),Tm=H("<!> <!> <!>",1),Pm=H("<p><strong>Preprocessing model</strong></p>"),Lm=H("<!> <!>",1),Nm=H("<p> </p>"),zm=H('<div class="prep-widget"><!></div> <!> <!>',1);function Rm(n,e){fe(e,!0);let r=V(e,"prepType",15),l=V(e,"prepobj",15),s=V(e,"prepdata",15),a=V(e,"prepmodel",15),o=V(e,"prepmeta",15),c=te(!1),d=te(0),u=te(Ne(e.rawdata?e.rawdata.values.ncols-e.rawdata.nresp:0)),f=te("neutral"),v=te(""),m=te(void 0);async function h(I,D,W){!D||!I||D.length===0||F(m,e.WASM().then(T=>{F(f,"applying");const q=Yo(T,I.values,I.nresp,D,!1,W);q.info=o(),a(q)}).catch(T=>{a(null),console.error(T),F(f,"error"),F(v,T,!0)}),!0)}async function p(I,D){if(!D||typeof D!="object"){s(null);return}if(Object.keys(D).length===0){s(I);return}F(m,e.WASM().then(W=>{F(f,"applying");const T=zs(W,I.values,I.nresp,D,!1,!1),q=Rv(Tc(I),T);s(Ku(q,D))}).catch(W=>{s(null),console.error(W),F(f,"error"),F(v,W,!0)}),!0)}function w(){r(null),s(null),a(null),l([]),setLeft(0),setRight(e.rawdata.values.ncols-e.rawdata.nresp)}function b(){l()&&l().length>0?h(e.rawdata,l(),e.outliers):(r(null),a(null)),F(c,!1)}function _(){r("create"),s(null),a(null),F(c,!0)}function S(){r("skip"),a({})}ge(()=>{a(),e.rawdata&&p(e.rawdata,a())}),ge(()=>{r()==="create"&&l()&&!a()&&h(e.rawdata,l(),e.outliers)}),ge(()=>{r()==="skip"&&s()===null&&(a({}),l([]),s(e.rawdata))});var y=zm(),C=X(y),L=Y(C);{var k=I=>{oe(I,{name:"info",children:(D,W)=>{var T=Cm(),q=X(T);{var Z=J=>{var se=Sm(),$=N(Y(se),2);ta($,{get prepmodel(){return a()}}),E(J,se)};B(q,J=>{t(c)||J(Z)})}var M=N(q,2);{var U=J=>{Go(J,{onclick:_})};B(M,J=>{r()==="create"&&J(U)})}var K=N(M,2);cr(K,{onclick:w}),E(D,T)},$$slots:{default:!0}})},P=I=>{var D=ce(),W=X(D);{var T=Z=>{oe(Z,{name:"prep-info",children:(M,U)=>{var K=Am(),J=N(X(K),2),se=Y(J);cr(se,{onclick:w}),E(M,K)},$$slots:{default:!0}})},q=Z=>{var M=ce(),U=X(M);{var K=se=>{oe(se,{label:"Preprocessing",name:"prep-container",children:($,Q)=>{var ae=Tm(),_e=X(ae);at(_e,{text:"Skip",onclick:S});var ie=N(_e,2);at(ie,{text:"Load",onclick:()=>r("file")});var ye=N(ie,2);at(ye,{text:"Create",onclick:_}),E($,ae)},$$slots:{default:!0}})},J=se=>{var $=ce(),Q=X($);{var ae=_e=>{var ie=Lm(),ye=X(ie);oe(ye,{children:(me,he)=>{var pe=Pm();E(me,pe)},$$slots:{default:!0}});var Ce=N(ye,2);qv(Ce,{get model(){return a()},set model(me){a(me)},get prepobj(){return l()},set prepobj(me){l(me)},get left(){return t(d)},set left(me){F(d,me,!0)},get right(){return t(u)},set right(me){F(u,me,!0)}}),E(_e,ie)};B(Q,_e=>{r()==="file"&&_e(ae)},!0)}E(se,$)};B(U,se=>{r()?se(J,!1):se(K)},!0)}E(Z,M)};B(W,Z=>{r()==="skip"?Z(T):Z(q,!1)},!0)}E(I,D)};B(L,I=>{a()&&s()&&a().ml?I(k):I(P,!1)})}var z=N(C,2);{var j=I=>{Qs(I,{closeModal:b,isDark:!0,children:(D,W)=>{Em(D,{get WASM(){return e.WASM},get rawdata(){return e.rawdata},get outliers(){return e.outliers},finalize:b,get prepobj(){return l()},set prepobj(T){l(T)},get left(){return t(d)},set left(T){F(d,T,!0)},get right(){return t(u)},set right(T){F(u,T,!0)},get meta(){return o()},set meta(T){o(T)}})},$$slots:{default:!0}})};B(z,I=>{t(c)&&I(j)})}var R=N(z,2);{var A=I=>{oe(I,{status:"error",children:(D,W)=>{var T=Nm(),q=Y(T);ne(()=>ke(q,t(v))),E(D,T)},$$slots:{default:!0}})};B(R,I=>{(t(f)==="error"||t(v))&&I(A)})}E(n,y),ve()}var Mm=H('<th class="svelte-8wnifa"> </th>'),Im=H('<td class="svelte-8wnifa"> </td>'),Fm=H('<tr class="svelte-8wnifa"></tr>'),jm=H('<table class="svelte-8wnifa"><thead><tr class="svelte-8wnifa"></tr></thead><tbody></tbody></table>');function zi(n,e){fe(e,!0);const r=1,l=["xcumexpvar","ycumexpvar"],s=["rmse","r2","slope","bias"];let a=g(()=>{if(!e.res||e.ncomp<0)return null;const u=Object.keys(e.res),f=u.length,v=["",...u];let h=[["#LVs",...Array(f).fill(e.ncomp)]];for(let p of l){let w=[p];for(let b=0;b<f;b++)w.push(e.res[u[b]].stat[p][e.ncomp-1].toFixed(3));h.push(w)}for(let p of s){let w=[p];for(let b=0;b<f;b++){let _=3;const S=e.res[u[b]].stat[p].getcolref(r)[e.ncomp-1];p==="rmse"&&(_=S<1?3:S>100?1:2),w.push(S.toFixed(_))}h.push(w)}return{header:v,rows:h}});var o=ce(),c=X(o);{var d=u=>{var f=jm(),v=Y(f),m=Y(v);Me(m,21,()=>t(a).header,qe,(p,w)=>{var b=Mm(),_=Y(b);ne(()=>ke(_,t(w))),E(p,b)});var h=N(v);Me(h,21,()=>t(a).rows,qe,(p,w)=>{var b=Fm();Me(b,21,()=>t(w),qe,(_,S)=>{var y=Im(),C=Y(y);ne(()=>ke(C,t(S))),E(_,y)}),E(p,b)}),E(u,f)};B(c,u=>{t(a)&&u(d)})}E(n,o),ve()}var Vm=H("<!> <!> <!> <!>",1),Om=H("<p> </p>"),Bm=H("<!> <p>Computing global model...</p>",1),qm=H('<p><span style="color:#a0a0a0;">PLS model:</span> </p> <!>',1),Dm=H('<div class="buttons"><!> <!></div>'),Ym=H("<!> <!>",1),Wm=H("<p> </p>"),Um=H("<!> <!> <!> <!>",1);function Hm(n,e){fe(e,!0);let r=V(e,"outliers",19,()=>[]),l=V(e,"exclvars",19,()=>[]),s=V(e,"resobj",15),a=V(e,"model",15),o=V(e,"downloadModel",3,null),c=V(e,"downloadResults",3,null),d=te("neutral"),u=te(""),f=te(1),v=te(!0),m=te(!1),h=te(void 0);async function p(A,I,D,W){const T=A.nresp,q=A.varindices;F(h,e.WASM().then(Z=>{F(d,"computing");const M=Wu(Z,A.values,T,I,D,W,r(),l());M.hash=Wo(),M.varlabels=A.varlabels.filter((K,J)=>J<T||!l().includes(q[J])),M.varindices=A.varindices.filter((K,J)=>J<T||!l().includes(q[J])),M.varvalues=A.varvalues.filter((K,J)=>J<T||!l().includes(q[J])),M.xvarlabels=M.varlabels.filter((K,J)=>J+1>T),M.xvarvalues=M.varvalues.filter((K,J)=>J+1>T),M.xvarindices=M.varindices.filter((K,J)=>J+1>T).map(K=>K+1),M.varvaluesName=A.varvaluesName,M.varvaluesUnits=A.varvaluesUnits,M.varrev=A.varrev,M.prep=null;const U=Rs(Z,M,A,r());M.stat={xexpvar:U.stat.xexpvar,yexpvar:U.stat.yexpvar},a(M),s(U),F(d,"success")}).catch(Z=>{console.error(Z),a(null),F(d,"error"),F(u,Z,!0)}),!0)}function w(A){F(d,"neutral"),F(u,null),p(e.dataset,t(f),t(v),t(m))}function b(){F(d,"neutral"),F(h,null),s(null),a(null),F(u,null)}let _=g(()=>e.dataset?Math.min(e.dataset.values.nrows-2-r().length,e.dataset.values.ncols-e.dataset.nresp-l().length-1,50):null);ge(()=>{e.dataset===null&&b()}),ge(()=>{F(f,t(_)?Math.min(t(_),20):null,!0)});var S=Um(),y=X(S);{var C=A=>{var I=Vm(),D=X(I);{var W=M=>{oe(M,{name:"ncomp",label:"# of LVs",children:(U,K)=>{hn(U,{id:"ncomp",min:1,get max(){return t(_)},step:1,decNum:0,get value(){return t(f)},set value(J){F(f,J,!0)}})},$$slots:{default:!0}})};B(D,M=>{t(f)&&t(_)&&M(W)})}var T=N(D,2);oe(T,{name:"center",label:"Center",children:(M,U)=>{Kt(M,{id:"center",options:["no","yes"],get value(){return t(v)},set value(K){F(v,K,!0)}})},$$slots:{default:!0}});var q=N(T,2);oe(q,{name:"scale",label:"Scale",children:(M,U)=>{Kt(M,{id:"scale",options:["no","yes"],get value(){return t(m)},set value(K){F(m,K,!0)}})},$$slots:{default:!0}});var Z=N(q,2);oe(Z,{name:"create-model",label:" ",children:(M,U)=>{at(M,{onclick:w,text:"Create model"})},$$slots:{default:!0}}),E(A,I)};B(y,A=>{e.dataset&&!a()&&t(d)!=="computing"&&A(C)})}var L=N(y,2);{var k=A=>{var I=ce(),D=X(I);ps(D,()=>t(h),W=>{oe(W,{name:"spinner",children:(T,q)=>{var Z=Bm(),M=X(Z);Fs(M),E(T,Z)},$$slots:{default:!0}})},void 0,(W,T)=>{oe(W,{name:"error",status:"error",children:(q,Z)=>{var M=Om(),U=Y(M);ne(()=>ke(U,t(T))),E(q,M)},$$slots:{default:!0}})}),E(A,I)};B(L,A=>{t(h)&&A(k)})}var P=N(L,2);{var z=A=>{var I=Ym(),D=X(I);oe(D,{name:"info",children:(q,Z)=>{var M=qm(),U=X(M),K=N(Y(U)),J=N(U,2);cr(J,{onclick:b}),ne(()=>ke(K,` ${a().ncomp??""} LVs${a().center?", centered":""}${a().scale?", scaled":""}`)),E(q,M)},$$slots:{default:!0}});var W=N(D,2);{var T=q=>{oe(q,{name:"download-buttons",label:"Download",children:(Z,M)=>{var U=Dm(),K=Y(U);at(K,{onclick:()=>c()(s(),e.dataset,"train",r()),text:"Results"});var J=N(K,2);at(J,{onclick:()=>o()(a()),text:"Model"}),E(Z,U)},$$slots:{default:!0}})};B(W,q=>{o()&&c()&&q(T)})}E(A,I)};B(P,A=>{a()&&a().ncomp&&A(z)})}var j=N(P,2);{var R=A=>{oe(A,{name:"error",status:"error",children:(I,D)=>{var W=Wm(),T=Y(W);ne(()=>ke(T,t(u))),E(I,W)},$$slots:{default:!0}})};B(j,A=>{(t(d)==="error"||t(u))&&A(R)})}E(n,S),ve()}var Xm=H("<!> <!> <!>",1),Gm=H('<p class="svelte-16w7odi"> </p>'),Km=H('<!> <p class="svelte-16w7odi">Computing PV-set...</p>',1),Jm=H('<p class="svelte-16w7odi"><span class="svelte-16w7odi">PV-set:</span> <br/> <span class="svelte-16w7odi">Size:</span> <span class="svelte-16w7odi">(X)</span> <span class="svelte-16w7odi">(Y)</span>,</p> <!> <!>',1),Qm=H('<p class="svelte-16w7odi"> </p>'),Zm=H("<!> <!> <!> <!>",1);function $m(n,e){fe(e,!0);let r=V(e,"outliers",19,()=>[]),l=V(e,"pvset",15),s=V(e,"pvres",15),a=V(e,"pvscalars",15),o=te("neutral"),c=te(""),d=te(Ne(["ven","rand","loo"])),u=te("ven"),f=te(void 0),v=e.calset.values.nrows-r().length,m=e.calset&&e.calset.values.nrows>0?[3,4,5,10,20].filter(R=>R>=v/(v-e.model.ncomp-1)&&R<=v/2):[],h=te(Ne(m.length>0?m[0]:0));ge(()=>{m.length===0&&(F(d,["loo"],!0),F(u,"loo"))});async function p(R,A,I,D){F(f,e.WASM().then(W=>{const T=I.type=="loo"?0:I.type=="rand"?2:1,[q,Z]=Hu(W,A,R.values,R.nresp,A.ncomp,I.nseg,T,0,D);l({classLabelsVarname:R.classLabelsVarname,classNames:R.classNames,classes:R.classes,dec:R.dec,fileName:R.fileName+"-pcv",hasClassNames:R.hasClassNames,hasLabels:R.hasLabels,header:R.header,labelsVarname:R.labelsVarname,objindices:e.calres.objindices,objlabels:e.calres.objlabels,sep:R.sep,values:q,varAxisTitle:R.varAxisTitle,varindices:A.varindices,varlabels:A.varlabels,varrev:A.varrev,varvalues:A.varvalues,varvaluesName:A.varvaluesName,varvaluesUnits:A.varvaluesUnits,nresp:A.nresp}),s(Rs(W,A,l(),[])),a(Z)}).catch(W=>{console.error(W),l(null),s(null),F(o,"error"),F(c,W,!0)}),!0)}function w(R){F(o,"neutral"),F(c,""),p(e.calset,e.model,{type:t(u),nseg:t(h)},r())}function b(){F(o,"neutral"),F(c,""),F(f,null),l(null),s(null)}ge(()=>{e.model===null&&b()});var _=Zm(),S=X(_);{var y=R=>{var A=Xm(),I=X(A);oe(I,{name:"split",label:"Split type:",children:(q,Z)=>{He(q,{id:"cvType",get options(){return t(d)},get value(){return t(u)},set value(M){F(u,M,!0)}})},$$slots:{default:!0}});var D=N(I,2);{var W=q=>{oe(q,{name:"nseg",label:"Segments:",children:(Z,M)=>{He(Z,{id:"nseg",get options(){return m},get value(){return t(h)},set value(U){F(h,U,!0)}})},$$slots:{default:!0}})};B(D,q=>{t(u)!=="loo"&&q(W)})}var T=N(D,2);oe(T,{name:"run-button",label:" ",children:(q,Z)=>{at(q,{onclick:w,text:"Compute PV-set"})},$$slots:{default:!0}}),E(R,A)};B(S,R=>{e.model&&!l()&&t(o)!=="busy"&&R(y)})}var C=N(S,2);{var L=R=>{var A=ce(),I=X(A);ps(I,()=>t(f),D=>{oe(D,{name:"spinner",children:(W,T)=>{var q=Km(),Z=X(q);Fs(Z),E(W,q)},$$slots:{default:!0}})},void 0,(D,W)=>{oe(D,{name:"error",status:"error",children:(T,q)=>{var Z=Gm(),M=Y(Z);ne(()=>ke(M,t(W))),E(T,Z)},$$slots:{default:!0}})}),E(R,A)};B(C,R=>{t(f)&&R(L)})}var k=N(C,2);{var P=R=>{oe(R,{name:"info",children:(A,I)=>{var D=Jm(),W=X(D),T=N(Y(W)),q=N(T,4),Z=N(q,2),M=N(W,2);ud(M,{onclick:()=>nd(l(),e.calset.fileName+"-pv")});var U=N(M,2);cr(U,{onclick:b}),ne(()=>{ke(T,` ${t(u)??""}
      ${t(u)!=="loo"?t(h)+" seg":""}`),ke(q,` ${l().values.nrows??""}×${l().values.ncols-l().nresp} `),ke(Z,`,
      ${l().values.nrows??""}×${l().nresp??""} `)}),E(A,D)},$$slots:{default:!0}})};B(k,R=>{l()&&R(P)})}var z=N(k,2);{var j=R=>{oe(R,{name:"error",status:"error",children:(A,I)=>{var D=Qm(),W=Y(D);ne(()=>ke(W,t(c))),E(A,D)},$$slots:{default:!0}})};B(z,R=>{t(o)==="error"&&t(c)&&R(j)})}E(n,_),ve()}var eh=H('<span style="font-weight:bold"> </span><br/>',1),th=H('<span class="file-size svelte-gdjwex"> </span> <span>(X)</span>, <span class="file-size svelte-gdjwex"> </span> <span>(Y)</span>',1),rh=H('<span class="file-size svelte-gdjwex"> </span>'),nh=H('<p class="dataset-info svelte-gdjwex"><!> <span>Data file:</span> <span class="file-name svelte-gdjwex"> </span><br/> <span>Size:</span> <!></p> <!>',1);function lh(n,e){fe(e,!0);let r=V(e,"title",3,"");var l=ce(),s=X(l);{var a=o=>{oe(o,{children:(c,d)=>{var u=nh(),f=X(u),v=Y(f);{var m=y=>{var C=eh(),L=X(C),k=Y(L);ne(()=>ke(k,r())),E(y,C)};B(v,y=>{r()&&r()!==""&&y(m)})}var h=N(v,4),p=Y(h),w=N(h,5);{var b=y=>{var C=th(),L=X(C),k=Y(L),P=N(L,4),z=Y(P);ne(()=>{ke(k,`${e.dataset.values.nrows??""}×${e.dataset.values.ncols-e.dataset.nresp}`),ke(z,`${e.dataset.values.nrows??""}×${e.dataset.nresp??""}`)}),E(y,C)},_=y=>{var C=rh(),L=Y(C);ne(()=>ke(L,`${e.dataset.values.nrows??""}×${e.dataset.values.ncols??""}`)),E(y,C)};B(w,y=>{e.dataset.nresp&&e.dataset.nresp>0?y(b):y(_,!1)})}var S=N(f,2);cr(S,{get onclick(){return e.reset}}),ne(()=>{O(h,"title",e.dataset.fileName),ke(p,e.dataset.fileName)}),E(c,u)},$$slots:{default:!0}})};B(s,o=>{e.dataset&&o(a)})}E(n,l),ve()}var sh=H("<!> <!>",1),ah=H("<!> <!> <!> <!> <!>",1),oh=H("<!> <!>",1),ih=H("<p> </p>"),ch=H("<!> <p> </p>",1),uh=H("<p> </p>"),dh=H("<!> <!> <!>",1);function ra(n,e){fe(e,!0);let r=V(e,"model",3,null),l=V(e,"outliers",19,()=>[]),s=V(e,"respMandatory",3,!1),a=V(e,"title",3,""),o=V(e,"dataset",15),c=V(e,"resobj",15);const d=[",",";"],u=g(()=>r()?["no","yes"]:["no","labels","values"]);let f=te(void 0),v=te(""),m=te(""),h=!1,p=te(","),w=te("no"),b=te(!1),_=te(0),S=g(()=>s()?1:0),y=te(null),C=te("neutral"),L=te("");function k($){F(C,"error"),F(L,$,!0),console.error($)}function P(){F(C,"neural"),F(L,"")}function z(){F(C,"success"),F(L,"")}function j($,Q,ae){c()||F(y,e.WASM().then(_e=>{c(Rs(_e,$,Q,ae,!0)),z()}).catch(_e=>{c(null),k(_e)}),!0)}function R($,Q){if(!$||$.size<10)return;const _e=$.slice(0,1e5),ie=new FileReader;ie.onload=()=>{const ye=ie.result;!ye||ye.length<0||((Ce=>{var me=Gl(Ce,5);F(p,me[0],!0),F(b,me[1],!0),h=me[2],F(w,me[3],!0),F(_,me[4],!0)})(td(ye,t(S))),Q&&t(w)!=="no"&&F(w,"yes"),z())},ie.onerror=function(ye){csvString=null,k("Error reading CSV file. "+ye)},ie.readAsText(_e)}function A($){try{const Q=Zu($,t(p),t(w)==="yes"?"labels":t(w),t(b),h,t(v),t(m),t(S));if(Q.values.nrows<1)throw new Error("Dataset must have at least 1 row.");if(Q.values.ncols-Q.nresp<2)throw new Error("Dataset should habe at least two predictors.");if(r()){const ae=r().prep&&r().prep.npred?r().prep.npred:r().npred+r().exclvars.length,_e=s()?ae+r().nresp:ae;if(Q.values.ncols!==_e)throw new Error("Dataset has different number of columns than the training set.");Q.varrev=r().varrev,Q.header=r().header,Q.varlabels=r().varlabels,Q.varvalues=r().varvalues,Q.varindices=r().varindices,Q.varvaluesName=r().varvaluesName,Q.varvaluesUnits=r().varvaluesUnits}Q.fileName=t(f).name.replace(/\.[^/.]+$/,""),o(Q),z()}catch(Q){o(null),k(Q)}}function I($){const Q=new FileReader;Q.onload=()=>{A(Q.result)},Q.readAsText(t(f))}async function D($){try{const Q=t(f)instanceof FileList?t(f):[t(f)];o(await ad(Q)),z()}catch(Q){k("Failed to read SPC file: "+Q)}}function W(){F(f,""),o(null),c(null),F(v,""),F(m,""),P()}ge(()=>{if(!(t(f)===0||t(f)===void 0||o())){if(t(f)===null||t(f)===""){W();return}if(Array.isArray(t(f))){if(t(f).filter($=>$.slice(-4)===".spc").length!==t(f).length){k("Multiple file selection is allowed only for SPC files.");return}D(t(f));return}t(f)&&(t(f).type==="text/csv"||t(f).type==="application/vnd.ms-excel")?(R(t(f),r()),P()):D([t(f)])}}),ge(()=>{t(p)&&P()}),ge(()=>{if(o()&&r()&&!c()&&!t(L))try{j(r(),o(),l()),z()}catch($){o(null),c(null),k($)}});var T=dh(),q=X(T);{var Z=$=>{var Q=oh(),ae=X(Q);zn(ae,()=>t(f)===void 0,ye=>{oe(ye,{children:(Ce,me)=>{var he=ce(),pe=X(he);{var Pe=de=>{jl(de,{id:"dataFile",message:"Select CSV file with dataset",get file(){return t(f)},set file(le){F(f,le,!0)}})},re=de=>{jl(de,{id:"dataFile",message:"Select CSV or SPC file with dataset",acceptType:".csv, .spc",multiple:!0,get file(){return t(f)},set file(le){F(f,le,!0)}})};B(pe,de=>{s()?de(Pe):de(re,!1)})}E(Ce,he)},$$slots:{default:!0}})});var _e=N(ae,2);{var ie=ye=>{var Ce=ah(),me=X(Ce);oe(me,{label:"Delimiter",children:(le,we)=>{He(le,{id:"sep",get options(){return d},get value(){return t(p)},set value(ue){F(p,ue,!0)}})},$$slots:{default:!0}});var he=N(me,2);oe(he,{label:"Row labels",children:(le,we)=>{Kt(le,{id:"hasLabels",options:["no","yes"],get value(){return t(b)},set value(ue){F(b,ue,!0)}})},$$slots:{default:!0}});var pe=N(he,2);oe(pe,{label:"Header",children:(le,we)=>{He(le,{id:"header",get options(){return t(u)},get value(){return t(w)},set value(ue){F(w,ue,!0)}})},$$slots:{default:!0}});var Pe=N(pe,2);{var re=le=>{var we=sh(),ue=X(we);oe(ue,{label:"Header name (predictors)",children:(Re,je)=>{ni(Re,{id:"varvaluesName",placeholder:"e.g. Wavelength",get value(){return t(v)},set value(Ve){F(v,Ve,!0)}})},$$slots:{default:!0}});var Ee=N(ue,2);oe(Ee,{label:"Header units (predictors)",children:(Re,je)=>{ni(Re,{id:"varvaluesUnits",maxLength:10,placeholder:"e.g. nm",get value(){return t(m)},set value(Ve){F(m,Ve,!0)}})},$$slots:{default:!0}}),E(le,we)};B(Pe,le=>{t(w)==="values"&&le(re)})}var de=N(Pe,2);oe(de,{label:" ",children:(le,we)=>{at(le,{text:"Load",onclick:I})},$$slots:{default:!0}}),E(ye,Ce)};B(_e,ye=>{t(f)&&!Array.isArray(t(f))&&(t(f).type==="text/csv"||t(f).type==="application/vnd.ms-excel")&&ye(ie)})}E($,Q)},M=$=>{var Q=ce(),ae=X(Q);{var _e=ie=>{var ye=ce(),Ce=X(ye);ps(Ce,()=>t(y),me=>{oe(me,{children:(he,pe)=>{var Pe=ch(),re=X(Pe);Fs(re);var de=N(re,2),le=Y(de);ne(()=>ke(le,r()?"Loading data and apply model...":"Loading data...")),E(he,Pe)},$$slots:{default:!0}})},void 0,(me,he)=>{oe(me,{status:"error",children:(pe,Pe)=>{var re=ih(),de=Y(re);ne(()=>ke(de,t(he))),E(pe,re)},$$slots:{default:!0}})}),E(ie,ye)};B(ae,ie=>{t(y)&&ie(_e)})}E($,Q)};B(q,$=>{o()?$(M,!1):$(Z)})}var U=N(q,2);{var K=$=>{lh($,{get dataset(){return o()},reset:W,get title(){return a()}})};B(U,$=>{o()&&$(K)})}var J=N(U,2);{var se=$=>{oe($,{status:"error",children:(Q,ae)=>{var _e=uh(),ie=Y(_e);ne(()=>ke(ie,t(L))),E(Q,_e)},$$slots:{default:!0}})};B(J,$=>{(t(C)==="error"||t(L))&&$(se)})}E(n,T),ve()}var fh=H('<div class="msg-select"> </div>'),vh=H('<div class="msg-select"> </div>'),mh=H('<div class="msg-select"> </div>'),hh=H('<div class="msg-select"> </div>'),gh=H('<div class="selected-buttons svelte-8mh2yv"><!></div>'),ph=H('<div class="selected-buttons svelte-8mh2yv"><!></div>'),bh=H("<!> <!> <!>",1),_h=()=>switchPlot(i),wh=(n,e,r)=>F(e,t(r),!0),yh=H("<button> </button>"),xh=H('<div class="plot-panel svelte-8mh2yv"><div class="plot-area svelte-8mh2yv"><div class="plot svelte-8mh2yv"><!></div> <div class="plot-select-msg svelte-8mh2yv"><!> <!></div></div> <div class="plot-controls-area svelte-8mh2yv"></div></div>');function na(n,e){fe(e,!0);let r=V(e,"selobjText",3,"Click to select an object..."),l=V(e,"selvarText",3,"Make rectangular selection of variable to exclude ..."),s=V(e,"clearText",3,"Click anywhere to remove selection..."),a=V(e,"params",15),o=Ne({objects:-1,variables:[]}),c=te(Ne(Object.keys(e.plots)[0]));function d(j,R){o.objects=R?R[j]:j}function u(j){o.objects=-1}function f(j){o.variables=j}function v(j){o.variables=[]}let m={objects:{select:d,unselect:u},variables:{select:f,unselect:v},stats:{}},h=g(()=>t(c)?e.plots[t(c)]:null),p=g(()=>t(h)?t(h).component:null);var w=xh(),b=Y(w),_=Y(b),S=Y(_);Jn(S,()=>t(p),(j,R)=>{R(j,{get params(){return a()[t(c)]},get callbacks(){return m[t(h).scope]},get selected(){return o[t(h).scope]},get props(){return e.props}})});var y=N(_,2),C=Y(y);{var L=j=>{var R=ce(),A=X(R);{var I=W=>{var T=fh(),q=Y(T);ne(()=>ke(q,r())),E(W,T)},D=W=>{var T=vh(),q=Y(T);ne(()=>ke(q,s())),E(W,T)};B(A,W=>{o[t(h).scope]<0?W(I):W(D,!1)})}E(j,R)};B(C,j=>{t(h).scope==="objects"&&a()[t(c)].plotType!=="l"&&r().length>0&&j(L)})}var k=N(C,2);{var P=j=>{var R=ce(),A=X(R);{var I=W=>{var T=mh(),q=Y(T);ne(()=>ke(q,l())),E(W,T)},D=W=>{var T=hh(),q=Y(T);ne(()=>ke(q,s())),E(W,T)};B(A,W=>{o[t(h).scope].length===0?W(I):W(D,!1)})}E(j,R)};B(k,j=>{t(h).scope==="variables"&&a()[t(c)].plotType!=="l"&&l().length>0&&j(P)})}var z=N(b,2);Me(z,21,()=>Object.keys(e.plots),qe,(j,R)=>{var A=ce(),I=X(A);{var D=T=>{var q=bh(),Z=X(q);Vd(Z,{get title(){return t(h).label},labelWidth:12,get options(){return e.controls[t(c)]},get value(){return a()[t(c)]},set value(se){a(a()[t(c)]=se,!0)}});var M=N(Z,2);{var U=se=>{var $=gh(),Q=Y($);Sr(Q,()=>t(h).buttons,()=>o.objects),E(se,$)};B(M,se=>{t(h).scope==="objects"&&t(h).buttons&&o.objects>=0&&se(U)})}var K=N(M,2);{var J=se=>{var $=ph(),Q=Y($);Sr(Q,()=>t(h).buttons,()=>o.variables),E(se,$)};B(K,se=>{t(h).scope==="variables"&&t(h).buttons&&o.variables.length>0&&se(J)})}E(T,q)},W=T=>{var q=yh();q.__keydown=[_h],q.__click=[wh,c,R];var Z=Y(q);ne(()=>{pt(q,1,`plot-selector plot-selector-${t(R)??""}`,"svelte-8mh2yv"),ke(Z,e.plots[t(R)].label)}),E(T,q)};B(I,T=>{t(h)&&t(c)===t(R)?T(D):T(W,!1)})}E(j,A)}),E(n,w),ve()}vt(["keydown","click"]);function Ri(n,e,r){!e.callbacks||!e.callbacks.select||pn(n,n.target.tagName,l=>e.callbacks.select(l,r()))}function kh(n,e){!e.callbacks||!e.callbacks.unselect||e.callbacks.unselect()}var Eh=xe("<text> </text>"),Sh=xe('<g class="series series-textlabels"></g>'),Ch=xe('<g class="series series-line"><polyline class="line"></polyline></g>'),Ah=xe("<rect></rect>"),Th=xe('<g class="series series-bar"></g>'),Ph=xe("<text> </text>"),Lh=xe('<g class="series series-points series-points1"></g>'),Nh=xe('<rect width="100%" height="100%" fill="#ffffff00"></rect>'),zh=xe('<g class="series series-points series-points1"><text> </text></g>'),Rh=xe('<g class="series series-bar"><rect></rect></g>'),Mh=xe('<g class="series series-text"><text> </text></g>'),Ih=xe("<!><!><!>",1),Fh=xe("<!><!><!><!><!>",1);function Jt(n,e){fe(e,!0);let r=V(e,"shortenLabels",3,!0),l=V(e,"lineWidth",3,1),s=V(e,"nBars",3,1),a=V(e,"barNum",3,1),o=V(e,"markerSize",3,null),c=V(e,"markerWidth",3,2),d=V(e,"marker",3,1),u=V(e,"colors",3,void 0),f=V(e,"filled",3,void 0),v=V(e,"mainColor",19,()=>Ur.cal),m=V(e,"faceColor",3,null),h=V(e,"selected",19,()=>-1),p=V(e,"maskSelected",3,!0),w=V(e,"xRange",15),b=V(e,"yRange",15),_=V(e,"ind",3,null);const S=jt("axes"),y=g(()=>Rt(e.xValues,"PlotSeries")),C=g(()=>t(y)?Rt(e.yValues,"PlotSeries",t(y).length):null);ge(()=>{if(_()){const pe=_().map(Pe=>Pe+1);w(t(y)?Tr(t(y).subset(pe)):null),b(t(C)?Tr(t(C).subset(pe)):null)}else w(t(y)?Tr(t(y)):null),b(t(C)?Tr(t(C)):null)});const L=g(()=>m()===null?e.plotType==="p"?"transparent":"white":m()),k=[1,.8,.8,.8,.8,.8,.8,.8],P=[.85,.65,.65,.65,.65,.65,.65,.65],z=g(()=>o()?o():e.plotType==="p"?k[d()-1]:P[d()-1]),j=g(()=>Rn[d()-1]),R=g(()=>Bs[S.scales().plot]),A=g(()=>mt([0],S.tY())[0]),I=g(()=>tl([.8],S.tX())[0]),D=g(()=>e.plotType==="h"?t(I)/s():0),W=g(()=>e.plotType==="h"?t(I)/2-(a()-1)*t(D):0),T=g(()=>t(R));let q=g(()=>e.plotType==="l"||e.plotType==="b"?Ys(t(y),t(C),S.tX(),S.tY()):null),Z=g(()=>t(y)?mt(t(y),S.tX()):null),M=g(()=>t(C)?mt(t(C),S.tY()):null),U=g(()=>e.labels&&Array.isArray(e.labels)?r()?e.labels.map(pe=>pe.slice(0,Ti)):e.labels:null);const K=g(()=>_()?_():Dr(0,t(Z).length-1));let J=g(()=>u()&&u().length===t(y).length?u():Array(t(y).length).fill(v())),se=g(()=>f()&&f().length===t(y).length?f().map(pe=>pe?"ff":"30"):Array(t(y).length).fill("30")),$=g(()=>u()&&u().length===t(y).length?u().map((pe,Pe)=>pe+t(se)[Pe]):Array(t(y).length).fill(m()));const Q=g(()=>`font-size:${t(z)}em;fill:${t(L)};cursor:default;text-anchor:middle;stroke-width:${c()}px;user-select:none;`),ae=`font-size:0.85em;fill:${Bl};cursor:default;text-anchor:middle;stroke:${Bl};stroke-width:0.1px;user-select:none;`,_e=g(()=>`font-size:${t(z)}em;fill:none;text-anchor:middle;text-anchor:middle;cursor:default;stroke-width:2px;user-select:none;`),ie=`fill:transparent;stroke-width:${l()}px;`,ye=`stroke-width:${l()}px;`;ge(()=>{h()&&_()&&_().indexOf(h())<0&&e.callbacks.unselect()});var Ce=ce(),me=X(Ce);{var he=pe=>{var Pe=Fh(),re=X(Pe);{var de=Ye=>{var Be=Sh();Me(Be,21,()=>t(K),qe,(Ze,Xe)=>{var Ke=Eh(),Qt=Y(Ke);ne(()=>{O(Ke,"opacity",t(Xe)===h()),O(Ke,"x",t(Z)[t(Xe)]-t(W)+t(D)/2),O(Ke,"y",t(M)[t(Xe)]),O(Ke,"dy",t(C).v[t(Xe)]<0?t(T):-t(T)),ke(Qt,t(U)[t(Xe)])}),E(Ze,Ke)}),ne(()=>ht(Be,ae+(h()>=0?"opacity:0.2;":""))),E(Ye,Be)};B(re,Ye=>{e.showLabels&&t(U)&&Ye(de)})}var le=N(re);{var we=Ye=>{var Be=Ch(),Ze=Y(Be);ne(()=>{ht(Be,ie),O(Ze,"points",t(q)),O(Ze,"stroke",v())}),E(Ye,Be)};B(le,Ye=>{(e.plotType==="l"||e.plotType==="b")&&Ye(we)})}var ue=N(le);{var Ee=Ye=>{var Be=Th();Be.__click=[Ri,e,_],Me(Be,21,()=>t(K),qe,(Ze,Xe)=>{var Ke=Ah();ne(()=>{O(Ke,"x",t(Z)[t(Xe)]-t(W)),O(Ke,"y",t(C).v[t(Xe)]<0?t(A):t(M)[t(Xe)]),O(Ke,"fill",t(J)[t(Xe)]),O(Ke,"width",t(D)),O(Ke,"height",t(C).v[t(Xe)]<0?t(M)[t(Xe)]-t(A):t(A)-t(M)[t(Xe)])}),E(Ze,Ke)}),ne(()=>ht(Be,ye+(h()>=0?"opacity:0.2;":""))),E(Ye,Be)};B(ue,Ye=>{e.plotType==="h"&&Ye(Ee)})}var Re=N(ue);{var je=Ye=>{var Be=Lh();Be.__click=[Ri,e,_],Me(Be,21,()=>t(K),qe,(Ze,Xe)=>{var Ke=Ph(),Qt=Y(Ke);ne(()=>{O(Ke,"x",t(Z)[t(Xe)]),O(Ke,"y",t(M)[t(Xe)]),O(Ke,"fill",t($)[t(Xe)]),O(Ke,"stroke",t(J)[t(Xe)]),ke(Qt,t(j))}),E(Ze,Ke)}),ne(()=>ht(Be,t(Q)+(h()>=0?"opacity:0.2;":""))),E(Ye,Be)};B(Re,Ye=>{(e.plotType==="p"||e.plotType==="b")&&Ye(je)})}var Ve=N(Re);{var tt=Ye=>{var Be=Ih(),Ze=X(Be);{var Xe=Le=>{var Ae=Nh();O(Ae,"x",0),O(Ae,"y",0),Ae.__click=[kh,e],E(Le,Ae)};B(Ze,Le=>{p()&&Le(Xe)})}var Ke=N(Ze);{var Qt=Le=>{var Ae=zh(),ze=Y(Ae),_t=Y(ze);ne(()=>{ht(Ae,t(_e)),O(ze,"x",t(Z)[h()]),O(ze,"y",t(M)[h()]),O(ze,"stroke",t(J)[h()]),O(ze,"fill",t($)[h()]),ke(_t,t(j))}),E(Le,Ae)},Pr=Le=>{var Ae=Rh(),ze=Y(Ae);ne(()=>{ht(Ae,ye),O(ze,"stroke",t(J)[h()]),O(ze,"fill",t(J)[h()]),O(ze,"x",t(Z)[h()]-t(W)),O(ze,"y",t(C).v[h()]<0?t(A):t(M)[h()]),O(ze,"width",t(D)),O(ze,"height",t(C).v[h()]<0?t(M)[h()]-t(A):t(A)-t(M)[h()])}),E(Le,Ae)};B(Ke,Le=>{e.plotType!=="h"?Le(Qt):Le(Pr,!1)})}var Lr=N(Ke);{var Se=Le=>{var Ae=Mh(),ze=Y(Ae),_t=Y(ze);ne(()=>{ht(Ae,ae),O(ze,"stroke",Ai),O(ze,"fill",Ai),O(ze,"x",t(Z)[h()]),O(ze,"y",t(M)[h()]),O(ze,"dy",t(C).v[h()]<0?t(T):-t(T)),ke(_t,t(U)[h()])}),E(Le,Ae)};B(Lr,Le=>{e.showLabels&&t(U)&&t(U).length>0&&Le(Se)})}E(Ye,Be)};B(Ve,Ye=>{h()>=0&&Ye(tt)})}E(pe,Pe)};B(me,pe=>{t(Z)&&t(M)&&pe(he)})}E(n,Ce),ve()}vt(["click"]);var jh=H("<!> <!> <!> <!>",1);function Mi(n,e){fe(e,!0);let r=g(()=>e.props?e.props.res:null),l=g(()=>t(r)?Object.keys(t(r)):null),s=g(()=>e.params&&e.params.resID&&t(l)?e.params.resID==="both"?t(l):[e.params.resID]:null),a=g(()=>t(s)?t(r)[t(s)[0]]:null);const o={expvar:"Explained variance",resvar:"Residual variance",cumexpvar:"Cumulative explained variance",cumresvar:"Cumulative residual variance"},c=g(()=>e.params.varSet==="X"?"x":"y"),d=g(()=>e.params.varForm==="cumulative"?"cum":""),u=g(()=>e.params.varType==="explained"?"exp":"res"),f=g(()=>t(d)+t(u)+"var"),v=g(()=>t(c)+t(d)+t(u)+"var"),m=g(()=>t(f)?o[t(f)]+" ("+e.params.varSet+")":""),h=g(()=>t(a).ncomp>1?1-t(a).ncomp*.065:-.1),p=g(()=>t(a).ncomp>1?t(a).ncomp*1.065:2.1),w=g(()=>[t(h),t(p)]),b=g(()=>t(a)?t(a).stat.components:null),_=g(()=>t(s)?t(s).map(z=>{const j=t(r)[z].stat[t(v)];return{yValues:Ge(j),labels:Array.from(j).map(R=>R.toFixed(R<.1?3:2)),faceColor:Ci[z],mainColor:Ur[z],marker:Wr[z]}}):null),S=g(()=>t(_)?Gt(t(_).map(z=>Math.min(-.05,Gt(z.yValues)))):0),y=g(()=>[t(S)*1.1,1.1]),C=g(()=>sl(t(s)));var L=ce(),k=X(L);{var P=z=>{{let j=g(()=>"plot-"+t(v));xr(z,{get title(){return t(m)},get limX(){return t(w)},get limY(){return t(y)},xLabel:"Number of LVs",yLabel:"Variance",get fileName(){return t(j)},whole:!0,children:(R,A)=>{var I=jh(),D=X(I);{var W=U=>{{let K=g(()=>[e.props.ncomp]),J=g(()=>[e.props.ncomp]),se=g(()=>[t(y)[0]]),$=g(()=>[t(y)[1]]);bn(U,{get xStart(){return t(K)},get xEnd(){return t(J)},get yStart(){return t(se)},get yEnd(){return t($)},lineColor:"#a0a0a0"})}};B(D,U=>{e.props.ncomp&&U(W)})}var T=N(D,2);Me(T,17,()=>t(_),qe,(U,K)=>{Jt(U,{get xValues(){return t(b)},get yValues(){return t(K).yValues},get labels(){return t(K).labels},get faceColor(){return t(K).faceColor},get mainColor(){return t(K).mainColor},get marker(){return t(K).marker},plotType:"b",get showLabels(){return e.params.showLabels},lineWidth:1.5})});var q=N(T,2);{var Z=U=>{var K=ce(),J=X(K);Me(J,17,()=>t(_),qe,(se,$)=>{{let Q=g(()=>[t(b)[e.props.ncomp-1]]),ae=g(()=>[t($).yValues.v[e.props.ncomp-1]]);Jt(se,{get xValues(){return t(Q)},get yValues(){return t(ae)},get faceColor(){return t($).faceColor},get mainColor(){return t($).mainColor},plotType:"b",get showLabels(){return e.params.showLabels},get marker(){return t($).marker},markerWidth:3})}}),E(U,K)};B(q,U=>{e.props.ncomp&&U(Z)})}var M=N(q,2);rl(M,{get items(){return t(C)}}),E(R,I)},$$slots:{default:!0}})}};B(k,z=>{t(b)&&t(_)&&z(P)})}E(n,L),ve()}var Vh=H("<!> <!> <!> <!>",1);function Ii(n,e){fe(e,!0);const r={rmse:"RMSE",r2:"R^2",slope:"Slope"};let l=g(()=>e.props?e.props.res:null),s=g(()=>t(l)?Object.keys(t(l)):null),a=g(()=>e.params&&e.params.resID&&t(s)?e.params.resID==="both"?t(s):[e.params.resID]:null),o=g(()=>t(a)?t(l)[t(a)[0]]:null),c=g(()=>e.params?r[e.params.fom]:""),d=g(()=>e.params?r[e.params.fom]+" ("+t(o).varlabels[e.params.resp-1]+")":""),u=g(()=>t(o).ncomp>1?1-t(o).ncomp*.065:-.1),f=g(()=>t(o).ncomp>1?t(o).ncomp*1.065:2.1),v=g(()=>[t(u),t(f)]),m=g(()=>t(o)?t(o).stat.components:null),h=g(()=>{if(!t(a))return null;let C=0,L=Number.NEGATIVE_INFINITY,k=[];for(let P of t(a)){const z=t(l)[P].stat[e.params.fom].getcolref(e.params.resp);C=Math.min(C,Gt(z)),L=Math.max(L,nr(z)),k.push({yValues:Ge(z),labels:Array.from(z).map(j=>j.toFixed(j<.1?3:2)),faceColor:Ci[P],mainColor:Ur[P],marker:Wr[P]})}return{yMin:C,yMax:L,values:k}}),p=g(()=>sl(t(a)));const w=g(()=>t(h)?(t(h).yMax-t(h).yMin)*.05:0),b=g(()=>t(h)?[t(h).yMin-t(w),t(h).yMax+4*t(w)]:[0,1]);var _=ce(),S=X(_);{var y=C=>{{let L=g(()=>"plot-"+e.params.fom);xr(C,{get title(){return t(d)},get limX(){return t(v)},get limY(){return t(b)},get yLabel(){return t(c)},xLabel:"Number of LVs",get fileName(){return t(L)},whole:!0,children:(k,P)=>{var z=Vh(),j=X(z);{var R=T=>{{let q=g(()=>[e.props.ncomp]),Z=g(()=>[e.props.ncomp]),M=g(()=>[t(b)[0]]),U=g(()=>[t(b)[1]]);bn(T,{get xStart(){return t(q)},get xEnd(){return t(Z)},get yStart(){return t(M)},get yEnd(){return t(U)},lineColor:"#a0a0a0"})}};B(j,T=>{e.props.ncomp&&T(R)})}var A=N(j,2);Me(A,17,()=>t(h).values,qe,(T,q)=>{Jt(T,{get xValues(){return t(m)},get yValues(){return t(q).yValues},get labels(){return t(q).labels},get faceColor(){return t(q).faceColor},get mainColor(){return t(q).mainColor},get marker(){return t(q).marker},plotType:"b",get showLabels(){return e.params.showLabels},lineWidth:1.5})});var I=N(A,2);{var D=T=>{var q=ce(),Z=X(q);Me(Z,17,()=>t(h).values,qe,(M,U)=>{{let K=g(()=>[t(m)[e.props.ncomp-1]]),J=g(()=>[t(U).yValues.v[e.props.ncomp-1]]);Jt(M,{get xValues(){return t(K)},get yValues(){return t(J)},get faceColor(){return t(U).mainColor},get mainColor(){return t(U).mainColor},get marker(){return t(U).marker},plotType:"b",get showLabels(){return e.params.showLabels},markerWidth:3})}}),E(T,q)};B(I,T=>{e.props.ncomp&&T(D)})}var W=N(I,2);rl(W,{get items(){return t(p)}}),E(k,z)},$$slots:{default:!0}})}};B(S,C=>{t(m)&&t(h)&&C(y)})}E(n,_),ve()}var Oh=H("<!> <!>",1),Bh=H("<!> <!> <!> <!>",1);function la(n,e){fe(e,!0);const r=g(()=>e.props?e.props.res:null),l=g(()=>t(r)?Object.keys(t(r)):null),s=g(()=>e.params&&e.params.resID&&t(l)?e.params.resID==="both"?t(l):[e.params.resID]:null),a=g(()=>t(s)&&t(r)[t(s)[0]]?t(r)[t(s)[0]]:null),o=g(()=>!!(t(a)&&t(a).Yref)),c=g(()=>t(a)?"Predictions for "+t(a).varlabels[e.params.resp-1]+" (A = "+e.props.ncomp+")":""),d=g(()=>t(o)?"Reference y-values":"Objects"),u=g(()=>{if(!t(a)||!t(a).stat||!e.params.showStat||e.params.resID==="both")return null;const _=e.params.resID,S=t(r)[_].stat.rmse.getcolref(e.params.resp)[e.props.ncomp-1],y=t(r)[_].stat.r2.getcolref(e.params.resp)[e.props.ncomp-1],C=t(r)[_].stat.slope.getcolref(e.params.resp)[e.props.ncomp-1];return'<tspan x="5em" dy="1.5em">RMSE: '+S.toFixed(2)+'</tspan><tspan x="5em" dy="1.5em">R2: '+y.toFixed(3)+'</tspan><tspan x="5em" dy="1.5em">Slope: '+C.toFixed(3)+"</tspan></tspan>"}),f=g(()=>{if(!t(s)||!t(a))return null;let _=e.params.resp?Number.POSITIVE_INFINITY:null,S=e.params.resp?Number.NEGATIVE_INFINITY:null,y=0,C=[],L="";for(let k of t(s)){const P=t(r)[k],z=P.Yref?P.Yref.getcolref(e.params.resp):P.objindices.map(I=>I+1),j=Lt(P,"Yp",e.props.ncomp,e.params.resp),R=xo(z,j)/Es(z),A=fn(j)-R*fn(z);_=Math.min(_,Gt(z),Gt(j)),S=Math.max(S,nr(z),nr(j)),y+=z.length,C.push({xValues:Ge(z),yValues:Ge(j),lineX:[_,S],lineY:[A+R*_,A+R*S],labels:e.params.showLabels==="labels"?P.objlabels:Sv(j,_,S),faceColor:nl[k],mainColor:Ur[k],marker:Wr[k],stats:L})}return{vMin:_,vMax:S,vNum:y,values:C}});let v=g(()=>sl(t(s)));const m=g(()=>t(f)?(t(f).vMax-t(f).vMin)*.075:null),h=g(()=>t(m)?[t(f).vMin-t(m),t(f).vMax+t(m)]:[0,1]);var p=ce(),w=X(p);{var b=_=>{{let S=g(()=>t(o)?t(h):[0,t(f).vNum+1]);xr(_,{get title(){return t(c)},get xLabel(){return t(d)},get limX(){return t(S)},get limY(){return t(h)},yLabel:"Predicted y-values",fileName:"plot-predictions",get onclick(){return e.callbacks.unselectObject},children:(y,C)=>{var L=Bh(),k=X(L);{var P=I=>{yr(I,{get xValues(){return t(h)},get yValues(){return t(h)},lineColor:"#d0d0d0"})};B(k,I=>{t(o)&&I(P)})}var z=N(k,2);Me(z,17,()=>t(f).values,qe,(I,D)=>{var W=Oh(),T=X(W);{var q=M=>{yr(M,{get xValues(){return t(D).lineX},get yValues(){return t(D).lineY},get lineColor(){return t(D).mainColor}})};B(T,M=>{t(o)&&M(q)})}var Z=N(T,2);{let M=g(()=>e.params.showLabels!=="hide"),U=g(()=>t(o)?"p":"h");Jt(Z,{get selected(){return e.selected},get callbacks(){return e.callbacks},get xValues(){return t(D).xValues},get yValues(){return t(D).yValues},get faceColor(){return t(D).faceColor},get mainColor(){return t(D).mainColor},get labels(){return t(D).labels},get marker(){return t(D).marker},get showLabels(){return t(M)},get plotType(){return t(U)}})}E(I,W)});var j=N(z,2);{var R=I=>{{let D=g(()=>[t(h)[0]]),W=g(()=>[t(h)[1]-t(m)]);_n(I,{textSize:.85,pos:0,get xValues(){return t(D)},get yValues(){return t(W)},get labels(){return t(u)}})}};B(j,I=>{t(u)&&I(R)})}var A=N(j,2);rl(A,{get items(){return t(v)},position:"bottomright"}),E(y,L)},$$slots:{default:!0}})}};B(w,_=>{t(f)&&_(b)})}E(n,p),ve()}var qh=H("<!> <!>",1),Dh=H("<!> <!> <!>",1);function sa(n,e){fe(e,!0);let r=g(()=>e.props?e.props.model:null),l=g(()=>e.props?e.props.res:null),s=g(()=>t(l)?Object.keys(t(l)):null),a=g(()=>e.params&&e.params.resID&&t(s)?e.params.resID==="both"?t(s):[e.params.resID]:null),o=g(()=>t(a)?t(l)[t(a)[0]]:null);const c="Scores";function d(S,y){return S==="X"?"X":S==="Y"?"Y":y==="x"?"X":"Y"}function u(S,y,C,L){return(S==="X"||S==="Y")&&L==="x"?y:C}function f(S,y){const C=d(S.varSet,y),L=u(S.varSet,S.comp1,S.comp2,y),k=t(r).stat[C.toLocaleLowerCase()+"expvar"][L-1]*100;return C+"-scores (LV"+L+", "+k.toFixed(k>1?1:2)+"%)"}let v=g(()=>{if(!t(a)||!t(o))return null;let S=Number.POSITIVE_INFINITY,y=Number.POSITIVE_INFINITY,C=Number.NEGATIVE_INFINITY,L=Number.NEGATIVE_INFINITY,k=[];for(let A of t(a)){const I=t(l)[A],D=e.params.varSet==="X"|e.params.varSet==="XY"?Lt(I,"xscores",e.params.varSet==="XY"?e.params.comp2:e.params.comp1):Lt(I,"yscores",e.params.comp1),W=e.params.varSet==="X"?Lt(I,"xscores",e.params.comp2):Lt(I,"yscores",e.params.comp2);S=Math.min(S,Gt(D)),y=Math.min(y,Gt(W)),C=Math.max(C,nr(D)),L=Math.max(L,nr(W)),k.push({xValues:Ge(D),yValues:Ge(W),labels:I.objlabels,marker:Wr[A],faceColor:nl[A],mainColor:Ur[A]})}const P=(C-S)*.05,z=(L-y)*.05,j=[S-P,C+P],R=[y-z,L+z];return{limX:j,limY:R,values:k}});const m=g(()=>f(e.params,"x")),h=g(()=>f(e.params,"y"));let p=g(()=>sl(t(a)));var w=ce(),b=X(w);{var _=S=>{{let y=g(()=>"plot-"+e.params.varSet.toLowerCase()+"scores");xr(S,{title:c,get xLabel(){return t(m)},get yLabel(){return t(h)},get limX(){return t(v).limX},get limY(){return t(v).limY},get fileName(){return t(y)},get onclick(){return e.callbacks.unselectObject},children:(C,L)=>{var k=Dh(),P=X(k);{var z=A=>{var I=qh(),D=X(I);{let T=g(()=>[t(v).limY[0]]),q=g(()=>[t(v).limY[1]]);bn(D,{xStart:[0],xEnd:[0],get yStart(){return t(T)},get yEnd(){return t(q)},get lineColor(){return ll}})}var W=N(D,2);{let T=g(()=>[t(v).limX[0]]),q=g(()=>[t(v).limX[1]]);bn(W,{yStart:[0],yEnd:[0],get xStart(){return t(T)},get xEnd(){return t(q)},get lineColor(){return ll}})}E(A,I)};B(P,A=>{e.props.ncomp&&A(z)})}var j=N(P,2);Me(j,17,()=>t(v).values,qe,(A,I)=>{Jt(A,{get selected(){return e.selected},get callbacks(){return e.callbacks},get xValues(){return t(I).xValues},get yValues(){return t(I).yValues},get faceColor(){return t(I).faceColor},get mainColor(){return t(I).mainColor},get marker(){return t(I).marker},get labels(){return t(I).labels},get showLabels(){return e.params.showLabels},plotType:"p",lineWidth:1.5})});var R=N(j,2);rl(R,{get items(){return t(p)}}),E(C,k)},$$slots:{default:!0}})}};B(b,S=>{t(v)&&S(_)})}E(n,w),ve()}var Yh=H("<!> <!> <!>",1),Wh=H("<!> <!> <!>",1);function Fi(n,e){fe(e,!0);function r(Q,ae,_e){if(_e<10)return Math.round(Math.log2(_e)+1);const ie=2*Q/Math.pow(_e,.3333333);return Math.round(ae/ie)}const l={p:"Reference y-values",qq:"Standard normal quantiles, z",h:"Residuals, e"},s={p:"Residuals, e",qq:"Sample quantiles, e",h:"Counts"},a=g(()=>e.props.res[e.params.resID]),o=g(()=>t(a)?"Residuals for "+t(a).varlabels[e.params.resp-1]+" (A = "+e.props.ncomp+")":""),c=g(()=>l[e.params.plotType]),d=g(()=>s[e.params.plotType]),u=g(()=>t(a)?t(a).Yref.getcolref(e.params.resp):null),f=g(()=>t(a)?Lt(t(a),"Yp",e.props.ncomp,e.params.resp):null),v=g(()=>t(u)&&t(f)?new Ie(t(u).map((Q,ae)=>Q-t(f)[ae])):null),m=g(()=>t(v)?t(v).sort():null),h=g(()=>t(a)?zu(t(a).nrows):null),p=g(()=>t(h)?Ml(t(h)):null),w=g(()=>t(m)?t(m).v[Math.round(t(m).length*.25)]:null),b=g(()=>t(m)?t(m).v[Math.round(t(m).length*.75)]:null),_=g(()=>t(w)&&t(b)?t(b)-t(w):null),S=g(()=>t(_)?t(_)/1.348:1),y=g(()=>t(w)&&t(S)?t(w)+t(S)*.674:0),C=g(()=>[-4*t(S)+t(y),4*t(S)+t(y)]),L=[-4,4],k=g(()=>t(a)?t(a).nrows:1),P=g(()=>t(v)?Tr(t(v)):null),z=g(()=>t(_)&&t(k)&&t(P)?r(t(_),t(P)[1]-t(P)[0],t(k)):10),j=g(()=>t(v)?Rl(t(v),t(z)):null),R=g(()=>t(j)?_o(t(v),t(j)):null),A=g(()=>t(j)?wo(t(j)):null),I=g(()=>t(v)?Array.from(t(v).sortind().v):null),D=g(()=>e.params.plotType==="p"?t(a).objlabels:t(I).map(Q=>t(a).objlabels[Q-1])),W=g(()=>t(v)?e.params.plotType==="p"?new Ie(t(u)):e.params.plotType==="qq"?t(p):t(A):null),T=g(()=>t(v)?e.params.plotType==="p"?t(v):e.params.plotType==="qq"?t(m):t(R):null),q=g(()=>Ur[e.params.resID]),Z=g(()=>nl[e.params.resID]),M=g(()=>Wr[e.params.resID]),U=g(()=>t(W)?Ar(t(W)):[0,1]),K=g(()=>t(T)?Ar(t(T)):[0,1]);var J=ce(),se=X(J);{var $=Q=>{xr(Q,{get title(){return t(o)},get xLabel(){return t(c)},get limX(){return t(U)},get limY(){return t(K)},get yLabel(){return t(d)},fileName:"plot-yresiduals",get onclick(){return e.callbacks.unselectObject},children:(ae,_e)=>{var ie=ce(),ye=X(ie);{var Ce=he=>{var pe=Yh(),Pe=X(pe);Jt(Pe,{get xValues(){return t(W)},get yValues(){return t(T)},get mainColor(){return t(q)},get faceColor(){return t(Z)},get marker(){return t(M)},plotType:"p"});var re=N(Pe,2);yr(re,{get xValues(){return L},get yValues(){return t(C)},lineColor:"#606060"});var de=N(re,2);{var le=we=>{_n(we,{get xValues(){return t(W)},get yValues(){return t(T)},get labels(){return t(D)},pos:3,textSize:.85,get faceColor(){return Bl}})};B(de,we=>{e.params.showLabels!=="hide"&&we(le)})}E(he,pe)},me=he=>{var pe=ce(),Pe=X(pe);{var re=le=>{nv(le,{get xValues(){return t(W)},get yValues(){return t(T)},get faceColor(){return t(q)},get lineColor(){return t(q)},barWidth:.95})},de=le=>{var we=Wh(),ue=X(we);Jt(ue,{get xValues(){return t(W)},get yValues(){return t(T)},get mainColor(){return t(q)},get faceColor(){return t(Z)},get marker(){return t(M)},plotType:"p"});var Ee=N(ue,2);yr(Ee,{get xValues(){return t(U)},yValues:[0,0],lineColor:"#606060"});var Re=N(Ee,2);{var je=Ve=>{_n(Ve,{get xValues(){return t(W)},get yValues(){return t(T)},get labels(){return t(D)},pos:3,textSize:.85,get faceColor(){return Bl}})};B(Re,Ve=>{e.params.showLabels!=="hide"&&Ve(je)})}E(le,we)};B(Pe,le=>{e.params.plotType==="h"?le(re):le(de,!1)},!0)}E(he,pe)};B(ye,he=>{e.params.plotType==="qq"?he(Ce):he(me,!1)})}E(ae,ie)},$$slots:{default:!0}})};B(se,Q=>{t(W)&&t(T)&&Q($)})}E(n,J),ve()}var Uh=H("<!> <!> <!>",1);function Hh(n,e){fe(e,!0);let r=g(()=>e.props?e.props.model:null);function l(P,z,j){return!P||!z||z<1||z>P.ncomp?null:new Ie(Ft(P,j,z))}let s=te(void 0),a=te(void 0);const o=g(()=>t(r)?Ge(t(r).xvarvalues):null),c=g(()=>t(r)?Ge(t(r).xvarindices):null),d=g(()=>t(r)?t(r).xvarlabels:null),u=g(()=>t(r)?l(t(r),e.params.comp2,e.params.statType):null),f=g(()=>t(r)?l(t(r),e.params.comp1,e.params.statType):null),v=g(()=>!t(r)||!e.params.comp1?null:e.params.plotType==="p"?{values:t(f),label:`LV${e.params.comp1}`}:e.params.plotType==="l"&&t(o)?{values:t(o),label:t(r).varvaluesName+(t(r).varvaluesUnits?", "+t(r).varvaluesUnits:"")}:{values:t(c),label:"Predictors"}),m=g(()=>t(v)?t(v).values:null),h=g(()=>t(v)?t(v).label:null),p=g(()=>t(u)),w=g(()=>`LV${e.params.comp2}`),b=g(()=>{if(t(a)&&t(a)[0]<Number.POSITIVE_INFINITY&&t(a)[1]>Number.NEGATIVE_INFINITY){const P=(t(a)[1]-t(a)[0])*.1;return[t(a)[0]-2*P,t(a)[1]+P]}else return[0,1]}),_=g(()=>{if(t(s)&&t(s)[0]<Number.POSITIVE_INFINITY&&t(s)[1]>Number.NEGATIVE_INFINITY){const P=Math.abs((t(s)[1]-t(s)[0])*.1);return e.params.plotType==="l"&&t(r).varrev?[t(s)[1]+P,t(s)[0]-P]:[t(s)[0]-P,t(s)[1]+P]}else return[0,1]}),S=g(()=>e.params.statType==="xloadings"?"X-loadings":"Weights"),y=g(()=>"plot-"+e.params.statType);var C=ce(),L=X(C);{var k=P=>{xr(P,{get xLabel(){return t(h)},get yLabel(){return t(w)},get title(){return t(S)},get fileName(){return t(y)},get limX(){return t(_)},get limY(){return t(b)},children:(z,j)=>{var R=Uh(),A=X(R);{let T=g(()=>[t(_)[0]]),q=g(()=>[t(_)[1]]);bn(A,{get xStart(){return t(T)},get xEnd(){return t(q)},yStart:[0],yEnd:[0],get lineColor(){return ll}})}var I=N(A,2);{var D=T=>{{let q=g(()=>[t(b)[0]]),Z=g(()=>[t(b)[1]]);bn(T,{xStart:[0],xEnd:[0],get yStart(){return t(q)},get yEnd(){return t(Z)},get lineColor(){return ll}})}};B(I,T=>{e.params.plotType==="p"&&T(D)})}var W=N(I,2);Jt(W,{get xValues(){return t(m)},get yValues(){return t(p)},get selected(){return e.selected},get plotType(){return e.params.plotType},get showLabels(){return e.params.showLabels},get labels(){return t(d)},shortenLabels:!1,get mainColor(){return Zs},markerWidth:2,get xRange(){return t(s)},set xRange(T){F(s,T,!0)},get yRange(){return t(a)},set yRange(T){F(a,T,!0)}}),E(z,R)},$$slots:{default:!0}})};B(L,P=>{t(m)&&t(p)&&P(k)})}E(n,C),ve()}var Xh=H("<!> <!> <!> <!>",1);function aa(n,e){fe(e,!0);let r=g(()=>e.props&&e.props.model?e.props.model:null),l=g(()=>e.props&&e.props.res?e.props.res:null),s=g(()=>t(l)?Object.keys(t(l)):null),a=g(()=>e.params&&e.params.resID&&t(s)?e.params.resID==="both"?t(s):[e.params.resID]:null);const o="#909090",c=g(()=>t(r)?e.params.limType==="classic"?{h:Ft(t(r),"cNh"),q:Ft(t(r),"cNq"),z:Ft(t(r),"cNz")}:{h:Ft(t(r),"rNh"),q:Ft(t(r),"rNq"),z:Ft(t(r),"rNz")}:null),d=g(()=>t(r)?e.params.limType==="classic"?{h:Ft(t(r),"ch0"),q:Ft(t(r),"cq0"),z:Ft(t(r),"cz0")}:{h:Ft(t(r),"rh0"),q:Ft(t(r),"rq0"),z:Ft(t(r),"rz0")}:null),u=g(()=>t(c)?{h:t(c).h[e.props.ncomp-1],q:t(c).q[e.props.ncomp-1],z:t(c).z[e.props.ncomp-1]}:null),f=g(()=>t(d)?{h:t(d).h[e.props.ncomp-1],q:t(d).q[e.props.ncomp-1],z:t(d).z[e.props.ncomp-1]}:null),v=g(()=>t(u)?e.params.distType==="h/q"?t(u).h:t(u).h+t(u).q:null),m=g(()=>t(u)?e.params.distType==="h/q"?t(u).q:t(u).z:null),h=g(()=>t(f)?e.params.distType==="h/q"?t(f).h:t(u).h+t(u).q:null),p=g(()=>t(f)?e.params.distType==="h/q"?t(f).q:t(f).z:null),w=g(()=>e.params.alpha?1-e.params.alpha/100:.95),b=g(()=>e.params.gamma?1-e.params.gamma/100:.99);let _=g(()=>t(u)?Ni(t(w),t(v),t(m),e.params.transType):null),S=g(()=>t(u)?Ni(Math.pow(t(b),1/t(r).nrows),t(v),t(m),e.params.transType):null);const y=g(()=>{if(!t(l)||!t(u)||!t(f))return null;let T=Number.POSITIVE_INFINITY,q=Number.POSITIVE_INFINITY,Z=Number.NEGATIVE_INFINITY,M=Number.NEGATIVE_INFINITY;const U=[];for(let K of t(a)){const J=t(l)[K];if(!J)return null;const se=Lt(J,"hdist",e.props.ncomp),$=Lt(J,"qdist",e.props.ncomp),Q=Lt(J,"zdist",e.props.ncomp),ae=e.params.distType==="h/q"?se:se.map((Ce,me)=>Ce/t(f).h*t(u).h+$[me]/t(f).q*t(u).q),_e=e.params.distType==="h/q"?$:Q,ie=Pi(ae,t(v),t(h),e.params.transType),ye=Pi(_e,t(m),t(p),e.params.transType);T=Math.min(T,ie.min),q=Math.min(q,ye.min),Z=Math.max(Z,ie.max),M=Math.max(M,ye.max),U.push({xValues:ie.values,yValues:ye.values,mainColor:Ur[K],faceColor:nl[K],marker:Wr[K],labels:J.objlabels.map(Ce=>Ce.slice(0,Ti))})}return{values:U,xMin:T,xMax:Z,yMin:q,yMax:M}});let C=g(()=>"Distances (A = "+e.props.ncomp+")"),L=g(()=>Li(e.params.distType==="h/q"?"h":"f",e.params.transType)),k=g(()=>Li(e.params.distType==="h/q"?"q":"z",e.params.transType)),P=te(void 0),z=te(void 0),j=g(()=>{if(!t(y))return[0,1];const T=Math.max(t(y).xMax,t(S).x.v[t(S).x.v.length-1]);return[-.02*(T-t(y).xMin),1.05*T]}),R=g(()=>{if(!t(y))return[0,1];const T=Math.max(t(y).yMax,t(S).y.v[0]);return[-.02*(T-t(y).yMin),(1.05+.1*(e.params.colorBy!=="none"))*T]}),A=g(()=>sl(t(a)));var I=ce(),D=X(I);{var W=T=>{xr(T,{get title(){return t(C)},get limX(){return t(j)},get limY(){return t(R)},get xLabel(){return t(L)},get yLabel(){return t(k)},fileName:"plot-distance",get onclick(){return e.callbacks.unselectObject},children:(q,Z)=>{var M=Xh(),U=X(M);{var K=ae=>{yr(ae,{get xValues(){return t(_).x},get yValues(){return t(_).y},lineColor:o,lineType:2})};B(U,ae=>{t(_)&&ae(K)})}var J=N(U,2);{var se=ae=>{yr(ae,{get xValues(){return t(S).x},get yValues(){return t(S).y},lineColor:o,lineType:3})};B(J,ae=>{t(S)&&ae(se)})}var $=N(J,2);Me($,17,()=>t(y).values,qe,(ae,_e)=>{Jt(ae,{get selected(){return e.selected},get callbacks(){return e.callbacks},get labels(){return t(_e).labels},get mainColor(){return t(_e).mainColor},get faceColor(){return t(_e).faceColor},get marker(){return t(_e).marker},get xValues(){return t(_e).xValues},get yValues(){return t(_e).yValues},plotType:"p",get showLabels(){return e.params.showLabels},get xRange(){return t(P)},set xRange(ie){F(P,ie,!0)},get yRange(){return t(z)},set yRange(ie){F(z,ie,!0)}})});var Q=N($,2);rl(Q,{get items(){return t(A)}}),E(q,M)},$$slots:{default:!0}})};B(D,T=>{t(y)&&T(W)})}E(n,I),ve()}var Gh=H("<!> <!>",1);function Kh(n,e){fe(e,!0);let r=g(()=>e.props?e.props.model:null),l=g(()=>t(r)&&e.props.ncomp>0?t(r).coeffs.subarray((e.props.ncomp-1)*t(r).npred*t(r).nresp,(e.props.ncomp-1)*t(r).npred*t(r).nresp+t(r).npred*t(r).nresp):null),s=g(()=>t(l)?new it(t(l),t(r).npred,t(r).nresp):null);const a=g(()=>t(r)?Ge(t(r).xvarvalues):null),o=g(()=>t(r)?Ge(t(r).xvarindices):null),c=g(()=>t(r)?t(r).xvarlabels:null),d=g(()=>t(r)?t(r).varvaluesName+(t(r).varvaluesUnits?", "+t(r).varvaluesUnits:""):""),u=g(()=>e.params.plotType==="h"?t(o):t(a)),f=g(()=>t(s)?t(s).getcolumn(e.params.resp):null),v=g(()=>e.params.plotType==="h"?"Predictors":t(d)),m=g(()=>e.params.plotType==="h"&&t(u).length<20?[.5,t(u).length+.5]:t(u)?Ar(t(u),.05):[0,1]),h=g(()=>t(f)?Ar(t(f),.075):[0,1]),p=g(()=>"Regression coefficients (A = "+e.props.ncomp+")"),w="Coefficients";var b=ce(),_=X(b);{var S=y=>{{let C=g(()=>e.params.plotType==="h");xr(y,{get xLabel(){return t(v)},yLabel:w,get limX(){return t(m)},get limY(){return t(h)},get title(){return t(p)},get whole(){return t(C)},fileName:"plot-regcoeffs",children:(L,k)=>{var P=Gh(),z=X(P);{let R=g(()=>[t(m)[0]]),A=g(()=>[t(m)[1]]);bn(z,{get xStart(){return t(R)},get xEnd(){return t(A)},yStart:[0],yEnd:[0],get lineColor(){return ll}})}var j=N(z,2);Jt(j,{get xValues(){return t(u)},get yValues(){return t(f)},get selected(){return e.selected},get plotType(){return e.params.plotType},get showLabels(){return e.params.showLabels},get mainColor(){return Zs},get labels(){return t(c)},shortenLabels:!1}),E(L,P)},$$slots:{default:!0}})}};B(_,y=>{t(u)&&t(f)&&y(S)})}E(n,b),ve()}var Jh=H("<!> <!> <!>",1),Qh=H('<div class="svelte-17oamay"><!></div>');function Zh(n,e){fe(e,!0);let r=g(()=>!0),l=te(!1),s=te(null),a=te(null),o=te(null),c=te(null);const d=g(()=>t(s)!==null&&t(o)!==null?Math.min(t(s),t(o)):null),u=g(()=>t(a)!==null&&t(c)!==null?Math.max(t(a),t(c)):null),f=g(()=>t(s)!==null&&t(o)!==null?Math.abs(t(s)-t(o)):null),v=g(()=>t(a)!==null&&t(c)!==null?Math.abs(t(a)-t(c)):null),m=g(()=>e.props?e.props.model:null),h=g(()=>e.props&&e.props.ncomp>0?e.props.ncomp:1),p=g(()=>t(m)&&t(h)>0?(t(h)-1)*t(m).npred*t(m).nresp:null),w=g(()=>t(p)!==null?t(p)+t(m).npred*t(m).nresp:null),b=g(()=>t(w)!==null?new it(t(m).sr.subarray(t(p),t(w)),t(m).npred,t(m).nresp):null),_=g(()=>t(w)!==null?new it(t(m).vip.subarray(t(p),t(w)),t(m).npred,t(m).nresp):null),S=g(()=>t(m)?Ge(t(m).xvarvalues):null),y=g(()=>t(m)?Ge(t(m).xvarindices):null),C=g(()=>t(m)?t(m).xvarlabels:null),L=g(()=>t(S)&&t(y)&&t(_)?{values:t(S),indices:t(y),vip:t(_).getcolumn(e.params.resp)}:null),k=g(()=>t(_)&&t(b)?{vip:t(_).getcolumn(e.params.resp),selratio:t(b).getcolumn(e.params.resp)}:null),P=g(()=>t(m)?{values:t(m).varvaluesName+(t(m).varvaluesUnits?", "+t(m).varvaluesUnits:""),indices:"Predictors",vip:"VIP scores"}:null),z=g(()=>t(m)?{vip:"VIP scores",selratio:"Selectivity ratio"}:null),j=g(()=>t(L)?t(L)[e.params.xset]:null),R=g(()=>t(k)?t(k)[e.params.yset]:null),A=g(()=>t(P)?t(P)[e.params.xset]:null),I=g(()=>t(z)?t(z)[e.params.yset]:null),D=g(()=>"Variable importance (A = "+t(h)+")"),W=g(()=>t(j)?Ar(t(j),.05):[0,1]),T=g(()=>t(R)?Ar(t(R),.075):[0,1]),q=g(()=>t(m)?t(m).npred<30?1:t(m).npred>200?.5:.8:1),Z=g(()=>e.selected&&e.selected.length>0?Ge(e.selected.map(ie=>t(j).v[ie])):null),M=g(()=>e.selected&&e.selected.length>0?Ge(e.selected.map(ie=>t(R).v[ie])):null);function U(){const ie=t(u)-t(v),ye=t(d)+t(f),Ce=[];for(let me=0;me<=t(j).length;me++){const he=t(j).v[me],pe=t(R).v[me];he>=t(d)&&he<=ye&&pe>=ie&&pe<=t(u)&&Ce.push(me)}Ce.length>0&&e.callbacks.select(Ce),F(s,null),F(a,null),F(o,null),F(c,null)}function K(ie,ye){e.callbacks.unselect(),F(l,!0),F(s,ie,!0),F(a,ye,!0),F(o,ie,!0),F(c,ye,!0)}function J(ie,ye){F(l,!1),F(r,!0),U()}function se(ie,ye){t(l)&&(F(o,ie,!0),F(c,ye,!0))}function $(){if(t(r)){F(r,!1);return}F(l,!1),F(s,null),F(a,null),F(o,null),F(c,null),e.callbacks.unselect()}var Q=ce(),ae=X(Q);{var _e=ie=>{var ye=Qh(),Ce=Y(ye);xr(Ce,{get xLabel(){return t(A)},get yLabel(){return t(I)},get limX(){return t(W)},get limY(){return t(T)},get title(){return t(D)},onmousedown:K,onmouseup:J,onmousemove:se,onclick:$,fileName:"plot-varimp",children:(me,he)=>{var pe=Jh(),Pe=X(pe);{let ue=g(()=>Zs+(e.selected&&e.selected.length>0?"80":""));Jt(Pe,{get xValues(){return t(j)},get yValues(){return t(R)},get markerSize(){return t(q)},get mainColor(){return t(ue)},plotType:"p",get showLabels(){return e.params.showLabels},get labels(){return t(C)},shortenLabels:!1})}var re=N(Pe,2);{var de=ue=>{{let Ee=g(()=>[t(d)]),Re=g(()=>[t(u)]),je=g(()=>[t(f)]),Ve=g(()=>[t(v)]);Mn(ue,{get left(){return t(Ee)},get top(){return t(Re)},get width(){return t(je)},get height(){return t(Ve)},faceColor:"#ff000040"})}};B(re,ue=>{t(d)&&t(u)&&t(l)&&ue(de)})}var le=N(re,2);{var we=ue=>{Jt(ue,{get xValues(){return t(Z)},get yValues(){return t(M)},get markerSize(){return t(q)},mainColor:"red",plotType:"p",shortenLabels:!1})};B(le,ue=>{t(Z)&&t(M)&&ue(we)})}E(me,pe)},$$slots:{default:!0}}),E(ie,ye)};B(ae,ie=>{t(j)&&t(R)&&ie(_e)})}E(n,Q),ve()}var $h=H("<!> <!> <!> <!> <!>",1);function eg(n,e){fe(e,!0);let r=g(()=>e.props?e.props.scalars:null);const l=[-99999,-2,-1,0,.2,.5,.8,1.2,1.5,1.8,2,2.5,3,99999],s=["#6200DF","#6923FF","#648FFF","#8CCDFD","#D2ECFF","#E8F5FF","#fefeff","#FFF5E5","#FFE5BE","#FFCE85","#FFA34E","#FF8024","#CF5903"],a=l.map(w=>w.toFixed(1));a[0]="&minus;&infin;",a[a.length-1]="&infin;";const o=g(()=>t(r)?t(r).nrows/8:1),c=g(()=>t(r)?[.45,t(r).ncols+.6]:[0,1]),d=g(()=>t(r)?[.45,t(r).nrows+Math.max(.9,t(o))]:[0,1]),u="PV-scalars",f="Segments, k",v="Components, A";var m=ce(),h=X(m);{var p=w=>{Xs(w,{get limX(){return t(c)},get limY(){return t(d)},title:u,fileName:"plot-pvscalars",children:(b,_)=>{var S=$h(),y=X(S);pv(y,{get values(){return t(r)},get breaks(){return l},get colmap(){return s}});var C=N(y,2);Ei(C,{get breaks(){return l},get colmap(){return s},get labels(){return a}});var L=N(C,2);Gs(L,{label:v,whole:!0});var k=N(L,2);Ks(k,{label:f,whole:!0});var P=N(k,2);Js(P,{}),E(b,S)},$$slots:{default:!0}})};B(h,w=>{t(r)&&w(p)})}E(n,m),ve()}function ji(n){const e=Object.keys(n),r=e.length>1?[...e,"both"]:e,l=e.length>1?"both":e[0];return{resID:{el:He,hidden:e.length==1,default:l,label:"Show",props:{options:r}},varSet:{el:He,hidden:!1,default:"X",label:"Variance for",props:{options:["X","Y"]}},varType:{el:He,hidden:!1,default:"explained",label:"Type",props:{options:["explained","residual"]}},varForm:{el:He,hidden:!1,default:"cumulative",label:"Form",props:{options:["individual","cumulative"]}},showLabels:{el:Kt,hidden:!1,default:!1,label:"Labels",props:{options:["hide","show"]}}}}function Vi(n,e){const r=Object.keys(n),l=r.length>1?[...r,"both"]:r,s=["rmse","r2","slope"],a=r.length>1?"both":r[0];return{resID:{el:He,hidden:r.length==1,default:a,label:"Show",props:{options:l}},fom:{el:He,hidden:!1,default:"rmse",label:"FoM",props:{options:s}},resp:{el:Dt,hidden:e<2,default:1,label:"Response",props:{min:1,max:e}},showLabels:{el:Kt,hidden:!1,default:!1,label:"Labels",props:{options:["hide","show"]}}}}function oa(n,e){const r=Object.keys(n),l=r.length>1?[...r,"both"]:r,s=n[r[0]],a=r.length>1?"both":r[0];return{resID:{el:He,hidden:r.length==1,default:a,label:"Show",props:{options:l}},resp:{el:Dt,hidden:e<2,default:1,label:"Response",props:{min:1,max:e}},showStat:{el:Kt,hidden:s.Yref===null,default:!1,label:"FoM",props:{options:["hide","show"]}},showLabels:{el:He,hidden:!1,default:"hide",label:"Labels",props:{options:["hide","labels","values"]}}}}function Oi(n,e){const r=Object.keys(n);return{resID:{el:He,hidden:r.length==1,default:r[0],label:"Show",props:{options:r}},resp:{el:Dt,hidden:e<2,default:1,label:"Response",props:{min:1,max:e}},plotType:{el:js,hidden:!1,default:"p",label:"Plot type",props:{options:["p","qq","h"]}},showLabels:{el:He,hidden:!1,default:"hide",label:"Labels",props:{options:["hide","show"]}}}}function ia(n){const e=Object.keys(n),r=e.length>1?[...e,"both"]:e,l=n[e[0]],s=l.Yref?["X","Y","XY"]:["X"],a=e.length>1?"both":e[0];return{resID:{el:He,hidden:e.length===1,default:a,label:"Show",props:{options:r}},varSet:{el:He,hidden:l.Yref===null,default:"X",label:"Scores for",props:{options:s}},comp2:{el:Dt,hidden:!1,default:l.ncomp>1?2:1,label:"LV (y-axis)",props:{min:1,max:l.ncomp}},comp1:{el:Dt,hidden:!1,default:1,label:"LV (x-axis)",props:{min:1,max:l.ncomp}},showLabels:{el:Kt,hidden:!1,default:!1,label:"Labels",props:{options:["hide","show"]}}}}function tg(n,e){return{statType:{el:He,hidden:!1,default:"xloadings",label:"Show",props:{options:["xloadings","weights"]}},plotType:{el:js,hidden:!1,default:"p",label:"Plot type",props:{options:["p","l","h"]}},comp2:{el:Dt,hidden:!1,default:n.ncomp>1?2:1,label:"LV (y-axis)",props:{min:1,max:n.ncomp}},comp1:{el:Dt,hidden:!1,default:1,label:"LV (x-axis)",props:{min:1,max:n.ncomp}},showLabels:{el:Kt,hidden:!1,default:!1,label:"Labels",props:{options:["hide","show"]}}}}function ca(n){const e=Object.keys(n),r=e.length>1?[...e,"both"]:e,l=n[e[0]],s=e.length>1?"both":e[0],a=l.Yref?["h/q","f/z"]:["h/q"];return{resID:{el:He,hidden:e.length==1,default:s,label:"Show",props:{options:r}},distType:{el:He,hidden:l.Yref===null,default:"h/q",label:"Show",props:{options:a}},transType:{el:He,hidden:!1,default:"no",label:"Transform",props:{options:["no","log"]}},limType:{el:He,hidden:!1,default:"classic",label:"Limits",props:{options:["classic","robust"]}},showLabels:{el:Kt,hidden:!1,default:!1,label:"Labels",props:{options:["hide","show"]}}}}function rg(n){return{plotType:{el:js,hidden:!1,default:"l",label:"Plot type",props:{options:["l","h"]}},resp:{el:Dt,hidden:n<2,default:1,label:"Response",props:{min:1,max:n}},showLabels:{el:Kt,hidden:!1,default:!1,label:"Labels",props:{options:["hide","show"]}}}}function ng(n){return{yset:{el:He,hidden:!1,default:"vip",label:"Y-axis",props:{options:["vip","selratio"]}},xset:{el:He,hidden:!1,default:"values",label:"X-axis",props:{options:["values","indices","vip"]}},resp:{el:Dt,hidden:n<2,default:1,label:"Response",props:{min:1,max:n}},showLabels:{el:Kt,hidden:!1,default:!1,label:"Labels",props:{options:["hide","show"]}}}}function lg(){return{}}var sg=H("<!> <!>",1),ag=H("<p>can not exclude</p>");function og(n,e){fe(e,!0);const r=(v,m=Tt)=>{oe(v,{label:"Selected",children:(h,p)=>{var w=sg(),b=X(w);at(b,{onclick:()=>e.showContributions(m()),text:"plot"});var _=N(b,2);{var S=y=>{at(y,{onclick:()=>e.markOutlier(m()),text:"remove"})};B(_,y=>{m()>=0&&y(S)})}E(h,w)},$$slots:{default:!0}})},l=(v,m=Tt)=>{oe(v,{label:"Selected",children:(h,p)=>{var w=ce(),b=X(w);{var _=y=>{at(y,{onclick:()=>e.excludeVars(m()),get text(){return`exclude ${m().length??""} variables`}})},S=y=>{var C=ag();E(y,C)};B(b,y=>{e.res.cal.npred-m().length>=2?y(_):y(S,!1)})}E(h,w)},$$slots:{default:!0}})},s=Object.keys(e.res),a=e.res[s[0]].nresp,o=g(()=>({pred:{label:"Predictions",scope:"objects",component:la,buttons:r},scores:{label:"Scores",scope:"objects",component:sa,buttons:r},distance:{label:"Distances",scope:"objects",component:aa,buttons:r},yresiduals:{label:"Residuals",scope:"stats",component:Fi},loadings:{label:"X-loadings and weights",scope:"stats",component:Hh},regcoeffs:{label:"Regression coefficients",scope:"stats",component:Kh},varsel:{label:"Variable importance",scope:"variables",component:Zh,buttons:l},fom:{label:"Figures of merit",scope:"stats",component:Ii},variance:{label:"Variance",scope:"stats",component:Mi},scalars:{label:"PV scalars",scope:"stats",component:eg}})),c=Ne({pred:oa(e.res,a),scores:ia(e.res),distance:ca(e.res),yresiduals:Oi(e.res,a),loadings:tg(e.model,e.ncomp),regcoeffs:rg(a),varsel:ng(a),fom:Vi(e.res,a),variance:ji(e.res),scalars:lg(e.res)});let d=te(Ne({pred:St(c.pred),scores:St(c.scores),distance:St(c.distance),yresiduals:St(c.yresiduals),loadings:St(c.loadings),regcoeffs:St(c.regcoeffs),varsel:St(c.varsel),fom:St(c.fom),variance:St(c.variance),scalars:St(c.scalars)}));ge(()=>{t(d).scores.varSet==="XY"?(c.scores.comp1.hidden=!0,c.scores.comp2.label="LV"):(c.scores.comp2.label="LV (y-axis)",c.scores.comp1.hidden=!1)}),ge(()=>{t(d).loadings.plotType!=="p"?c.loadings.comp1.hidden=!0:c.loadings.comp1.hidden=!1}),ge(()=>{t(d).pred.resID==="both"?c.pred.showStat.hidden=!0:c.pred.showStat.hidden=!1}),ge(()=>{t(d).yresiduals.plotType==="h"?c.yresiduals.showLabels.hidden=!0:c.yresiduals.showLabels.hidden=!1});const u=g(()=>({res:e.res,model:e.model,data:e.data,ncomp:e.ncomp,scalars:e.scalars})),f={markOutlier:e.markOutlier};na(n,{get plots(){return t(o)},get props(){return t(u)},get controls(){return c},get callbacks(){return f},get params(){return t(d)},set params(v){F(d,v,!0)}}),ve()}var ig=H('<div class="outliers-pane svelte-b7gdku"><!></div>'),cg=H('<div class="exclvars-pane svelte-b7gdku"><!></div>'),ug=H('<div class="model-calculator svelte-b7gdku"><!></div>'),dg=H('<div class="pcv-calculator svelte-b7gdku"><!></div>'),fg=H('<div class="buttons"><!> <!> <!></div>'),vg=H('<div class="ncomp-selector svelte-b7gdku"><!> <!></div> <div class="result-stats svelte-b7gdku"><!></div>',1),mg=H(`<p class="svelte-b7gdku">This tab lets you train a PLS regression model and optimize it using Procrustes cross-validation.
               After that you can save the model to a file, apply it to a test set (tab <strong>Test</strong>)
               or to a new set of samples whose response us unknown (tab <strong>Predict</strong>).</p> <p class="svelte-b7gdku"><strong>Step 1.</strong></p> <p class="svelte-b7gdku">Load your training/calibration set from a CSV file. The file should contain data as numeric values delimited
               by comma (with dot as decimal separator) or by semicolon (with comma as decimal separator). Rows
               correspond to observations or objects, columns — to variables (both response and predictors).</p> <p class="svelte-b7gdku">First row in the CSV file can contain variable labels or values (<strong>header</strong>). It is assumed
               that variable lables are text (or have text parts), e.g. <em>"Na"</em>, <em>"OD260"</em>, etc. If x-variables
               are signals, e.g. spectra, this part of header can content numeric values, e.g. wavelength or wavenumbers.
               If this is the case, select <em>values</em> option for the header. This will let you to specify
               name of the values (e.g. <em>Wavelength</em>) and the units (e.g. <em>nm</em>) if necessary.</p> <p class="svelte-b7gdku">First column in the file can contain labels for the objects/observations (<strong>row labels</strong>) — if so, just set
               the corresponding options after selecting the file.</p> <p class="svelte-b7gdku">The response variable (<em>Y</em>) should be located right after the column with object/row labels. If there are no
               object labels, the response variable is expected to be in the first column. <strong>Response variable is mandatory
               in the training set and in this version of app only single response is supported (PLS1).</strong></p> <p class="svelte-b7gdku">Here is an example how data structure may look like (note, that row labels and header are optional):</p> <div class="svelte-b7gdku"><table class="svelte-b7gdku"><thead class="svelte-b7gdku"><tr class="svelte-b7gdku"><td class="svelte-b7gdku">Name</td><td class="svelte-b7gdku">y</td><td class="svelte-b7gdku">x1</td><td class="svelte-b7gdku">x2</td><td class="svelte-b7gdku">x3</td></tr></thead><tbody class="svelte-b7gdku"><tr><td class="svelte-b7gdku">O1</td><td class="svelte-b7gdku">96.1</td><td class="svelte-b7gdku">3.8</td><td class="svelte-b7gdku">1.3</td><td class="svelte-b7gdku">13.6</td></tr><tr><td class="svelte-b7gdku">O2</td><td class="svelte-b7gdku">88.9</td><td class="svelte-b7gdku">11.1</td><td class="svelte-b7gdku">12.3</td><td class="svelte-b7gdku">3.3</td></tr><tr><td class="svelte-b7gdku">O3</td><td class="svelte-b7gdku">56.1</td><td class="svelte-b7gdku">1.2</td><td class="svelte-b7gdku">2.3</td><td class="svelte-b7gdku">4.2</td></tr></tbody></table></div> <p class="svelte-b7gdku"></p>`,1),hg=H(`<p class="svelte-b7gdku"><strong>Step 2</strong></p> <p class="svelte-b7gdku">Next step is to decide how to preprocess the data. You can either skip preprocessing (in the model settings you
               will be able to apply centering and scaling), create the chain of preprocessing methods in special constructor
               (use <em>Create</em> to load the constructor) or load already built preprocessing model from a file. Make your choice.</p>`,1),gg=H(`<p class="svelte-b7gdku"><strong>Step 3</strong></p> <p class="svelte-b7gdku">Now you can create a global PLS model for the training set. Use more components/latent variables (LVs) than
               you expect to be optimal. You will have possibility to select the optimal number of components later.</p>`,1),pg=H(`<p class="svelte-b7gdku"><strong>Step 4</strong></p> <p class="svelte-b7gdku">Now set necessary parameters for Procrustes cross-validation and click button to compute the PV-set,
               which will help you to optimize PLS model parameters. The parameters are the same as for conventional
               cross-validation: type of splits and number of segments. It is recommended to use fewer number of
               segments (e.g. 3, 4 or 5).</p> <p class="svelte-b7gdku">After this step PLS model will be created automatically and you will be able to explore it and tune
               its parameters.</p>`,1),bg=H("<!> <!> <!>",1),_g=H('<div class="help-text svelte-b7gdku"><!></div>'),wg=H('<div class="app-container svelte-b7gdku"><!> <div class="app-controls svelte-b7gdku"><div class="data-loader svelte-b7gdku"><!></div> <!> <!> <!> <!> <!> <!></div> <div class="app-content svelte-b7gdku"><!></div></div>');function yg(n,e){fe(e,!0);const r=g(()=>e.session.train);let l=te(-1),s=te(!1);function a(M){if(M.length<1)return;const U=M.map(K=>t(r).model.varindices[K+t(r).model.nresp]);if(U.length>0){const K=new Set(t(r).exclvars),J=[...new Set(U)].filter(se=>!K.has(se));t(r).exclvars=t(r).exclvars.concat(J),t(r).model=null,t(r).pvres=null,t(r).calres=null,t(r).pvset=null,t(r).ncomp_selected=1}}function o(){t(r).exclvars=[],t(r).model=null,t(r).pvres=null,t(r).calres=null,t(r).pvset=null,t(r).ncomp_selected=1}function c(M){if(M<0||M>t(r).calres.nrows-1)return;const U=t(r).calres.objindices[M];U>=0&&!t(r).outliers.includes(U)&&(t(r).outliers.push(U),t(r).model=null,t(r).pvres=null,t(r).calres=null,t(r).calsetp=null,t(r).prepmodel=null,t(r).pvset=null,t(r).ncomp_selected=1)}function d(){t(r).outliers=[],t(r).model=null,t(r).pvres=null,t(r).calres=null,t(r).calsetp=null,t(r).prepmodel=null,t(r).pvset=null,t(r).ncomp_selected=1}function u(){t(r).outliers.pop(),t(r).model=null,t(r).pvres=null,t(r).calres=null,t(r).calsetp=null,t(r).prepmodel=null,t(r).pvset=null,t(r).ncomp_selected=1}function f(M,U){M<0||(F(l,M,!0),F(s,!0))}function v(){F(s,!1),F(l,-1)}ge(()=>{t(r).calset===null&&(t(r).pvres=null,t(r).calres=null,t(r).pvset=null,t(r).calsetp=null,t(r).prepmodel=null,t(r).prepobj=[],t(r).prepType=null,t(r).outliers=[],t(r).exclvars=[],t(r).ncomp_selected=1,t(r).model=null)}),ge(()=>{t(r).model===null&&(t(r).calres=null,t(r).pvres=null,t(r).pvset=null)}),ge(()=>{t(r).prepmodel||(t(r).calres=null,t(r).calsetp=null,t(r).exclvars=[])}),ge(()=>{t(r).calsetp||(t(r).model=null,t(r).calres=null,t(r).pvres=null)}),ge(()=>{if(t(r).model&&t(r).model.ncomp&&t(r).pvres&&t(r).pvres.stat){const M=t(r).pvres.stat.rmse.getcolref(1),K=M.map((J,se)=>se>0?1-J*J/M[se-1]**2:1).findIndex(J=>J<=.0975);t(r).ncomp_selected=K<0?t(r).model.ncomp:K}}),ge(()=>{const M=_r(()=>JSON.stringify(e.session,$n));e.backupSession(M,t(r).model,t(r).calset,t(r).calsetp,t(r).pvres)});var m=wg(),h=Y(m);{var p=M=>{{let U=g(()=>({cal:t(r).calres,pv:t(r).pvres}));$s(M,{get model_getter(){return Ft},get res_getter(){return Lt},get model(){return t(r).model},get res(){return t(U)},get ncomp(){return t(r).ncomp_selected},get selected(){return t(l)},closeModal:v})}};B(h,M=>{t(s)&&M(p)})}var w=N(h,2),b=Y(w),_=Y(b);ra(_,{respMandatory:!0,get dataset(){return t(r).calset},set dataset(M){t(r).calset=M}});var S=N(b,2);{var y=M=>{var U=ig(),K=Y(U);Vs(K,{get outliers(){return t(r).outliers},get dataset(){return t(r).calset},resetOutliers:d,undoOutliers:u}),E(M,U)};B(S,M=>{t(r).outliers&&t(r).outliers.length>0&&M(y)})}var C=N(S,2);{var L=M=>{Rm(M,{get WASM(){return e.WASM},get rawdata(){return t(r).calset},get outliers(){return t(r).outliers},get prepType(){return t(r).prepType},set prepType(U){t(r).prepType=U},get prepobj(){return t(r).prepobj},set prepobj(U){t(r).prepobj=U},get prepdata(){return t(r).calsetp},set prepdata(U){t(r).calsetp=U},get prepmeta(){return t(r).prepmeta},set prepmeta(U){t(r).prepmeta=U},get prepmodel(){return t(r).prepmodel},set prepmodel(U){t(r).prepmodel=U}})};B(C,M=>{t(r).calset&&M(L)})}var k=N(C,2);{var P=M=>{var U=cg(),K=Y(U);Dd(K,{get exclvars(){return t(r).exclvars},get dataset(){return t(r).calset},resetExclvars:o}),E(M,U)};B(k,M=>{t(r).exclvars&&t(r).exclvars.length>0&&M(P)})}var z=N(k,2);{var j=M=>{var U=ug(),K=Y(U);Hm(K,{get WASM(){return e.WASM},get dataset(){return t(r).calsetp},get outliers(){return t(r).outliers},get exclvars(){return t(r).exclvars},get model(){return t(r).model},set model(J){t(r).model=J},get resobj(){return t(r).calres},set resobj(J){t(r).calres=J}}),E(M,U)};B(z,M=>{t(r).calsetp&&M(j)})}var R=N(z,2);{var A=M=>{var U=dg(),K=Y(U);$m(K,{get WASM(){return e.WASM},get calset(){return t(r).calsetp},get outliers(){return t(r).outliers},get model(){return t(r).model},get calres(){return t(r).calres},get pvset(){return t(r).pvset},set pvset(J){t(r).pvset=J},get pvres(){return t(r).pvres},set pvres(J){t(r).pvres=J},get pvscalars(){return t(r).pvscalars},set pvscalars(J){t(r).pvscalars=J}}),E(M,U)};B(R,M=>{t(r).calsetp&&t(r).model&&M(A)})}var I=N(R,2);{var D=M=>{var U=vg(),K=X(U),J=Y(K);oe(J,{name:"ncomp",label:"# of LVs",children:(ae,_e)=>{hn(ae,{min:1,get max(){return t(r).model.ncomp},step:1,decNum:0,get value(){return t(r).ncomp_selected},set value(ie){t(r).ncomp_selected=ie}})},$$slots:{default:!0}});var se=N(J,2);oe(se,{label:"Download",children:(ae,_e)=>{var ie=fg(),ye=Y(ie);at(ye,{onclick:()=>Vl(t(r).calres,t(r).calset,"train",t(r).ncomp_selected),text:"Res (cal)"});var Ce=N(ye,2);at(Ce,{onclick:()=>Vl(t(r).pvres,t(r).pvset,"PV",t(r).ncomp_selected),text:"Res (pv)"});var me=N(Ce,2);at(me,{onclick:()=>li(t(r).model,t(r).ncomp_selected,t(r).prepmodel),text:"Model"}),E(ae,ie)},$$slots:{default:!0}});var $=N(K,2),Q=Y($);{let ae=g(()=>({cal:t(r).calres,pv:t(r).pvres}));zi(Q,{get res(){return t(ae)},get ncomp(){return t(r).ncomp_selected}})}E(M,U)};B(I,M=>{t(r).model&&t(r).model.ncomp&&t(r).calres&&t(r).pvres&&M(D)})}var W=N(w,2),T=Y(W);{var q=M=>{var U=_g(),K=Y(U);{var J=$=>{var Q=mg();E($,Q)},se=$=>{var Q=bg(),ae=X(Q);{var _e=he=>{var pe=hg();E(he,pe)};B(ae,he=>{t(r).calset&&!t(r).prepmodel&&he(_e)})}var ie=N(ae,2);{var ye=he=>{var pe=gg();E(he,pe)};B(ie,he=>{t(r).prepmodel&&!t(r).model&&he(ye)})}var Ce=N(ie,2);{var me=he=>{var pe=pg();E(he,pe)};B(Ce,he=>{t(r).model&&!t(r).pvset&&he(me)})}E($,Q)};B(K,$=>{t(r).calset?$(se,!1):$(J)})}E(M,U)},Z=M=>{var U=ce(),K=X(U);zn(K,()=>t(r).pvres&&t(r).model,J=>{var se=ce(),$=X(se);{var Q=ae=>{{let _e=g(()=>({cal:t(r).calset,pv:t(r).pvset})),ie=g(()=>({cal:t(r).calres,pv:t(r).pvres}));og(ae,{markOutlier:c,showContributions:f,excludeVars:a,get data(){return t(_e)},get res(){return t(ie)},get scalars(){return t(r).pvscalars},get model(){return t(r).model},get ncomp(){return t(r).ncomp_selected}})}};B($,ae=>{t(r).calres&&t(r).pvres&&t(r).model&&t(r).calset&&t(r).pvset&&ae(Q)})}E(J,se)}),E(M,U)};B(T,M=>{!t(r).calres||!t(r).pvres||!t(r).model?M(q):M(Z,!1)})}E(n,m),ve()}var xg=H("<!> <!>",1),kg=H('<br/><span style="color:#a0a0a0;">Optimal LVs:</span> <span style="color:#a0a0a0;"> </span>',1),Eg=H('<br/><span style="color:#a0a0a0;">Preprocessing:</span> <!>',1),Sg=H('<br/><span style="color:#a0a0a0;">Excluded</span> <span style="color:#a0a0a0;">variables.</span>',1),Cg=H('<p class="info-text svelte-3v2vv7"><span>Model file:</span> <span class="file-name svelte-3v2vv7"> </span><br/> <span style="color:#a0a0a0;">Model info:</span> <!> <!> <!></p> <!>',1),Ag=H("<p><!></p>"),Tg=H("<!> <!>",1);function Bi(n,e){fe(e,!0);let r=V(e,"model",15),l=te(""),s=te("neutral"),a=te("");function o(b){try{const _=JSON.parse(b,Ms);if(Array.isArray(_.v)&&(_.v=Float64Array.from(_.v)),_.class[0]!=="plsmodel")throw Error("The JSON file you selected does not contain PLS model.");_.fileName=t(u),r(_),F(s,"success"),F(a,"")}catch(_){console.error(_),r(null),F(s,"error"),F(a,_,!0)}}function c(b){const _=new FileReader;_.onload=()=>{o(_.result)},_.readAsText(t(l))}function d(){F(l,""),r(null),F(s,"neutral"),F(a,"")}ge(()=>{t(l)===null?(r(null),F(s,"neutral"),F(a,"")):(F(s,"neutral"),F(a,""))});let u=g(()=>t(l)?t(l).name.replace(/\.[^/.]+$/,""):"");var f=Tg(),v=X(f);{var m=b=>{var _=xg(),S=X(_);zn(S,()=>t(l),L=>{oe(L,{name:"file-selector",children:(k,P)=>{jl(k,{id:"modelFile",acceptType:".json",message:"Select file with model",get file(){return t(l)},set file(z){F(l,z,!0)}})},$$slots:{default:!0}})});var y=N(S,2);{var C=L=>{oe(L,{name:"load-button",label:" ",children:(k,P)=>{at(k,{onclick:c,text:"Load"})},$$slots:{default:!0}})};B(y,L=>{t(l)&&L(C)})}E(b,_)},h=b=>{oe(b,{name:"info",class:"info",children:(_,S)=>{var y=Cg(),C=X(y),L=N(Y(C),2),k=Y(L),P=N(L,4),z=N(P);{var j=T=>{var q=kg(),Z=N(X(q),3),M=Y(Z);ne(()=>ke(M,r().ncomp_selected)),E(T,q)};B(z,T=>{r().ncomp_selected&&T(j)})}var R=N(z,2);{var A=T=>{var q=Eg(),Z=N(X(q),3);ta(Z,{get prepmodel(){return r().prep}}),E(T,q)};B(R,T=>{r().prep&&T(A)})}var I=N(R,2);{var D=T=>{var q=Sg(),Z=N(X(q),2);ne(()=>ke(Z,` ${r().exclvars.length??""} `)),E(T,q)};B(I,T=>{r().exclvars.length>0&&T(D)})}var W=N(C,2);cr(W,{onclick:d}),ne(()=>{O(L,"title",r().fileName),ke(k,r().fileName),ke(P,` ${r().ncomp??""} LVs${r().center?", centered":""}${r().scale?", scaled":""} `)}),E(_,y)},$$slots:{default:!0}})};B(v,b=>{r()?b(h,!1):b(m)})}var p=N(v,2);{var w=b=>{oe(b,{name:"error",status:"error",children:(_,S)=>{var y=Ag(),C=Y(y);Pt(C,()=>t(a)),E(_,y)},$$slots:{default:!0}})};B(p,b=>{(t(s)==="error"||t(a))&&b(w)})}E(n,f),ve()}var Pg=H("<!> <!>",1);function Lg(n,e){fe(e,!0);const r=(f,v=Tt)=>{oe(f,{label:"Selected",children:(m,h)=>{var p=Pg(),w=X(p);at(w,{onclick:()=>e.showContributions(v()),text:"plot"});var b=N(w,2);at(b,{onclick:()=>e.markOutlier(v()),text:"remove"}),E(m,p)},$$slots:{default:!0}})},l=Object.keys(e.res),s=e.res[l[0]].nresp,a=g(()=>({pred:{label:"Predictions",scope:"objects",component:la,buttons:r},scores:{label:"Scores",scope:"objects",component:sa,buttons:r},distance:{label:"Distances",scope:"objects",component:aa,buttons:r},yresiduals:{label:"Residuals",scope:"stats",component:Fi},fom:{label:"Figures of merit",scope:"stats",component:Ii},variance:{label:"Variance",scope:"stats",component:Mi}})),o=Ne({pred:oa(e.res,s),scores:ia(e.res),distance:ca(e.res),yresiduals:Oi(e.res,s),fom:Vi(e.res,s),variance:ji(e.res)});let c=te(Ne({pred:St(o.pred),scores:St(o.scores),distance:St(o.distance),yresiduals:St(o.yresiduals),fom:St(o.fom),variance:St(o.variance)}));ge(()=>{t(c).scores.varSet==="XY"?(o.scores.comp1.hidden=!0,o.scores.comp2.label="LV"):(o.scores.comp2.label="LV (y-axis)",o.scores.comp1.hidden=!1)}),ge(()=>{t(c).pred.resID==="both"?o.pred.showStat.hidden=!0:o.pred.showStat.hidden=!1}),ge(()=>{t(c).yresiduals.plotType==="h"?o.yresiduals.showLabels.hidden=!0:o.yresiduals.showLabels.hidden=!1});const d=g(()=>({res:e.res,model:e.model,data:e.data,ncomp:e.ncomp,scalars:e.scalars})),u={markOutlier:e.markOutlier};na(n,{get plots(){return t(a)},get controls(){return o},get props(){return t(d)},get callbacks(){return u},get params(){return t(c)},set params(f){F(c,f,!0)}}),ve()}var Ng=H('<div class="outliers-pane svelte-b7gdku"><!></div>'),zg=H('<div class="buttons"><!> <!></div>'),Rg=H('<div class="ncomp-selector svelte-b7gdku"><!> <!></div> <div class="result-stats svelte-b7gdku"><!></div>',1),Mg=H('<div class="data-loader svelte-b7gdku"><!></div> <!> <!>',1),Ig=H(`<p class="svelte-b7gdku">In this tab you can test a PLS regression model developed in <strong>Train</strong> tab by
               applying it to a test set, which contains both predictors and responses.</p> <p class="svelte-b7gdku"><strong>Step 1.</strong></p> <p class="svelte-b7gdku">Load the previously developed PLS model from a JSON file.</p>`,1),Fg=H(`<p class="svelte-b7gdku"><strong>Step 2.</strong></p> <p class="svelte-b7gdku">Load your test set from a CSV file. The file structure should be the same as the training/calibration set.
               The response variable is mandatory. Here is an example how data structure may look like (note, that row labels
               and header are optional):</p> <div class="svelte-b7gdku"><table class="svelte-b7gdku"><thead class="svelte-b7gdku"><tr class="svelte-b7gdku"><td class="svelte-b7gdku">Name</td><td class="svelte-b7gdku">y</td><td class="svelte-b7gdku">x1</td><td class="svelte-b7gdku">x2</td><td class="svelte-b7gdku">x3</td></tr></thead><tbody class="svelte-b7gdku"><tr><td class="svelte-b7gdku">O1</td><td class="svelte-b7gdku">96.1</td><td class="svelte-b7gdku">3.8</td><td class="svelte-b7gdku">1.3</td><td class="svelte-b7gdku">13.6</td></tr><tr><td class="svelte-b7gdku">O2</td><td class="svelte-b7gdku">88.9</td><td class="svelte-b7gdku">11.1</td><td class="svelte-b7gdku">12.3</td><td class="svelte-b7gdku">3.3</td></tr><tr><td class="svelte-b7gdku">O3</td><td class="svelte-b7gdku">56.1</td><td class="svelte-b7gdku">1.2</td><td class="svelte-b7gdku">2.3</td><td class="svelte-b7gdku">4.2</td></tr></tbody></table></div> <p class="svelte-b7gdku"></p>`,1),jg=H('<div class="help-text svelte-b7gdku"><!></div>'),Vg=H('<div class="app-container svelte-b7gdku"><!> <div class="app-controls svelte-b7gdku"><div class="model-loader svelte-b7gdku"><!></div> <!></div> <div class="app-content svelte-b7gdku"><!></div></div>');function Og(n,e){fe(e,!0);const r=g(()=>e.session.test);let l=te(-1),s=te(!1);function a(k){if(k<0||k>t(r).testres.nrows-1)return;const P=t(r).testres.objindices[k];P>=0&&!t(r).outliers.includes(P)&&(t(r).outliers.push(P),t(r).testres=null)}function o(){t(r).outliers=[],t(r).testres=null}function c(){t(r).outliers.pop(),t(r).testres=null}function d(k){k<0||(F(l,k,!0),F(s,!0))}function u(){F(s,!1),F(l,-1)}ge(()=>{t(r).testset===null&&(t(r).outliers=[],t(r).testres=null),t(r).model===null&&(t(r).testres=null,t(r).testset=null)}),ge(()=>{t(r).model&&(t(r).ncomp_selected=t(r).model.ncomp_selected)}),ge(()=>{const k=_r(()=>JSON.stringify(e.session,$n));e.backupSession(k,t(r).model,t(r).testres)});var f=Vg(),v=Y(f);{var m=k=>{{let P=g(()=>({test:t(r).testres}));$s(k,{get model_getter(){return Ft},get res_getter(){return Lt},get model(){return t(r).model},get res(){return t(P)},get ncomp(){return t(r).ncomp_selected},get selected(){return t(l)},closeModal:u})}};B(v,k=>{t(s)&&k(m)})}var h=N(v,2),p=Y(h),w=Y(p);Bi(w,{get model(){return t(r).model},set model(k){t(r).model=k}});var b=N(p,2);{var _=k=>{var P=Mg(),z=X(P),j=Y(z);ra(j,{get WASM(){return e.WASM},get outliers(){return t(r).outliers},get model(){return t(r).model},respMandatory:!0,get dataset(){return t(r).testset},set dataset(W){t(r).testset=W},get resobj(){return t(r).testres},set resobj(W){t(r).testres=W}});var R=N(z,2);{var A=W=>{var T=Ng(),q=Y(T);Vs(q,{get outliers(){return t(r).outliers},get dataset(){return t(r).testset},resetOutliers:o,undoOutliers:c}),E(W,T)};B(R,W=>{t(r).outliers&&t(r).outliers.length>0&&W(A)})}var I=N(R,2);{var D=W=>{var T=Rg(),q=X(T),Z=Y(q);oe(Z,{name:"ncomp",label:"# of LVs",children:(J,se)=>{hn(J,{min:1,get max(){return t(r).model.ncomp},step:1,decNum:0,get value(){return t(r).ncomp_selected},set value($){t(r).ncomp_selected=$}})},$$slots:{default:!0}});var M=N(Z,2);oe(M,{label:"Download",children:(J,se)=>{var $=zg(),Q=Y($);at(Q,{onclick:()=>Vl(t(r).testres,t(r).testset,"test",t(r).ncomp_selected),text:"Res (test)"});var ae=N(Q,2);at(ae,{onclick:()=>li(t(r).model,t(r).ncomp_selected),text:"Model"}),E(J,$)},$$slots:{default:!0}});var U=N(q,2),K=Y(U);{let J=g(()=>({test:t(r).testres}));zi(K,{get res(){return t(J)},get ncomp(){return t(r).ncomp_selected}})}E(W,T)};B(I,W=>{t(r).model&&t(r).testres&&W(D)})}E(k,P)};B(b,k=>{t(r).model&&k(_)})}var S=N(h,2),y=Y(S);{var C=k=>{var P=jg(),z=Y(P);{var j=A=>{var I=Ig();E(A,I)},R=A=>{var I=ce(),D=X(I);{var W=T=>{var q=Fg();E(T,q)};B(D,T=>{t(r).testset||T(W)},!0)}E(A,I)};B(z,A=>{t(r).model?A(R,!1):A(j)})}E(k,P)},L=k=>{var P=ce(),z=X(P);zn(z,()=>t(r).testres&&t(r).model,j=>{var R=ce(),A=X(R);{var I=D=>{{let W=g(()=>({test:t(r).testset})),T=g(()=>({test:t(r).testres}));Lg(D,{markOutlier:a,showContributions:d,get data(){return t(W)},get res(){return t(T)},get model(){return t(r).model},get ncomp(){return t(r).ncomp_selected}})}};B(A,D=>{t(r).testres&&t(r).model&&D(I)})}E(j,R)}),E(k,P)};B(y,k=>{t(r).testres?k(L,!1):k(C)})}E(n,f),ve()}var Bg=H("<!> <!>",1);function qg(n,e){fe(e,!0);const r=(f,v=Tt)=>{oe(f,{label:"Selected",children:(m,h)=>{var p=Bg(),w=X(p);at(w,{onclick:()=>e.showContributions(v()),text:"plot"});var b=N(w,2);at(b,{onclick:()=>e.markOutlier(v()),text:"remove"}),E(m,p)},$$slots:{default:!0}})},l=Object.keys(e.res),s=e.res[l[0]].nresp,a=g(()=>({pred:{label:"Predictions",scope:"objects",component:la,buttons:r},scores:{label:"Scores",scope:"objects",component:sa,buttons:r},distance:{label:"Distances",scope:"objects",component:aa,buttons:r}})),o=Ne({pred:oa(e.res,s),scores:ia(e.res),distance:ca(e.res)});let c=te(Ne({pred:St(o.pred),scores:St(o.scores),distance:St(o.distance)}));const d=g(()=>({res:e.res,model:e.model,data:e.data,ncomp:e.ncomp,scalars:e.scalars})),u={markOutlier:e.markOutlier};na(n,{get plots(){return t(a)},get controls(){return o},get props(){return t(d)},get callbacks(){return u},get params(){return t(c)},set params(f){F(c,f,!0)}}),ve()}var Dg=H('<div class="data-loader svelte-1ssp7bh"><!></div>'),Yg=H('<div class="outliers-pane svelte-1ssp7bh"><!></div>'),Wg=H('<div class="buttons"><!></div>'),Ug=H('<div class="ncomp-selector svelte-1ssp7bh"><!></div>'),Hg=H(`<p class="svelte-1ssp7bh">In this tab you can apply a PLS regression model developed in <strong>Train</strong> tab to
               new set of measurements without known response variable.</p> <p class="svelte-1ssp7bh"><strong>Step 1.</strong></p> <p class="svelte-1ssp7bh">Load the previously developed PLS model from a JSON file.</p>`,1),Xg=H(`<p class="svelte-1ssp7bh"><strong>Step 2.</strong></p> <p class="svelte-1ssp7bh">Load your test set. In this case, because dataset should not contain the response variable you
            can load it either from a CSV file or from SPC files.</p> <p class="svelte-1ssp7bh">If you load data from a <strong>CSV file</strong>, the file structure should be the same as the training/calibration set but <strong>without the response values</strong> (only predictors). Here is an example how data structure may look like
               (note, that row labels and header are optional):</p> <div class="svelte-1ssp7bh"><table class="svelte-1ssp7bh"><thead class="svelte-1ssp7bh"><tr class="svelte-1ssp7bh"><td class="svelte-1ssp7bh">Name</td><td class="svelte-1ssp7bh">x1</td><td class="svelte-1ssp7bh">x2</td><td class="svelte-1ssp7bh">x3</td></tr></thead><tbody><tr><td class="svelte-1ssp7bh">O1</td><td class="svelte-1ssp7bh">3.8</td><td class="svelte-1ssp7bh">1.3</td><td class="svelte-1ssp7bh">13.6</td></tr><tr><td class="svelte-1ssp7bh">O2</td><td class="svelte-1ssp7bh">11.1</td><td class="svelte-1ssp7bh">12.3</td><td class="svelte-1ssp7bh">3.3</td></tr><tr><td class="svelte-1ssp7bh">O3</td><td class="svelte-1ssp7bh">1.2</td><td class="svelte-1ssp7bh">2.3</td><td class="svelte-1ssp7bh">4.2</td></tr></tbody></table> <p>If your model uses spectra as predictors, you can also load spectral data directly
                  from Galactic Industries <strong>SPC files</strong>. The app supports both single spectrum in a file and
                  files with multiple spectra, however only 2-way datasets can be loaded. You can select several
                  SPC files to load (hold Ctrl or Shift when selecting), in this case they will be combined together
                  into the same dataset.</p></div> <p class="svelte-1ssp7bh"></p>`,1),Gg=H('<div class="help-text svelte-1ssp7bh"><!></div>'),Kg=H('<div class="app-container svelte-1ssp7bh"><!> <div class="app-controls svelte-1ssp7bh"><div class="model-loader svelte-1ssp7bh"><!></div> <!> <!> <!></div> <div class="app-content svelte-1ssp7bh"><!></div></div>');function Jg(n,e){fe(e,!0);const r=g(()=>e.session.new);let l=te(-1),s=te(!1);function a(R){if(R<0||R>t(r).newres.nrows-1)return;const A=t(r).newres.objindices[R];A>=0&&!t(r).outliers.includes(A)&&(t(r).outliers.push(A),t(r).newres=null)}function o(){t(r).outliers=[],t(r).newres=null}function c(){t(r).outliers.pop(),t(r).newres=null}function d(R){R<0||(F(l,R,!0),F(s,!0))}function u(){F(s,!1),F(l,-1)}ge(()=>{t(r).newset===null&&(t(r).outliers=[],t(r).newres=null),t(r).model===null&&(t(r).newres=null,t(r).newset=null)}),ge(()=>{t(r).model&&(t(r).ncomp_selected=t(r).model.ncomp_selected)}),ge(()=>{const R=_r(()=>JSON.stringify(e.session,$n));e.backupSession(R,t(r).model,t(r).newres)});var f=Kg(),v=Y(f);{var m=R=>{{let A=g(()=>({new:t(r).newres}));$s(R,{get model_getter(){return Ft},get res_getter(){return Lt},get model(){return t(r).model},get res(){return t(A)},get ncomp(){return t(r).ncomp_selected},get selected(){return t(l)},closeModal:u})}};B(v,R=>{t(s)&&R(m)})}var h=N(v,2),p=Y(h),w=Y(p);Bi(w,{get model(){return t(r).model},set model(R){t(r).model=R}});var b=N(p,2);{var _=R=>{var A=Dg(),I=Y(A);ra(I,{get WASM(){return e.WASM},get outliers(){return t(r).outliers},get model(){return t(r).model},respMandatory:!1,get dataset(){return t(r).newset},set dataset(D){t(r).newset=D},get resobj(){return t(r).newres},set resobj(D){t(r).newres=D}}),E(R,A)};B(b,R=>{t(r).model&&R(_)})}var S=N(b,2);{var y=R=>{var A=Yg(),I=Y(A);Vs(I,{get outliers(){return t(r).outliers},get dataset(){return t(r).newset},resetOutliers:o,undoOutliers:c}),E(R,A)};B(S,R=>{t(r).outliers&&t(r).outliers.length>0&&R(y)})}var C=N(S,2);{var L=R=>{var A=Ug(),I=Y(A);oe(I,{label:"Download",children:(D,W)=>{var T=Wg(),q=Y(T);at(q,{onclick:()=>Vl(t(r).newres,t(r).newset,"new",t(r).ncomp_selected),text:"Res (new)"}),E(D,T)},$$slots:{default:!0}}),E(R,A)};B(C,R=>{t(r).newres&&R(L)})}var k=N(h,2),P=Y(k);{var z=R=>{var A=Gg(),I=Y(A);{var D=T=>{var q=Hg();E(T,q)},W=T=>{var q=ce(),Z=X(q);{var M=U=>{var K=Xg();E(U,K)};B(Z,U=>{t(r).newset||U(M)},!0)}E(T,q)};B(I,T=>{t(r).model?T(W,!1):T(D)})}E(R,A)},j=R=>{var A=ce(),I=X(A);zn(I,()=>t(r).newres&&t(r).model,D=>{var W=ce(),T=X(W);{var q=Z=>{{let M=g(()=>({new:t(r).newset})),U=g(()=>({new:t(r).newres}));qg(Z,{markOutlier:a,showContributions:d,get data(){return t(M)},get res(){return t(U)},get model(){return t(r).model},get ncomp(){return t(r).ncomp_selected}})}};B(T,Z=>{t(r).newres&&t(r).model&&Z(q)})}E(D,W)}),E(R,A)};B(P,R=>{t(r).newres?R(j,!1):R(z)})}E(n,f),ve()}function qi(n,e){F(e,!0)}function Qg(n,e,r){const l=Is(new Date),s=e.appID+"-session-"+l+".json";t(r).date=l;const a=JSON.stringify(t(r),$n),o=new Blob([a],{type:"text/json"}),c=window.URL.createObjectURL(o),d=document.createElement("a");d.setAttribute("href",c),d.setAttribute("download",s),d.click()}function Zg(n,e){confirm("Are you sure? All current results and models will be lost in all tabs.")&&e()}var $g=H('<sup style="color:red">β</sup>'),e1=H('<li><button class="svelte-1cyr8za"> </button></li>'),t1=H("<div><!></div>"),r1=H('<div class="info-container svelte-1cyr8za"><!></div>'),n1=H('<div class="page svelte-1cyr8za"><header class="page-header svelte-1cyr8za"><div class="header-group svelte-1cyr8za"><img class="logo svelte-1cyr8za" src="logo.svg"/> <h1 class="svelte-1cyr8za"> <!></h1> <p class="svelte-1cyr8za"> </p></div> <ul class="nav svelte-1cyr8za"></ul></header> <main class="svelte-1cyr8za"></main> <footer class="svelte-1cyr8za"><div><span class="session-message svelte-1cyr8za"> </span> <label title="load session from file" class="upload-button svelte-1cyr8za"><input type="file" class="svelte-1cyr8za"/> <svg xmlns="http://www.w3.org/2000/svg" version="2.0" width="20px" height="20px" viewBox="0 0 100 100" class="svelte-1cyr8za"><line x1="50" y1="25" x2="50" y2="75"></line><line x1="30" y1="40" x2="50" y2="25"></line><line x1="70" y1="40" x2="50" y2="25"></line></svg></label> <button title="download session as a file" class="download-button svelte-1cyr8za"><svg xmlns="http://www.w3.org/2000/svg" version="2.0" width="20px" height="20px" viewBox="0 0 100 100" class="svelte-1cyr8za"><line x1="50" y1="25" x2="50" y2="75"></line><line x1="30" y1="60" x2="50" y2="75"></line><line x1="70" y1="60" x2="50" y2="75"></line></svg></button> <button title="reset all sessions" class="clear-button svelte-1cyr8za"><svg xmlns="http://www.w3.org/2000/svg" version="2.0" width="20px" height="20px" viewBox="0 0 100 100" class="svelte-1cyr8za"><line x1="25" y1="25" x2="75" y2="75"></line><line x1="25" y1="75" x2="75" y2="25"></line></svg></button></div> <div class="info svelte-1cyr8za"><button title="Show information about the app" class="button-info svelte-1cyr8za">info</button> <!></div></footer> <!></div>');function l1(n,e){fe(e,!0);let r=V(e,"tabs",19,()=>[]),l=V(e,"isBeta",3,!1);const s="mdatools-"+e.appID;let a=te(!1),o=te(void 0),c=te("Current session "),d=te(!1);function u(C){F(c,C,!0),F(d,!0),setTimeout(()=>{F(c,"Current session "),F(d,!1)},1e3)}function f(){F(a,!1)}function v(C){t(o).tab=C}function m(){const C=indexedDB.open(s,1);C.onsuccess=L=>{const P=L.target.result.transaction(e.appID,"readwrite");P.objectStore(e.appID).delete("session"),P.oncomplete=()=>{F(o,e.initSession(),!0),u("Session was reinitialzed.")},P.onerror=()=>console.error("Failed to session from DB.")}}function h(C,L){window.localStorage.removeItem(e.appID+"-blocked");const k=indexedDB.open(s,1);k.onsuccess=P=>{const R=P.target.result.transaction(e.appID,"readwrite").objectStore(e.appID);R.put(C,"session"),R.put(Is(new Date),"session-update")}}function p(){new Promise((C,L)=>{const k=indexedDB.open(s,1);k.onsuccess=P=>{const A=P.target.result.transaction(e.appID,"readonly").objectStore(e.appID).get("session");A.onsuccess=()=>C(A.result),A.onerror=()=>L(A.error)}}).then(C=>{w(C),F(c,"Last session is restored "),F(d,!0),setTimeout(()=>{F(c,"Current session "),F(d,!1)},1500)}).catch(C=>{console.error(C),F(o,e.initSession(),!0)})}function w(C){if(!C||C==="undefined"){F(o,e.initSession(),!0);return}const L=JSON.parse(C,Ms);F(o,e.checkSession(L)?L:e.initSession(e.appID),!0)}function b(C){e.resetSession(t(o));const L=new FileReader;L.onload=()=>{w(L.result),C.target.value=""},L.readAsText(C.target.files[0])}Pu(()=>{const C=e.appID,L=indexedDB.open(s,1);L.onupgradeneeded=k=>{const P=k.target.result;P.objectStoreNames.contains(C)||P.createObjectStore(C)},L.onsuccess=k=>{p()}});var _=ce(),S=X(_);{var y=C=>{var L=n1(),k=Y(L),P=Y(k),z=Y(P),j=N(z,2),R=Y(j),A=N(R);{var I=he=>{var pe=$g();E(he,pe)};B(A,he=>{l()&&he(I)})}var D=N(j,2),W=Y(D),T=N(P,2);Me(T,21,r,qe,(he,pe,Pe)=>{var re=e1();let de;var le=Y(re);le.__click=()=>v(Pe),le.__keydown=()=>v(Pe);var we=Y(le);ne(ue=>{de=pt(re,1,"nav-item svelte-1cyr8za",null,de,ue),ke(we,t(pe).name)},[()=>({selected:t(o).tab===Pe})]),E(he,re)});var q=N(k,2);Me(q,21,r,qe,(he,pe,Pe)=>{var re=t1();let de;var le=Y(re);Jn(le,()=>t(pe).component,(we,ue)=>{ue(we,{get WASM(){return e.WASM},get session(){return t(o)},backupSession:h})}),ne(we=>de=pt(re,1,"tab-content svelte-1cyr8za",null,de,we),[()=>({hidden:t(o).tab!==Pe})]),E(he,re)});var Z=N(q,2),M=Y(Z);let U;var K=Y(M),J=Y(K),se=N(K,2),$=Y(se);$.__change=b;var Q=N(se,2);Q.__click=[Qg,e,o];var ae=N(Q,2);ae.__click=[Zg,m];var _e=N(M,2),ie=Y(_e);ie.__click=[qi,a],ie.__keydown=[qi,a];var ye=N(ie,2);Sr(ye,()=>e.footer);var Ce=N(Z,2);{var me=he=>{Qs(he,{closeModal:f,children:(pe,Pe)=>{var re=r1(),de=Y(re);Sr(de,()=>e.info),E(pe,re)},$$slots:{default:!0}})};B(Ce,he=>{t(a)&&he(me)})}ne(he=>{O(z,"alt",e.appShortTitle),ke(R,e.appTitle),ke(W,e.appSlogan),U=pt(M,1,"session svelte-1cyr8za",null,U,he),ke(J,t(c))},[()=>({"no-buttons":t(d)})]),E(C,L)};B(S,C=>{t(o)&&C(y)})}E(n,_),ve()}vt(["click","keydown","change"]);const g1="modulepreload",p1=function(n){return"/"+n},b1={},s1=function(e,r,l){let s=Promise.resolve();function a(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return s.then(o=>{for(const c of o||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})};async function a1(n={}){var Yi;var e,r=n,l=typeof window=="object",s=typeof WorkerGlobalScope<"u",a=typeof process=="object"&&((Yi=process.versions)==null?void 0:Yi.node)&&process.type!="renderer";if(a){const{createRequire:G}=await s1(()=>Promise.resolve().then(()=>u1),void 0);var o=G(Qe&&Qe.tagName.toUpperCase()==="SCRIPT"&&Qe.src||new URL("pls.js",document.baseURI).href)}var c=(G,ee)=>{throw ee},d=Qe&&Qe.tagName.toUpperCase()==="SCRIPT"&&Qe.src||new URL("pls.js",document.baseURI).href,u="";function f(G){return r.locateFile?r.locateFile(G,u):u+G}var v,m;if(a){var h=o("fs");d.startsWith("file:")&&(u=o("path").dirname(o("url").fileURLToPath(d))+"/"),m=G=>{G=y(G)?new URL(G):G;var ee=h.readFileSync(G);return ee},v=async(G,ee=!0)=>{G=y(G)?new URL(G):G;var be=h.readFileSync(G,ee?void 0:"utf8");return be},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),c=(G,ee)=>{throw process.exitCode=G,ee}}else if(l||s){try{u=new URL(".",d).href}catch{}s&&(m=G=>{var ee=new XMLHttpRequest;return ee.open("GET",G,!1),ee.responseType="arraybuffer",ee.send(null),new Uint8Array(ee.response)}),v=async G=>{if(y(G))return new Promise((be,rt)=>{var Je=new XMLHttpRequest;Je.open("GET",G,!0),Je.responseType="arraybuffer",Je.onload=()=>{if(Je.status==200||Je.status==0&&Je.response){be(Je.response);return}rt(Je.status)},Je.onerror=rt,Je.send(null)});var ee=await fetch(G,{credentials:"same-origin"});if(ee.ok)return ee.arrayBuffer();throw new Error(ee.status+" : "+ee.url)}}var p=console.log.bind(console),w=console.error.bind(console),b,_=!1,S,y=G=>G.startsWith("file://"),C,L,k,P,z,j,R=!1;function A(){var G=k.buffer;P=new Int8Array(G),z=new Uint8Array(G),r.HEAP32=new Int32Array(G),j=new Uint32Array(G),r.HEAPF64=new Float64Array(G),new BigInt64Array(G),new BigUint64Array(G)}function I(){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;)Pe(r.preRun.shift());Ce(pe)}function D(){R=!0,dl.i()}function W(){if(r.postRun)for(typeof r.postRun=="function"&&(r.postRun=[r.postRun]);r.postRun.length;)he(r.postRun.shift());Ce(me)}var T=0,q=null;function Z(G){var ee;T++,(ee=r.monitorRunDependencies)==null||ee.call(r,T)}function M(G){var be;if(T--,(be=r.monitorRunDependencies)==null||be.call(r,T),T==0&&q){var ee=q;q=null,ee()}}function U(G){var be;(be=r.onAbort)==null||be.call(r,G),G="Aborted("+G+")",w(G),_=!0,G+=". Build with -sASSERTIONS for more info.";var ee=new WebAssembly.RuntimeError(G);throw L==null||L(ee),ee}var K;function J(){return r.locateFile?f("pls_wasm.wasm"):new URL("/pls/pls.wasm",Qe&&Qe.tagName.toUpperCase()==="SCRIPT"&&Qe.src||new URL("pls.js",document.baseURI).href).href}function se(G){if(G==K&&b)return new Uint8Array(b);if(m)return m(G);throw"both async and sync fetching of the wasm failed"}async function $(G){if(!b)try{var ee=await v(G);return new Uint8Array(ee)}catch{}return se(G)}async function Q(G,ee){try{var be=await $(G),rt=await WebAssembly.instantiate(be,ee);return rt}catch(Je){w(`failed to asynchronously prepare wasm: ${Je}`),U(Je)}}async function ae(G,ee,be){if(!G&&!y(ee)&&!a)try{var rt=fetch(ee,{credentials:"same-origin"}),Je=await WebAssembly.instantiateStreaming(rt,be);return Je}catch(ct){w(`wasm streaming compile failed: ${ct}`),w("falling back to ArrayBuffer instantiation")}return Q(ee,be)}function _e(){return{a:d1}}async function ie(){function G(ct,ut){return dl=ct.exports,k=dl.h,A(),ua(dl),M(),dl}Z();function ee(ct){return G(ct.instance)}var be=_e();if(r.instantiateWasm)return new Promise((ct,ut)=>{r.instantiateWasm(be,(ft,fr)=>{ct(G(ft))})});K??(K=J());var rt=await ae(b,K,be),Je=ee(rt);return Je}class ye{constructor(ee){vr(this,"name","ExitStatus");this.message=`Program terminated with exit(${ee})`,this.status=ee}}var Ce=G=>{for(;G.length>0;)G.shift()(r)},me=[],he=G=>me.push(G),pe=[],Pe=G=>pe.push(G),re=!0,de=G=>Wl(G),le=()=>Et(),we=()=>U(""),ue=0,Ee=()=>{re=!1,ue=0},Re={},je=G=>{if(G instanceof ye||G=="unwind")return S;c(1,G)},Ve=()=>re||ue>0,tt=G=>{var ee;S=G,Ve()||((ee=r.onExit)==null||ee.call(r,G),_=!0),c(G,new ye(G))},Ye=(G,ee)=>{S=G,tt(G)},Be=Ye,Ze=()=>{if(!Ve())try{Be(S)}catch(G){je(G)}},Xe=G=>{if(!_)try{G(),Ze()}catch(ee){je(ee)}},Ke=()=>performance.now(),Qt=(G,ee)=>{if(Re[G]&&(clearTimeout(Re[G].id),delete Re[G]),!ee)return 0;var be=setTimeout(()=>{delete Re[G],Xe(()=>Nt(G,Ke()))},ee);return Re[G]={id:be,timeout_ms:ee},0},Pr=()=>Date.now(),Lr=()=>2147483648,Se=(G,ee)=>Math.ceil(G/ee)*ee,Le=G=>{var ee=k.buffer.byteLength,be=(G-ee+65535)/65536|0;try{return k.grow(be),A(),1}catch{}},Ae=G=>{var ee=z.length;G>>>=0;var be=Lr();if(G>be)return!1;for(var rt=1;rt<=4;rt*=2){var Je=ee*(1+.2/rt);Je=Math.min(Je,G+100663296);var ct=Math.min(be,Se(Math.max(G,Je),65536)),ut=Le(ct);if(ut)return!0}return!1},ze=[null,[],[]],_t=typeof TextDecoder<"u"?new TextDecoder:void 0,dr=(G,ee,be,rt)=>{for(var Je=ee+be;G[ee]&&!(ee>=Je);)++ee;return ee},Bt=(G,ee=0,be,rt)=>{var Je=dr(G,ee,be);if(Je-ee>16&&G.buffer&&_t)return _t.decode(G.subarray(ee,Je));for(var ct="";ee<Je;){var ut=G[ee++];if(!(ut&128)){ct+=String.fromCharCode(ut);continue}var ft=G[ee++]&63;if((ut&224)==192){ct+=String.fromCharCode((ut&31)<<6|ft);continue}var fr=G[ee++]&63;if((ut&240)==224?ut=(ut&15)<<12|ft<<6|fr:ut=(ut&7)<<18|ft<<12|fr<<6|G[ee++]&63,ut<65536)ct+=String.fromCharCode(ut);else{var xn=ut-65536;ct+=String.fromCharCode(55296|xn>>10,56320|xn&1023)}}return ct},Yt=(G,ee)=>{var be=ze[G];ee===0||ee===10?((G===1?p:w)(Bt(be)),be.length=0):be.push(ee)},ot=(G,ee,be)=>G?Bt(z,G,ee):"",$e=(G,ee,be,rt)=>{for(var Je=0,ct=0;ct<be;ct++){var ut=j[ee>>2],ft=j[ee+4>>2];ee+=8;for(var fr=0;fr<ft;fr++)Yt(G,z[ut+fr]);Je+=ft}return j[rt>>2]=Je,0},Mt=G=>{var ee=r["_"+G];return ee},kt=(G,ee)=>{P.set(G,ee)},wt=G=>{for(var ee=0,be=0;be<G.length;++be){var rt=G.charCodeAt(be);rt<=127?ee++:rt<=2047?ee+=2:rt>=55296&&rt<=57343?(ee+=4,++be):ee+=3}return ee},dt=(G,ee,be,rt)=>{if(!(rt>0))return 0;for(var Je=be,ct=be+rt-1,ut=0;ut<G.length;++ut){var ft=G.codePointAt(ut);if(ft<=127){if(be>=ct)break;ee[be++]=ft}else if(ft<=2047){if(be+1>=ct)break;ee[be++]=192|ft>>6,ee[be++]=128|ft&63}else if(ft<=65535){if(be+2>=ct)break;ee[be++]=224|ft>>12,ee[be++]=128|ft>>6&63,ee[be++]=128|ft&63}else{if(be+3>=ct)break;ee[be++]=240|ft>>18,ee[be++]=128|ft>>12&63,ee[be++]=128|ft>>6&63,ee[be++]=128|ft&63,ut++}}return ee[be]=0,be-Je},sr=(G,ee,be)=>dt(G,z,ee,be),Kr=G=>kr(G),nt=G=>{var ee=wt(G)+1,be=Kr(ee);return sr(G,be,ee),be},Te=(G,ee,be,rt,Je)=>{var ct={string:Zt=>{var fl=0;return Zt!=null&&Zt!==0&&(fl=nt(Zt)),fl},array:Zt=>{var fl=Kr(Zt.length);return kt(Zt,fl),fl}};function ut(Zt){return ee==="string"?ot(Zt):ee==="boolean"?!!Zt:Zt}var ft=Mt(G),fr=[],xn=0;if(rt)for(var kn=0;kn<rt.length;kn++){var Wi=ct[be[kn]];Wi?(xn===0&&(xn=le()),fr[kn]=Wi(rt[kn])):fr[kn]=rt[kn]}var fa=ft(...fr);function v1(Zt){return xn!==0&&de(xn),ut(Zt)}return fa=v1(fa),fa};r.noExitRuntime&&(re=r.noExitRuntime),r.print&&(p=r.print),r.printErr&&(w=r.printErr),r.wasmBinary&&(b=r.wasmBinary),r.arguments&&r.arguments,r.thisProgram&&r.thisProgram,r.ccall=Te;var Nt,Wl,kr,Et;function ua(G){r._plsfit_wasm=G.j,r._free=G.k,r._malloc=G.l,r._plspredict_wasm=G.m,r._pcvpls_wasm=G.n,r._prepfit_wasm=G.o,r._prepapply_wasm=G.p,Nt=G.q,Wl=G.r,kr=G.s,Et=G.t}var d1={c:we,b:Ee,d:Qt,g:Pr,e:Ae,f:$e,a:tt},dl=await ie();function da(){if(T>0){q=da;return}if(I(),T>0){q=da;return}function G(){var ee;r.calledRun=!0,!_&&(D(),C==null||C(r),(ee=r.onRuntimeInitialized)==null||ee.call(r),W())}r.setStatus?(r.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>r.setStatus(""),1),G()},1)):G()}function f1(){if(r.preInit)for(typeof r.preInit=="function"&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.shift()()}return f1(),da(),R?e=r:e=new Promise((G,ee)=>{C=G,L=ee}),e}var o1=H('<p>Current release: <span>1.2.6</span> Feedback: <a class="paper-link" href="mailto:help@mda.tools?subject=PCA app">help@mda.tools</a> Tutorial: <a class="paper-link" href="Tecator.zip" download="">dataset</a> | <a href="">video lessons</a></p>'),i1=H(`<h2>Partial Least Squares regression</h2> <p>Interactive web-application for creating, testing and applying PLS models for multivariate regression
      directly in your browser. The app does not send any information to the server,
      all calculations are done locally on your device.</p> <p>The application uses <a href="https://doi.org/10.1016/j.aca.2023.341096">Procrustes cross-validation</a> for optimization and quality check on the training stage.</p> <p>Check out YouTube <a href="">video-lessons</a> for more details. The lessons are based on the Tecator dataset, which
   you can download from the app. These data are recorded on a Tecator Infratec Food and Feed Analyzer working in the wavelength
   range 850—1050 nm by the Near Infrared Transmission (NIT) principle. The response variable is Fat content (original
   dataset also contains moisture and protein content).</p> <h3>v. 1.2.6</h3> <p class="release-info">released 25/08/2025</p> <ul><li>Fixed small bugs in preprocessing.</li> <li>Added links to tutorial videos and dataset.</li></ul> <h3>v. 1.2.5</h3> <p class="release-info">released 2/08/2025</p> <ul><li>Built in preprocessing functionality.</li> <li>Added ability to read SPC files in <em>Predict</em> tab.</li> <li>Numerous small improvements and bug fixes.</li></ul>`,1);function c1(n,e){fe(e,!1);function r(o){o.train.calset=null,o.test.model=null,o.new.model=null,o.tab=0}function l(o){const c=Object.keys(o);if(!["date","tab","train","test","new"].every(p=>c.includes(p)))return!1;const d=["model","calset","calsetp","calres","pvset","pvres","outliers","exclvars","ncomp_selected","pvscalars","prepType","prepmodel","prepmeta","prepobj"],u=Object.keys(o.train);if(!d.every(p=>u.includes(p)))return!1;const f=["model","testset","testres","outliers","ncomp_selected"],v=Object.keys(o.test);if(!f.every(p=>v.includes(p)))return!1;const m=["model","newset","newres","outliers","ncomp_selected"],h=Object.keys(o.new);return!!m.every(p=>h.includes(p))}function s(){return{date:Is(new Date),tab:0,train:{model:0,calset:0,calsetp:0,calres:0,pvset:0,pvres:0,outliers:[],exclvars:[],ncomp_selected:1,pvscalars:0,prepType:null,prepmodel:0,prepmeta:0,prepobj:[]},test:{model:0,testset:0,testres:0,outliers:[],ncomp_selected:1},new:{model:0,newset:0,newres:0,outliers:[],ncomp_selected:1}}}const a=[{name:"Train",label:"train",component:yg},{name:"Test",label:"test",component:Og},{name:"Predict",label:"new",component:Jg}];Su(),l1(n,{appID:"pls",appTitle:"PLS",appShortTitle:"PLS",appSlogan:"Partial least squares regression",get WASM(){return a1},get tabs(){return a},initSession:s,checkSession:l,resetSession:r,footer:d=>{var u=o1();E(d,u)},info:d=>{var u=i1();E(d,u)},$$slots:{footer:!0,info:!0}}),ve()}ou(c1,{target:document.body});const u1=Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"}))})();
//# sourceMappingURL=pls.js.map
